<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Number Field Ideals &mdash; Sage Reference Manual v6.7: Algebraic Number Fields</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.7: Algebraic Number Fields" href="../../../index.html" />
    <link rel="next" title="Relative Number Field Ideals" href="number_field_ideal_rel.html" />
    <link rel="prev" title="Orders in Number Fields" href="order.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="number_field_ideal_rel.html" title="Relative Number Field Ideals"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="order.html" title="Orders in Number Fields"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Algebraic Number Fields</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="number-field-ideals">
<span id="sage-rings-number-field-number-field-ideal"></span><h1>Number Field Ideals<a class="headerlink" href="#number-field-ideals" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.number_field.number_field_ideal"></span><p>AUTHORS:</p>
<ul>
<li><p class="first">Steven Sivek (2005-05-16)</p>
</li>
<li><p class="first">William Stein (2007-09-06): vastly improved the doctesting</p>
</li>
<li><p class="first">William Stein and John Cremona (2007-01-28): new class
NumberFieldFractionalIdeal now used for all except the 0 ideal</p>
</li>
<li><dl class="first docutils">
<dt>Radoslav Kirov and Alyson Deines (2010-06-22):</dt>
<dd><p class="first last">prime_to_S_part, is_S_unit, is_S_integral</p>
</dd>
</dl>
</li>
</ul>
<p>We test that pickling works:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.rings.number_field.number_field_ideal.LiftMap">
<em class="property">class </em><tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">LiftMap</tt><big>(</big><em>OK</em>, <em>M_OK_map</em>, <em>Q</em>, <em>I</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.LiftMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold data needed by lifting maps from residue fields to
number field orders.</p>
</dd></dl>

<dl class="class">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal">
<em class="property">class </em><tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">NumberFieldFractionalIdeal</tt><big>(</big><em>field</em>, <em>gens</em>, <em>coerce=True</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal" title="sage.rings.number_field.number_field_ideal.NumberFieldIdeal"><tt class="xref py py-class docutils literal"><span class="pre">sage.rings.number_field.number_field_ideal.NumberFieldIdeal</span></tt></a></p>
<p>A fractional ideal in a number field.</p>
<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.denominator">
<tt class="descname">denominator</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.denominator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the denominator ideal of this fractional ideal. Each
fractional ideal has a unique expression as <span class="math">\(N/D\)</span> where <span class="math">\(N\)</span>,
<span class="math">\(D\)</span> are coprime integral ideals; the denominator is <span class="math">\(D\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (4/5*i + 3/5)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">Fractional ideal (2*i + 1)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">Fractional ideal (-i - 2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span> <span class="ow">and</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">+</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">/</span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.divides">
<tt class="descname">divides</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.divides" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this ideal divides other and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Cyclotomic Field of order 11 and degree 10</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">31</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (31, a^5 + 10*a^4 - a^3 + a^2 + 9*a - 1)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.element_1_mod">
<tt class="descname">element_1_mod</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.element_1_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an element <span class="math">\(r\)</span> in this ideal such that <span class="math">\(1-r\)</span> is in other</p>
<p>An error is raised if either ideal is not integral of if they
are not coprime.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; another ideal of the same field, or generators
of an ideal.</li>
</ul>
<p>OUTPUT:</p>
<p>An element <span class="math">\(r\)</span> of the ideal self such that <span class="math">\(1-r\)</span> is in the ideal other</p>
<p>AUTHOR: Maite Aranes (modified to use PARI&#8217;s idealaddtoone by Francis Clarke)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">A</span><span class="p">;</span> <span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">Fractional ideal (a + 1)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">B</span><span class="p">;</span> <span class="n">B</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">Fractional ideal (a^2 - 4*a + 2)</span>
<span class="go">68</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">element_1_mod</span><span class="p">(</span><span class="n">B</span><span class="p">);</span> <span class="n">r</span>
<span class="go">-a^2 + 4*a - 1</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="ow">in</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">1</span><span class="o">-</span><span class="n">r</span> <span class="ow">in</span> <span class="n">B</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">B</span><span class="p">;</span> <span class="n">B</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">Fractional ideal (a^2 - 4*a + 1)</span>
<span class="go">99</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">element_1_mod</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">Fractional ideal (a + 1), Fractional ideal (a^2 - 4*a + 1) are not coprime ideals</span>

<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">);</span> <span class="n">B</span>
<span class="go">Fractional ideal (1/2*a^2)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">element_1_mod</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">Fractional ideal (1/2*a^2) is not an integral ideal</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.euler_phi">
<tt class="descname">euler_phi</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.euler_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Euler <span class="math">\(\varphi\)</span>-function of this integral ideal.</p>
<p>This is the order of the multiplicative group of the quotient
modulo the ideal.</p>
<p>An error is raised if the ideal is not integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span> <span class="k">if</span> <span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span>
<span class="go">[-2*i, -i, i, 2*i]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">J</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span> <span class="k">if</span> <span class="n">J</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">r</span><span class="p">)])</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span><span class="o">*</span><span class="n">J</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">J</span><span class="p">)</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.factor">
<tt class="descname">factor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization of this ideal in terms of prime ideals.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">23</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^4 + 23</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">19</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (19)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">F</span>
<span class="go">(Fractional ideal (19, 1/2*a^2 + a - 17/2)) * (Fractional ideal (19, 1/2*a^2 - a - 17/2))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.structure.factorization.Factorization&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[(Fractional ideal (19, 1/2*a^2 + a - 17/2), 1), (Fractional ideal (19, 1/2*a^2 - a - 17/2), 1)]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">Fractional ideal (19)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealcoprime">
<tt class="descname">idealcoprime</tt><big>(</big><em>J</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealcoprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns l such that l*self is coprime to J.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">J</span></tt> - another integral ideal of the same field as self, which must also be integral.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">l</span></tt> - an element such that l*self is coprime to the ideal J</li>
</ul>
<p>TODO: Extend the implementation to non-integral ideals.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">lam</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealcoprime</span><span class="p">(</span><span class="n">B</span><span class="p">);</span> <span class="n">lam</span>
<span class="go">-1/6*a + 1/6</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">lam</span><span class="o">*</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Pari function <tt class="docutils literal"><span class="pre">idealcoprime</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ideallog">
<tt class="descname">ideallog</tt><big>(</big><em>x</em>, <em>gens=None</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ideallog" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the discrete logarithm of x with respect to the generators
given in the <tt class="docutils literal"><span class="pre">bid</span></tt> structure of the ideal self, or with respect to
the generators <tt class="docutils literal"><span class="pre">gens</span></tt> if these are given.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - a non-zero element of the number field of self,
which must have valuation equal to 0 at all prime ideals in
the support of the ideal self.</li>
<li><tt class="docutils literal"><span class="pre">gens</span></tt> - a list of elements of the number field which generate <span class="math">\((R
/ I)^*\)</span>, where <span class="math">\(R\)</span> is the ring of integers of the field and <span class="math">\(I\)</span> is
this ideal, or <tt class="docutils literal"><span class="pre">None</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt>, use the generators calculated
by <a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar" title="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar"><tt class="xref py py-meth docutils literal"><span class="pre">idealstar()</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> - if True, do a consistency check on the results. Ignored
if <tt class="docutils literal"><span class="pre">gens</span></tt> is None.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">l</span></tt> - a list of non-negative integers <span class="math">\((x_i)\)</span> such that <span class="math">\(x =
\prod_i g_i^{x_i}\)</span> in <span class="math">\((R/I)^*\)</span>, where <span class="math">\(x_i\)</span> are the generators, and
the list <span class="math">\((x_i)\)</span> is lexicographically minimal with respect to this
requirement. If the <span class="math">\(x_i\)</span> generate independent cyclic factors of
order <span class="math">\(d_i\)</span>, as is the case for the default generators calculated by
<a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar" title="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar"><tt class="xref py py-meth docutils literal"><span class="pre">idealstar()</span></tt></a>, this just means that <span class="math">\(0 \le x_i &lt; d_i\)</span>.</li>
</ul>
<p>A <tt class="docutils literal"><span class="pre">ValueError</span></tt> will be raised if the elements specified in <tt class="docutils literal"><span class="pre">gens</span></tt>
do not in fact generate the unit group (even if the element <span class="math">\(x\)</span> is in
the subgroup they generate).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">G</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="c"># random</span>
<span class="go">a^2 - 2</span>
</pre></div>
</div>
<p>Examples with custom generators:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">[10, 3]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">])</span>
<span class="go">[0, 118]</span>

<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">21</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[4, 13]</span>
</pre></div>
</div>
<p>A non-example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Given elements do not generate unit group -- they generate a subgroup of index 36</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Pari function <tt class="docutils literal"><span class="pre">ideallog</span></tt>, and (if <tt class="docutils literal"><span class="pre">gens</span></tt> is not
None) a Hermite normal form calculation to express the result in terms
of the generators <tt class="docutils literal"><span class="pre">gens</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar">
<tt class="descname">idealstar</tt><big>(</big><em>flag=1</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the finite abelian group <span class="math">\((O_K/I)^*\)</span>, where I is the ideal self
of the number field K, and <span class="math">\(O_K\)</span> is the ring of integers of K.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">flag</span></tt> (int default 1) &#8211; when <tt class="docutils literal"><span class="pre">flag</span></tt> =2, it also
computes the generators of the group <span class="math">\((O_K/I)^*\)</span>, which
takes more time. By default <tt class="docutils literal"><span class="pre">flag</span></tt> =1 (no generators are
computed). In both cases the special pari structure <tt class="docutils literal"><span class="pre">bid</span></tt>
is computed as well.  If <tt class="docutils literal"><span class="pre">flag</span></tt> =0 (deprecated) it computes
only the group structure of <span class="math">\((O_K/I)^*\)</span> (with generators)
and not the special <tt class="docutils literal"><span class="pre">bid</span></tt> structure.</li>
</ul>
<p>OUTPUT:</p>
<p>The finite abelian group <span class="math">\((O_K/I)^*\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Uses the pari function <tt class="docutils literal"><span class="pre">idealstar</span></tt>. The pari function outputs
a special <tt class="docutils literal"><span class="pre">bid</span></tt> structure which is stored in the internal
field <tt class="docutils literal"><span class="pre">_bid</span></tt> of the ideal (when flag=1,2). The special structure
<tt class="docutils literal"><span class="pre">bid</span></tt> is used in the pari function <tt class="docutils literal"><span class="pre">ideallog</span></tt>
to compute discrete logarithms.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealstar</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Multiplicative Abelian group isomorphic to C24 x C4</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(f0, f1)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(f0, f1)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>   <span class="c"># random output</span>
<span class="go">(2*a^2 - 1, 2*a^2 + 2*a - 2)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">G</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="ow">in</span> <span class="n">k</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">ngens</span><span class="p">())])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Trivial Abelian group</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Pari function <tt class="docutils literal"><span class="pre">idealstar</span></tt></p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues">
<tt class="descname">invertible_residues</tt><big>(</big><em>reduce=True</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a iterator through a list of invertible residues
modulo this integral ideal.</p>
<p>An error is raised if this fractional ideal is not integral.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">reduce</span></tt> - bool. If True (default), use <tt class="docutils literal"><span class="pre">small_residue</span></tt> to get
small representatives of the residues.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>An iterator through a list of invertible residues modulo this ideal
<span class="math">\(I\)</span>, i.e. a list of elements in the ring of integers <span class="math">\(R\)</span> representing
the elements of <span class="math">\((R/I)^*\)</span>.</li>
</ul>
<p>ALGORITHM: Use pari&#8217;s <tt class="docutils literal"><span class="pre">idealstar</span></tt> to find the group structure and
generators of the multiplicative group modulo the ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ires</span> <span class="o">=</span>  <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">();</span> <span class="n">ires</span>
<span class="go">xmrange_iter([[0, 1]], &lt;function &lt;lambda&gt; at 0x...&gt;)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">ires</span><span class="p">)</span>
<span class="go">[1, -i]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">())</span>
<span class="go">[1, 2, 4, 3]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">())</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">units</span><span class="o">=</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">units</span><span class="p">))</span><span class="o">==</span><span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">()))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">()))</span>
<span class="go">80</span>
</pre></div>
</div>
<p>AUTHOR: John Cremona</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues_mod">
<tt class="descname">invertible_residues_mod</tt><big>(</big><em>subgp_gens=</em>, <span class="optional">[</span><span class="optional">]</span><em>reduce=True</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a iterator through a list of representatives for the invertible
residues modulo this integral ideal, modulo the subgroup generated by
the elements in the list <tt class="docutils literal"><span class="pre">subgp_gens</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">subgp_gens</span></tt> - either None or a list of elements of the number
field of self. These need not be integral, but should be coprime to
the ideal self. If the list is empty or None, the function returns
an iterator through a list of representatives for the invertible
residues modulo the integral ideal self.</li>
<li><tt class="docutils literal"><span class="pre">reduce</span></tt> - bool. If True (default), use <tt class="docutils literal"><span class="pre">small_residues</span></tt> to
get small representatives of the residues.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See also invertible_residues() for a simpler version without the subgroup.</p>
</div>
<p>OUTPUT:</p>
<ul class="simple">
<li>An iterator through a list of representatives for the invertible
residues modulo self and modulo the group generated by
<tt class="docutils literal"><span class="pre">subgp_gens</span></tt>, i.e. a list of elements in the ring of integers <span class="math">\(R\)</span>
representing the elements of <span class="math">\((R/I)^*/U\)</span>, where <span class="math">\(I\)</span> is this ideal and
<span class="math">\(U\)</span> is the subgroup of <span class="math">\((R/I)^*\)</span> generated by <tt class="docutils literal"><span class="pre">subgp_gens</span></tt>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[1, 5, 2, 10, 4, 20, 8, 17, 16, 11, 9]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">[1, 5]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([</span><span class="mi">23</span><span class="p">]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">the element must be invertible mod the ideal</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([])))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([]))</span>
<span class="go">[1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([])))</span>
<span class="go">80</span>
</pre></div>
</div>
<p>AUTHOR: Maite Aranes.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_integral">
<tt class="descname">is_S_integral</tt><big>(</big><em>S</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this fractional ideal is integral with respect to the list of primes <tt class="docutils literal"><span class="pre">S</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(S\)</span> - a list of prime ideals (not checked if they are indeed
prime).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function assumes that <span class="math">\(S\)</span> is a list of prime ideals,
but does not check this.  This function will fail if <span class="math">\(S\)</span> is
not a list of prime ideals.</p>
</div>
<p>OUTPUT:</p>
<p>True, if the ideal is <span class="math">\(S\)</span>-integral: that is, if the valuations
of the ideal at all primes not in <span class="math">\(S\)</span> are non-negative. False,
otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_S_integral</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_S_integral</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_unit">
<tt class="descname">is_S_unit</tt><big>(</big><em>S</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this fractional ideal is a unit with respect to the list of primes <tt class="docutils literal"><span class="pre">S</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(S\)</span> - a list of prime ideals (not checked if they are
indeed prime).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function assumes that <span class="math">\(S\)</span> is a list of prime ideals,
but does not check this.  This function will fail if <span class="math">\(S\)</span> is
not a list of prime ideals.</p>
</div>
<p>OUTPUT:</p>
<p>True, if the ideal is an <span class="math">\(S\)</span>-unit: that is, if the valuations of
the ideal at all primes not in <span class="math">\(S\)</span> are zero. False, otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_S_unit</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_coprime">
<tt class="descname">is_coprime</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_coprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this ideal is coprime to the other, else False.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; another ideal of the same field, or generators
of an ideal.</li>
</ul>
<p>OUTPUT:</p>
<p>True if self and other are coprime, else False.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function works for fractional ideals as well as
integral ideals.</p>
</div>
<p>AUTHOR: John Cremona</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">J</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="mi">6</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">True</span>

<span class="go"># See trac \# 4536:</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OE</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">OE</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_maximal">
<tt class="descname">is_maximal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_maximal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this ideal is maximal.  This is equivalent to
self being prime, since it is nonzero.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^3 + 3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_trivial">
<tt class="descname">is_trivial</tt><big>(</big><em>proof=None</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_trivial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this is a trivial ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="n">J</span><span class="p">)</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.numerator">
<tt class="descname">numerator</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.numerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the numerator ideal of this fractional ideal.</p>
<p>Each fractional ideal has a unique expression as <span class="math">\(N/D\)</span> where <span class="math">\(N\)</span>,
<span class="math">\(D\)</span> are coprime integral ideals.  The numerator is <span class="math">\(N\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (4/5*i + 3/5)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">Fractional ideal (2*i + 1)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">Fractional ideal (-i - 2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span> <span class="ow">and</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">+</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">/</span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_factors">
<tt class="descname">prime_factors</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the prime ideal factors of self</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>list &#8211; list of prime ideals (a new list is returned
each time this function is called)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">prime_factors</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, 1/2*w - 1/2), Fractional ideal (2, 1/2*w + 1/2), Fractional ideal (3, 1/2*w + 1/2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_S_part">
<tt class="descname">prime_to_S_part</tt><big>(</big><em>S</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_S_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the part of this fractional ideal which is coprime to the prime ideals in the list <tt class="docutils literal"><span class="pre">S</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function assumes that <span class="math">\(S\)</span> is a list of prime ideals,
but does not check this.  This function will fail if <span class="math">\(S\)</span> is
not a list of prime ideals.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(S\)</span> - a list of prime ideals</li>
</ul>
<p>OUTPUT:</p>
<p>A fractional ideal coprime to the primes in <span class="math">\(S\)</span>, whose prime
factorization is that of <tt class="docutils literal"><span class="pre">self</span></tt> withe the primes in <span class="math">\(S\)</span>
removed.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">),</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">prime_to_S_part</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Fractional ideal (3)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">prime_to_S_part</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Fractional ideal (3)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">15161</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">28383</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">53135</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">99478</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">186250</span><span class="p">),</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">11</span><span class="p">),</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">101</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">prime_to_S_part</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Fractional ideal (24)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_idealM_part">
<tt class="descname">prime_to_idealM_part</tt><big>(</big><em>M</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_idealM_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Version for integral ideals of the <tt class="docutils literal"><span class="pre">prime_to_m_part</span></tt> function over <span class="math">\(\ZZ\)</span>.
Returns the largest divisor of self that is coprime to the ideal <tt class="docutils literal"><span class="pre">M</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">M</span></tt> &#8211; an integral ideal of the same field, or generators of an ideal</li>
</ul>
<p>OUTPUT:</p>
<p>An ideal which is the largest divisor of self that is coprime to <span class="math">\(M\)</span>.</p>
<p>AUTHOR: Maite Aranes</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">prime_to_idealM_part</span><span class="p">(</span><span class="n">M</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Fractional ideal (12, 1/2*a + 13/2)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">prime_to_idealM_part</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Fractional ideal (3, 1/2*a + 1/2)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ramification_index">
<tt class="descname">ramification_index</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ramification_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ramification index of this fractional ideal,
assuming it is prime.  Otherwise, raise a ValueError.</p>
<p>The ramification index is the power of this prime appearing in
the factorization of the prime in <span class="math">\(\ZZ\)</span> that this prime lies
over.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(Fractional ideal (a))^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ramification_index</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">ramification_index</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">ramification_index</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Fractional ideal (17) is not a prime ideal</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ray_class_number">
<tt class="descname">ray_class_number</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ray_class_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of the ray class group modulo this ideal. This is a
wrapper around Pari&#8217;s <tt class="docutils literal"><span class="pre">bnrclassno()</span></tt> function.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ray_class_number</span><span class="p">()</span>
<span class="go">3</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ray_class_number</span><span class="p">()</span>
<span class="go">5184</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.reduce">
<tt class="descname">reduce</tt><big>(</big><em>f</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the canonical reduction of the element of <span class="math">\(f\)</span> modulo the ideal
<span class="math">\(I\)</span> (=self). This is an element of <span class="math">\(R\)</span> (the ring of integers of the
number field) that is equivalent modulo <span class="math">\(I\)</span> to <span class="math">\(f\)</span>.</p>
<p>An error is raised if this fractional ideal is not integral or
the element <span class="math">\(f\)</span> is not integral.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - an integral element of the number field</li>
</ul>
<p>OUTPUT:</p>
<p>An integral element <span class="math">\(g\)</span>, such that <span class="math">\(f - g\)</span> belongs to the ideal self
and such that <span class="math">\(g\)</span> is a canonical reduced representative of the coset
<span class="math">\(f + I\)</span> (<span class="math">\(I\)</span> =self) as described in the <tt class="docutils literal"><span class="pre">residues</span></tt> function, namely an integral element with coordinates <span class="math">\((r_0, \dots,r_{n-1})\)</span>, where:</p>
<ul class="simple">
<li><span class="math">\(r_i\)</span> is reduced modulo <span class="math">\(d_i\)</span></li>
<li><span class="math">\(d_i = b_i[i]\)</span>, with <span class="math">\({b_0, b_1, \dots, b_n}\)</span> HNF basis
of the ideal self.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The reduced element <span class="math">\(g\)</span> is not necessarily small. To get a
small <span class="math">\(g\)</span> use the method <tt class="docutils literal"><span class="pre">small_residue</span></tt>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">9</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">a^2 - 2*a</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">-</span> <span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The reduced element is in the list of canonical representatives
returned by the <tt class="docutils literal"><span class="pre">residues</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The reduced element does not necessarily have smaller norm (use
<tt class="docutils literal"><span class="pre">small_residue</span></tt> for that)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">25</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">209</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Sometimes the canonical reduced representative of <span class="math">\(1\)</span> won&#8217;t be <span class="math">\(1\)</span>
(it depends on the choice of basis for the ring of integers):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">-3/2*a - 1/2</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/2*a + 1/2, a]</span>
</pre></div>
</div>
<p>AUTHOR: Maite Aranes.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_class_degree">
<tt class="descname">residue_class_degree</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_class_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the residue class degree of this fractional ideal,
assuming it is prime.  Otherwise, raise a ValueError.</p>
<p>The residue class degree of a prime ideal <span class="math">\(I\)</span> is the degree of
the extension <span class="math">\(O_K/I\)</span> of its prime subfield.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^5 + 2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">19</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(Fractional ideal (a^2 + a - 3)) * (Fractional ideal (-2*a^4 - a^2 + 2*a - 1)) * (Fractional ideal (a^2 + a - 1))</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[2, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field">
<tt class="descname">residue_field</tt><big>(</big><em>names=None</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the residue class field of this fractional ideal, which
must be prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="go">Residue field in abar of Fractional ideal (2*a^2 + 3*a - 10)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">)</span>
<span class="go">Residue field in z of Fractional ideal (2*a^2 + 3*a - 10)</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">P</span>
<span class="go">Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="go">Residue field in abar of Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">)</span>
<span class="go">Residue field in z of Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FF</span>
<span class="go">Residue field in w of Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">390</span><span class="p">)</span>
<span class="go">36</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">w</span>
</pre></div>
</div>
<p>An example of reduction maps to the residue field: these are
defined on the whole valuation ring, i.e. the subring of the
number field consisting of elements with non-negative
valuation.  This shows that the issue raised in <a class="reference external" href="http://trac.sagemath.org/1951">trac ticket #1951</a>
has been fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="p">)];</span> <span class="p">(</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">)</span>
<span class="go">(Fractional ideal (-i - 2), Fractional ideal (2*i + 1))</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F1</span><span class="p">,</span> <span class="n">F2</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">]];</span> <span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="go">(Residue field of Fractional ideal (-i - 2), Residue field of Fractional ideal (2*i + 1))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">F1</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">F1</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">P2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">F2</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="nc">ZeroDivisionError: Cannot reduce field element -2/5*i + 1/5 modulo Fractional ideal (2*i + 1)</span>: <span class="n-Identifier">it has negative valuation</span>
</pre></div>
</div>
<p>An example with a relative number field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">residue_field</span><span class="p">();</span> <span class="n">R</span>
<span class="go">Residue field in abar of Fractional ideal ((-1/2*b - 1/2)*a + 1/2*b - 1/2)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span>
<span class="go">abar</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>
<span class="go">2*abar</span>
</pre></div>
</div>
<p>We verify that #8721 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="go">Residue field in abar of Fractional ideal (a)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residues">
<tt class="descname">residues</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a iterator through a complete list of residues modulo this integral ideal.</p>
<p>An error is raised if this fractional ideal is not integral.</p>
<p>OUTPUT:</p>
<p>An iterator through a complete list of residues modulo the integral
ideal self. This list is the set of canonical reduced representatives
given by all integral elements with coordinates <span class="math">\((r_0, \dots,r_{n-1})\)</span>,
where:</p>
<ul class="simple">
<li><span class="math">\(r_i\)</span> is reduced modulo <span class="math">\(d_i\)</span></li>
<li><span class="math">\(d_i = b_i[i]\)</span>, with <span class="math">\({b_0, b_1, \dots, b_n}\)</span> HNF basis
of the ideal.</li>
</ul>
<p>AUTHOR: John Cremona (modified by Maite Aranes)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">res</span> <span class="o">=</span>  <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">();</span> <span class="n">res</span>
<span class="go">xmrange_iter([[0, 1], [0, 1]], &lt;function &lt;lambda&gt; at 0x...&gt;)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">[0, i, 1, i + 1]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">[-2*i, -i, 0, i, 2*i]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">reps</span><span class="o">=</span><span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">reps</span><span class="p">))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">r</span><span class="o">==</span><span class="n">s</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reps</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">reps</span><span class="p">])</span>  <span class="c"># long time (6s on sage.math, 2011)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">()))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">3</span><span class="o">**</span><span class="mi">5</span>  <span class="c"># long time (5s on sage.math, 2011)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.small_residue">
<tt class="descname">small_residue</tt><big>(</big><em>f</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.small_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an element <span class="math">\(f\)</span> of the ambient number field, returns an
element <span class="math">\(g\)</span> such that <span class="math">\(f - g\)</span> belongs to the ideal self (which
must be integral), and <span class="math">\(g\)</span> is small.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The reduced representative returned is not uniquely determined.</p>
</div>
<p>ALGORITHM: Uses Pari function <tt class="docutils literal"><span class="pre">nfeltreduce</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">13</span><span class="p">)</span>
<span class="go">a^2 + 5*a - 3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal">
<em class="property">class </em><tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">NumberFieldIdeal</tt><big>(</big><em>field</em>, <em>gens</em>, <em>coerce=True</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ideal.html#sage.rings.ideal.Ideal_generic" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v6.7)"><tt class="xref py py-class docutils literal"><span class="pre">sage.rings.ideal.Ideal_generic</span></tt></a></p>
<p>An ideal of a number field.</p>
<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.S_ideal_class_log">
<tt class="descname">S_ideal_class_log</tt><big>(</big><em>S</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.S_ideal_class_log" title="Permalink to this definition">¶</a></dt>
<dd><p>S-class group version of <a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log" title="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log"><tt class="xref py py-meth docutils literal"><span class="pre">ideal_class_log()</span></tt></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">S_ideal_class_log</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">S_ideal_class_log</span><span class="p">([])</span>
<span class="go">[3]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">974</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">S_class_group</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I0</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="mf">0.</span><span class="n">ideal</span><span class="p">();</span> <span class="n">I1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="mf">1.</span><span class="n">ideal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="gp">... </span>          <span class="n">v</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">S_ideal_class_log</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">... </span>          <span class="k">assert</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">G</span><span class="p">(</span><span class="n">I0</span><span class="o">^</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">I1</span><span class="o">^</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_norm">
<tt class="descname">absolute_norm</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for norm.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_norm</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_ramification_index">
<tt class="descname">absolute_ramification_index</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_ramification_index" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for ramification_index.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_ramification_index</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.artin_symbol">
<tt class="descname">artin_symbol</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.artin_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Artin symbol <span class="math">\(( K / \QQ, P)\)</span>, where <span class="math">\(K\)</span> is the
number field of <span class="math">\(P\)</span> =self.  This is the unique element <span class="math">\(s\)</span> of
the decomposition group of <span class="math">\(P\)</span> such that <span class="math">\(s(x) = x^p \pmod{P}\)</span>
where <span class="math">\(p\)</span> is the residue characteristic of <span class="math">\(P\)</span>.  (Here <span class="math">\(P\)</span>
(self) should be prime and unramified.)</p>
<p>See the <tt class="docutils literal"><span class="pre">artin_symbol</span></tt> method of the <tt class="docutils literal"><span class="pre">GaloisGroup_v2</span></tt>
class for further documentation and examples.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">artin_symbol</span><span class="p">()</span>
<span class="go">(1,2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.basis">
<tt class="descname">basis</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an immutable sequence of elements of this ideal (note:
their parent is the number field) that form a basis for this
ideal viewed as a <span class="math">\(\ZZ\)</span> -module.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>basis &#8211; an immutable sequence.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>           <span class="c"># warning -- choice of basis can be somewhat random</span>
<span class="go">[11, 11*z, 11*z^2, z^3 + 5*z^2 + 4*z + 10, z^4 + z^2 + z + 5, z^5 + z^4 + z^3 + 2*z^2 + 6*z + 5]</span>
</pre></div>
</div>
<p>An example of a non-integral ideal.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">I</span>
<span class="gp">sage: </span><span class="n">J</span>          <span class="c"># warning -- choice of generators can be somewhat random</span>
<span class="go">Fractional ideal (2/11*z^5 + 2/11*z^4 + 3/11*z^3 + 2/11)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>           <span class="c"># warning -- choice of basis can be somewhat random</span>
<span class="go">[1, z, z^2, 1/11*z^3 + 7/11*z^2 + 6/11*z + 10/11, 1/11*z^4 + 1/11*z^2 + 1/11*z + 7/11, 1/11*z^5 + 1/11*z^4 + 1/11*z^3 + 2/11*z^2 + 8/11*z + 7/11]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.coordinates">
<tt class="descname">coordinates</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinate vector of <span class="math">\(x\)</span> with respect to this ideal.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><tt class="docutils literal"><span class="pre">x</span></tt> &#8211; an element of the number field (or ring of integers) of this ideal.</dd>
<dt>OUTPUT:</dt>
<dd>List giving the coordinates of <span class="math">\(x\)</span> with respect to the integral basis
of the ideal.  In general this will be a vector of
rationals; it will consist of integers if and only if <span class="math">\(x\)</span>
is in the ideal.</dd>
</dl>
<p>AUTHOR: John Cremona  2008-10-31</p>
<p>ALGORITHM:</p>
<p>Uses linear algebra.
Provides simpler implementations for <tt class="docutils literal"><span class="pre">_contains_()</span></tt>,
<tt class="docutils literal"><span class="pre">is_integral()</span></tt> and <tt class="docutils literal"><span class="pre">smallest_integer()</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ibasis</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">();</span> <span class="n">Ibasis</span>
<span class="go">[58, i + 41]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">23</span><span class="o">-</span><span class="mi">14</span><span class="o">*</span><span class="n">i</span>
<span class="gp">sage: </span><span class="n">acoords</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">acoords</span>
<span class="go">(597/58, -14)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">Ibasis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">acoords</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">123</span><span class="o">+</span><span class="mi">456</span><span class="o">*</span><span class="n">i</span>
<span class="gp">sage: </span><span class="n">bcoords</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">b</span><span class="p">);</span> <span class="n">bcoords</span>
<span class="go">(-18573/58, 456)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">Ibasis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">bcoords</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">vector is not in free module</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.decomposition_group">
<tt class="descname">decomposition_group</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.decomposition_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the decomposition group of self, as a subset of the
automorphism group of the number field of self. Raises an
error if the field isn&#8217;t Galois. See the decomposition_group
method of the <tt class="docutils literal"><span class="pre">GaloisGroup_v2</span></tt> class for further examples
and doctests.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decomposition_group</span><span class="p">()</span>
<span class="go">Galois group of Number Field in w with defining polynomial x^2 + 23</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.free_module">
<tt class="descname">free_module</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.free_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the free <span class="math">\(\ZZ\)</span>-module contained in the vector space
associated to the ambient number field, that corresponds
to this ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (-2*z^4 - 2*z^2 - 2*z + 1)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>              <span class="c"># warning -- choice of basis can be somewhat random</span>
<span class="go">Free module of degree 6 and rank 6 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[11  0  0  0  0  0]</span>
<span class="go">[ 0 11  0  0  0  0]</span>
<span class="go">[ 0  0 11  0  0  0]</span>
<span class="go">[10  4  5  1  0  0]</span>
<span class="go">[ 5  1  1  0  1  0]</span>
<span class="go">[ 5  6  2  1  1  1]</span>
</pre></div>
</div>
<p>However, the actual <span class="math">\(\ZZ\)</span>-module is not at all random:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  0  0  5  1  1]</span>
<span class="go">[ 0  1  0  1  1  7]</span>
<span class="go">[ 0  0  1  7  6 10]</span>
<span class="go">[ 0  0  0 11  0  0]</span>
<span class="go">[ 0  0  0  0 11  0]</span>
<span class="go">[ 0  0  0  0  0 11]</span>
</pre></div>
</div>
<p>The ideal doesn&#8217;t have to be integral:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">echelonized_basis_matrix</span><span class="p">()</span>
<span class="go">[ 1/11     0     0  7/11  1/11  1/11]</span>
<span class="go">[    0  1/11     0  1/11  1/11  5/11]</span>
<span class="go">[    0     0  1/11  5/11  4/11 10/11]</span>
<span class="go">[    0     0     0     1     0     0]</span>
<span class="go">[    0     0     0     0     1     0]</span>
<span class="go">[    0     0     0     0     0     1]</span>
</pre></div>
</div>
<p>This also works for relative extensions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[  4   0   0   0]</span>
<span class="go">[ -3   7  -1   1]</span>
<span class="go">[  3   7   1   1]</span>
<span class="go">[  0 -10   0  -2]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[  1/4     0     0     0]</span>
<span class="go">[-3/16  7/16 -1/16  1/16]</span>
<span class="go">[ 3/16  7/16  1/16  1/16]</span>
<span class="go">[    0  -5/8     0  -1/8]</span>
</pre></div>
</div>
<p>An example of intersecting ideals by intersecting free modules.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">free_module</span><span class="p">());</span> <span class="n">N</span>
<span class="go">Free module of degree 3 and rank 3 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[  1 1/2 1/2]</span>
<span class="go">[  0   1   1]</span>
<span class="go">[  0   0   2]</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Sage can find the free module associated to quite large ideals
quickly (see trac #4627):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">20</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">19</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">17</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">40</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">64</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">46</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">11</span> <span class="o">-</span> <span class="mi">32</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">46</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">64</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">40</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">6000</span><span class="p">,</span> <span class="mi">6200</span><span class="p">)))</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 20 and rank 20 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">20 x 20 dense matrix over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_reduced">
<tt class="descname">gens_reduced</tt><big>(</big><em>proof=None</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_reduced" title="Permalink to this definition">¶</a></dt>
<dd><p>Express this ideal in terms of at most two generators, and one
if possible.</p>
<p>This function indirectly uses <tt class="docutils literal"><span class="pre">bnfisprincipal</span></tt>, so set
<tt class="docutils literal"><span class="pre">proof=True</span></tt> if you want to prove correctness (which <em>is</em> the
default).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(a + 2, 9)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>  <span class="c"># random sign</span>
<span class="go">(a + 2,)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>
<span class="go">(3, a + 2)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">())</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_principal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>
<span class="go">(5, a)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Make sure this works with large ideals (#11836):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">20</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">165</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">760</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2220</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5280</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">7744</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z_x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">96698852571685</span><span class="o">/</span><span class="mi">2145672615243325696</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">2472249905907</span><span class="o">/</span><span class="mi">195061146840302336</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">916693155514421</span><span class="o">/</span><span class="mi">2145672615243325696</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">1348520950997779</span><span class="o">/</span><span class="mi">2145672615243325696</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">82344497086595</span><span class="o">/</span><span class="mi">12191321677518896</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2627122040194919</span><span class="o">/</span><span class="mi">536418153810831424</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">452199105143745</span><span class="o">/</span><span class="mi">48765286710075584</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4317002771457621</span><span class="o">/</span><span class="mi">536418153810831424</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2050725777454935</span><span class="o">/</span><span class="mi">67052269226353928</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">3711967683469209</span><span class="o">/</span><span class="mi">3047830419379724</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="s">&#39;57a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">z_x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">ideal</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ideal</span><span class="o">.</span><span class="n">is_principal</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">  ***   Warning: precision too low for generators, not given.</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">ideal</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_two">
<tt class="descname">gens_two</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Express this ideal using exactly two generators, the first of
which is a generator for the intersection of the ideal with <span class="math">\(Q\)</span>.</p>
<p>ALGORITHM: uses PARI&#8217;s <tt class="docutils literal"><span class="pre">idealtwoelt</span></tt> function, which runs in
randomized polynomial time and is very fast in practice.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(a + 2, 9)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(9, a + 2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">8</span><span class="p">])</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(3, a + 2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
<p>The second generator is zero if and only if the ideal is
generated by a rational, in contrast to the PARI function
<tt class="docutils literal"><span class="pre">idealtwoelt()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pari</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">idealtwoelt</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>  <span class="c"># Note that second element is not zero</span>
<span class="go">[12, [0, 12]~]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(12, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log">
<tt class="descname">ideal_class_log</tt><big>(</big><em>proof=None</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the output of PARI&#8217;s <tt class="docutils literal"><span class="pre">bnfisprincipal</span></tt> for this ideal,
i.e. a vector expressing the class of this ideal in terms of a
set of generators for the class group.</p>
<p>Since it uses the PARI method <tt class="docutils literal"><span class="pre">bnfisprincipal</span></tt>, specify
<tt class="docutils literal"><span class="pre">proof=True</span></tt> (this is the default setting) to prove the correctness
of the output.</p>
<p>EXAMPLES:</p>
<p>When the class number is 1, the result is always the empty list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">163</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">random_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>An example with class group of order 2.  The first ideal is
not principal, the second one is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">J</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>An example with a more complicated class group:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">26</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span>
<span class="go">Class group of order 18 with structure C6 x C3 of Number Field in a with defining polynomial x^3 - x + 1 over its base field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span> <span class="c"># random</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.inertia_group">
<tt class="descname">inertia_group</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.inertia_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inertia group of self, i.e. the set of elements s of the
Galois group of the number field of self (which we assume is Galois)
such that s acts trivially modulo self. This is the same as the 0th
ramification group of self. See the inertia_group method of the
<tt class="docutils literal"><span class="pre">GaloisGroup_v2</span></tt> class for further examples and doctests.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">inertia_group</span><span class="p">()</span>
<span class="go">Galois group of Number Field in w with defining polynomial x^2 + 23</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_basis">
<tt class="descname">integral_basis</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of generators for this ideal as a <span class="math">\(\ZZ\)</span>-module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()</span>
<span class="go">[2, i + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_split">
<tt class="descname">integral_split</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple <span class="math">\((I, d)\)</span>, where <span class="math">\(I\)</span> is an integral ideal, and <span class="math">\(d\)</span> is the
smallest positive integer such that this ideal is equal to <span class="math">\(I/d\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">integral_split</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">Fractional ideal (-1/2*a + 5/2)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">==</span> <span class="n">J</span><span class="o">/</span><span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.intersection">
<tt class="descname">intersection</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of self and other.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">q</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example with non-principal ideals:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A relative example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Test that this works with non-integral ideals (#10767):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">Fractional ideal (1/2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_integral">
<tt class="descname">is_integral</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this ideal is integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_maximal">
<tt class="descname">is_maximal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_maximal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this ideal is maximal.  This is equivalent to
self being prime and nonzero.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^3 + 3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_prime">
<tt class="descname">is_prime</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this ideal is prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">17</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 - 17</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>   <span class="c"># inert prime</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>  <span class="c"># split</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>  <span class="c"># ramified</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_principal">
<tt class="descname">is_principal</tt><big>(</big><em>proof=None</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_principal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this ideal is principal.</p>
<p>Since it uses the PARI method <tt class="docutils literal"><span class="pre">bnfisprincipal</span></tt>, specify
<tt class="docutils literal"><span class="pre">proof=True</span></tt> (this is the default setting) to prove the correctness
of the output.</p>
<p>EXAMPLES:</p>
<blockquote>
<div>sage: K = QuadraticField(-119,&#8217;a&#8217;)
sage: P = K.factor(2)[1][0]
sage: P.is_principal()
False
sage: I = P^5
sage: I.is_principal()
True
sage: I # random
Fractional ideal (-1/2*a + 3/2)
sage: P = K.ideal([2]).factor()[1][0]
sage: I = P^5
sage: I.is_principal()
True</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_zero">
<tt class="descname">is_zero</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True iff self is the zero ideal</p>
<p>Note that <span class="math">\((0)\)</span> is a <tt class="docutils literal"><span class="pre">NumberFieldIdeal</span></tt>, not a
<tt class="docutils literal"><span class="pre">NumberFieldFractionalIdeal</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">I</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">Ideal (0) of Number Field in a with defining polynomial x^2 + 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.norm">
<tt class="descname">norm</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the norm of this fractional ideal as a rational number.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">23</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^4 + 23</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">19</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (19)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
<span class="go">19^4</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">19^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.number_field">
<tt class="descname">number_field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.number_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number field that this is a fractional ideal in.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">number_field</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">number_field</span><span class="p">()</span> <span class="c"># not tested (not implemented)</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_hnf">
<tt class="descname">pari_hnf</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_hnf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return PARI&#8217;s representation of this ideal in Hermite normal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">pari_hnf</span><span class="p">()</span>
<span class="go">[2, 0, 50/127; 0, 2, 244/127; 0, 0, 2/127]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_prime">
<tt class="descname">pari_prime</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a PARI prime ideal corresponding to the ideal <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - a prime ideal.</li>
</ul>
</div></blockquote>
<p>OUTPUT: a PARI &#8220;prime ideal&#8221;, i.e. a five-component vector <span class="math">\([p,a,e,f,b]\)</span>
representing the prime ideal <span class="math">\(p O_K + a O_K\)</span>, <span class="math">\(e\)</span>, <span class="math">\(f\)</span> as usual, <span class="math">\(a\)</span> as
vector of components on the integral basis, <span class="math">\(b\)</span> Lenstra&#8217;s constant.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">pari_prime</span><span class="p">()</span>
<span class="go">[3, [3, 0]~, 1, 2, 1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">pari_prime</span><span class="p">()</span>
<span class="go">[5, [2, 1]~, 1, 1, [-2, -1; 1, -2]]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">pari_prime</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Fractional ideal (2) is not a prime ideal</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ramification_group">
<tt class="descname">ramification_group</tt><big>(</big><em>v</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ramification_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(v\)</span>&#8216;th ramification group of self, i.e. the set of
elements <span class="math">\(s\)</span> of the Galois group of the number field of self
(which we assume is Galois) such that <span class="math">\(s\)</span> acts trivially
modulo the <span class="math">\((v+1)\)</span>&#8216;st power of self. See the
ramification_group method of the <tt class="docutils literal"><span class="pre">GaloisGroup</span></tt> class for
further examples and doctests.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ramification_group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Galois group of Number Field in w with defining polynomial x^2 + 23</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ramification_group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Subgroup [()] of Galois group of Number Field in w with defining polynomial x^2 + 23</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.random_element">
<tt class="descname">random_element</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.random_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random element of this order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">*args</span></tt>, <tt class="docutils literal"><span class="pre">*kwds</span></tt> - Parameters passed to the random integer
function.  See the documentation of <tt class="docutils literal"><span class="pre">ZZ.random_element()</span></tt> for
details.</li>
</ul>
<p>OUTPUT:</p>
<p>A random element of this fractional ideal, computed as a random
<span class="math">\(\ZZ\)</span>-linear combination of the basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="c"># random output</span>
<span class="go">-a^2 - a - 19</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="s">&quot;uniform&quot;</span><span class="p">)</span> <span class="c"># random output</span>
<span class="go">a^2 - 2*a - 8</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span> <span class="c"># random output</span>
<span class="go">-7*a^2 - 17*a - 75</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A relative example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1000</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="c"># random output</span>
<span class="go">17/500002*a^3 + 737253/250001*a^2 - 1494505893/500002*a + 752473260/250001</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.reduce_equiv">
<tt class="descname">reduce_equiv</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.reduce_equiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a small ideal that is equivalent to self in the group
of fractional ideals modulo principal ideals.  Very often (but
not always) if self is principal then this function returns
the unit ideal.</p>
<p>ALGORITHM: Calls pari&#8217;s idealred function.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="mi">23</span><span class="o">^</span><span class="mi">5</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (6436343*w)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce_equiv</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span><span class="o">.</span><span class="mf">0.</span><span class="n">ideal</span><span class="p">()</span><span class="o">^</span><span class="mi">10</span><span class="p">;</span> <span class="n">I</span>
<span class="go">Fractional ideal (1024, 1/2*w + 979/2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce_equiv</span><span class="p">()</span>
<span class="go">Fractional ideal (2, 1/2*w - 1/2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_norm">
<tt class="descname">relative_norm</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for norm.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">relative_norm</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_ramification_index">
<tt class="descname">relative_ramification_index</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_ramification_index" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for ramification_index.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">relative_ramification_index</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.residue_symbol">
<tt class="descname">residue_symbol</tt><big>(</big><em>e</em>, <em>m</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.residue_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>The m-th power residue symbol for an element e and the proper ideal.</p>
<div class="math">
\[\left(\frac{\alpha}{\mathbf{P}}\right) \equiv \alpha^{\frac{N(\mathbf{P})-1}{m}} \operatorname{mod} \mathbf{P}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">accepts m=1, in which case returns 1</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">can also be called for an element from sage.rings.number_field_element.residue_symbol</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">e is coerced into the number field of self</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if m=2, e is an integer, and self.number_field() has absolute degree 1 (i.e. it is a copy of the rationals), then this calls kronecker_symbol, which is implemented using GMP.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">e</span></tt> - element of the number field</li>
<li><tt class="docutils literal"><span class="pre">m</span></tt> - positive integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an m-th root of unity in the number field</li>
</ul>
<p>EXAMPLES:</p>
<p>Quadratic Residue (7 is not a square modulo 11):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">residue_symbol</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Cubic Residue:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">residue_symbol</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-w</span>
</pre></div>
</div>
<p>The field must contain the m-th roots of unity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">residue_symbol</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">The residue symbol to that power is not defined for the number field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.smallest_integer">
<tt class="descname">smallest_integer</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.smallest_integer" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the smallest non-negative integer in <span class="math">\(I \cap \ZZ\)</span>,
where <span class="math">\(I\)</span> is this ideal.  If <span class="math">\(I = 0\)</span>, returns 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">])</span><span class="o">/</span><span class="mi">7</span><span class="p">;</span> <span class="n">I</span>
<span class="go">Fractional ideal (2/7, 1/7*a)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([(</span><span class="n">P1</span><span class="o">^</span><span class="n">i</span><span class="o">*</span><span class="n">P2</span><span class="o">^</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">()</span> <span class="o">==</span> <span class="mi">13</span><span class="o">^</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">()</span>
<span class="go">0</span>

<span class="go"># See trac\# 4392:</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">()</span>
<span class="go">7</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">()</span>
<span class="go">146196692151</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">1315770229359</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">/</span> <span class="n">I</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.valuation">
<tt class="descname">valuation</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the valuation of self at <tt class="docutils literal"><span class="pre">p</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> &#8211; a prime ideal <span class="math">\(\mathfrak{p}\)</span> of this number field.</li>
</ul>
<p>OUTPUT:</p>
<p>(integer) The valuation of this fractional ideal at the prime
<span class="math">\(\mathfrak{p}\)</span>.  If <span class="math">\(\mathfrak{p}\)</span> is not prime, raise a
ValueError.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^5 + 2</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">38</span><span class="p">);</span> <span class="n">i</span>
<span class="go">Fractional ideal (38)</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">19</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">p (= 0) must be nonzero</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.number_field.number_field_ideal.QuotientMap">
<em class="property">class </em><tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">QuotientMap</tt><big>(</big><em>K</em>, <em>M_OK_change</em>, <em>Q</em>, <em>I</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.QuotientMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold data needed by quotient maps from number field
orders to residue fields.  These are only partial maps: the exact
domain is the appropriate valuation ring.  For examples, see
<a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field" title="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field"><tt class="xref py py-meth docutils literal"><span class="pre">residue_field()</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="sage.rings.number_field.number_field_ideal.basis_to_module">
<tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">basis_to_module</tt><big>(</big><em>B</em>, <em>K</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.basis_to_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a basis <span class="math">\(B\)</span> of elements for a <span class="math">\(\ZZ\)</span>-submodule of a number
field <span class="math">\(K\)</span>, return the corresponding <span class="math">\(\ZZ\)</span>-submodule.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">basis_to_module</span>
<span class="gp">sage: </span><span class="n">basis_to_module</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">],</span> <span class="n">K</span><span class="p">)</span>
<span class="go">Free module of degree 4 and rank 2 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[3 0 1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.number_field.number_field_ideal.convert_from_idealprimedec_form">
<tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">convert_from_idealprimedec_form</tt><big>(</big><em>field</em>, <em>ideal</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.convert_from_idealprimedec_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Used internally in the number field ideal implementation for
converting from the form output by the PARI function <tt class="docutils literal"><span class="pre">idealprimedec</span></tt>
to a Sage ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">field</span></tt> - a number field</li>
<li><tt class="docutils literal"><span class="pre">ideal</span></tt> - a PARI prime ideal, as output by the
<tt class="docutils literal"><span class="pre">idealprimedec</span></tt> or <tt class="docutils literal"><span class="pre">idealfactor</span></tt> functions</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">convert_from_idealprimedec_form</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K_bnf</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">pari_bnf</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">ideal</span> <span class="o">=</span> <span class="n">K_bnf</span><span class="o">.</span><span class="n">idealprimedec</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">convert_from_idealprimedec_form</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">ideal</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: convert_from_idealprimedec_form() is deprecated</span>
<span class="go">See http://trac.sagemath.org/15767 for details.</span>
<span class="go">Fractional ideal (-a)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(Fractional ideal (-a))^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.number_field.number_field_ideal.convert_to_idealprimedec_form">
<tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">convert_to_idealprimedec_form</tt><big>(</big><em>field</em>, <em>ideal</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.convert_to_idealprimedec_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Used internally in the number field ideal implementation for
converting to the form output by the pari function <tt class="docutils literal"><span class="pre">idealprimedec</span></tt>
from a Sage ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">field</span></tt> - a number field</li>
<li><tt class="docutils literal"><span class="pre">ideal</span></tt> - a prime ideal</li>
</ul>
<p>NOTE:</p>
<p>The algorithm implemented right now is not optimal, but works. It should
eventually be replaced with something better.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">convert_to_idealprimedec_form</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">convert_to_idealprimedec_form</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: convert_to_idealprimedec_form() is deprecated, use ideal.pari_prime() instead</span>
<span class="go">See http://trac.sagemath.org/15767 for details.</span>
<span class="go">[3, [1, 2]~, 2, 1, [1, 1; -1, 2]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.number_field.number_field_ideal.is_NumberFieldFractionalIdeal">
<tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">is_NumberFieldFractionalIdeal</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.is_NumberFieldFractionalIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is a fractional ideal of a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">is_NumberFieldFractionalIdeal</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (a + 1)</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">Z</span>
<span class="go">Ideal (0) of Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.number_field.number_field_ideal.is_NumberFieldIdeal">
<tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">is_NumberFieldIdeal</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.is_NumberFieldIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is an ideal of a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">is_NumberFieldIdeal</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (a + 1)</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">Z</span>
<span class="go">Ideal (0) of Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.number_field.number_field_ideal.quotient_char_p">
<tt class="descclassname">sage.rings.number_field.number_field_ideal.</tt><tt class="descname">quotient_char_p</tt><big>(</big><em>I</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.quotient_char_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an integral ideal <span class="math">\(I\)</span> that contains a prime number <span class="math">\(p\)</span>, compute
a vector space <span class="math">\(V = (O_K \mod p) / (I \mod p)\)</span>, along with a
homomorphism <span class="math">\(O_K \to V\)</span> and a section <span class="math">\(V \to O_K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">quotient_char_p</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">O</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">quotient_char_p</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Vector space quotient V/W of dimension 2 over Finite Field of size 5 where</span>
<span class="go">V: Vector space of dimension 2 over Finite Field of size 5</span>
<span class="go">W: Vector space of degree 2 and dimension 0 over Finite Field of size 5</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">quotient_char_p</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Vector space quotient V/W of dimension 2 over Finite Field of size 3 where</span>
<span class="go">V: Vector space of dimension 2 over Finite Field of size 3</span>
<span class="go">W: Vector space of degree 2 and dimension 0 over Finite Field of size 3</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">13</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (-3*i - 2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">quotient_char_p</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">13</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Vector space quotient V/W of dimension 1 over Finite Field of size 13 where</span>
<span class="go">V: Vector space of dimension 2 over Finite Field of size 13</span>
<span class="go">W: Vector space of degree 2 and dimension 1 over Finite Field of size 13</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 8]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="order.html"
                                  title="previous chapter">Orders in Number Fields</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="number_field_ideal_rel.html"
                                  title="next chapter">Relative Number Field Ideals</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/rings/number_field/number_field_ideal.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="number_field_ideal_rel.html" title="Relative Number Field Ideals"
             >next</a> |</li>
        <li class="right" >
          <a href="order.html" title="Orders in Number Fields"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Algebraic Number Fields</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>