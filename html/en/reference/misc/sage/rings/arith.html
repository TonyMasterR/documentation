<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Miscellaneous arithmetic functions &mdash; Sage Reference Manual v6.8: Utilities</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.8: Utilities" href="../../index.html" />
    <link rel="next" title="Temporary file handling" href="../misc/temporary_file.html" />
    <link rel="prev" title="Utility classes for multi-modular algorithms" href="../ext/multi_modular.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../misc/temporary_file.html" title="Temporary file handling"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../ext/multi_modular.html" title="Utility classes for multi-modular algorithms"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Utilities</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="miscellaneous-arithmetic-functions">
<span id="sage-rings-arith"></span><h1>Miscellaneous arithmetic functions<a class="headerlink" href="#miscellaneous-arithmetic-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.arith"></span><dl class="function">
<dt id="sage.rings.arith.CRT">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">CRT</tt><big>(</big><em>a</em>, <em>b</em>, <em>m=None</em>, <em>n=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.CRT" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a solution to a Chinese Remainder Theorem problem.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt> - two residues (elements of some ring for which
extended gcd is available), or two lists, one of residues and
one of moduli.</li>
<li><tt class="docutils literal"><span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">n</span></tt> - (default: <tt class="docutils literal"><span class="pre">None</span></tt>) two moduli, or <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<p>If <tt class="docutils literal"><span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">n</span></tt> are not <tt class="docutils literal"><span class="pre">None</span></tt>, returns a solution <span class="math">\(x\)</span> to the
simultaneous congruences <span class="math">\(x\equiv a \bmod m\)</span> and <span class="math">\(x\equiv b \bmod
n\)</span>, if one exists. By the Chinese Remainder Theorem, a solution to the
simultaneous congruences exists if and only if
<span class="math">\(a\equiv b\pmod{\gcd(m,n)}\)</span>. The solution <span class="math">\(x\)</span> is only well-defined modulo
<span class="math">\(\text{lcm}(m,n)\)</span>.</p>
<p>If <tt class="docutils literal"><span class="pre">a</span></tt> and <tt class="docutils literal"><span class="pre">b</span></tt> are lists, returns a simultaneous solution to
the congruences <span class="math">\(x\equiv a_i\pmod{b_i}\)</span>, if one exists.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.arith.CRT_list" title="sage.rings.arith.CRT_list"><tt class="xref py py-func docutils literal"><span class="pre">CRT_list()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>Using <tt class="docutils literal"><span class="pre">crt</span></tt> by giving it pairs of residues and moduli:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>
<span class="go">28013</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">])</span>
<span class="go">28013</span>
</pre></div>
</div>
<p>You can also use upper case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">c</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that this also works for polynomial rings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">-3/26*y^4 + 5/26*y^3 + 15/26*y + 53/26</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">(-3/52*a + 3/52)*y^4 + (5/52*a - 5/52)*y^3 + (15/52*a - 15/52)*y + 27/52*a + 25/52</span>
</pre></div>
</div>
<p>You can also do this for any number of moduli:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([],</span> <span class="p">[])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([</span><span class="n">a</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">9</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">]);</span> <span class="n">k</span>
<span class="go">(127/26988*a - 5807/386828)*x^9 + (45/8996*a - 33677/1160484)*x^8 + (2/173*a - 6/173)*x^7 + (133/6747*a - 5373/96707)*x^6 + (-6/2249*a + 18584/290121)*x^5 + (-277/8996*a + 38847/386828)*x^4 + (-135/4498*a + 42673/193414)*x^3 + (-1005/8996*a + 470245/1160484)*x^2 + (-1215/8996*a + 141165/386828)*x + 621/8996*a + 836445/386828</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>If the moduli are not coprime, a solution may not exist:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">No solution to crt problem since gcd(8,12) does not divide 4-6</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x + 5/2</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x^3 + x^2 + 1/2*x + 1</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">No solution to crt problem since gcd(x^2 - 1,x^3 - 1) does not divide 2-x</span>

<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.CRT_basis">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">CRT_basis</tt><big>(</big><em>moduli</em><big>)</big><a class="headerlink" href="#sage.rings.arith.CRT_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a CRT basis for the given moduli.</p>
<p>INPUT:</p>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">moduli</span></tt> - list of pairwise coprime moduli <span class="math">\(m\)</span> which admit an</dt>
<dd><p class="first last">extended Euclidean algorithm</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of elements <span class="math">\(a_i\)</span> of the same length as <span class="math">\(m\)</span> such that
<span class="math">\(a_i\)</span> is congruent to 1 modulo <span class="math">\(m_i\)</span> and to 0 modulo <span class="math">\(m_j\)</span> for
<span class="math">\(j\not=i\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The pairwise coprimality of the input is not checked.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a1</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a2</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span> <span class="o">=</span> <span class="n">CRT_basis</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">mod</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">c1</span><span class="o">+</span><span class="n">a2</span><span class="o">*</span><span class="n">c2</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
<p>A polynomial example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mods</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">CRT_basis</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">[-2/3*x^3 + x^2 - 2/3*x + 1, 6/13*x^3 - x^2 + 6/13*x, 8/39*x^3 + 8/39*x]</span>
<span class="gp">sage: </span><span class="p">[[</span><span class="n">bi</span> <span class="o">%</span> <span class="n">mj</span> <span class="k">for</span> <span class="n">mj</span> <span class="ow">in</span> <span class="n">mods</span><span class="p">]</span> <span class="k">for</span> <span class="n">bi</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[[1, 0, 0], [0, 1, 0], [0, 0, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.CRT_list">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">CRT_list</tt><big>(</big><em>v</em>, <em>moduli</em><big>)</big><a class="headerlink" href="#sage.rings.arith.CRT_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list <tt class="docutils literal"><span class="pre">v</span></tt> of elements and a list of corresponding
<tt class="docutils literal"><span class="pre">moduli</span></tt>, find a single element that reduces to each element of
<tt class="docutils literal"><span class="pre">v</span></tt> modulo the corresponding moduli.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.arith.crt" title="sage.rings.arith.crt"><tt class="xref py py-func docutils literal"><span class="pre">crt()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">CRT_list</span><span class="p">([</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">]);</span> <span class="n">c</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>It also works if the moduli are not coprime:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">32</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="go">452</span>
</pre></div>
</div>
<p>But with non coprime moduli there is not always a solution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">32</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">No solution to crt problem since gcd(180,150) does not divide 92-1</span>
</pre></div>
</div>
<p>The arguments must be lists:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s">&quot;not a list&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Arguments to CRT_list should be lists</span>
<span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">(</span><span class="s">&quot;not a list&quot;</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Arguments to CRT_list should be lists</span>
</pre></div>
</div>
<p>The list of moduli must have the same length as the list of elements:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Arguments to CRT_list should be lists of the same length</span>
<span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Arguments to CRT_list should be lists of the same length</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CRT</span><span class="p">([</span><span class="mi">32</span><span class="n">r</span><span class="p">,</span><span class="mi">2</span><span class="n">r</span><span class="p">,</span><span class="mi">2</span><span class="n">r</span><span class="p">],[</span><span class="mi">60</span><span class="n">r</span><span class="p">,</span><span class="mi">90</span><span class="n">r</span><span class="p">,</span><span class="mi">150</span><span class="n">r</span><span class="p">])</span>
<span class="go">452</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.CRT_vectors">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">CRT_vectors</tt><big>(</big><em>X</em>, <em>moduli</em><big>)</big><a class="headerlink" href="#sage.rings.arith.CRT_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector form of the Chinese Remainder Theorem: given a list of integer
vectors <span class="math">\(v_i\)</span> and a list of coprime moduli <span class="math">\(m_i\)</span>, find a vector <span class="math">\(w\)</span> such
that <span class="math">\(w = v_i \pmod m_i\)</span> for all <span class="math">\(i\)</span>. This is more efficient than applying
<a class="reference internal" href="#sage.rings.arith.CRT" title="sage.rings.arith.CRT"><tt class="xref py py-func docutils literal"><span class="pre">CRT()</span></tt></a> to each entry.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">X</span></tt> - list or tuple, consisting of lists/tuples/vectors/etc of
integers of the same length</li>
<li><tt class="docutils literal"><span class="pre">moduli</span></tt> - list of len(X) moduli</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">list</span></tt> - application of CRT componentwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CRT_vectors</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[3, 5, 5]</span>

<span class="gp">sage: </span><span class="n">CRT_vectors</span><span class="p">([</span><span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">Sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">ZZ</span><span class="p">)],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="go">[10, 43, 17]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.rings.arith.Euler_Phi">
<em class="property">class </em><tt class="descclassname">sage.rings.arith.</tt><tt class="descname">Euler_Phi</tt><a class="headerlink" href="#sage.rings.arith.Euler_Phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the Euler phi function on the integer n. We
defined this to be the number of positive integers &lt;= n that are
relatively prime to n. Thus if n&lt;=0 then
<tt class="docutils literal"><span class="pre">euler_phi(n)</span></tt> is defined and equals 0.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">36</span>
</pre></div>
</div>
<p>Notice that euler_phi is defined to be 0 on negative numbers and
0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>We verify directly that the phi function is correct for 21.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">[1, 2, 4, 5, 8, 10, 11, 13, 16, 17, 19, 20]</span>
</pre></div>
</div>
<p>The length of the list of integers &#8216;i&#8217; in range(n) such that the
gcd(i,n) == 1 equals euler_phi(n).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">euler_phi</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The phi function also has a special plotting method.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">euler_phi</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">71</span><span class="p">)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein</li>
<li>Alex Clemesha (2006-01-10): some examples</li>
</ul>
<dl class="method">
<dt id="sage.rings.arith.Euler_Phi.plot">
<tt class="descname">plot</tt><big>(</big><em>xmin=1</em>, <em>xmax=50</em>, <em>pointsize=30</em>, <em>rgbcolor=(0</em>, <em>0</em>, <em>1)</em>, <em>join=True</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.arith.Euler_Phi.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the Euler phi function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">xmin</span></tt> - default: 1</li>
<li><tt class="docutils literal"><span class="pre">xmax</span></tt> - default: 50</li>
<li><tt class="docutils literal"><span class="pre">pointsize</span></tt> - default: 30</li>
<li><tt class="docutils literal"><span class="pre">rgbcolor</span></tt> - default: (0,0,1)</li>
<li><tt class="docutils literal"><span class="pre">join</span></tt> - default: True; whether to join the
points.</li>
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - passed on</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Euler_Phi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ymax</span><span class="p">()</span>
<span class="go">46.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.GCD">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">GCD</tt><big>(</big><em>a</em>, <em>b=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#sage.rings.arith.GCD" title="Permalink to this definition">¶</a></dt>
<dd><p>The greatest common divisor of a and b, or if a is a list and b is
omitted the greatest common divisor of all elements of a.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a,b</span></tt> - two elements of a ring with gcd or</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - a list or tuple of elements of a ring with
gcd</li>
</ul>
<p>Additional keyword arguments are passed to the respectively called
methods.</p>
<p>OUTPUT:</p>
<p>The given elements are first coerced into a common parent. Then,
their greatest common divisor <em>in that common parent</em> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="mi">97</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">97</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2/15</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>  <span class="c"># fast  !!</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Note that to take the gcd of <span class="math">\(n\)</span> elements for <span class="math">\(n \not= 2\)</span> you must
put the elements into a list by enclosing them in <tt class="docutils literal"><span class="pre">[..]</span></tt>.  Before
#4988 the following wrongly returned 3 since the third parameter
was just ignored:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">gcd() takes at most 2 arguments (3 given)</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Similarly, giving just one element (which is not a list) gives an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">&#39;sage.rings.integer.Integer&#39; object is not iterable</span>
</pre></div>
</div>
<p>By convention, the gcd of the empty list is (the integer) 0:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gcd</span><span class="p">([])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">gcd</span><span class="p">([]))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The following shows that indeed coercion takes place before computing
the gcd. This behaviour was introduced in <a class="reference external" href="http://trac.sagemath.org/10771">trac ticket #10771</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="go">Fraction Field of Univariate Polynomial Ring in x over Rational Field</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">]))</span>
<span class="go">Fraction Field of Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>Make sure we try QQ and not merely ZZ (<a class="reference external" href="http://trac.sagemath.org/13014">trac ticket #13014</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">gcd</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Make sure that the gcd of Expressions stays symbolic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<p>Verify that objects without gcd methods but which can&#8217;t be
coerced to ZZ or QQ raise an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeMonoid</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to find gcd</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.LCM">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">LCM</tt><big>(</big><em>a</em>, <em>b=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.LCM" title="Permalink to this definition">¶</a></dt>
<dd><p>The least common multiple of a and b, or if a is a list and b is
omitted the least common multiple of all elements of a.</p>
<p>Note that LCM is an alias for lcm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a,b</span></tt> - two elements of a ring with lcm or</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - a list or tuple of elements of a ring with
lcm</li>
</ul>
<p>OUTPUT:</p>
<p>First, the given elements are coerced into a common parent. Then,
their least common multiple <em>in that parent</em> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9700</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9700</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">60</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">LCM</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">))</span>   <span class="c"># *very* fast!</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="go">4349</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The following tests against a bug that was fixed in <a class="reference external" href="http://trac.sagemath.org/10771">trac ticket #10771</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The following shows that indeed coercion takes place before
computing the least common multiple:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">]))</span>
<span class="go">Fraction Field of Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>Make sure we try QQ and not merely ZZ (<a class="reference external" href="http://trac.sagemath.org/13014">trac ticket #13014</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">lcm</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Make sure that the lcm of Expressions stays symbolic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<p>Verify that objects without lcm methods but which can&#8217;t be
coerced to ZZ or QQ raise an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeMonoid</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to find lcm</span>
</pre></div>
</div>
<p>Check rational and integers (<a class="reference external" href="http://trac.sagemath.org/17852">trac ticket #17852</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.rings.arith.Moebius">
<em class="property">class </em><tt class="descclassname">sage.rings.arith.</tt><tt class="descname">Moebius</tt><a class="headerlink" href="#sage.rings.arith.Moebius" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the Moebius function of abs(n), where n is an
integer.</p>
<p>DEFINITION: <span class="math">\(\mu(n)\)</span> is 0 if <span class="math">\(n\)</span> is not square
free, and otherwise equals <span class="math">\((-1)^r\)</span>, where <span class="math">\(n\)</span> has
<span class="math">\(r\)</span> distinct prime factors.</p>
<p>For simplicity, if <span class="math">\(n=0\)</span> we define <span class="math">\(\mu(n) = 0\)</span>.</p>
<p>IMPLEMENTATION: Factors or - for integers - uses the PARI C
library.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - anything that can be factored.</li>
</ul>
<p>OUTPUT: 0, 1, or -1</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="o">-</span><span class="mi">35</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="c"># potentially nonstandard!</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The moebius function even makes sense for non-integer inputs.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.arith.Moebius.plot">
<tt class="descname">plot</tt><big>(</big><em>xmin=0</em>, <em>xmax=50</em>, <em>pointsize=30</em>, <em>rgbcolor=(0</em>, <em>0</em>, <em>1)</em>, <em>join=True</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.arith.Moebius.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the Moebius function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">xmin</span></tt> - default: 0</li>
<li><tt class="docutils literal"><span class="pre">xmax</span></tt> - default: 50</li>
<li><tt class="docutils literal"><span class="pre">pointsize</span></tt> - default: 30</li>
<li><tt class="docutils literal"><span class="pre">rgbcolor</span></tt> - default: (0,0,1)</li>
<li><tt class="docutils literal"><span class="pre">join</span></tt> - default: True; whether to join the points
(very helpful in seeing their order).</li>
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - passed on</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Moebius</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ymax</span><span class="p">()</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.arith.Moebius.range">
<tt class="descname">range</tt><big>(</big><em>start</em>, <em>stop=None</em>, <em>step=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.Moebius.range" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Moebius function evaluated at the given range of values,
i.e., the image of the list range(start, stop, step) under the
Mobius function.</p>
<p>This is much faster than directly computing all these values with a
list comprehension.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">moebius</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="n">v</span>
<span class="go">[1, 0, 0, -1, 1, -1, 0, -1, -1, 1, 0, 1, -1, -1, 0, -1, 1, -1, 0, 0]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">==</span> <span class="p">[</span><span class="n">moebius</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">moebius</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">==</span> <span class="p">[</span><span class="n">moebius</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.arith.Sigma">
<em class="property">class </em><tt class="descclassname">sage.rings.arith.</tt><tt class="descname">Sigma</tt><a class="headerlink" href="#sage.rings.arith.Sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of the k-th powers of the divisors of n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">k</span></tt> - integer (default: 1)</li>
</ul>
<p>OUTPUT: integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">26</span>
</pre></div>
</div>
<p>The sigma function also has a special plotting method.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>This method also works with k-th powers.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein: original implementation</li>
<li>Craig Citro (2007-06-01): rewrote for huge speedup</li>
</ul>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">106811523</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">144169</span><span class="p">)</span>
<span class="go">3672</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">691</span><span class="p">)</span>
<span class="go">176</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">sigma</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">133</span><span class="p">),</span><span class="mi">20</span><span class="p">))</span>
<span class="go">2.80414775675747e4523</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="go">39001250856960000</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">41</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="go">229199532273029988767733858700732906511758707916800</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.arith.Sigma.plot">
<tt class="descname">plot</tt><big>(</big><em>xmin=1</em>, <em>xmax=50</em>, <em>k=1</em>, <em>pointsize=30</em>, <em>rgbcolor=(0</em>, <em>0</em>, <em>1)</em>, <em>join=True</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.arith.Sigma.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the sigma (sum of k-th powers of divisors) function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">xmin</span></tt> - default: 1</li>
<li><tt class="docutils literal"><span class="pre">xmax</span></tt> - default: 50</li>
<li><tt class="docutils literal"><span class="pre">k</span></tt> - default: 1</li>
<li><tt class="docutils literal"><span class="pre">pointsize</span></tt> - default: 30</li>
<li><tt class="docutils literal"><span class="pre">rgbcolor</span></tt> - default: (0,0,1)</li>
<li><tt class="docutils literal"><span class="pre">join</span></tt> - default: True; whether to join the
points.</li>
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - passed on</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Sigma</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ymax</span><span class="p">()</span>
<span class="go">124.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.XGCD">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">XGCD</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="headerlink" href="#sage.rings.arith.XGCD" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a triple <tt class="docutils literal"><span class="pre">(g,s,t)</span></tt> such that <span class="math">\(g = s\cdot a+t\cdot b = \gcd(a,b)\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One exception is if <span class="math">\(a\)</span> and <span class="math">\(b\)</span> are not in a principal ideal domain (see
<a class="reference external" href="https://en.wikipedia.org/wiki/Principal_ideal_domain">Wikipedia article Principal_ideal_domain</a>), e.g., they are both polynomials
over the integers. Then this function can&#8217;t in general return <tt class="docutils literal"><span class="pre">(g,s,t)</span></tt>
as above, since they need not exist.  Instead, over the integers, we
first multiply <span class="math">\(g\)</span> by a divisor of the resultant of <span class="math">\(a/g\)</span> and <span class="math">\(b/g\)</span>, up
to sign.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a,</span> <span class="pre">b</span></tt> - integers or more generally, element of a ring for which the
xgcd make sense (e.g. a field or univariate polynomials).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">g,</span> <span class="pre">s,</span> <span class="pre">t</span></tt> - such that <span class="math">\(g = s\cdot a + t\cdot b\)</span></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is no guarantee that the returned cofactors (s and t) are
minimal.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">56</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(4, 4, -5)</span>
<span class="gp">sage: </span><span class="mi">4</span><span class="o">*</span><span class="mi">56</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">44</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">xgcd</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">);</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="go">(1, 3, -2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(x - 1, 1, -x)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">g</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 1/3*g, 0)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()[]</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, a^2/b^2, ((-a)/b^2)*y + 1/b)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">((</span><span class="n">b</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, (a^2 + (2*g)*a + 3)/(b^3 + (g)*b^2), ((-a + (-g))/b^2)*y + 1/b)</span>
</pre></div>
</div>
<p>Here is an example of a xgcd for two polynomials over the integers, where the linear
combination is not the gcd but the gcd multiplied by the resultant:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2*x, -1, 2)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.algdep">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">algdep</tt><big>(</big><em>z</em>, <em>degree</em>, <em>known_bits=None</em>, <em>use_bits=None</em>, <em>known_digits=None</em>, <em>use_digits=None</em>, <em>height_bound=None</em>, <em>proof=False</em><big>)</big><a class="headerlink" href="#sage.rings.arith.algdep" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math">\(degree\)</span> which is
approximately satisfied by the number <span class="math">\(z\)</span>. Note that the returned
polynomial need not be irreducible, and indeed usually won&#8217;t be if
<span class="math">\(z\)</span> is a good approximation to an algebraic number of degree less
than <span class="math">\(degree\)</span>.</p>
<p>You can specify the number of known bits or digits of <span class="math">\(z\)</span> with
<tt class="docutils literal"><span class="pre">known_bits=k</span></tt> or <tt class="docutils literal"><span class="pre">known_digits=k</span></tt>. PARI is then told to
compute the result using <span class="math">\(0.8k\)</span> of these bits/digits. Or, you can
specify the precision to use directly with <tt class="docutils literal"><span class="pre">use_bits=k</span></tt> or
<tt class="docutils literal"><span class="pre">use_digits=k</span></tt>. If none of these are specified, then the precision
is taken from the input value.</p>
<p>A height bound may be specified to indicate the maximum coefficient
size of the returned polynomial; if a sufficiently small polynomial
is not found, then <tt class="docutils literal"><span class="pre">None</span></tt> will be returned. If <tt class="docutils literal"><span class="pre">proof=True</span></tt> then
the result is returned only if it can be proved correct (i.e. the
only possible minimal polynomial satisfying the height bound, or no
such polynomial exists). Otherwise a <tt class="docutils literal"><span class="pre">ValueError</span></tt> is raised
indicating that higher precision is required.</p>
<p>ALGORITHM: Uses LLL for real/complex inputs, PARI C-library
<tt class="docutils literal"><span class="pre">algdep</span></tt> command otherwise.</p>
<p>Note that <tt class="docutils literal"><span class="pre">algebraic_dependency</span></tt> is a synonym for <tt class="docutils literal"><span class="pre">algdep</span></tt>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">z</span></tt> - real, complex, or <span class="math">\(p\)</span>-adic number</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">degree</span></tt> - an integer</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">height_bound</span></tt> - an integer (default: <tt class="docutils literal"><span class="pre">None</span></tt>) specifying the maximum</dt>
<dd><p class="first last">coefficient size for the returned polynomial</p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">proof</span></tt> - a boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>), requires height_bound to be set</p>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">1.888888888888888</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">9*x - 17</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">0.12121212121212</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">33*x - 4</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>This example involves a complex number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RDF</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span><span class="n">CC</span><span class="o">.</span><span class="mi">0</span><span class="p">);</span> <span class="n">z</span>
<span class="go">0.500000000000000 + 0.866025403784439*I</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span> <span class="n">p</span>
<span class="go">x^3 + 1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + 1) * (x^2 - x + 1)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span>   <span class="c"># abs tol 2e-16</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
<p>This example involves a <span class="math">\(p\)</span>-adic number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">print_mode</span> <span class="o">=</span> <span class="s">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
</pre></div>
</div>
<p>These examples show the importance of proper precision control. We
compute a 200-bit approximation to <span class="math">\(sqrt(2)\)</span> which is wrong in the
33&#8217;rd bit:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">33</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="n">p</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_bits</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>Using the <tt class="docutils literal"><span class="pre">height_bound</span></tt> and <tt class="docutils literal"><span class="pre">proof</span></tt> parameters, we can see that
<span class="math">\(pi\)</span> is not the root of an integer polynomial of degree at most 5
and coefficients bounded above by 10:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For stronger results, we need more precicion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also use <tt class="docutils literal"><span class="pre">proof=True</span></tt> to get positive results:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">insufficient precision for uniqueness proof</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^8 - 40*x^6 + 352*x^4 - 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="s">&quot;1+2j&quot;</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^2 - 2*x + 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.algebraic_dependency">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">algebraic_dependency</tt><big>(</big><em>z</em>, <em>degree</em>, <em>known_bits=None</em>, <em>use_bits=None</em>, <em>known_digits=None</em>, <em>use_digits=None</em>, <em>height_bound=None</em>, <em>proof=False</em><big>)</big><a class="headerlink" href="#sage.rings.arith.algebraic_dependency" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math">\(degree\)</span> which is
approximately satisfied by the number <span class="math">\(z\)</span>. Note that the returned
polynomial need not be irreducible, and indeed usually won&#8217;t be if
<span class="math">\(z\)</span> is a good approximation to an algebraic number of degree less
than <span class="math">\(degree\)</span>.</p>
<p>You can specify the number of known bits or digits of <span class="math">\(z\)</span> with
<tt class="docutils literal"><span class="pre">known_bits=k</span></tt> or <tt class="docutils literal"><span class="pre">known_digits=k</span></tt>. PARI is then told to
compute the result using <span class="math">\(0.8k\)</span> of these bits/digits. Or, you can
specify the precision to use directly with <tt class="docutils literal"><span class="pre">use_bits=k</span></tt> or
<tt class="docutils literal"><span class="pre">use_digits=k</span></tt>. If none of these are specified, then the precision
is taken from the input value.</p>
<p>A height bound may be specified to indicate the maximum coefficient
size of the returned polynomial; if a sufficiently small polynomial
is not found, then <tt class="docutils literal"><span class="pre">None</span></tt> will be returned. If <tt class="docutils literal"><span class="pre">proof=True</span></tt> then
the result is returned only if it can be proved correct (i.e. the
only possible minimal polynomial satisfying the height bound, or no
such polynomial exists). Otherwise a <tt class="docutils literal"><span class="pre">ValueError</span></tt> is raised
indicating that higher precision is required.</p>
<p>ALGORITHM: Uses LLL for real/complex inputs, PARI C-library
<tt class="docutils literal"><span class="pre">algdep</span></tt> command otherwise.</p>
<p>Note that <tt class="docutils literal"><span class="pre">algebraic_dependency</span></tt> is a synonym for <tt class="docutils literal"><span class="pre">algdep</span></tt>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">z</span></tt> - real, complex, or <span class="math">\(p\)</span>-adic number</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">degree</span></tt> - an integer</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">height_bound</span></tt> - an integer (default: <tt class="docutils literal"><span class="pre">None</span></tt>) specifying the maximum</dt>
<dd><p class="first last">coefficient size for the returned polynomial</p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">proof</span></tt> - a boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>), requires height_bound to be set</p>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">1.888888888888888</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">9*x - 17</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">0.12121212121212</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">33*x - 4</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>This example involves a complex number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RDF</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span><span class="n">CC</span><span class="o">.</span><span class="mi">0</span><span class="p">);</span> <span class="n">z</span>
<span class="go">0.500000000000000 + 0.866025403784439*I</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span> <span class="n">p</span>
<span class="go">x^3 + 1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + 1) * (x^2 - x + 1)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span>   <span class="c"># abs tol 2e-16</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
<p>This example involves a <span class="math">\(p\)</span>-adic number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">print_mode</span> <span class="o">=</span> <span class="s">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
</pre></div>
</div>
<p>These examples show the importance of proper precision control. We
compute a 200-bit approximation to <span class="math">\(sqrt(2)\)</span> which is wrong in the
33&#8217;rd bit:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">33</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="n">p</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_bits</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>Using the <tt class="docutils literal"><span class="pre">height_bound</span></tt> and <tt class="docutils literal"><span class="pre">proof</span></tt> parameters, we can see that
<span class="math">\(pi\)</span> is not the root of an integer polynomial of degree at most 5
and coefficients bounded above by 10:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For stronger results, we need more precicion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also use <tt class="docutils literal"><span class="pre">proof=True</span></tt> to get positive results:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">insufficient precision for uniqueness proof</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^8 - 40*x^6 + 352*x^4 - 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="s">&quot;1+2j&quot;</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^2 - 2*x + 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.bernoulli">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">bernoulli</tt><big>(</big><em>n</em>, <em>algorithm='default'</em>, <em>num_threads=1</em><big>)</big><a class="headerlink" href="#sage.rings.arith.bernoulli" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the n-th Bernoulli number, as a rational number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt>:<ul>
<li><tt class="docutils literal"><span class="pre">'default'</span></tt> &#8211; use &#8216;flint&#8217; for n &lt;= 300000, and &#8216;bernmm&#8217;
otherwise (this is just a heuristic, and not guaranteed to be
optimal on all hardware)</li>
<li><tt class="docutils literal"><span class="pre">'flint'</span></tt> &#8211; use the FLINT library</li>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> &#8211; use the PARI C library</li>
<li><tt class="docutils literal"><span class="pre">'gap'</span></tt> &#8211; use GAP</li>
<li><tt class="docutils literal"><span class="pre">'gp'</span></tt> &#8211; use PARI/GP interpreter</li>
<li><tt class="docutils literal"><span class="pre">'magma'</span></tt> &#8211; use MAGMA (optional)</li>
<li><tt class="docutils literal"><span class="pre">'bernmm'</span></tt> &#8211; use bernmm package (a multimodular algorithm)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">num_threads</span></tt> - positive integer, number of
threads to use (only used for bernmm algorithm)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">495057205241079648212477525/66</span>
</pre></div>
</div>
<p>We demonstrate each of the alternative algorithms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;flint&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;gap&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;gp&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;magma&#39;</span><span class="p">)</span>           <span class="c"># optional - magma</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;bernmm&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;bernmm&#39;</span><span class="p">,</span> <span class="n">num_threads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">-691/2730</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">algs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;gap&#39;</span><span class="p">,</span><span class="s">&#39;gp&#39;</span><span class="p">,</span><span class="s">&#39;pari&#39;</span><span class="p">,</span><span class="s">&#39;bernmm&#39;</span><span class="p">,</span><span class="s">&#39;flint&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">test_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">vals</span> <span class="o">=</span> <span class="p">[[</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">algs</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_list</span><span class="p">]</span>  <span class="c"># long time (up to 21s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="n">union</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">])</span>  <span class="c"># long time (depends on previous line)</span>
<span class="go">[True]</span>
<span class="gp">sage: </span><span class="n">algs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;gp&#39;</span><span class="p">,</span><span class="s">&#39;pari&#39;</span><span class="p">,</span><span class="s">&#39;bernmm&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">test_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">2256</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">vals</span> <span class="o">=</span> <span class="p">[[</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">algs</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_list</span><span class="p">]</span>  <span class="c"># long time (up to 30s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="n">union</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">])</span>  <span class="c"># long time (depends on previous line)</span>
<span class="go">[True]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>David Joyner and William Stein</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.binomial">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">binomial</tt><big>(</big><em>x</em>, <em>m</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.arith.binomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the binomial coefficient</p>
<div class="math">
\[\binom{x}{m} = x (x-1) \cdots (x-m+1) / m!\]</div>
<p>which is defined for <span class="math">\(m \in \ZZ\)</span> and any
<span class="math">\(x\)</span>. We extend this definition to include cases when
<span class="math">\(x-m\)</span> is an integer but <span class="math">\(m\)</span> is not by</p>
<div class="math">
\[\binom{x}{m} = \binom{x}{x-m}\]</div>
<p>If <span class="math">\(m &lt; 0\)</span>, return <span class="math">\(0\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">m</span></tt> - numbers or symbolic expressions. Either <tt class="docutils literal"><span class="pre">m</span></tt>
or <tt class="docutils literal"><span class="pre">x-m</span></tt> must be an integer.</li>
</ul>
<p>OUTPUT: number or symbolic expression (if input is symbolic)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.arith</span> <span class="kn">import</span> <span class="n">binomial</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">184756</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">-6</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">RealField</span><span class="p">()(</span><span class="s">&#39;2.5&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">1.87500000000000</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">);</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1/2*(n - 1)*n</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">);</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">);</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">n</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">1/6*x^3 - 1/2*x^2 + 1/3*x</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/6*x^3 - 1/2*x^2 + 1/3*x</span>
</pre></div>
</div>
<p>If <span class="math">\(x \in \ZZ\)</span>, there is an optional &#8216;algorithm&#8217; parameter, which
can be &#8216;mpir&#8217; (faster for small values) or &#8216;pari&#8217; (faster for
large values):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;mpir&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We test that certain binomials are very fast (this should be
instant) &#8211; see <a class="reference external" href="http://trac.sagemath.org/3309">trac ticket #3309</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">1140000.78</span><span class="p">),</span> <span class="mi">23310000</span><span class="p">)</span>
</pre></div>
</div>
<p>We test conversion of arguments to Integers &#8211; see <a class="reference external" href="http://trac.sagemath.org/6870">trac ticket #6870</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1/2</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">20</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="o">^</span><span class="mi">20</span><span class="p">)</span>
<span class="go">100000000000000000001</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">),</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">))</span>
<span class="go">3/2</span>
</pre></div>
</div>
<p>Some floating point cases &#8211; see <a class="reference external" href="http://trac.sagemath.org/7562">trac ticket #7562</a>, <a class="reference external" href="http://trac.sagemath.org/9633">trac ticket #9633</a>, and
<a class="reference external" href="http://trac.sagemath.org/12448">trac ticket #12448</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0.000000000000000</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-4.00000000000000</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mf">0.5</span><span class="n">r</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">0.02734375</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1001</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span> <span class="n">a</span>
<span class="go">1001.0</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;type &#39;float&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">1001</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>Test more output types:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">&lt;type &#39;int&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="n">r</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>

<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mf">5.0</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">&lt;type &#39;float&#39;&gt;</span>

<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.rational.Rational&#39;&gt;</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Ring of integers modulo 11</span>
</pre></div>
</div>
<p>Test symbolic and uni/multivariate polynomials:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">1/6*x^3 - 1/2*x^2 + 1/3*x</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">7</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-y^3 + 3*y^2 - 2*y</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in x, y over Ring of integers modulo 7</span>

<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1/2*(n - 1)*n</span>
</pre></div>
</div>
<p>Invalid inputs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">either m or x-m must be an integer</span>

<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;k,i&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">either m or x-m must be an integer</span>

<span class="gp">sage: </span><span class="n">R6</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">R6</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">factorial(2) not invertible in Ring of integers modulo 6</span>

<span class="gp">sage: </span><span class="n">R7</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">R7</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">7</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">factorial(7) not invertible in Ring of integers modulo 7</span>
</pre></div>
</div>
<p>The last two examples failed to execute since <span class="math">\(2!\)</span> and <span class="math">\(7!\)</span> are respectively
not invertible in <span class="math">\(\ZZ/6\ZZ\)</span> and <span class="math">\(\ZZ/7\ZZ\)</span>. One can check that there
is no well defined value for that binomial coefficient in the quotient:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R6</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">R6</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">R7</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R7</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R7</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
<p>For symbolic manipulation, you should use the function
<tt class="xref py py-func docutils literal"><span class="pre">binomial()</span></tt> from the module
<a class="reference external" href="../../../functions/sage/functions/other.html#module-sage.functions.other" title="(in Sage Reference Manual: Functions v6.8)"><tt class="xref py py-mod docutils literal"><span class="pre">sage.functions.other</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.functions.other</span> <span class="kn">import</span> <span class="n">binomial</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">binomial(k, i)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.binomial_coefficients">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">binomial_coefficients</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.binomial_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary containing pairs
<span class="math">\(\{(k_1,k_2) : C_{k,n}\}\)</span> where <span class="math">\(C_{k_n}\)</span> are
binomial coefficients and <span class="math">\(n = k_1 + k_2\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer</li>
</ul>
<p>OUTPUT: dict</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">binomial_coefficients</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 3), 1), ((1, 2), 3), ((2, 1), 3), ((3, 0), 1)]</span>
</pre></div>
</div>
<p>Notice the coefficients above are the same as below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="go">x^3 + 3*x^2*y + 3*x*y^2 + y^3</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Fredrik Johansson</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.continuant">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">continuant</tt><big>(</big><em>v</em>, <em>n=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.continuant" title="Permalink to this definition">¶</a></dt>
<dd><p>Function returns the continuant of the sequence <span class="math">\(v\)</span> (list
or tuple).</p>
<p>Definition: see Graham, Knuth and Patashnik, <em>Concrete Mathematics</em>,
section 6.7: Continuants. The continuant is defined by</p>
<ul class="simple">
<li><span class="math">\(K_0() = 1\)</span></li>
<li><span class="math">\(K_1(x_1) = x_1\)</span></li>
<li><span class="math">\(K_n(x_1, \cdots, x_n) = K_{n-1}(x_n, \cdots x_{n-1})x_n + K_{n-2}(x_1,  \cdots, x_{n-2})\)</span></li>
</ul>
<p>If <tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">None</span></tt> or <tt class="docutils literal"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">len(v)</span></tt> the default
<tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">len(v)</span></tt> is used.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">v</span></tt> - list or tuple of elements of a ring</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> - optional integer</li>
</ul>
<p>OUTPUT: element of ring (integer, polynomial, etcetera).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">continuant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">continuant</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">continuant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">/</span><span class="n">q</span>
<span class="go">517656/190435</span>
<span class="gp">sage: </span><span class="n">continued_fraction</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">convergent</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="go">517656/190435</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RationalField</span><span class="p">(),</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">x0*x1*x2*x3*x4 + x0*x1*x2 + x0*x1*x4 + x0*x3*x4 + x2*x3*x4 + x0 + x2 + x4</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">x0*x1*x2 + x0 + x2</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x0*x1 + 1</span>
</pre></div>
</div>
<p>We verify the identity</p>
<div class="math">
\[K_n(z,z,\cdots,z) = \sum_{k=0}^n \binom{n-k}{k} z^{n-2k}\]</div>
<p>for <span class="math">\(n = 6\)</span> using polynomial arithmetic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">((</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">),</span><span class="mi">6</span><span class="p">)</span>
<span class="go">z^6 + 5*z^4 + 6*z^2 + 1</span>

<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">object of type &#39;sage.rings.integer.Integer&#39; has no len()</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2007-02-06)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.crt">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">crt</tt><big>(</big><em>a</em>, <em>b</em>, <em>m=None</em>, <em>n=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.crt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a solution to a Chinese Remainder Theorem problem.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt> - two residues (elements of some ring for which
extended gcd is available), or two lists, one of residues and
one of moduli.</li>
<li><tt class="docutils literal"><span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">n</span></tt> - (default: <tt class="docutils literal"><span class="pre">None</span></tt>) two moduli, or <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<p>If <tt class="docutils literal"><span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">n</span></tt> are not <tt class="docutils literal"><span class="pre">None</span></tt>, returns a solution <span class="math">\(x\)</span> to the
simultaneous congruences <span class="math">\(x\equiv a \bmod m\)</span> and <span class="math">\(x\equiv b \bmod
n\)</span>, if one exists. By the Chinese Remainder Theorem, a solution to the
simultaneous congruences exists if and only if
<span class="math">\(a\equiv b\pmod{\gcd(m,n)}\)</span>. The solution <span class="math">\(x\)</span> is only well-defined modulo
<span class="math">\(\text{lcm}(m,n)\)</span>.</p>
<p>If <tt class="docutils literal"><span class="pre">a</span></tt> and <tt class="docutils literal"><span class="pre">b</span></tt> are lists, returns a simultaneous solution to
the congruences <span class="math">\(x\equiv a_i\pmod{b_i}\)</span>, if one exists.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.arith.CRT_list" title="sage.rings.arith.CRT_list"><tt class="xref py py-func docutils literal"><span class="pre">CRT_list()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>Using <tt class="docutils literal"><span class="pre">crt</span></tt> by giving it pairs of residues and moduli:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>
<span class="go">28013</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">])</span>
<span class="go">28013</span>
</pre></div>
</div>
<p>You can also use upper case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">c</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that this also works for polynomial rings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">-3/26*y^4 + 5/26*y^3 + 15/26*y + 53/26</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">(-3/52*a + 3/52)*y^4 + (5/52*a - 5/52)*y^3 + (15/52*a - 15/52)*y + 27/52*a + 25/52</span>
</pre></div>
</div>
<p>You can also do this for any number of moduli:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([],</span> <span class="p">[])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([</span><span class="n">a</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">9</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">]);</span> <span class="n">k</span>
<span class="go">(127/26988*a - 5807/386828)*x^9 + (45/8996*a - 33677/1160484)*x^8 + (2/173*a - 6/173)*x^7 + (133/6747*a - 5373/96707)*x^6 + (-6/2249*a + 18584/290121)*x^5 + (-277/8996*a + 38847/386828)*x^4 + (-135/4498*a + 42673/193414)*x^3 + (-1005/8996*a + 470245/1160484)*x^2 + (-1215/8996*a + 141165/386828)*x + 621/8996*a + 836445/386828</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>If the moduli are not coprime, a solution may not exist:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">No solution to crt problem since gcd(8,12) does not divide 4-6</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x + 5/2</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x^3 + x^2 + 1/2*x + 1</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">No solution to crt problem since gcd(x^2 - 1,x^3 - 1) does not divide 2-x</span>

<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.dedekind_sum">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">dedekind_sum</tt><big>(</big><em>p</em>, <em>q</em>, <em>algorithm='default'</em><big>)</big><a class="headerlink" href="#sage.rings.arith.dedekind_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Dedekind sum <span class="math">\(s(p,q)\)</span> defined for integers <span class="math">\(p\)</span>, <span class="math">\(q\)</span> as</p>
<div class="math">
\[s(p,q) = \sum_{i=0}^{q-1} \left(\!\left(\frac{i}{q}\right)\!\right)
                          \left(\!\left(\frac{pi}{q}\right)\!\right)\]</div>
<p>where</p>
<div class="math">
\[\begin{split}((x))=\begin{cases}
    x-\lfloor x \rfloor - \frac{1}{2} &amp;\mbox{if }
        x \in \QQ \setminus \ZZ \\
    0 &amp; \mbox{if } x \in \ZZ.
    \end{cases}\end{split}\]</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Caution is required as the Dedekind sum sometimes depends on the
algorithm or is left undefined when <span class="math">\(p\)</span> and <span class="math">\(q\)</span> are not coprime.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt>, <tt class="docutils literal"><span class="pre">q</span></tt> &#8211; integers</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; must be one of the following<ul>
<li><tt class="docutils literal"><span class="pre">'default'</span></tt> - (default) use FLINT</li>
<li><tt class="docutils literal"><span class="pre">'flint'</span></tt> - use FLINT</li>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> - use PARI (gives different results if <span class="math">\(p\)</span> and <span class="math">\(q\)</span>
are not coprime)</li>
</ul>
</li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<p>Several small values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="k">print</span> <span class="p">[</span><span class="n">dedekind_sum</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[0]</span>
<span class="go">[0, 0]</span>
<span class="go">[0, 0, 0]</span>
<span class="go">[0, 1/18, -1/18, 0]</span>
<span class="go">[0, 1/8, 0, -1/8, 0]</span>
<span class="go">[0, 1/5, 0, 0, -1/5, 0]</span>
<span class="go">[0, 5/18, 1/18, 0, -1/18, -5/18, 0]</span>
<span class="go">[0, 5/14, 1/14, -1/14, 1/14, -1/14, -5/14, 0]</span>
<span class="go">[0, 7/16, 1/8, 1/16, 0, -1/16, -1/8, -7/16, 0]</span>
<span class="go">[0, 14/27, 4/27, 1/18, -4/27, 4/27, -1/18, -4/27, -14/27, 0]</span>
</pre></div>
</div>
<p>Check relations for restricted arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span> <span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="go">77/46</span>
<span class="go">77/46</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">723</span>    <span class="c"># must be coprime</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">+</span> <span class="n">dedekind_sum</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">31583/86760</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="n">q</span> <span class="o">+</span> <span class="n">q</span><span class="o">/</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span>
<span class="go">31583/86760</span>
</pre></div>
</div>
<p>We check that evaluation works with large input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">54</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">93</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">459340694971839990630374299870/29710560942849126597578981379</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">54</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">93</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">459340694971839990630374299870/29710560942849126597578981379</span>
</pre></div>
</div>
<p>We check consistency of the results:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;flint&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">)</span>
<span class="go">-1/8</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;flint&#39;</span><span class="p">)</span>
<span class="go">-1/8</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">-1/8</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="apostol" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Apostol]</td><td>T. Apostol, Modular functions and Dirichlet series
in number theory, Springer, 1997 (2nd ed), section 3.7&#8211;3.9.</td></tr>
</tbody>
</table>
<ul class="simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Dedekind_sum">Wikipedia article Dedekind_sum</a></li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.differences">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">differences</tt><big>(</big><em>lis</em>, <em>n=1</em><big>)</big><a class="headerlink" href="#sage.rings.arith.differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <span class="math">\(n\)</span> successive differences of the elements in
<span class="math">\(lis\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">differences</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="go">[1, 2, 2, 4, 2, 4, 2, 4, 6, 2, 6, 4, 2, 4]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)])</span>
<span class="go">[3, 5, 7, 9, 11, 13, 15, 17, 19]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">i</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)])</span>
<span class="go">[10, 22, 40, 64, 94, 130, 172, 220, 274, 334, 400, 472, 550, 634, 724, 820, 922, 1030, 1144]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">i</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[10, 16, 22, 28, 34, 40, 46, 52, 58, 64, 70, 76, 82, 88, 94, 100, 106, 112]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">p</span> <span class="o">-</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">50</span><span class="p">))],</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[-1, 2, -4, 4, -4, 4, 0, -6, 8, -6, 0, 4]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Timothy Clemans (2008-03-09)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.divisors">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">divisors</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.divisors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all positive integer divisors of the nonzero
integer n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - the element</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1, 3]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[1, 2, 3, 6]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<span class="go">[1, 2, 4, 7, 14, 28]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1, 2, 4, 8, 16, 32]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[1, 2, 4, 5, 10, 20, 25, 50, 100]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">n must be nonzero</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">17</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 6, 8, 9, 12, 17, 18, 24, 34, 36, 51, 68, 72, 102, 136, 153, 204, 306, 408, 612, 1224]</span>
</pre></div>
</div>
<p>This function works whenever one has unique factorization:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">[Fractional ideal (1), Fractional ideal (a), Fractional ideal (7)]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[Fractional ideal (1), Fractional ideal (3), Fractional ideal (-a + 2), Fractional ideal (-a - 2)]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="go">[Fractional ideal (1), Fractional ideal (5), Fractional ideal (a), Fractional ideal (7), Fractional ideal (5*a), Fractional ideal (35)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">300</span><span class="p">))</span>
<span class="go">[1, 2, 3, 4, 5, 6, 10, 12, 15, 20, 25, 30, 50, 60, 75, 100, 150, 300]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.eratosthenes">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">eratosthenes</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.eratosthenes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the primes <span class="math">\(\leq n\)</span>.</p>
<p>This is extremely slow and is for educational purposes only.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - a positive integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of primes less than or equal to n.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">25</span>
<span class="gp">sage: </span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">213</span><span class="p">)</span> <span class="o">==</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">213</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.factor">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">factor</tt><big>(</big><em>n</em>, <em>proof=None</em>, <em>int_=False</em>, <em>algorithm='pari'</em>, <em>verbose=0</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.arith.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the factorization of <tt class="docutils literal"><span class="pre">n</span></tt>.  The result depends on the
type of <tt class="docutils literal"><span class="pre">n</span></tt>.</p>
<p>If <tt class="docutils literal"><span class="pre">n</span></tt> is an integer, returns the factorization as an object
of type <tt class="docutils literal"><span class="pre">Factorization</span></tt>.</p>
<p>If n is not an integer, <tt class="docutils literal"><span class="pre">n.factor(proof=proof,</span> <span class="pre">**kwds)</span></tt> gets called.
See <tt class="docutils literal"><span class="pre">n.factor??</span></tt> for more documentation in this case.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This means that applying <tt class="docutils literal"><span class="pre">factor</span></tt> to an integer result of
a symbolic computation will not factor the integer, because it is
considered as an element of a larger symbolic ring.</p>
<p>EXAMPLE:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">9</span>
</pre></div>
</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an nonzero integer</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - bool or None (default: None)</li>
<li><tt class="docutils literal"><span class="pre">int_</span></tt> - bool (default: False) whether to return
answers as Python ints</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - string<ul>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> - (default) use the PARI c library</li>
<li><tt class="docutils literal"><span class="pre">'kash'</span></tt> - use KASH computer algebra system (requires the
optional kash package be installed)</li>
<li><tt class="docutils literal"><span class="pre">'magma'</span></tt> - use Magma (requires magma be installed)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> - integer (default: 0); PARI&#8217;s debug
variable is set to this; e.g., set to 4 or 8 to see lots of output
during factorization.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>factorization of n</li>
</ul>
<p>The qsieve and ecm commands give access to highly optimized
implementations of algorithms for doing certain integer
factorization problems. These implementations are not used by the
generic factor command, which currently just calls PARI (note that
PARI also implements sieve and ecm algorithms, but they aren&#8217;t as
optimized). Thus you might consider using them instead for certain
numbers.</p>
<p>The factorization returned is an element of the class
<a class="reference external" href="../../../structure/sage/structure/factorization.html#sage.structure.factorization.Factorization" title="(in Sage Reference Manual: Basic Structures v6.8)"><tt class="xref py py-class docutils literal"><span class="pre">Factorization</span></tt></a>; see Factorization??
for more details, and examples below for usage. A Factorization contains
both the unit factor (+1 or -1) and a sorted list of (prime, exponent)
pairs.</p>
<p>The factorization displays in pretty-print format but it is easy to
obtain access to the (prime,exponent) pairs and the unit, to
recover the number from its factorization, and even to multiply two
factorizations. See examples below.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="go">2^2 * 5^3</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="go">-1 * 2^2 * 5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[(2, 2), (5, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span> <span class="o">-</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span> <span class="p">)</span>
<span class="go">-1 * 101 * 10000019</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;kash&#39;</span><span class="p">)</span>      <span class="c"># optional - kash</span>
<span class="go">-1 * 2^2 * 5^3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;magma&#39;</span><span class="p">)</span>     <span class="c"># optional - magma</span>
<span class="go">-1 * 2^2 * 5^3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Prime factorization of 0 not defined.</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">59649589127497217 * 5704689200685129054721</span>
</pre></div>
</div>
<p>Sage calls PARI&#8217;s factor, which has proof False by default.
Sage has a global proof flag, set to True by default (see
<a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Sage Reference Manual v6.8)"><tt class="xref py py-mod docutils literal"><span class="pre">sage.structure.proof.proof</span></tt></a>, or proof.[tab]). To override
the default, call this function with proof=False.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">89</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">2 * 179 * 1611479891519807 * 5042939439565996049162197</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">197</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c"># long time (2s)</span>
<span class="go">3 * 197002597249 * 1348959352853811313 * 251951573867253012259144010843</span>
</pre></div>
</div>
<p>Any object which has a factor method can be factored like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">122</span> <span class="o">-</span> <span class="mi">454</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="go">(-3*i - 2) * (-i - 2)^3 * (i + 1)^3 * (i + 4)</span>
</pre></div>
</div>
<p>To access the data in a factorization:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="mi">420</span><span class="p">);</span> <span class="n">f</span>
<span class="go">2^2 * 3 * 5 * 7</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[(2, 2), (3, 1), (5, 1), (7, 1)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[2, 3, 5, 7]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[2, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span><span class="o">^</span><span class="n">e</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[4, 3, 5, 7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.factorial">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">factorial</tt><big>(</big><em>n</em>, <em>algorithm='gmp'</em><big>)</big><a class="headerlink" href="#sage.rings.arith.factorial" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the factorial of <span class="math">\(n\)</span>, which is the product
<span class="math">\(1\cdot 2\cdot 3 \cdots (n-1)\cdot n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - string (default: &#8216;gmp&#8217;):<ul>
<li><tt class="docutils literal"><span class="pre">'gmp'</span></tt> - use the GMP C-library factorial function</li>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> - use PARI&#8217;s factorial function</li>
</ul>
</li>
</ul>
<p>OUTPUT: an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.arith</span> <span class="kn">import</span> <span class="n">factorial</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">3628800</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">71</span><span class="p">)</span> <span class="o">==</span> <span class="mi">71</span><span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="o">-</span><span class="mi">32</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">factorial -- must be nonnegative</span>
</pre></div>
</div>
<p>PERFORMANCE: This discussion is valid as of April 2006. All timings
below are on a Pentium Core Duo 2Ghz MacBook Pro running Linux with
a 2.6.16.1 kernel.</p>
<ul class="simple">
<li>It takes less than a minute to compute the factorial of
<span class="math">\(10^7\)</span> using the GMP algorithm, and the factorial of
<span class="math">\(10^6\)</span> takes less than 4 seconds.</li>
<li>The GMP algorithm is faster and more memory efficient than the
PARI algorithm. E.g., PARI computes <span class="math">\(10^7\)</span> factorial in 100
seconds on the core duo 2Ghz.</li>
<li>For comparison, computation in Magma <span class="math">\(\leq\)</span> 2.12-10 of
<span class="math">\(n!\)</span> is best done using <tt class="docutils literal"><span class="pre">*[1..n]</span></tt>. It takes
113 seconds to compute the factorial of <span class="math">\(10^7\)</span> and 6
seconds to compute the factorial of <span class="math">\(10^6\)</span>. Mathematica
V5.2 compute the factorial of <span class="math">\(10^7\)</span> in 136 seconds and the
factorial of <span class="math">\(10^6\)</span> in 7 seconds. (Mathematica is notably
very efficient at memory usage when doing factorial
calculations.)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.falling_factorial">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">falling_factorial</tt><big>(</big><em>x</em>, <em>a</em><big>)</big><a class="headerlink" href="#sage.rings.arith.falling_factorial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the falling factorial <span class="math">\((x)_a\)</span>.</p>
<p>The notation in the literature is a mess: often <span class="math">\((x)_a\)</span>,
but there are many other notations: GKP: Concrete Mathematics uses
<span class="math">\(x^{\underline{a}}\)</span>.</p>
<p>Definition: for integer <span class="math">\(a \ge 0\)</span> we have
<span class="math">\(x(x-1) \cdots (x-a+1)\)</span>. In all other cases we use the
GAMMA-function: <span class="math">\(\frac {\Gamma(x+1)} {\Gamma(x-a+1)}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - element of a ring</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - a non-negative integer or</li>
</ul>
<p>OR</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span> <span class="pre">and</span> <span class="pre">a</span></tt> - any numbers</li>
</ul>
<p>OUTPUT: the falling factorial</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">720</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">RR</span><span class="p">(</span><span class="s">&#39;3.0&#39;</span><span class="p">))</span>
<span class="go">720.000000000000</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">RR</span><span class="p">(</span><span class="s">&#39;3.3&#39;</span><span class="p">))</span>
<span class="go">1310.11633396601</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">3628800</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">3628800</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">falling_factorial</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">,</span> <span class="n">I</span><span class="p">);</span> <span class="n">a</span>
<span class="go">gamma(I + 2)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">0.652965496420167 + 0.343065839816545*I</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">4*I + 2</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">-10</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c"># A(A - I)</span>
<span class="go">[  1   0  10  10]</span>
<span class="go">[  1   0  10  10]</span>
<span class="go">[ 20   0 101 100]</span>
<span class="go">[  2   0  11  10]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - 6*x^3 + 11*x^2 - 6*x</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/14858">trac ticket #14858</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">20</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/16770">trac ticket #16770</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">falling_factorial</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2006-03-05)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.four_squares">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">four_squares</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.four_squares" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the integer <span class="math">\(n\)</span> as a sum of four integer squares.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; an integer</li>
</ul>
<p>OUTPUT: a tuple <span class="math">\((a,b,c,d)\)</span> of non-negative integers such that
<span class="math">\(n = a^2 + b^2 + c^2 + d^2\)</span> with <span class="math">\(a &lt;= b &lt;= c &lt;= d\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(0, 1, 1, 1)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">(0, 0, 2, 3)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">130</span><span class="p">)</span>
<span class="go">(0, 0, 3, 11)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">1101011011004</span><span class="p">)</span>
<span class="go">(90, 102, 1220, 1049290)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">100</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(155024616290, 2612183768627, 14142135623730950488016887, 99999999999999999999999999999999999999999999999999)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">129</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">129</span><span class="o">+</span><span class="mi">10000</span><span class="p">):</span>  <span class="c"># long time</span>
<span class="go">....:     S = four_squares(i)</span>
<span class="go">....:     assert sum(x^2 for x in S) == i</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<span class="go">....:     n = ZZ.random_element(2**32,2**34)</span>
<span class="go">....:     aa,bb,cc,dd = four_squares(n)</span>
<span class="go">....:     assert aa**2 + bb**2 + cc**2 + dd**2 == n</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.fundamental_discriminant">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">fundamental_discriminant</tt><big>(</big><em>D</em><big>)</big><a class="headerlink" href="#sage.rings.arith.fundamental_discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the quadratic extension
<span class="math">\(K=Q(\sqrt{D})\)</span>, i.e. an integer d congruent to either 0 or
1, mod 4, and such that, at most, the only square dividing it is
4.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">D</span></tt> - an integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an integer, the fundamental discriminant</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
<span class="go">408</span>
<span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="mi">720</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.gcd">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">gcd</tt><big>(</big><em>a</em>, <em>b=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#sage.rings.arith.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>The greatest common divisor of a and b, or if a is a list and b is
omitted the greatest common divisor of all elements of a.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a,b</span></tt> - two elements of a ring with gcd or</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - a list or tuple of elements of a ring with
gcd</li>
</ul>
<p>Additional keyword arguments are passed to the respectively called
methods.</p>
<p>OUTPUT:</p>
<p>The given elements are first coerced into a common parent. Then,
their greatest common divisor <em>in that common parent</em> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="mi">97</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">97</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2/15</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>  <span class="c"># fast  !!</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Note that to take the gcd of <span class="math">\(n\)</span> elements for <span class="math">\(n \not= 2\)</span> you must
put the elements into a list by enclosing them in <tt class="docutils literal"><span class="pre">[..]</span></tt>.  Before
#4988 the following wrongly returned 3 since the third parameter
was just ignored:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">gcd() takes at most 2 arguments (3 given)</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Similarly, giving just one element (which is not a list) gives an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">&#39;sage.rings.integer.Integer&#39; object is not iterable</span>
</pre></div>
</div>
<p>By convention, the gcd of the empty list is (the integer) 0:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gcd</span><span class="p">([])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">gcd</span><span class="p">([]))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The following shows that indeed coercion takes place before computing
the gcd. This behaviour was introduced in <a class="reference external" href="http://trac.sagemath.org/10771">trac ticket #10771</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="go">Fraction Field of Univariate Polynomial Ring in x over Rational Field</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">]))</span>
<span class="go">Fraction Field of Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>Make sure we try QQ and not merely ZZ (<a class="reference external" href="http://trac.sagemath.org/13014">trac ticket #13014</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">gcd</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Make sure that the gcd of Expressions stays symbolic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<p>Verify that objects without gcd methods but which can&#8217;t be
coerced to ZZ or QQ raise an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeMonoid</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to find gcd</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.get_gcd">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">get_gcd</tt><big>(</big><em>order</em><big>)</big><a class="headerlink" href="#sage.rings.arith.get_gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fastest gcd function for integers of size no larger than
order.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">get_gcd</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
<span class="go">&lt;built-in method gcd_int of sage.rings.fast_arith.arith_int object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">get_gcd</span><span class="p">(</span><span class="mi">400000</span><span class="p">)</span>
<span class="go">&lt;built-in method gcd_longlong of sage.rings.fast_arith.arith_llong object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">get_gcd</span><span class="p">(</span><span class="mi">4000000000</span><span class="p">)</span>
<span class="go">&lt;function gcd at ...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.get_inverse_mod">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">get_inverse_mod</tt><big>(</big><em>order</em><big>)</big><a class="headerlink" href="#sage.rings.arith.get_inverse_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fastest inverse_mod function for integers of size no
larger than order.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">get_inverse_mod</span><span class="p">(</span><span class="mi">6000</span><span class="p">)</span>
<span class="go">&lt;built-in method inverse_mod_int of sage.rings.fast_arith.arith_int object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">get_inverse_mod</span><span class="p">(</span><span class="mi">600000</span><span class="p">)</span>
<span class="go">&lt;built-in method inverse_mod_longlong of sage.rings.fast_arith.arith_llong object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">get_inverse_mod</span><span class="p">(</span><span class="mi">6000000000</span><span class="p">)</span>
<span class="go">&lt;function inverse_mod at ...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.hilbert_conductor">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">hilbert_conductor</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="headerlink" href="#sage.rings.arith.hilbert_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the product of all (finite) primes where the Hilbert symbol is -1.
What is the same, this is the (reduced) discriminant of the quaternion
algebra <span class="math">\((a,b)\)</span> over <span class="math">\(\QQ\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt> &#8211; integers</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>squarefree positive integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span><span class="p">)</span>
<span class="go">17</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Gonzalo Tornaria (2009-03-02)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.hilbert_conductor_inverse">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">hilbert_conductor_inverse</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#sage.rings.arith.hilbert_conductor_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a pair of integers <span class="math">\((a,b)\)</span> such that <tt class="docutils literal"><span class="pre">hilbert_conductor(a,b)</span> <span class="pre">==</span> <span class="pre">d</span></tt>.
The quaternion algebra <span class="math">\((a,b)\)</span> over <span class="math">\(\QQ\)</span> will then have (reduced)
discriminant <span class="math">\(d\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">d</span></tt> &#8211; square-free positive integer</li>
</ul>
<p>OUTPUT: pair of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(-1, -1)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(-1, -3)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">(-1, 3)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">(-3, -10)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">d needs to be squarefree</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">d needs to be positive</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Gonzalo Tornaria (2009-03-02)</li>
</ul>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">d</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">squarefree_part</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">*</span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="o">!=</span> <span class="n">d</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;hilbert_conductor_inverse failed for d =&quot;</span><span class="p">,</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.hilbert_symbol">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">hilbert_symbol</tt><big>(</big><em>a</em>, <em>b</em>, <em>p</em>, <em>algorithm='pari'</em><big>)</big><a class="headerlink" href="#sage.rings.arith.hilbert_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns 1 if <span class="math">\(ax^2 + by^2\)</span> <span class="math">\(p\)</span>-adically represents
a nonzero square, otherwise returns <span class="math">\(-1\)</span>. If either a or b
is 0, returns 0.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a,</span> <span class="pre">b</span></tt> - integers</li>
<li><tt class="docutils literal"><span class="pre">p</span></tt> - integer; either prime or -1 (which
represents the archimedean place)</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - string<ul>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> - (default) use the PARI C library</li>
<li><tt class="docutils literal"><span class="pre">'direct'</span></tt> - use a Python implementation</li>
<li><tt class="docutils literal"><span class="pre">'all'</span></tt> - use both PARI and direct and check that
the results agree, then return the common answer</li>
</ul>
</li>
</ul>
<p>OUTPUT: integer (0, -1, or 1)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="go">-1</span>

<span class="gp">sage: </span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">QQ</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">QQ</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein and David Kohel (2006-01-05)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.integer_ceil">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">integer_ceil</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.rings.arith.integer_ceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ceiling of x.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">integer_ceil</span><span class="p">(</span><span class="mf">5.4</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">integer_ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">computation of ceil of x not implemented</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.integer_floor">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">integer_floor</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.rings.arith.integer_floor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the largest integer <span class="math">\(\leq x\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - an object that has a floor method or is
coercible to int</li>
</ul>
<p>OUTPUT: an Integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="mf">5.4</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mf">5.4</span><span class="p">))</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="n">RDF</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">-3</span>

<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">computation of floor of x not implemented</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.inverse_mod">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">inverse_mod</tt><big>(</big><em>a</em>, <em>m</em><big>)</big><a class="headerlink" href="#sage.rings.arith.inverse_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of the ring element a modulo m.</p>
<p>If no special inverse_mod is defined for the elements, it tries to
coerce them into integers and perform the inversion there</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_power_of_two">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_power_of_two</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_power_of_two" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns True if and only if <tt class="docutils literal"><span class="pre">n</span></tt> is a power of
2</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> - if n is a power of 2</li>
<li><tt class="docutils literal"><span class="pre">False</span></tt> - if not</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_prime">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_prime</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if <span class="math">\(n\)</span> is a prime number, and <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</p>
<p>Use a provable primality test or a strong pseudo-primality test depending
on the global <a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Sage Reference Manual v6.8)"><tt class="xref py py-mod docutils literal"><span class="pre">arithmetic</span> <span class="pre">proof</span> <span class="pre">flag</span></tt></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - the object for which to determine primality</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.arith.is_pseudoprime" title="sage.rings.arith.is_pseudoprime"><tt class="xref py py-meth docutils literal"><span class="pre">is_pseudoprime()</span></tt></a></li>
<li><a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.is_prime" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">sage.rings.integer.Integer.is_prime()</span></tt></a></li>
</ul>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Kevin Stueve <a class="reference external" href="mailto:kstueve&#37;&#52;&#48;uw&#46;edu">kstueve<span>&#64;</span>uw<span>&#46;</span>edu</a> (2010-01-17):
delegated calculation to <tt class="docutils literal"><span class="pre">n.is_prime()</span></tt></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2048</span> <span class="o">+</span> <span class="mi">981</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>    <span class="c"># not tested - takes ~ 1min</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>    <span class="c"># instantaneous!</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_prime_power">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_prime_power</tt><big>(</big><em>n</em>, <em>flag=None</em>, <em>get_data=False</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_prime_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <tt class="docutils literal"><span class="pre">n</span></tt> is a positive power of a prime number</p>
<p>This function simply calls the method <a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.is_prime_power" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">Integer.is_prime_power()</span></tt></a> of Integers.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; an integer</li>
<li><tt class="docutils literal"><span class="pre">get_data</span></tt> &#8211; if set to <tt class="docutils literal"><span class="pre">True</span></tt>, return a pair <tt class="docutils literal"><span class="pre">(p,k)</span></tt> such that
this integer equals <tt class="docutils literal"><span class="pre">p^k</span></tt> instead of <tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">(self,0)</span></tt> instead of
<tt class="docutils literal"><span class="pre">False</span></tt></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(2, 10)</span>
</pre></div>
</div>
<p>The same results can be obtained with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="mf">389.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">2000.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mf">2.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">1024.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">1024.</span><span class="n">is_prime_power</span><span class="p">(</span><span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(2, 10)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="mi">997</span><span class="o">^</span><span class="mi">100</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2197</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no conversion of this rational to integer</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to convert &#39;foo&#39; to an integer</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_pseudoprime">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_pseudoprime</tt><big>(</big><em>n</em>, <em>flag=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_pseudoprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <tt class="docutils literal"><span class="pre">n</span></tt> is a pseudo-prime</p>
<p>The result is <em>NOT</em> proven correct - <em>this is a pseudo-primality test!</em>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; an integer</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We do not consider negatives of prime numbers as prime.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="go">-1 * 2 * 3</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Deprecation warning from <a class="reference external" href="http://trac.sagemath.org/16878">trac ticket #16878</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: the keyword &#39;flag&#39; is deprecated and no longer used</span>
<span class="go">See http://trac.sagemath.org/16878 for details.</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_pseudoprime_power">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_pseudoprime_power</tt><big>(</big><em>n</em>, <em>get_data=False</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_pseudoprime_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if <tt class="docutils literal"><span class="pre">n</span></tt> is a power of a pseudoprime.</p>
<p>The result is <em>NOT</em> proven correct - <em>this IS a pseudo-primality test!</em>.
Note that a prime power is a positive power of a prime number so that 1 is
not a prime power.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer</li>
<li><tt class="docutils literal"><span class="pre">get_data</span></tt> - (boolean) instead of a boolean return a pair <span class="math">\((p,k)\)</span> so
that <tt class="docutils literal"><span class="pre">n</span></tt> equals <span class="math">\(p^k\)</span> and <span class="math">\(p\)</span> is a pseudoprime or <span class="math">\((n,0)\)</span> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">997</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Use of the get_data keyword:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">1024</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(3, 1024)</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">256</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(2, 256)</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(31, 1)</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(15, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_pseudoprime_small_power">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_pseudoprime_small_power</tt><big>(</big><em>n</em>, <em>bound=None</em>, <em>get_data=False</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_pseudoprime_small_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated version of <tt class="docutils literal"><span class="pre">is_pseudoprime_power</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_pseudoprime_small_power</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: the function is_pseudoprime_small_power() is deprecated, use is_pseudoprime_power() instead.</span>
<span class="go">See http://trac.sagemath.org/16878 for details.</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_small_power</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">1024</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(3, 1024)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_square">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_square</tt><big>(</big><em>n</em>, <em>root=False</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether or not n is square, and if n is a square also
returns the square root. If n is not square, also returns None.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer</li>
<li><tt class="docutils literal"><span class="pre">root</span></tt> - whether or not to also return a square
root (default: False)</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">bool</span></tt> - whether or not a square</li>
<li><tt class="docutils literal"><span class="pre">object</span></tt> - (optional) an actual square if found,
and None otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mf">2.2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.is_squarefree">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">is_squarefree</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.is_squarefree" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <tt class="docutils literal"><span class="pre">n</span></tt> is square free.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">O</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">O</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(-I) * (I + 1)^2</span>
</pre></div>
</div>
<p>This method fails on domains which are not Unique Factorization Domains:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">non-principal ideal in factorization</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.jacobi_symbol">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">jacobi_symbol</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="headerlink" href="#sage.rings.arith.jacobi_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>The Jacobi symbol of integers a and b, where b is odd.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="#sage.rings.arith.kronecker_symbol" title="sage.rings.arith.kronecker_symbol"><tt class="xref py py-func docutils literal"><span class="pre">kronecker_symbol()</span></tt></a> command extends the Jacobi
symbol to all integers b.</p>
</div>
<p>If</p>
<p><span class="math">\(b = p_1^{e_1} * ... * p_r^{e_r}\)</span></p>
<p>then</p>
<p><span class="math">\((a|b) = (a|p_1)^{e_1} ... (a|p_r)^{e_r}\)</span></p>
<p>where <span class="math">\((a|p_j)\)</span> are Legendre Symbols.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a</span></tt> - an integer</li>
<li><tt class="docutils literal"><span class="pre">b</span></tt> - an odd integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">777</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">second input must be odd, 2 is not odd</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.kronecker">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">kronecker</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#sage.rings.arith.kronecker" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for <a class="reference internal" href="#sage.rings.arith.kronecker_symbol" title="sage.rings.arith.kronecker_symbol"><tt class="xref py py-func docutils literal"><span class="pre">kronecker_symbol()</span></tt></a>.</p>
<p>The Kronecker symbol <span class="math">\((x|y)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">y</span></tt> - integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.kronecker_symbol">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">kronecker_symbol</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#sage.rings.arith.kronecker_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>The Kronecker symbol <span class="math">\((x|y)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">y</span></tt> - integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>IMPLEMENTATION: Using GMP.</p>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.lcm">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">lcm</tt><big>(</big><em>a</em>, <em>b=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.lcm" title="Permalink to this definition">¶</a></dt>
<dd><p>The least common multiple of a and b, or if a is a list and b is
omitted the least common multiple of all elements of a.</p>
<p>Note that LCM is an alias for lcm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a,b</span></tt> - two elements of a ring with lcm or</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - a list or tuple of elements of a ring with
lcm</li>
</ul>
<p>OUTPUT:</p>
<p>First, the given elements are coerced into a common parent. Then,
their least common multiple <em>in that parent</em> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9700</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9700</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">60</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">LCM</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">))</span>   <span class="c"># *very* fast!</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="go">4349</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The following tests against a bug that was fixed in <a class="reference external" href="http://trac.sagemath.org/10771">trac ticket #10771</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The following shows that indeed coercion takes place before
computing the least common multiple:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">]))</span>
<span class="go">Fraction Field of Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>Make sure we try QQ and not merely ZZ (<a class="reference external" href="http://trac.sagemath.org/13014">trac ticket #13014</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">lcm</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Make sure that the lcm of Expressions stays symbolic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<p>Verify that objects without lcm methods but which can&#8217;t be
coerced to ZZ or QQ raise an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeMonoid</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to find lcm</span>
</pre></div>
</div>
<p>Check rational and integers (<a class="reference external" href="http://trac.sagemath.org/17852">trac ticket #17852</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.legendre_symbol">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">legendre_symbol</tt><big>(</big><em>x</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.rings.arith.legendre_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>The Legendre symbol <span class="math">\((x|p)\)</span>, for <span class="math">\(p\)</span> prime.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="#sage.rings.arith.kronecker_symbol" title="sage.rings.arith.kronecker_symbol"><tt class="xref py py-func docutils literal"><span class="pre">kronecker_symbol()</span></tt></a> command extends the Legendre
symbol to composite moduli and <span class="math">\(p=2\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">p</span></tt> - an odd prime number</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p must be odd</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p must be a prime</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.mqrr_rational_reconstruction">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">mqrr_rational_reconstruction</tt><big>(</big><em>u</em>, <em>m</em>, <em>T</em><big>)</big><a class="headerlink" href="#sage.rings.arith.mqrr_rational_reconstruction" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximal Quotient Rational Reconstruction.</p>
<p>For research purposes only - this is pure Python, so slow.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">u,</span> <span class="pre">m,</span> <span class="pre">T</span></tt> -  integers such that <span class="math">\(m &gt; u \ge 0\)</span>, <span class="math">\(T &gt; 0\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>Either integers <span class="math">\(n,d\)</span> such that <span class="math">\(d&gt;0\)</span>, <span class="math">\(\mathop{\mathrm{gcd}}(n,d)=1\)</span>, <span class="math">\(n/d=u \bmod m\)</span>, and
<span class="math">\(T \cdot d \cdot |n| &lt; m\)</span>, or <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>Reference: Monagan, Maximal Quotient Rational Reconstruction: An
Almost Optimal Algorithm for Rational Reconstruction (page 11)</p>
<p>This algorithm is probabilistic.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">mqrr_rational_reconstruction</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">3100</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
<span class="go">(21, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.multinomial">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">multinomial</tt><big>(</big><em>*ks</em><big>)</big><a class="headerlink" href="#sage.rings.arith.multinomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the multinomial coefficient</p>
<p>INPUT:</p>
<ul class="simple">
<li>An arbitrary number of integer arguments <span class="math">\(k_1,\dots,k_n\)</span></li>
<li>A list of integers <span class="math">\([k_1,\dots,k_n]\)</span></li>
</ul>
<p>OUTPUT:</p>
<p>Returns the integer:</p>
<div class="math">
\[\binom{k_1 + \cdots + k_n}{k_1, \cdots, k_n}
=\frac{\left(\sum_{i=1}^n k_i\right)!}{\prod_{i=1}^n k_i!}
= \prod_{i=1}^n \binom{\sum_{j=1}^i k_j}{k_i}\]</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">618970023101454657175683075</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">([</span><span class="mi">2</span><span class="o">^</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">618970023101454657175683075</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Gabriel Ebner</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.multinomial_coefficients">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">multinomial_coefficients</tt><big>(</big><em>m</em>, <em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.multinomial_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary containing pairs
<span class="math">\(\{(k_1, k_2, ..., k_m) : C_{k, n}\}\)</span> where
<span class="math">\(C_{k, n}\)</span> are multinomial coefficients such that
<span class="math">\(n = k_1 + k_2 + ...+ k_m\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">m</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer</li>
</ul>
<p>OUTPUT: dict</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 5), 1), ((1, 4), 5), ((2, 3), 10), ((3, 2), 10), ((4, 1), 5), ((5, 0), 1)]</span>
</pre></div>
</div>
<p>Notice that these are the coefficients of <span class="math">\((x+y)^5\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="go">x^5 + 5*x^4*y + 10*x^3*y^2 + 10*x^2*y^3 + 5*x*y^4 + y^5</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 0, 2), 1), ((0, 1, 1), 2), ((0, 2, 0), 1), ((1, 0, 1), 2), ((1, 1, 0), 2), ((2, 0, 0), 1)]</span>
</pre></div>
</div>
<p>ALGORITHM: The algorithm we implement for computing the multinomial
coefficients is based on the following result:</p>
<p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>\binom{n}{k_1, \cdots, k_m} =
\frac{k_1+1}{n-k_1}\sum_{i=2}^m \binom{n}{k_1+1, \cdots, k_i-1, \cdots}
</pre></div>
</div>
<p>e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c"># random value</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)):</span>
<span class="gp">... </span>      <span class="n">ki</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="gp">... </span>      <span class="n">ki</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">... </span>      <span class="n">ki</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="gp">... </span>      <span class="n">s</span> <span class="o">+=</span> <span class="n">multinomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">ki</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">{(): 1}</span>
<span class="gp">sage: </span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.next_prime">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">next_prime</tt><big>(</big><em>n</em>, <em>proof=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.next_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>The next prime greater than the integer n. If n is prime, then this
function does not return n, but the next prime after n. If the
optional argument proof is False, this function only returns a
pseudo-prime, as defined by the PARI nextprime function. If it is
None, uses the global default (see <a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Sage Reference Manual v6.8)"><tt class="xref py py-mod docutils literal"><span class="pre">sage.structure.proof.proof</span></tt></a>)</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - bool or None (default: None)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Notice that the next_prime(5) is not 5 but 7.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="go">2011</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.next_prime_power">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">next_prime_power</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.next_prime_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the smallest prime power greater than <tt class="docutils literal"><span class="pre">n</span></tt>.</p>
<p>Note that if <tt class="docutils literal"><span class="pre">n</span></tt> is a prime power, then this function does not return
<tt class="docutils literal"><span class="pre">n</span></tt>, but the next prime power after <tt class="docutils literal"><span class="pre">n</span></tt>.</p>
<p>This function just calls the method
<a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.next_prime_power" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">Integer.next_prime_power()</span></tt></a>
of Integers.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.arith.is_prime_power" title="sage.rings.arith.is_prime_power"><tt class="xref py py-func docutils literal"><span class="pre">is_prime_power()</span></tt></a> (and
<a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.is_prime_power" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">Integer.is_prime_power()</span></tt></a>)</li>
<li><a class="reference internal" href="#sage.rings.arith.previous_prime_power" title="sage.rings.arith.previous_prime_power"><tt class="xref py py-func docutils literal"><span class="pre">previous_prime_power()</span></tt></a> (and
<a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.next_prime_power" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">Integer.previous_prime_power()</span></tt></a>)</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="go">101</span>
</pre></div>
</div>
<p>The same results can be obtained with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="mf">1.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="mf">2.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">11</span>
</pre></div>
</div>
<p>Note that <span class="math">\(2\)</span> is the smallest prime power:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.next_probable_prime">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">next_probable_prime</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.next_probable_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the next probable prime after self, as determined by PARI.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">999999999</span><span class="p">))</span>
<span class="go">1000000007</span>
<span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">768</span><span class="p">)</span>
<span class="go">1552518092300708935148979488462502555256886017116696611139052038026050952686376886330878408828646477950487730697131073206171580044114814391444287275041181139204454976020849905550265285631598444825262999193716468750892846853816058039</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.nth_prime">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">nth_prime</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.nth_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the n-th prime number (1-indexed, so that 2 is the 1st prime.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; a positive integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>the n-th prime number</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">nth_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">29</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">nth_prime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">nth prime meaningless for non-positive n (=0)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">prime_pi</span><span class="p">(</span><span class="n">nth_prime</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="o">==</span> <span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.number_of_divisors">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">number_of_divisors</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.number_of_divisors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of divisors of the integer n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - a nonzero integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an integer, the number of divisors of n</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">number_of_divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">number_of_divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">720</span><span class="p">)</span>
<span class="go">30</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.odd_part">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">odd_part</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.odd_part" title="Permalink to this definition">¶</a></dt>
<dd><p>The odd part of the integer <span class="math">\(n\)</span>. This is <span class="math">\(n / 2^v\)</span>,
where <span class="math">\(v = \mathrm{valuation}(n,2)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span>
<span class="go">122529844256906551386796875</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.power_mod">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">power_mod</tt><big>(</big><em>a</em>, <em>n</em>, <em>m</em><big>)</big><a class="headerlink" href="#sage.rings.arith.power_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>The n-th power of a modulo the integer m.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">0^0 is undefined.</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">390</span><span class="p">,</span><span class="mi">391</span><span class="p">)</span>
<span class="go">285</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">4*x^10</span>

<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">modulus must be nonzero.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.previous_prime">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">previous_prime</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.previous_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>The largest prime &lt; n. The result is provably correct. If n &lt;= 1,
this function raises a ValueError.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no previous prime</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no previous prime</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no previous prime</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.previous_prime_power">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">previous_prime_power</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.previous_prime_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the largest prime power smaller than <tt class="docutils literal"><span class="pre">n</span></tt>.</p>
<p>The result is provably correct. If <tt class="docutils literal"><span class="pre">n</span></tt> is smaller or equal than <tt class="docutils literal"><span class="pre">2</span></tt> this
function raises an error.</p>
<p>This function simply call the method
<a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.previous_prime_power" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">Integer.previous_prime_power()</span></tt></a>
of Integers.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.arith.is_prime_power" title="sage.rings.arith.is_prime_power"><tt class="xref py py-func docutils literal"><span class="pre">is_prime_power()</span></tt></a> (and <a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.is_prime_power" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">Integer.is_prime_power()</span></tt></a>)</li>
<li><a class="reference internal" href="#sage.rings.arith.next_prime_power" title="sage.rings.arith.next_prime_power"><tt class="xref py py-func docutils literal"><span class="pre">next_prime_power()</span></tt></a> (and <a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.next_prime_power" title="(in Sage Reference Manual: Standard Commutative Rings v6.8)"><tt class="xref py py-meth docutils literal"><span class="pre">Integer.next_prime_power()</span></tt></a>)</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">127</span><span class="p">)</span>
<span class="go">125</span>
</pre></div>
</div>
<p>The same results can be obtained with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="mf">3.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="mf">7.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="mf">127.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">125</span>
</pre></div>
</div>
<p>Input less than or equal to <span class="math">\(2\)</span> raises errors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no prime power less than 2</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no prime power less than 2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="go">....:     n = previous_prime_power(n)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">251^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.prime_divisors">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">prime_divisors</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.prime_divisors" title="Permalink to this definition">¶</a></dt>
<dd><p>The prime divisors of <tt class="docutils literal"><span class="pre">n</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; any object which can be factored</li>
</ul>
<p>OUTPUT:</p>
<p>A list of prime factors of <tt class="docutils literal"><span class="pre">n</span></tt>. For integers, this list is sorted
in increasing order.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="go">[2, 3, 167]</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">n</span></tt> is negative, we do <em>not</em> include -1 among the prime
divisors, since -1 is not a prime number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
</pre></div>
</div>
<p>For polynomials we get all irreducible factors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[x - 1, x + 1, x^2 - x + 1, x^2 + 1, x^2 + x + 1, x^4 - x^2 + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.prime_factors">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">prime_factors</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.prime_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>The prime divisors of <tt class="docutils literal"><span class="pre">n</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; any object which can be factored</li>
</ul>
<p>OUTPUT:</p>
<p>A list of prime factors of <tt class="docutils literal"><span class="pre">n</span></tt>. For integers, this list is sorted
in increasing order.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="go">[2, 3, 167]</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">n</span></tt> is negative, we do <em>not</em> include -1 among the prime
divisors, since -1 is not a prime number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
</pre></div>
</div>
<p>For polynomials we get all irreducible factors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[x - 1, x + 1, x^2 - x + 1, x^2 + 1, x^2 + x + 1, x^4 - x^2 + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.prime_powers">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">prime_powers</tt><big>(</big><em>start</em>, <em>stop=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.prime_powers" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all positive primes powers between <tt class="docutils literal"><span class="pre">start</span></tt> and
<tt class="docutils literal"><span class="pre">stop</span></tt>-1, inclusive. If the second argument is omitted, returns
the prime powers up to the first argument.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">start</span></tt> - an integer. If two inputs are given, a lower bound
for the returned set of prime powers. If this is the only input,
then it is an upper bound.</li>
<li><tt class="docutils literal"><span class="pre">stop</span></tt> - an integer (default: <tt class="docutils literal"><span class="pre">None</span></tt>). An upper bound for the
returned set of prime powers.</li>
</ul>
<p>OUTPUT:</p>
<p>The set of all prime powers between <tt class="docutils literal"><span class="pre">start</span></tt> and <tt class="docutils literal"><span class="pre">stop</span></tt> or, if
only one argument is passed, the set of all prime powers between 1
and <tt class="docutils literal"><span class="pre">start</span></tt>. The number <span class="math">\(n\)</span> is a prime power if <span class="math">\(n=p^k\)</span>, where
<span class="math">\(p\)</span> is a prime number and <span class="math">\(k\)</span> is a positive integer. Thus, <span class="math">\(1\)</span> is
not a prime power.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">[2, 3, 4, 5, 7, 8, 9, 11, 13, 16, 17, 19]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">193</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">168</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span><span class="mi">1234</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime_power</span><span class="p">(</span><span class="n">z</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">prime_powers</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span><span class="mi">1234</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">194</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">194</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">[97, 101, 103, 107, 109, 113, 121, 125, 127, 128]</span>
<span class="gp">sage: </span><span class="n">b</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">[97, 101, 103, 107, 109, 113, 121, 125, 127, 128]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime_power</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[2]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that output are always Sage integers (<a class="reference external" href="http://trac.sagemath.org/922">trac ticket #922</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">prime_powers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>

<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[2]</span>

<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to convert &#39;foo&#39; to an integer</span>

<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to convert &#39;bar&#39; to an integer</span>
</pre></div>
</div>
<p>Check that long input are accepted (<a class="reference external" href="http://trac.sagemath.org/17852">trac ticket #17852</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">6</span><span class="n">l</span><span class="p">)</span>
<span class="go">[2, 3, 4, 5]</span>
<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">6</span><span class="n">l</span><span class="p">,</span><span class="mi">10</span><span class="n">l</span><span class="p">)</span>
<span class="go">[7, 8, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.prime_to_m_part">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">prime_to_m_part</tt><big>(</big><em>n</em>, <em>m</em><big>)</big><a class="headerlink" href="#sage.rings.arith.prime_to_m_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the prime-to-m part of n, i.e., the largest divisor of n
that is coprime to m.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - Integer (nonzero)</li>
<li><tt class="docutils literal"><span class="pre">m</span></tt> - Integer</li>
</ul>
<p>OUTPUT: Integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="mf">240.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="mf">240.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">80</span>
<span class="gp">sage: </span><span class="mf">240.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">48</span>

<span class="gp">sage: </span><span class="mf">43434.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">21717</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.primes">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">primes</tt><big>(</big><em>start</em>, <em>stop=None</em>, <em>proof=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over all primes between start and stop-1,
inclusive. This is much slower than <tt class="docutils literal"><span class="pre">prime_range</span></tt>, but
potentially uses less memory.  As with <a class="reference internal" href="#sage.rings.arith.next_prime" title="sage.rings.arith.next_prime"><tt class="xref py py-func docutils literal"><span class="pre">next_prime()</span></tt></a>, the optional
argument proof controls whether the numbers returned are
guaranteed to be prime or not.</p>
<p>This command is like the xrange command, except it only iterates
over primes. In some cases it is better to use primes than
<tt class="docutils literal"><span class="pre">prime_range</span></tt>, because primes does not build a list of all primes in
the range in memory all at once. However, it is potentially much
slower since it simply calls the <a class="reference internal" href="#sage.rings.arith.next_prime" title="sage.rings.arith.next_prime"><tt class="xref py py-func docutils literal"><span class="pre">next_prime()</span></tt></a> function
repeatedly, and <a class="reference internal" href="#sage.rings.arith.next_prime" title="sage.rings.arith.next_prime"><tt class="xref py py-func docutils literal"><span class="pre">next_prime()</span></tt></a> is slow.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">start</span></tt> - an integer - lower bound for the primes</li>
<li><tt class="docutils literal"><span class="pre">stop</span></tt> - an integer (or infinity) optional argument -
giving upper (open) bound for the primes</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - bool or None (default: None)  If True, the function
yields only proven primes.  If False, the function uses a
pseudo-primality test, which is much faster for really big
numbers but does not provide a proof of primality. If None,
uses the global default (see <a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Sage Reference Manual v6.8)"><tt class="xref py py-mod docutils literal"><span class="pre">sage.structure.proof.proof</span></tt></a>)</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an iterator over primes from start to stop-1, inclusive</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">p</span>
<span class="gp">...</span>
<span class="go">5</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">[2, 3, 5, 7, 11]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">10000000000</span><span class="p">,</span> <span class="mi">10000000100</span><span class="p">))</span>
<span class="go">[10000000019, 10000000033, 10000000061, 10000000069, 10000000097]</span>
<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="o">^</span><span class="mi">100</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009631</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">20</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">100000000000000001243</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">is_prime</span><span class="p">,</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)))</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9973</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">is_prime</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9973</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">infinity</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">p</span>
<span class="gp">...</span>
<span class="go">11</span>
<span class="go">13</span>
<span class="go">17</span>
<span class="go">19</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">oo</span><span class="p">))</span> <span class="c"># checks alternate infinity notation</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.primes_first_n">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">primes_first_n</tt><big>(</big><em>n</em>, <em>leave_pari=False</em><big>)</big><a class="headerlink" href="#sage.rings.arith.primes_first_n" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first <span class="math">\(n\)</span> primes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(n\)</span> - a nonnegative integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of the first <span class="math">\(n\)</span> prime numbers.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">primes_first_n</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">primes_first_n</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">1000</span>
<span class="gp">sage: </span><span class="n">primes_first_n</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.primitive_root">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">primitive_root</tt><big>(</big><em>n</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.rings.arith.primitive_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a positive integer that generates the multiplicative group
of integers modulo <span class="math">\(n\)</span>, if one exists; otherwise, raise a
<tt class="docutils literal"><span class="pre">ValueError</span></tt>.</p>
<p>A primitive root exists if <span class="math">\(n=4\)</span> or <span class="math">\(n=p^k\)</span> or <span class="math">\(n=2p^k\)</span>, where <span class="math">\(p\)</span>
is an odd prime and <span class="math">\(k\)</span> is a nonnegative number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; a non-zero integer</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> &#8211; bool (default: True); if False, then <span class="math">\(n\)</span> is assumed
to be a positive integer possessing a primitive root, and behavior
is undefined otherwise.</li>
</ul>
<p>OUTPUT:</p>
<p>A primitive root of <span class="math">\(n\)</span>. If <span class="math">\(n\)</span> is prime, this is the smallest
primitive root.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="o">-</span><span class="mi">46</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="p">[</span><span class="n">primitive_root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 3, 2, 2, 3, 2, 5, 2, 3, 2, 6, 3, 5, 2, 2, 2, 2, 7, 5, 3, 2, 3, 5]</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no primitive root</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It takes extra work to check if <span class="math">\(n\)</span> has a primitive root; to
avoid this, use <tt class="docutils literal"><span class="pre">check=False</span></tt>, which may slightly speed things
up (but could also result in undefined behavior).  For example,
the second call below is an order of magnitude faster than the
first:</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">151</span>   <span class="c"># a prime</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Various special cases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no primitive root</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>We test that various numbers without primitive roots give
an error - see <a class="reference external" href="http://trac.sagemath.org/10836">trac ticket #10836</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no primitive root</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no primitive root</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">1729</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no primitive root</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no primitive root</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.quadratic_residues">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">quadratic_residues</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.quadratic_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of all squares modulo the integer <span class="math">\(n\)</span>
in the range <span class="math">\(0\leq x &lt; |n|\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">[0, 1, 3, 4, 5, 9]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[0, 1, 4]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 1, 4, 5, 6, 9]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="go">159</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.radical">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">radical</tt><big>(</big><em>n</em>, <em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.arith.radical" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product of the prime divisors of n.</p>
<p>This calls <tt class="docutils literal"><span class="pre">n.radical(*args,</span> <span class="pre">**kwds)</span></tt>.  If that doesn&#8217;t work, it
does <tt class="docutils literal"><span class="pre">n.factor(*args,</span> <span class="pre">**kwds)</span></tt> and returns the product of the prime
factors in the resulting factorization.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">5</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="go">30</span>
<span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Radical of 0 not defined.</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">i + 1</span>
</pre></div>
</div>
<p>The next example shows how to compute the radical of a number,
assuming no prime &gt; 100000 has exponent &gt; 1 in the factorization:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">1000</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">n</span> <span class="o">/</span> <span class="n">radical</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="go">125</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.random_prime">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">random_prime</tt><big>(</big><em>n</em>, <em>proof=None</em>, <em>lbound=2</em><big>)</big><a class="headerlink" href="#sage.rings.arith.random_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random prime p between <span class="math">\(lbound\)</span> and n (i.e. <span class="math">\(lbound &lt;= p &lt;= n\)</span>).
The returned prime is chosen uniformly at random from the set of prime
numbers less than or equal to n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer &gt;= 2.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - bool or None (default: None) If False, the function uses a
pseudo-primality test, which is much faster for really big numbers but
does not provide a proof of primality. If None, uses the global default
(see <a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Sage Reference Manual v6.8)"><tt class="xref py py-mod docutils literal"><span class="pre">sage.structure.proof.proof</span></tt></a>)</li>
<li><tt class="docutils literal"><span class="pre">lbound</span></tt> - an integer &gt;= 2
lower bound for the chosen primes</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">random_prime</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="go">88237</span>
<span class="gp">sage: </span><span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Here we generate a random prime between 100 and 200:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">random_prime</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">149</span>
</pre></div>
</div>
<p>If all we care about is finding a pseudo prime, then we can pass
in <tt class="docutils literal"><span class="pre">proof=False</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">random_prime</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">149</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">random_prime</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">random_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>   <span class="c">#caused Sage hang #10112</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">n must be greater than or equal to 2</span>
<span class="gp">sage: </span><span class="n">random_prime</span><span class="p">(</span><span class="mi">126</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">114</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">There are no primes between 114 and 126 (inclusive)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jon Hanke (2006-08-08): with standard Stein cleanup</li>
<li>Jonathan Bober (2007-03-17)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.rational_reconstruction">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">rational_reconstruction</tt><big>(</big><em>a</em>, <em>m</em>, <em>algorithm='fast'</em><big>)</big><a class="headerlink" href="#sage.rings.arith.rational_reconstruction" title="Permalink to this definition">¶</a></dt>
<dd><p>This function tries to compute <span class="math">\(x/y\)</span>, where <span class="math">\(x/y\)</span> is a rational number in
lowest terms such that the reduction of <span class="math">\(x/y\)</span> modulo <span class="math">\(m\)</span> is equal to <span class="math">\(a\)</span> and
the absolute values of <span class="math">\(x\)</span> and <span class="math">\(y\)</span> are both <span class="math">\(\le \sqrt{m/2}\)</span>. If such <span class="math">\(x/y\)</span>
exists, that pair is unique and this function returns it. If no
such pair exists, this function raises ZeroDivisionError.</p>
<p>An efficient algorithm for computing rational reconstruction is
very similar to the extended Euclidean algorithm. For more details,
see Knuth, Vol 2, 3rd ed, pages 656-657.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a</span></tt> &#8211; an integer</li>
<li><tt class="docutils literal"><span class="pre">m</span></tt> &#8211; a modulus</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; (default: &#8216;fast&#8217;)<ul>
<li><tt class="docutils literal"><span class="pre">'fast'</span></tt> - a fast implementation using direct MPIR calls
in Cython.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>Numerator and denominator <span class="math">\(n\)</span>, <span class="math">\(d\)</span> of the unique rational number
<span class="math">\(r=n/d\)</span>, if it exists, with <span class="math">\(n\)</span> and <span class="math">\(|d| \le \sqrt{N/2}\)</span>. Return
<span class="math">\((0,0)\)</span> if no such number exists.</p>
<p>The algorithm for rational reconstruction is described (with a
complete nontrivial proof) on pages 656-657 of Knuth, Vol 2, 3rd
ed. as the solution to exercise 51 on page 379. See in particular
the conclusion paragraph right in the middle of page 657, which
describes the algorithm thus:</p>
<blockquote>
<div>This discussion proves that the problem can be solved
efficiently by applying Algorithm 4.5.2X with <span class="math">\(u=m\)</span> and <span class="math">\(v=a\)</span>,
but with the following replacement for step X2: If
<span class="math">\(v3 \le \sqrt{m/2}\)</span>, the algorithm terminates. The pair
<span class="math">\((x,y)=(|v2|,v3*\mathrm{sign}(v2))\)</span> is then the unique
solution, provided that <span class="math">\(x\)</span> and <span class="math">\(y\)</span> are coprime and
<span class="math">\(x \le \sqrt{m/2}\)</span>; otherwise there is no solution. (Alg 4.5.2X is
the extended Euclidean algorithm.)</div></blockquote>
<p>Knuth remarks that this algorithm is due to Wang, Kornerup, and
Gregory from around 1983.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">119</span><span class="o">*</span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span><span class="n">m</span><span class="p">))</span><span class="o">%</span><span class="n">m</span>
<span class="go">11323</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">11323</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
<span class="go">119/53</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">rational reconstruction of 400 (mod 1000) does not exist</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">292393</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">292393</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">97</span><span class="p">);</span> <span class="n">a</span>
<span class="go">204977</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">292393</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;fast&#39;</span><span class="p">)</span>
<span class="go">45/97</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">293048</span><span class="p">,</span> <span class="mi">292393</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">rational reconstruction of 655 (mod 292393) does not exist</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">rational reconstruction with zero modulus</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;foobar&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">unknown algorithm &#39;foobar&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.rising_factorial">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">rising_factorial</tt><big>(</big><em>x</em>, <em>a</em><big>)</big><a class="headerlink" href="#sage.rings.arith.rising_factorial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the rising factorial <span class="math">\((x)^a\)</span>.</p>
<p>The notation in the literature is a mess: often <span class="math">\((x)^a\)</span>,
but there are many other notations: GKP: Concrete Mathematics uses
<span class="math">\(x^{\overline{a}}\)</span>.</p>
<p>The rising factorial is also known as the Pochhammer symbol, see
Maple and Mathematica.</p>
<p>Definition: for integer <span class="math">\(a \ge 0\)</span> we have
<span class="math">\(x(x+1) \cdots (x+a-1)\)</span>. In all other cases we use the
GAMMA-function: <span class="math">\(\frac {\Gamma(x+a)} {\Gamma(x)}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - element of a ring</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - a non-negative integer or</li>
<li><tt class="docutils literal"><span class="pre">x</span> <span class="pre">and</span> <span class="pre">a</span></tt> - any numbers</li>
</ul>
<p>OUTPUT: the rising factorial</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1320</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">RR</span><span class="p">(</span><span class="s">&#39;3.0&#39;</span><span class="p">))</span>
<span class="go">1320.00000000000</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">RR</span><span class="p">(</span><span class="s">&#39;3.3&#39;</span><span class="p">))</span>
<span class="go">2826.38895824964</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">rising_factorial</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">,</span> <span class="n">I</span><span class="p">);</span> <span class="n">a</span>
<span class="go">gamma(2*I + 1)/gamma(I + 1)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">0.266816390637832 + 0.122783354006372*I</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">rising_factorial</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="n">a</span>
<span class="go">-10</span>
</pre></div>
</div>
<p>See falling_factorial(I, 4).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 + 6*x^3 + 11*x^2 + 6*x</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/14858">trac ticket #14858</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">rising_factorial</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span>
<span class="go">....:      rising_factorial(-4, SR(2)) ==</span>
<span class="go">....:      rising_factorial(SR(-4), SR(2)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/16770">trac ticket #16770</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">rising_factorial</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2006-03-05)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.sort_complex_numbers_for_display">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">sort_complex_numbers_for_display</tt><big>(</big><em>nums</em><big>)</big><a class="headerlink" href="#sage.rings.arith.sort_complex_numbers_for_display" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of complex numbers (or a list of tuples, where the
first element of each tuple is a complex number), we sort the list
in a &#8220;pretty&#8221; order.  First come the real numbers (with zero
imaginary part), then the complex numbers sorted according to
their real part.  If two complex numbers have a real part which is
sufficiently close, then they are sorted according to their
imaginary part.</p>
<p>This is not a useful function mathematically (not least because
there&#8217;s no principled way to determine whether the real components
should be treated as equal or not).  It is called by various
polynomial root-finders; its purpose is to make doctest printing
more reproducible.</p>
<p>We deliberately choose a cumbersome name for this function to
discourage use, since it is mathematically meaningless.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.rings.arith</span>
<span class="gp">sage: </span><span class="n">sort_c</span> <span class="o">=</span> <span class="n">sort_complex_numbers_for_display</span>
<span class="gp">sage: </span><span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">CDF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="go">....:     nums.append(CDF(i + RDF.random_element(-3e-11, 3e-11),</span>
<span class="go">....:                     RDF.random_element()))</span>
<span class="go">....:     nums.append(CDF(i + RDF.random_element(-3e-11, 3e-11),</span>
<span class="go">....:                     RDF.random_element()))</span>
<span class="gp">sage: </span><span class="n">shuffle</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sort_c</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<span class="go">[0.0, 1.0, 2.0, -2.862406201002009e-11 - 0.7088740263015161*I, 2.2108362706985576e-11 - 0.43681052967509904*I, 1.0000000000138833 - 0.7587654737635712*I, 0.9999999999760288 - 0.7238965893336062*I, 1.9999999999874383 - 0.4560801012073723*I, 1.9999999999869107 + 0.6090836283134269*I]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.squarefree_divisors">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">squarefree_divisors</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.rings.arith.squarefree_divisors" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over the squarefree divisors (up to units) of the element x.</p>
<p>Depends on the output of the prime_divisors function.</p>
<p>INPUT:</p>
<ul class="simple">
<li>x &#8211; an element of any ring for which the prime_divisors
function works.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">[1, 7]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="go">[1, 2, 3, 6]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="go">[1, 2, 3, 6]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that the first divisor (i.e. <span class="math">\(1\)</span>) is a Sage integer (see
<a class="reference external" href="http://trac.sagemath.org/17852">trac ticket #17852</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.subfactorial">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">subfactorial</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.subfactorial" title="Permalink to this definition">¶</a></dt>
<dd><p>Subfactorial or rencontres numbers, or derangements: number of
permutations of <span class="math">\(n\)</span> elements with no fixed points.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - non negative integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">integer</span></tt> - function value</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">14833</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2007-01-23)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.sum_of_k_squares">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">sum_of_k_squares</tt><big>(</big><em>k</em>, <em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.sum_of_k_squares" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the integer <span class="math">\(n\)</span> as a sum of <span class="math">\(k\)</span> integer squares if possible;
otherwise raise a <tt class="docutils literal"><span class="pre">ValueError</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">k</span></tt> &#8211; a non-negative integer</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; an integer</li>
</ul>
<p>OUTPUT: a tuple <span class="math">\((x_1, ..., x_k)\)</span> of non-negative integers such that
their squares sum to <span class="math">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(15, 97)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(0, 15, 97)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(1, 2, 5, 98)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(0, 1, 2, 5, 98)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="o">^</span><span class="mi">1111</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(19215400822645944253860920437586326284, 37204645194585992174252915693267578306, 3473654819477394665857484221256136567800161086815834297092488779216863122, 5860191799617673633547572610351797996721850737768032876360978911074629287841061578270832330322236796556721252602860754789786937515870682024273948, 20457423294558182494001919812379023992538802203730791019728543439765347851316366537094696896669915675685581905102118246887673397020172285247862426612188418787649371716686651256443143210952163970564228423098202682066311189439731080552623884051737264415984619097656479060977602722566383385989, 311628095411678159849237738619458396497534696043580912225334269371611836910345930320700816649653412141574887113710604828156159177769285115652741014638785285820578943010943846225597311231847997461959204894255074229895666356909071243390280307709880906261008237873840245959883405303580405277298513108957483306488193844321589356441983980532251051786704380984788999660195252373574924026139168936921591652831237741973242604363696352878914129671292072201700073286987126265965322808664802662993006926302359371379531571194266134916767573373504566621665949840469229781956838744551367172353)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 0, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">999999</span><span class="p">)</span>
<span class="go">(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7, 44, 999)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="go">(3,)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">10 is not a sum of 1 square</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">-10 is not a sum of 1 square</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">9 is not a sum of 0 squares</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">-1 is not a sum of 7 squares</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">k = -1 must be non-negative</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.three_squares">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">three_squares</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.three_squares" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the integer <span class="math">\(n\)</span> as a sum of three integer squares if possible;
otherwise raise a <tt class="docutils literal"><span class="pre">ValueError</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; an integer</li>
</ul>
<p>OUTPUT: a tuple <span class="math">\((a,b,c)\)</span> of non-negative integers such that
<span class="math">\(n = a^2 + b^2 + c^2\)</span> with <span class="math">\(a &lt;= b &lt;= c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">(1, 8, 18)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">946</span><span class="p">)</span>
<span class="go">(9, 9, 28)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">2986</span><span class="p">)</span>
<span class="go">(3, 24, 49)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span>
<span class="go">(0, 0, 1798465042647412146620280340569649349251249)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">111</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(616274160655975340150706442680, 901582938385735143295060746161, 6270382387635744140394001363065311967964099981788593947233)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="mi">2</span><span class="o">^</span><span class="mi">41</span><span class="p">)</span>
<span class="go">(1048576, 2097152, 3145728)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="mi">2</span><span class="o">^</span><span class="mi">42</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">30786325577728 is not a sum of 3 squares</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">-1 is not a sum of 3 squares</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<span class="go">....:     a = ZZ.random_element(2**16, 2**20)</span>
<span class="go">....:     b = ZZ.random_element(2**16, 2**20)</span>
<span class="go">....:     c = ZZ.random_element(2**16, 2**20)</span>
<span class="go">....:     n = a**2 + b**2 + c**2</span>
<span class="go">....:     aa,bb,cc = three_squares(n)</span>
<span class="go">....:     assert aa**2 + bb**2 + cc**2 == n</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>See <a class="reference external" href="http://www.schorn.ch/howto.html">http://www.schorn.ch/howto.html</a></p>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.trial_division">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">trial_division</tt><big>(</big><em>n</em>, <em>bound=None</em><big>)</big><a class="headerlink" href="#sage.rings.arith.trial_division" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the smallest prime divisor &lt;= bound of the positive integer
n, or n if there is no such prime. If the optional argument bound
is omitted, then bound &lt;= n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - a positive integer</li>
<li><tt class="docutils literal"><span class="pre">bound</span></tt> - (optional) a positive integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">int</span></tt> - a prime p=bound that divides n, or n if
there is no such prime.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">91</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">387833</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="go">387833</span>
<span class="gp">sage: </span><span class="c"># 300 is not big enough to split off a</span>
<span class="gp">sage: </span><span class="c"># factor, but 400 is.</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">387833</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="go">389</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.two_squares">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">two_squares</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.two_squares" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the integer <span class="math">\(n\)</span> as a sum of two integer squares if possible;
otherwise raise a <tt class="docutils literal"><span class="pre">ValueError</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; an integer</li>
</ul>
<p>OUTPUT: a tuple <span class="math">\((a,b)\)</span> of non-negative integers such that
<span class="math">\(n = a^2 + b^2\)</span> with <span class="math">\(a &lt;= b\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">(10, 17)</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">21 is not a sum of 2 squares</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">21</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0, 21)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">two_squares</span><span class="p">(</span><span class="mi">100000000000000000129</span><span class="p">);</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>
<span class="go">(4418521500, 8970878873)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span>
<span class="go">100000000000000000129</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">222</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(253801659504708621991421712450521, 2583712713213354898490304645018692)</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">-1 is not a sum of 2 squares</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<span class="go">....:     a = ZZ.random_element(2**16, 2**20)</span>
<span class="go">....:     b = ZZ.random_element(2**16, 2**20)</span>
<span class="go">....:     n = a**2 + b**2</span>
<span class="go">....:     aa,bb = two_squares(n)</span>
<span class="go">....:     assert aa**2 + bb**2 == n</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>See <a class="reference external" href="http://www.schorn.ch/howto.html">http://www.schorn.ch/howto.html</a></p>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.valuation">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">valuation</tt><big>(</big><em>m</em>, <em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.rings.arith.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the valuation of <tt class="docutils literal"><span class="pre">m</span></tt>.</p>
<p>This function simply calls the m.valuation() method.
See the documentation of m.valuation() for a more precise description.</p>
<p>Note that the use of this functions is discouraged as it is better to use
m.valuation() directly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is not always a valuation in the mathematical sense.
For more information see:
sage.rings.finite_rings.integer_mod.IntegerMod_int.valuation</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>Valuation of 0 is defined, but valuation with respect to 0 is not:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You can only compute the valuation with respect to a integer larger than 1.</span>
</pre></div>
</div>
<p>Here are some other examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">243</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">243</span><span class="o">*</span><span class="mi">10007</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">243</span><span class="o">*</span><span class="mi">10007</span><span class="p">,</span><span class="mi">10007</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[[</span><span class="s">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">4</span><span class="n">r</span><span class="p">,</span><span class="mi">2</span><span class="n">r</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="n">r</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You can only compute the valuation with respect to a integer larger than 1.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.xgcd">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">xgcd</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="headerlink" href="#sage.rings.arith.xgcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a triple <tt class="docutils literal"><span class="pre">(g,s,t)</span></tt> such that <span class="math">\(g = s\cdot a+t\cdot b = \gcd(a,b)\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One exception is if <span class="math">\(a\)</span> and <span class="math">\(b\)</span> are not in a principal ideal domain (see
<a class="reference external" href="https://en.wikipedia.org/wiki/Principal_ideal_domain">Wikipedia article Principal_ideal_domain</a>), e.g., they are both polynomials
over the integers. Then this function can&#8217;t in general return <tt class="docutils literal"><span class="pre">(g,s,t)</span></tt>
as above, since they need not exist.  Instead, over the integers, we
first multiply <span class="math">\(g\)</span> by a divisor of the resultant of <span class="math">\(a/g\)</span> and <span class="math">\(b/g\)</span>, up
to sign.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a,</span> <span class="pre">b</span></tt> - integers or more generally, element of a ring for which the
xgcd make sense (e.g. a field or univariate polynomials).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">g,</span> <span class="pre">s,</span> <span class="pre">t</span></tt> - such that <span class="math">\(g = s\cdot a + t\cdot b\)</span></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is no guarantee that the returned cofactors (s and t) are
minimal.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">56</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(4, 4, -5)</span>
<span class="gp">sage: </span><span class="mi">4</span><span class="o">*</span><span class="mi">56</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">44</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">xgcd</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">);</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="go">(1, 3, -2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(x - 1, 1, -x)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">g</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 1/3*g, 0)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()[]</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, a^2/b^2, ((-a)/b^2)*y + 1/b)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">((</span><span class="n">b</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, (a^2 + (2*g)*a + 3)/(b^3 + (g)*b^2), ((-a + (-g))/b^2)*y + 1/b)</span>
</pre></div>
</div>
<p>Here is an example of a xgcd for two polynomials over the integers, where the linear
combination is not the gcd but the gcd multiplied by the resultant:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2*x, -1, 2)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.xkcd">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">xkcd</tt><big>(</big><em>n=''</em><big>)</big><a class="headerlink" href="#sage.rings.arith.xkcd" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is similar to the xgcd function, but behaves
in a completely different way.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer (optional)</li>
</ul>
<p>OUTPUT:</p>
<p>This function outputs nothing it just prints something. Note that this
function does not feel itself at ease in a html deprived environment.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">xkcd</span><span class="p">(</span><span class="mi">353</span><span class="p">)</span> <span class="c"># optional - internet</span>
<span class="go">&lt;html&gt;&lt;font color=&#39;black&#39;&gt;&lt;h1&gt;Python&lt;/h1&gt;&lt;img src=&quot;http://imgs.xkcd.com/comics/python.png&quot; title=&quot;I wrote 20 short programs in Python yesterday.  It was wonderful.  Perl, I&#39;m leaving you.&quot;&gt;&lt;div&gt;Source: &lt;a href=&quot;http://xkcd.com/353&quot; target=&quot;_blank&quot;&gt;http://xkcd.com/353&lt;/a&gt;&lt;/div&gt;&lt;/font&gt;&lt;/html&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.arith.xlcm">
<tt class="descclassname">sage.rings.arith.</tt><tt class="descname">xlcm</tt><big>(</big><em>m</em>, <em>n</em><big>)</big><a class="headerlink" href="#sage.rings.arith.xlcm" title="Permalink to this definition">¶</a></dt>
<dd><p>Extended lcm function: given two positive integers <span class="math">\(m,n\)</span>, returns
a triple <span class="math">\((l,m_1,n_1)\)</span> such that <span class="math">\(l=\mathop{\mathrm{lcm}}(m,n)=m_1
\cdot n_1\)</span> where <span class="math">\(m_1|m\)</span>, <span class="math">\(n_1|n\)</span> and <span class="math">\(\gcd(m_1,n_1)=1\)</span>, all with no
factorization.</p>
<p>Used to construct an element of order <span class="math">\(l\)</span> from elements of orders <span class="math">\(m,n\)</span>
in any group: see sage/groups/generic.py for examples.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">xlcm</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
<span class="go">(360, 40, 9)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="../ext/multi_modular.html"
                                  title="previous chapter">Utility classes for multi-modular algorithms</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../misc/temporary_file.html"
                                  title="next chapter">Temporary file handling</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/rings/arith.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../misc/temporary_file.html" title="Temporary file handling"
             >next</a> |</li>
        <li class="right" >
          <a href="../ext/multi_modular.html" title="Utility classes for multi-modular algorithms"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Utilities</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>