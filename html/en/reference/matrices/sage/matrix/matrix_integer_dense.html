<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Dense matrices over the integer ring &mdash; Sage Reference Manual v6.6: Matrices and Spaces of Matrices</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.6: Matrices and Spaces of Matrices" href="../../index.html" />
    <link rel="next" title="Dense matrices over the rational field" href="matrix_rational_dense.html" />
    <link rel="prev" title="Symbolic matrices" href="matrix_symbolic_dense.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="matrix_rational_dense.html" title="Dense matrices over the rational field"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="matrix_symbolic_dense.html" title="Symbolic matrices"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Matrices and Spaces of Matrices</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="dense-matrices-over-the-integer-ring">
<span id="sage-matrix-matrix-integer-dense"></span><h1>Dense matrices over the integer ring<a class="headerlink" href="#dense-matrices-over-the-integer-ring" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.matrix.matrix_integer_dense"></span><p>AUTHORS:</p>
<ul class="simple">
<li>William Stein</li>
<li>Robert Bradshaw</li>
<li>Marc Masdeu (August 2014). Implemented using FLINT, see <a class="reference external" href="http://trac.sagemath.org/16803">trac ticket #16803</a>.</li>
<li>Jeroen Demeyer (October 2014): lots of fixes, see <a class="reference external" href="http://trac.sagemath.org/17090">trac ticket #17090</a> and
<a class="reference external" href="http://trac.sagemath.org/17094">trac ticket #17094</a>.</li>
<li>Vincent Delecroix (February 2015): make it faster, see <a class="reference external" href="http://trac.sagemath.org/17822">trac ticket #17822</a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-30</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^3 - 22*x^2 + 102*x + 30</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense">
<em class="property">class </em><tt class="descclassname">sage.matrix.matrix_integer_dense.</tt><tt class="descname">Matrix_integer_dense</tt><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="matrix_dense.html#sage.matrix.matrix_dense.Matrix_dense" title="sage.matrix.matrix_dense.Matrix_dense"><tt class="xref py py-class docutils literal"><span class="pre">sage.matrix.matrix_dense.Matrix_dense</span></tt></a></p>
<p>Matrix over the integers, implemented using FLINT.</p>
<p>On a 32-bit machine, they can have at most <span class="math">\(2^{32}-1\)</span> rows or
columns.  On a 64-bit machine, matrices can have at most
<span class="math">\(2^{64}-1\)</span> rows or columns.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[ 1  2 -3]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">nonzero scalar matrix must be square</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ">
<tt class="descname">BKZ</tt><big>(</big><em>delta=None</em>, <em>algorithm='fpLLL'</em>, <em>fp=None</em>, <em>block_size=10</em>, <em>prune=0</em>, <em>use_givens=False</em>, <em>precision=0</em>, <em>max_loops=0</em>, <em>max_time=0</em>, <em>auto_abort=False</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Block Korkin-Zolotarev reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">delta</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">0.99</span></tt>) LLL parameter</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">&quot;fpLLL&quot;</span></tt>) <tt class="docutils literal"><span class="pre">&quot;fpLLL&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;NTL&quot;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">fp</span></tt> &#8211; floating point number implementation<ul>
<li><tt class="docutils literal"><span class="pre">None</span></tt> &#8211; NTL&#8217;s exact reduction or fpLLL&#8217;s wrapper (default)</li>
<li><tt class="docutils literal"><span class="pre">'fp'</span></tt> &#8211; double precision: NTL&#8217;s FP or fpLLL&#8217;s double</li>
<li><tt class="docutils literal"><span class="pre">'qd'</span></tt> &#8211; NTL&#8217;s QP or fpLLL&#8217;s long doubles</li>
<li><tt class="docutils literal"><span class="pre">'qd1'</span></tt> &#8211; quad doubles: Uses <tt class="docutils literal"><span class="pre">quad_float</span></tt> precision to compute
Gram-Schmidt, but uses double precision in the search phase of the
block reduction algorithm. This seems adequate for most purposes,
and is faster than <tt class="docutils literal"><span class="pre">'qd'</span></tt>, which uses quad_float precision
uniformly throughout (NTL only).</li>
<li><tt class="docutils literal"><span class="pre">'xd'</span></tt> &#8211; extended exponent: NTL&#8217;s XD or fpLLL&#8217;s dpe</li>
<li><tt class="docutils literal"><span class="pre">'rr'</span></tt> &#8211; arbitrary precision: NTL&#8217;RR or fpLLL&#8217;s MPFR</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">block_size</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">10</span></tt>) Specifies the size of the blocks
in the reduction. High values yield shorter vectors, but the running
time increases double exponentially with <tt class="docutils literal"><span class="pre">block_size</span></tt>.
<tt class="docutils literal"><span class="pre">block_size</span></tt> should be between 2 and the number of rows
of <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<p>NLT SPECIFIC INPUTS:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prune</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">0</span></tt>) The optional parameter <tt class="docutils literal"><span class="pre">prune</span></tt> can
be set to any positive number to invoke the Volume Heuristic from
<a class="reference internal" href="#sh95" id="id1">[SH95]</a>. This can significantly reduce the running time, and hence
allow much bigger block size, but the quality of the reduction is
of course not as good in general. Higher values of <tt class="docutils literal"><span class="pre">prune</span></tt> mean
better quality, and slower running time. When <tt class="docutils literal"><span class="pre">prune</span></tt> is <tt class="docutils literal"><span class="pre">0</span></tt>,
pruning is disabled. Recommended usage: for <tt class="docutils literal"><span class="pre">block_size==30</span></tt>, set
<tt class="docutils literal"><span class="pre">10</span> <span class="pre">&lt;=</span> <span class="pre">prune</span> <span class="pre">&lt;=15</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">use_givens</span></tt> &#8211; Use Given&#8217;s orthogonalization.  This is a bit
slower, but generally much more stable, and is really the preferred
orthogonalization strategy. For a nice description of this, see
Chapter 5 of <a class="reference internal" href="#gl96" id="id2">[GL96]</a>.</li>
</ul>
<p>fpLLL SPECIFIC INPUTS:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">precision</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">0</span></tt> for automatic choice) bit
precision to use if <tt class="docutils literal"><span class="pre">fp='rr'</span></tt> is set</li>
<li><tt class="docutils literal"><span class="pre">max_loops</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">0</span></tt> for no restriction) maximum
number of full loops</li>
<li><tt class="docutils literal"><span class="pre">max_time</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">0</span></tt> for no restricion) stop after
time seconds (up to loop completion)</li>
<li><tt class="docutils literal"><span class="pre">auto_abort</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) heuristic, stop when the
average slope of <span class="math">\(\log(||b_i^*||)\)</span> does not decrease fast enough</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">()</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">use_givens</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="s">&quot;fp&quot;</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Calls either NTL or fpLLL.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="sh95" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[SH95]</a></td><td>C. P. Schnorr and H. H. Hörner. <em>Attacking the Chor-Rivest
Cryptosystem by Improved Lattice Reduction</em>. Advances in Cryptology
- EUROCRYPT &#8216;95. LNCS Volume 921, 1995, pp 1-12.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gl96" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[GL96]</a></td><td>G. Golub and C. van Loan. <em>Matrix Computations</em>.
3rd edition, Johns Hopkins Univ. Press, 1996.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL">
<tt class="descname">LLL</tt><big>(</big><em>delta=None</em>, <em>eta=None</em>, <em>algorithm='fpLLL:wrapper'</em>, <em>fp=None</em>, <em>prec=0</em>, <em>early_red=False</em>, <em>use_givens=False</em>, <em>use_siegel=False</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL" title="Permalink to this definition">¶</a></dt>
<dd><p>Return LLL reduced or approximated LLL reduced lattice <span class="math">\(R\)</span> for this
matrix interpreted as a lattice.</p>
<p>A lattice <span class="math">\((b_1, b_2, ..., b_d)\)</span> is <span class="math">\((\delta, \eta)\)</span>-LLL-reduced
if the two following conditions hold:</p>
<ul class="simple">
<li>For any <span class="math">\(i &gt; j\)</span>, we have <span class="math">\(\lvert \mu_{i,j} \rvert \leq \eta\)</span>.</li>
<li>For any <span class="math">\(i &lt; d\)</span>, we have <span class="math">\(\delta \lvert b_i^* \rvert^2 \leq
\lvert b_{i + 1}^* + \mu_{i+1, i} b_i^* \rvert^2\)</span>,</li>
</ul>
<p>where <span class="math">\(μ_{i,j} = \langle b_i, b_j^* \rangle / \langle b_j^*, b_j^*
\rangle\)</span> and <span class="math">\(b_i^*\)</span> is the <span class="math">\(i\)</span>-th vector of the Gram-Schmidt
orthogonalisation of <span class="math">\((b_1, b_2, ..., b_d)\)</span>.</p>
<p>The default reduction parameters are <span class="math">\(\delta = 3/4\)</span> and <span class="math">\(\eta = 0.501\)</span>.
The parameters <span class="math">\(\delta\)</span> and <span class="math">\(\eta\)</span> must satisfy: <span class="math">\(0.25 &lt; \delta
\leq 1.0\)</span> and <span class="math">\(0.5 \leq \eta &lt; \sqrt{\delta}\)</span>. Polynomial time
complexity is only guaranteed for <span class="math">\(\delta &lt; 1\)</span>. Not every algorithm
admits the case <span class="math">\(\delta = 1\)</span>.</p>
<p>The lattice is returned as a matrix. Also the rank (and the
determinant) of <tt class="docutils literal"><span class="pre">self</span></tt> are cached if those are computed during
the reduction. Note that in general this only happens when
<tt class="docutils literal"><span class="pre">self.rank()</span> <span class="pre">==</span> <span class="pre">self.ncols()</span></tt> and the exact algorithm is used.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">delta</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">0.99</span></tt>) <span class="math">\(\delta\)</span> parameter as described
above</li>
<li><tt class="docutils literal"><span class="pre">eta</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">0.501</span></tt>) <span class="math">\(\eta\)</span> parameter as described above,
ignored by NTL</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; string one of the algorithms listed below
(default: <tt class="docutils literal"><span class="pre">&quot;fpLLL:wrapper&quot;</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">fp</span></tt> &#8211; floating point number implementation:<ul>
<li><tt class="docutils literal"><span class="pre">None</span></tt> &#8211; NTL&#8217;s exact reduction or fpLLL&#8217;s wrapper</li>
<li><tt class="docutils literal"><span class="pre">'fp'</span></tt> &#8211; double precision: NTL&#8217;s FP or fpLLL&#8217;s double</li>
<li><tt class="docutils literal"><span class="pre">'qd'</span></tt> &#8211; NTL&#8217;s QP or fpLLL&#8217;s long doubles</li>
<li><tt class="docutils literal"><span class="pre">'xd'</span></tt> &#8211; extended exponent: NTL&#8217;s XD or fpLLL&#8217;s dpe</li>
<li><tt class="docutils literal"><span class="pre">'rr'</span></tt> &#8211; arbitrary precision: NTL&#8217;s RR or fpLLL&#8217;s MPFR</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> &#8211; (default: auto choose) precision, ignored by NTL</li>
<li><tt class="docutils literal"><span class="pre">early_red</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) perform early reduction,
ignored by NTL</li>
<li><tt class="docutils literal"><span class="pre">use_givens</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) use Givens orthogonalization
only applicable to approximate reductions and NTL; this is more
stable but slower</li>
<li><tt class="docutils literal"><span class="pre">use_siegel</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) use Siegel&#8217;s condition
instead of Lovasz&#8217;s condition, ignored by NTL</li>
</ul>
<p>Also, if the verbose level is at least <span class="math">\(2\)</span>, some more verbose output
is printed during the computation.</p>
<p>AVAILABLE ALGORITHMS:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">NTL:LLL</span></tt> - NTL&#8217;s LLL + choice of <tt class="docutils literal"><span class="pre">fp</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">fpLLL:heuristic</span></tt> - fpLLL&#8217;s heuristic + choice of <tt class="docutils literal"><span class="pre">fp</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">fpLLL:fast</span></tt> - fpLLL&#8217;s fast + choice of <tt class="docutils literal"><span class="pre">fp</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">fpLLL:proved</span></tt> - fpLLL&#8217;s proved + choice of <tt class="docutils literal"><span class="pre">fp</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">fpLLL:wrapper</span></tt> - fpLLL&#8217;s automatic choice (default).</li>
</ul>
<p>OUTPUT:</p>
<p>A matrix over the integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
<p>We compute the extended GCD of a list of integers using LLL, this
example is from the Magma handbook:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">67015143</span><span class="p">,</span> <span class="mi">248934363018</span><span class="p">,</span> <span class="mi">109210</span><span class="p">,</span> <span class="mi">25590011055</span><span class="p">,</span> <span class="mi">74631449</span><span class="p">,</span>
<span class="go">....:       10230248, 709487, 68965012139, 972065, 864972271 ]</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[-3, -1, 13, -1, -4, 2, 3, 4, 5, -1]</span>
<span class="gp">sage: </span><span class="n">add</span><span class="p">([</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>The case <span class="math">\(\delta = 1\)</span> is not always supported:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">delta must be &lt;= 1</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>    <span class="c"># not tested, will eat lots of ram</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">RuntimeError</span>: <span class="n-Identifier">infinite loop in LLL</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NTL:LLL&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(-100, -3, -1, 13, -1, -4, 2, 3, 4, 5, -1)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">31</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">51</span><span class="p">],[</span><span class="mi">101</span><span class="p">,</span><span class="mi">201</span><span class="p">,</span><span class="mi">301</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[-1  0  1]</span>
<span class="go">[ 1  1  1]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NTL:LLL&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NTL:LLL&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NTL:LLL&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="s">&#39;fp&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NTL:LLL&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="s">&#39;xd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NTL:LLL&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="s">&#39;rr&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">B</span> <span class="o">==</span> <span class="n">C</span> <span class="o">==</span> <span class="n">D</span> <span class="o">==</span> <span class="n">F</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NTL:LLL&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="s">&#39;qd&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">algorithm NTL:LLL_QD not supported</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <tt class="docutils literal"><span class="pre">ntl.mat_ZZ</span></tt> or <tt class="docutils literal"><span class="pre">sage.libs.fplll.fplll</span></tt> for details on
the used algorithms.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL_gram">
<tt class="descname">LLL_gram</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL_gram" title="Permalink to this definition">¶</a></dt>
<dd><p>LLL reduction of the lattice whose gram matrix is <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">M</span></tt> &#8211; gram matrix of a definite quadratic form</li>
</ul>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">U</span></tt> - unimodular transformation matrix such that
<tt class="docutils literal"><span class="pre">U.T</span> <span class="pre">*</span> <span class="pre">M</span> <span class="pre">*</span> <span class="pre">U</span></tt>  is LLL-reduced.</p>
<p>ALGORITHM: Use PARI</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="p">;</span> <span class="n">M</span>
<span class="go">[5 3]</span>
<span class="go">[3 2]</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL_gram</span><span class="p">();</span> <span class="n">U</span>
<span class="go">[-1  1]</span>
<span class="go">[ 1 -2]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="n">U</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
<p>Semidefinite and indefinite forms no longer raise a <tt class="docutils literal"><span class="pre">ValueError</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">LLL_gram</span><span class="p">()</span>
<span class="go">[-3 -1]</span>
<span class="go">[ 1  0]</span>
<span class="gp">sage: </span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">LLL_gram</span><span class="p">()</span>
<span class="go">[ 0 -1]</span>
<span class="go">[ 1  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose">
<tt class="descname">antitranspose</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the antitranspose of self, without changing self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5 2]</span>
<span class="go">[4 1]</span>
<span class="go">[3 0]</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[0 1|2]</span>
<span class="go">[---+-]</span>
<span class="go">[3 4|5]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5|2]</span>
<span class="go">[-+-]</span>
<span class="go">[4|1]</span>
<span class="go">[3|0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment">
<tt class="descname">augment</tt><big>(</big><em>right</em>, <em>subdivide=False</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new matrix formed by appending the matrix
(or vector) <tt class="docutils literal"><span class="pre">right</span></tt> on the right side of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">right</span></tt> - a matrix, vector or free module element, whose
dimensions are compatible with <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">subdivide</span></tt> - default: <tt class="docutils literal"><span class="pre">False</span></tt> - request the resulting
matrix to have a new subdivision, separating <tt class="docutils literal"><span class="pre">self</span></tt> from <tt class="docutils literal"><span class="pre">right</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<p>A new matrix formed by appending <tt class="docutils literal"><span class="pre">right</span></tt> onto the right side of <tt class="docutils literal"><span class="pre">self</span></tt>.
If <tt class="docutils literal"><span class="pre">right</span></tt> is a vector (or free module element) then in this context
it is appropriate to consider it as a column vector.  (The code first
converts a vector to a 1-column matrix.)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0  1  2]</span>
<span class="go">[ 5  6  7  8  9  3  4  5]</span>
<span class="go">[10 11 12 13 14  6  7  8]</span>
<span class="go">[15 16 17 18 19  9 10 11]</span>
</pre></div>
</div>
<p>A vector may be augmented to a matrix.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0]</span>
<span class="go">[ 5  6  7  8  9  1]</span>
<span class="go">[10 11 12 13 14  2]</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">subdivide</span></tt> option will add a natural subdivision between
<tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">right</span></tt>.  For more details about how subdivisions
are managed when augmenting, see
<a class="reference internal" href="matrix1.html#sage.matrix.matrix1.Matrix.augment" title="sage.matrix.matrix1.Matrix.augment"><tt class="xref py py-meth docutils literal"><span class="pre">sage.matrix.matrix1.Matrix.augment()</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4| 0  1  2]</span>
<span class="go">[ 5  6  7  8  9| 3  4  5]</span>
<span class="go">[10 11 12 13 14| 6  7  8]</span>
</pre></div>
</div>
<p>Errors are raised if the sizes are incompatible.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">number of rows must be the same, not 2 != 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly">
<tt class="descname">charpoly</tt><big>(</big><em>var='x'</em>, <em>algorithm='generic'</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">var</span></tt> - a variable name</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - &#8216;generic&#8217; (default), &#8216;flint&#8217; or &#8216;linbox&#8217;</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Linbox charpoly disabled on 64-bit machines, since it hangs
in many cases.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^6 - 105*x^5 - 630*x^4</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^20 - 3990*x^19 - 266000*x^18</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - 3990*x^2 - 266000*x</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The cached polynomial should be independent of the <tt class="docutils literal"><span class="pre">var</span></tt>
argument (<a class="reference external" href="http://trac.sagemath.org/12292">trac ticket #12292</a>). We check (indirectly) that the
second call uses the cached value by noting that its result is
not cached:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="go">x^2 - 3*x - 2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="go">y^2 - 3*y - 2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s">&#39;charpoly_linbox&#39;</span><span class="p">]</span>
<span class="go">x^2 - 3*x - 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition">
<tt class="descname">decomposition</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the decomposition of the free module on which this matrix A
acts from the right (i.e., the action is x goes to x A), along with
whether this matrix acts irreducibly on each factor. The factors
are guaranteed to be sorted in the same way as the corresponding
factors of the characteristic polynomial, and are saturated as ZZ
modules.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - a matrix over the integers</li>
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - these are passed onto to the
decomposition over QQ command.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[3, -1, 0, -2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant">
<tt class="descname">determinant</tt><big>(</big><em>algorithm='default'</em>, <em>proof=None</em>, <em>stabilize=2</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the determinant of this matrix.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt></p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'default'</span></tt> &#8211; use <tt class="docutils literal"><span class="pre">flint</span></tt></li>
<li><tt class="docutils literal"><span class="pre">'flint'</span></tt> &#8211; let flint do the determinant</li>
<li><tt class="docutils literal"><span class="pre">'padic'</span></tt> -  uses a p-adic / multimodular
algorithm that relies on code in IML and linbox</li>
<li><tt class="docutils literal"><span class="pre">'linbox'</span></tt> - calls linbox det (you <em>must</em> set
proof=False to use this!)</li>
<li><tt class="docutils literal"><span class="pre">'ntl'</span></tt> - calls NTL&#8217;s det function</li>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> - uses PARI</li>
</ul>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">proof</span></tt> - bool or None; if None use
proof.linear_algebra(); only relevant for the padic algorithm.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It would be <em>VERY VERY</em> hard for det to fail even with
proof=False.</p>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">stabilize</span></tt> - if proof is False, require det to be
the same for this many CRT primes in a row. Ignored if proof is
True.</p>
</li>
</ul>
<p>ALGORITHM: The p-adic algorithm works by first finding a random
vector v, then solving A*x = v and taking the denominator
<span class="math">\(d\)</span>. This gives a divisor of the determinant. Then we
compute <span class="math">\(\det(A)/d\)</span> using a multimodular algorithm and the
Hadamard bound, skipping primes that divide <span class="math">\(d\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,[</span><span class="mf">3.</span><span class="o">.</span><span class="mi">66</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;ntl&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D1</span> <span class="o">==</span> <span class="n">D2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We have a special-case algorithm for 4 x 4 determinants:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">270</span>
</pre></div>
</div>
<p>Next we try the Linbox det. Note that we must have proof=False.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;linbox&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">RuntimeError</span>: <span class="n-Identifier">you must pass the proof=False option to the determinant command to use LinBox&#39;s det algorithm</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;linbox&#39;</span><span class="p">,</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">-21</span>
</pre></div>
</div>
<p>A bigger example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;linbox&#39;</span><span class="p">,</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>This shows that we can compute determinants for all sizes up to
80.  The check that the determinant of a squared matrix is a
square is a sanity check that the result is probably correct:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">80</span><span class="p">]:</span>  <span class="c"># long time</span>
<span class="go">....:     M = random_matrix(ZZ, s)</span>
<span class="go">....:     d = (M*M).determinant()</span>
<span class="go">....:     assert d.is_square()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form">
<tt class="descname">echelon_form</tt><big>(</big><em>algorithm='default'</em>, <em>proof=None</em>, <em>include_zero_rows=True</em>, <em>transformation=False</em>, <em>D=None</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the echelon form of this matrix over the integers, also known
as the hermite normal form (HNF).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; String. The algorithm to use. Valid options are:<ul>
<li><tt class="docutils literal"><span class="pre">'default'</span></tt> &#8211; Let Sage pick an algorithm (default). Up
to 10 rows or columns: pari with flag 0; Up to 75 rows or
columns: pari with flag 1; Larger: use padic algorithm.</li>
<li><tt class="docutils literal"><span class="pre">'padic'</span></tt> - an asymptotically fast p-adic modular
algorithm, If your matrix has large coefficients and is
small, you may also want to try this.</li>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> - use PARI with flag 1</li>
<li><tt class="docutils literal"><span class="pre">'pari0'</span></tt> - use PARI with flag 0</li>
<li><tt class="docutils literal"><span class="pre">'pari4'</span></tt> - use PARI with flag 4 (use heuristic LLL)</li>
<li><tt class="docutils literal"><span class="pre">'ntl'</span></tt> - use NTL (only works for square matrices of
full rank!)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - (default: True); if proof=False certain
determinants are computed using a randomized hybrid p-adic
multimodular strategy until it stabilizes twice (instead of up to
the Hadamard bound). It is <em>incredibly</em> unlikely that one would
ever get an incorrect result with proof=False.</li>
<li><tt class="docutils literal"><span class="pre">include_zero_rows</span></tt> - (default: True) if False,
don&#8217;t include zero rows</li>
<li><tt class="docutils literal"><span class="pre">transformation</span></tt> - if given, also compute
transformation matrix; only valid for padic algorithm</li>
<li><tt class="docutils literal"><span class="pre">D</span></tt> - (default: None) if given and the algorithm
is &#8216;ntl&#8217;, then D must be a multiple of the determinant and this
function will use that fact.</li>
</ul>
<p>OUTPUT:</p>
<p>The Hermite normal form (=echelon form over <span class="math">\(\ZZ\)</span>) of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
<p>Getting a transformation matrix in the nonsquare case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">15</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS: Make sure the zero matrices are handled correctly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>The ultimate border case!</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,[])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If &#8216;ntl&#8217; is chosen for a non square matrix this function
raises a ValueError.</p>
</div>
<p>Special cases: 0 or 1 rows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>Illustrate using various algorithms.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari0&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari4&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;padic&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>The &#8216;ntl&#8217; algorithm doesn&#8217;t work on matrices that do not have full rank.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;ntl&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="mf">2.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>This example illustrated trac 2398:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1 2]</span>
<span class="go">[0 0 3]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>Check that #12280 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">)])</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<span class="gp">... </span>              <span class="mi">200</span> <span class="o">*</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[  1   0   2   0  13   5   1 166  72  69]</span>
<span class="go">[  0   1   1   0  20   4  15 195  65 190]</span>
<span class="go">[  0   0   4   0  24   5  23  22  51 123]</span>
<span class="go">[  0   0   0   1  23   7  20 105  60 151]</span>
<span class="go">[  0   0   0   0  40   4   0  80  36  68]</span>
<span class="go">[  0   0   0   0   0  10   0 100 190 170]</span>
<span class="go">[  0   0   0   0   0   0  25   0 100 150]</span>
<span class="go">[  0   0   0   0   0   0   0 200   0   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0 200   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0   0 200]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;padic&#39;</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[  1   0   2   0  13   5   1 166  72  69]</span>
<span class="go">[  0   1   1   0  20   4  15 195  65 190]</span>
<span class="go">[  0   0   4   0  24   5  23  22  51 123]</span>
<span class="go">[  0   0   0   1  23   7  20 105  60 151]</span>
<span class="go">[  0   0   0   0  40   4   0  80  36  68]</span>
<span class="go">[  0   0   0   0   0  10   0 100 190 170]</span>
<span class="go">[  0   0   0   0   0   0  25   0 100 150]</span>
<span class="go">[  0   0   0   0   0   0   0 200   0   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0 200   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0   0 200]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors">
<tt class="descname">elementary_divisors</tt><big>(</big><em>algorithm='pari'</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elementary divisors of self, in order.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is MUCH faster than the smith_form function.</p>
</div>
<p>The elementary divisors are the invariants of the finite abelian
group that is the cokernel of <em>left</em> multiplication of this matrix.
They are ordered in reverse by divisibility.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - matrix</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - (default: &#8216;pari&#8217;)<ul>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt>: works robustly, but is slower.</li>
<li><tt class="docutils literal"><span class="pre">'linbox'</span></tt> - use linbox (currently off, broken)</li>
</ul>
</li>
</ul>
<p>OUTPUT: list of integers</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These are the invariants of the cokernel of <em>left</em> multiplication:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[3 0 1]</span>
<span class="go">[0 1 0]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 0]</span>
</pre></div>
</div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">)([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 1, 687]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
<p>This returns a copy, which is safe to change:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">edivs</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">edivs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><tt class="xref py py-meth docutils literal"><span class="pre">smith_form()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius">
<tt class="descname">frobenius</tt><big>(</big><em>flag=0</em>, <em>var='x'</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Frobenius form (rational canonical form) of this
matrix.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">flag</span></tt> &#8211; 0 (default), 1 or 2 as follows:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">0</span></tt> &#8211; (default) return the Frobenius form of this
matrix.</li>
<li><tt class="docutils literal"><span class="pre">1</span></tt> &#8211; return only the elementary divisor
polynomials, as polynomials in var.</li>
<li><tt class="docutils literal"><span class="pre">2</span></tt> &#8211; return a two-components vector [F,B] where F
is the Frobenius form and B is the basis change so that
<span class="math">\(M=B^{-1}FB\)</span>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">var</span></tt> &#8211; a string (default: &#8216;x&#8217;)</p>
</li>
</ul>
<p>ALGORITHM: uses PARI&#8217;s matfrobenius()</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 1  0 18]</span>
<span class="go">[ 0  1 12]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[x^3 - 12*x^2 - 18*x]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="go">[y^3 - 12*y^2 - 18*y]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">B</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">B</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([], [])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">frobenius</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ArithmeticError</span>: <span class="n-Identifier">frobenius matrix of non-square matrix not defined.</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Martin Albrect (2006-04-02)</li>
</ul>
<p>TODO: - move this to work for more general matrices than just over
Z. This will require fixing how PARI polynomials are coerced to
Sage polynomials.</p>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd">
<tt class="descname">gcd</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gcd of all entries of self; very fast.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.height">
<tt class="descname">height</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.height" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the height of this matrix, i.e., the max absolute value of
the entries of the matrix.</p>
<p>OUTPUT: A nonnegative integer.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)([</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">389</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[ -17    3 -389]</span>
<span class="go">[  15   -1    0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form">
<tt class="descname">hermite_form</tt><big>(</big><em>algorithm='default'</em>, <em>proof=None</em>, <em>include_zero_rows=True</em>, <em>transformation=False</em>, <em>D=None</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the echelon form of this matrix over the integers, also known
as the hermite normal form (HNF).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; String. The algorithm to use. Valid options are:<ul>
<li><tt class="docutils literal"><span class="pre">'default'</span></tt> &#8211; Let Sage pick an algorithm (default). Up
to 10 rows or columns: pari with flag 0; Up to 75 rows or
columns: pari with flag 1; Larger: use padic algorithm.</li>
<li><tt class="docutils literal"><span class="pre">'padic'</span></tt> - an asymptotically fast p-adic modular
algorithm, If your matrix has large coefficients and is
small, you may also want to try this.</li>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> - use PARI with flag 1</li>
<li><tt class="docutils literal"><span class="pre">'pari0'</span></tt> - use PARI with flag 0</li>
<li><tt class="docutils literal"><span class="pre">'pari4'</span></tt> - use PARI with flag 4 (use heuristic LLL)</li>
<li><tt class="docutils literal"><span class="pre">'ntl'</span></tt> - use NTL (only works for square matrices of
full rank!)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - (default: True); if proof=False certain
determinants are computed using a randomized hybrid p-adic
multimodular strategy until it stabilizes twice (instead of up to
the Hadamard bound). It is <em>incredibly</em> unlikely that one would
ever get an incorrect result with proof=False.</li>
<li><tt class="docutils literal"><span class="pre">include_zero_rows</span></tt> - (default: True) if False,
don&#8217;t include zero rows</li>
<li><tt class="docutils literal"><span class="pre">transformation</span></tt> - if given, also compute
transformation matrix; only valid for padic algorithm</li>
<li><tt class="docutils literal"><span class="pre">D</span></tt> - (default: None) if given and the algorithm
is &#8216;ntl&#8217;, then D must be a multiple of the determinant and this
function will use that fact.</li>
</ul>
<p>OUTPUT:</p>
<p>The Hermite normal form (=echelon form over <span class="math">\(\ZZ\)</span>) of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
<p>Getting a transformation matrix in the nonsquare case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">15</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS: Make sure the zero matrices are handled correctly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>The ultimate border case!</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,[])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If &#8216;ntl&#8217; is chosen for a non square matrix this function
raises a ValueError.</p>
</div>
<p>Special cases: 0 or 1 rows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>Illustrate using various algorithms.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari0&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari4&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;padic&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>The &#8216;ntl&#8217; algorithm doesn&#8217;t work on matrices that do not have full rank.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;ntl&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="mf">2.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>This example illustrated trac 2398:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1 2]</span>
<span class="go">[0 0 3]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>Check that #12280 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<span class="gp">... </span>              <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">)])</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<span class="gp">... </span>              <span class="mi">200</span> <span class="o">*</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[  1   0   2   0  13   5   1 166  72  69]</span>
<span class="go">[  0   1   1   0  20   4  15 195  65 190]</span>
<span class="go">[  0   0   4   0  24   5  23  22  51 123]</span>
<span class="go">[  0   0   0   1  23   7  20 105  60 151]</span>
<span class="go">[  0   0   0   0  40   4   0  80  36  68]</span>
<span class="go">[  0   0   0   0   0  10   0 100 190 170]</span>
<span class="go">[  0   0   0   0   0   0  25   0 100 150]</span>
<span class="go">[  0   0   0   0   0   0   0 200   0   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0 200   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0   0 200]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;padic&#39;</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[  1   0   2   0  13   5   1 166  72  69]</span>
<span class="go">[  0   1   1   0  20   4  15 195  65 190]</span>
<span class="go">[  0   0   4   0  24   5  23  22  51 123]</span>
<span class="go">[  0   0   0   1  23   7  20 105  60 151]</span>
<span class="go">[  0   0   0   0  40   4   0  80  36  68]</span>
<span class="go">[  0   0   0   0   0  10   0 100 190 170]</span>
<span class="go">[  0   0   0   0   0   0  25   0 100 150]</span>
<span class="go">[  0   0   0   0   0   0   0 200   0   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0 200   0]</span>
<span class="go">[  0   0   0   0   0   0   0   0   0 200]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation">
<tt class="descname">index_in_saturation</tt><big>(</big><em>proof=None</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of self in its saturation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - (default: use proof.linear_algebra());
if False, the determinant calculations are done with proof=False.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">positive</span> <span class="pre">integer</span></tt> - the index of the row span of
this matrix in its saturation</li>
</ul>
<p>ALGORITHM: Use Hermite normal form twice to find an invertible
matrix whose inverse transforms a matrix with the same row span as
self to its saturation, then compute the determinant of that
matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">6</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">()</span>
<span class="go">[1 2 3]</span>
<span class="go">[1 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row">
<tt class="descname">insert_row</tt><big>(</big><em>index</em>, <em>row</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new matrix from self with.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">index</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">row</span></tt> - a vector</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">X</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="go">[  1   5 -10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced">
<tt class="descname">is_LLL_reduced</tt><big>(</big><em>delta=None</em>, <em>eta=None</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if this lattice is <span class="math">\((\delta, \eta)\)</span>-LLL reduced.
See <tt class="docutils literal"><span class="pre">self.LLL</span></tt> for a definition of LLL reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">delta</span></tt> &#8211; (default: <span class="math">\(0.99\)</span>) parameter <span class="math">\(\delta\)</span> as described above</li>
<li><tt class="docutils literal"><span class="pre">eta</span></tt> &#8211; (default: <span class="math">\(0.501\)</span>) parameter <span class="math">\(\eta\)</span> as described above</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly">
<tt class="descname">minpoly</tt><big>(</big><em>var='x'</em>, <em>algorithm='linbox'</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">var</span></tt> - a variable name</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - &#8216;linbox&#8217; (default) &#8216;generic&#8217;</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Linbox charpoly disabled on 64-bit machines, since it hangs
in many cases.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - 105*x^2 - 630*x</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">)([</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^4 - 2695*x^3 - 257964*x^2 + 1693440*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots">
<tt class="descname">pivots</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pivot column positions of this matrix.</p>
<p>OUTPUT: a tuple of Python integers: the position of the
first nonzero entry in each row of the echelon form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 3  0 -3]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums">
<tt class="descname">prod_of_row_sums</tt><big>(</big><em>cols</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product of the sums of the entries in the submatrix of
<tt class="docutils literal"><span class="pre">self</span></tt> with given columns.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">cols</span></tt> &#8211; a list (or set) of integers representing columns
of <tt class="docutils literal"><span class="pre">self</span></tt></li>
</ul>
<p>OUTPUT: an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">6</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">40</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize">
<tt class="descname">randomize</tt><big>(</big><em>density=1</em>, <em>x=None</em>, <em>y=None</em>, <em>distribution=None</em>, <em>nonzero=False</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomize <tt class="docutils literal"><span class="pre">density</span></tt> proportion of the entries of this matrix,
leaving the rest unchanged.</p>
<p>The parameters are the same as the ones for the integer ring&#8217;s
<tt class="docutils literal"><span class="pre">random_element</span></tt> function.</p>
<p>If <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> are given, randomized entries of this matrix have
to be between <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> and have density 1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - a mutable matrix over ZZ</li>
<li><tt class="docutils literal"><span class="pre">density</span></tt> - a float between 0 and 1</li>
<li><tt class="docutils literal"><span class="pre">x,</span> <span class="pre">y</span></tt> - if not <tt class="docutils literal"><span class="pre">None</span></tt>, these are passed to the
<tt class="docutils literal"><span class="pre">ZZ.random_element</span></tt> function as the upper and lower endpoints in
the  uniform distribution</li>
<li><tt class="docutils literal"><span class="pre">distribution</span></tt> - would also be passed into <tt class="docutils literal"><span class="pre">ZZ.random_element</span></tt>
if given</li>
<li><tt class="docutils literal"><span class="pre">nonzero</span></tt> - bool (default: <tt class="docutils literal"><span class="pre">False</span></tt>); whether the new entries
are guaranteed to be zero</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>None, the matrix is modified in-place</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">6</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[-8  2  0]</span>
<span class="go">[ 0  1 -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[  5 -19  24]</span>
<span class="go">[ 24  23  -9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank">
<tt class="descname">rank</tt><big>(</big><em>algorithm='modp'</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rank of this matrix.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">nonnegative</span> <span class="pre">integer</span></tt> - the rank</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - either <tt class="docutils literal"><span class="pre">'modp'</span></tt> (default) or <tt class="docutils literal"><span class="pre">'flint'</span></tt> or <tt class="docutils literal"><span class="pre">'linbox'</span></tt></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The rank is cached.</p>
</div>
<p>ALGORITHM: If set to <tt class="docutils literal"><span class="pre">'modp'</span></tt>, first check if the matrix has maximum possible rank by
working modulo one random prime. If not call LinBox&#8217;s rank
function.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">6</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="go">[7 8 9]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Here&#8217;s a bigger example - the rank is of course still 2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">100</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">100</span><span class="o">^</span><span class="mi">2</span><span class="p">]);</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction">
<tt class="descname">rational_reconstruction</tt><big>(</big><em>N</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction" title="Permalink to this definition">¶</a></dt>
<dd><p>Use rational reconstruction to lift self to a matrix over the
rational numbers (if possible), where we view self as a matrix
modulo N.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">N</span></tt> - an integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">matrix</span></tt> - over QQ or raise a ValueError</li>
</ul>
<p>EXAMPLES: We create a random 4x4 matrix over ZZ.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>There isn&#8217;t a unique rational reconstruction of it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">rational reconstruction does not exist</span>
</pre></div>
</div>
<p>We throw in a denominator and reduce the matrix modulo 389 - it
does rationally reconstruct.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="mi">3</span> <span class="o">%</span> <span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">/</span><span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TEST:</p>
<p>Check that trac:<span class="math">\(9345\)</span> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ZeroDivisionError</span>: <span class="n-Identifier">The modulus cannot be zero</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation">
<tt class="descname">saturation</tt><big>(</big><em>p=0</em>, <em>proof=None</em>, <em>max_dets=5</em><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a saturation matrix of self, which is a matrix whose rows
span the saturation of the row span of self. This is not unique.</p>
<p>The saturation of a <span class="math">\(\ZZ\)</span> module <span class="math">\(M\)</span>
embedded in <span class="math">\(\ZZ^n\)</span> is the a module <span class="math">\(S\)</span> that
contains <span class="math">\(M\)</span> with finite index such that
<span class="math">\(\ZZ^n/S\)</span> is torsion free. This function takes the
row span <span class="math">\(M\)</span> of self, and finds another matrix of full rank
with row span the saturation of <span class="math">\(M\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - (default: 0); if nonzero given, saturate
only at the prime <span class="math">\(p\)</span>, i.e., return a matrix whose row span
is a <span class="math">\(\ZZ\)</span>-module <span class="math">\(S\)</span> that contains self and
such that the index of <span class="math">\(S\)</span> in its saturation is coprime to
<span class="math">\(p\)</span>. If <span class="math">\(p\)</span> is None, return full saturation of
self.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> - (default: use proof.linear_algebra());
if False, the determinant calculations are done with proof=False.</li>
<li><tt class="docutils literal"><span class="pre">max_dets</span></tt> - (default: 5); technical parameter -
max number of determinant to compute when bounding prime divisor of
self in its saturation.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">matrix</span></tt> - a matrix over ZZ</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The result is <em>not</em> cached.</p>
</div>
<p>ALGORITHM: 1. Replace input by a matrix of full rank got from a
subset of the rows. 2. Divide out any common factors from rows. 3.
Check max_dets random dets of submatrices to see if their GCD
(with p) is 1 - if so matrix is saturated and we&#8217;re done. 4.
Finally, use that if A is a matrix of full rank, then
<span class="math">\(hnf(transpose(A))^{-1}*A\)</span> is a saturation of A.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">51</span><span class="p">,</span> <span class="o">-</span><span class="mi">1509</span><span class="p">,</span> <span class="o">-</span><span class="mi">71</span><span class="p">,</span> <span class="o">-</span><span class="mi">109</span><span class="p">,</span> <span class="o">-</span><span class="mi">593</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">341</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">246</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">217</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[      1       5    2262   20364   56576]</span>
<span class="go">[      0       6   35653  320873  891313]</span>
<span class="go">[      0       0   42993  386937 1074825]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">();</span> <span class="n">S</span>
<span class="go">[  -51 -1509   -71  -109  -593]</span>
<span class="go">[  -19  -341     4    86    98]</span>
<span class="go">[   35   994    43    51   347]</span>
</pre></div>
</div>
<p>Notice that the saturation spans a different module than A.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  2  0  8 32]</span>
<span class="go">[ 0  3  0 -2 -6]</span>
<span class="go">[ 0  0  1  9 25]</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">();</span> <span class="n">W</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">85986</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">85986</span>
</pre></div>
</div>
<p>We illustrate each option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">max_dets</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form">
<tt class="descname">smith_form</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matrices S, U, and V such that S = U*self*V, and S is in
Smith normal form. Thus S is diagonal with diagonal entries the
ordered elementary divisors of S.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The elementary_divisors function, which returns the
diagonal entries of S, is VASTLY faster than this function.</p>
</div>
<p>The elementary divisors are the invariants of the finite abelian
group that is the cokernel of this matrix. They are ordered in
reverse by divisibility.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[ 0  1  0]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[-1  2 -1]</span>
<span class="gp">sage: </span><span class="n">V</span>
<span class="go">[-1  4  1]</span>
<span class="go">[ 1 -3 -2]</span>
<span class="go">[ 0  0  1]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">V</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>It also makes sense for nonsquare matrices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[ 0  1  0]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[-1  2 -1]</span>
<span class="gp">sage: </span><span class="n">V</span>
<span class="go">[-1  3]</span>
<span class="go">[ 1 -2]</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">V</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
<p>Empty matrices are handled sensibly (see trac #3068):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors"><tt class="xref py py-meth docutils literal"><span class="pre">elementary_divisors()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form">
<tt class="descname">symplectic_form</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a symplectic basis for self if self is an anti-symmetric,
alternating matrix.</p>
<p>Returns a pair (F, C) such that the rows of C form a symplectic
basis for self and F = C * self * C.transpose().</p>
<p>Raises a ValueError if self is not anti-symmetric, or self is not
alternating.</p>
<p>Anti-symmetric means that <span class="math">\(M = -M^t\)</span>. Alternating means
that the diagonal of <span class="math">\(M\)</span> is identically zero.</p>
<p>A symplectic basis is a basis of the form
<span class="math">\(e_1, \ldots, e_j, f_1, \ldots f_j, z_1, \dots, z_k\)</span>
such that</p>
<ul>
<li><p class="first"><span class="math">\(z_i M v^t\)</span> = 0 for all vectors <span class="math">\(v\)</span></p>
</li>
<li><p class="first"><span class="math">\(e_i M {e_j}^t = 0\)</span> for all <span class="math">\(i, j\)</span></p>
</li>
<li><p class="first"><span class="math">\(f_i M {f_j}^t = 0\)</span> for all <span class="math">\(i, j\)</span></p>
</li>
<li><p class="first"><span class="math">\(e_i M {f_i}^t = 1\)</span> for all <span class="math">\(i\)</span></p>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(e_i M {f_j}^t = 0\)</span> for all <span class="math">\(i\)</span> not equal</dt>
<dd><p class="first last"><span class="math">\(j\)</span>.</p>
</dd>
</dl>
</li>
</ul>
<p>The ordering for the factors <span class="math">\(d_{i} | d_{i+1}\)</span> and for
the placement of zeroes was chosen to agree with the output of
<tt class="docutils literal"><span class="pre">smith_form</span></tt>.</p>
<p>See the example for a pictorial description of such a basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">[  0  14   0  -8  -2]</span>
<span class="go">[-14   0  -3 -11   4]</span>
<span class="go">[  0   3   0   0   0]</span>
<span class="go">[  8  11   0   0   8]</span>
<span class="go">[  2  -4   0  -8   0]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">symplectic_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">[ 0  0  1  0  0]</span>
<span class="go">[ 0  0  0  2  0]</span>
<span class="go">[-1  0  0  0  0]</span>
<span class="go">[ 0 -2  0  0  0]</span>
<span class="go">[ 0  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">==</span> <span class="n">C</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 2 0 0]</span>
<span class="go">[0 0 0 2 0]</span>
<span class="go">[0 0 0 0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose">
<tt class="descname">transpose</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the transpose of self, without changing self.</p>
<p>EXAMPLES:</p>
<p>We create a matrix, compute its transpose, and note that the
original matrix is not changed.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">xrange</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">B</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">.T</span></tt> is a convenient shortcut for the transpose:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">T</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[0|1 2]</span>
<span class="go">[3|4 5]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[0 3]</span>
<span class="go">[---]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="matrix_symbolic_dense.html"
                                  title="previous chapter">Symbolic matrices</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="matrix_rational_dense.html"
                                  title="next chapter">Dense matrices over the rational field</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/matrix/matrix_integer_dense.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="matrix_rational_dense.html" title="Dense matrices over the rational field"
             >next</a> |</li>
        <li class="right" >
          <a href="matrix_symbolic_dense.html" title="Symbolic matrices"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Matrices and Spaces of Matrices</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>