<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cython helper methods to compute integral points in polyhedra. &mdash; Sage Reference Manual v7.0: Geometry</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.0: Geometry" href="../../index.html" />
    <link rel="prev" title="Hasse diagrams of finite atomic and coatomic lattices." href="hasse_diagram.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hasse_diagram.html" title="Hasse diagrams of finite atomic and coatomic lattices."
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Geometry</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="cython-helper-methods-to-compute-integral-points-in-polyhedra">
<span id="sage-geometry-integral-points"></span><h1>Cython helper methods to compute integral points in polyhedra.<a class="headerlink" href="#cython-helper-methods-to-compute-integral-points-in-polyhedra" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.geometry.integral_points"></span><dl class="class">
<dt id="sage.geometry.integral_points.InequalityCollection">
<em class="property">class </em><tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">InequalityCollection</tt><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>A collection of inequalities.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">polyhedron</span></tt> &#8211; a polyhedron defining the inequalities.</li>
<li><tt class="docutils literal"><span class="pre">permutation</span></tt> &#8211; a permutation of the coordinates. Will be used
to permute the coordinates of the inequality.</li>
<li><tt class="docutils literal"><span class="pre">box_min</span></tt>, <tt class="docutils literal"><span class="pre">box_max</span></tt> &#8211; the (not permuted) minimal and maximal
coordinates of the bounding box. Used for bounds checking.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">P_QQ</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">()</span> <span class="o">+</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P_QQ</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, -2, -2) x + 2 &gt;= 0</span>
<span class="go">integer: (-1, 4, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, 4) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, -1) x + 1 &gt;= 0</span>

<span class="gp">sage: </span><span class="n">P_RR</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">()</span> <span class="o">+</span> <span class="p">[(</span><span class="o">-</span><span class="mf">2.7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">RDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P_RR</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (-1, -1) x + 1 &gt;= 0</span>
<span class="go">generic: (-1.0, 3.7) x + 1.0 &gt;= 0</span>
<span class="go">generic: (1.0, -1.35) x + 1.35 &gt;= 0</span>

<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">eqns</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">InequalityCollection</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="p">)</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7) x + 2 &gt;= 0</span>
<span class="go">integer: (-3, -7) x + -2 &gt;= 0</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">ieq</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">skip</span><span class="o">=</span><span class="s">&#39;_test_pickling&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.are_satisfied">
<tt class="descname">are_satisfied</tt><big>(</big><em>inner_loop_variable</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.are_satisfied" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether all inequalities are satisfied.</p>
<p>You must call <a class="reference internal" href="#sage.geometry.integral_points.InequalityCollection.prepare_inner_loop" title="sage.geometry.integral_points.InequalityCollection.prepare_inner_loop"><tt class="xref py py-meth docutils literal"><span class="pre">prepare_inner_loop()</span></tt></a> before calling this
method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">inner_loop_variable</span></tt> &#8211; Integer. the 0-th coordinate of
the lattice point.</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean. Whether the lattice point is in the polyhedron.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">eqns</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">are_satisfied</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.prepare_inner_loop">
<tt class="descname">prepare_inner_loop</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.prepare_inner_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Peel off the inner loop.</p>
<p>In the inner loop of <a class="reference internal" href="#sage.geometry.integral_points.rectangular_box_points" title="sage.geometry.integral_points.rectangular_box_points"><tt class="xref py py-func docutils literal"><span class="pre">rectangular_box_points()</span></tt></a>, we have
to repeatedly evaluate <span class="math">\(A x+b\geq 0\)</span>. To speed up computation, we pre-evaluate</p>
<div class="math">
\[c = A x - A_0 x_0 +b = b + \sum_{i=1} A_i x_i\]</div>
<p>and only test <span class="math">\(A_0 x_0 +c \geq 0\)</span> in the inner loop.</p>
<p>You must call <a class="reference internal" href="#sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop" title="sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop"><tt class="xref py py-meth docutils literal"><span class="pre">prepare_next_to_inner_loop()</span></tt></a> before
calling this method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> &#8211; the coordinates of the point to loop over. Only the
<tt class="docutils literal"><span class="pre">p[1:]</span></tt> entries are used.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span><span class="p">,</span> <span class="n">print_cache</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7, 11) x + 2 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">print_cache</span><span class="p">(</span><span class="n">ieq</span><span class="p">)</span>
<span class="go">Cached inner loop: 3 * x_0 + 42 &gt;= 0</span>
<span class="go">Cached next-to-inner loop: 3 * x_0 + 7 * x_1 + 35 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop">
<tt class="descname">prepare_next_to_inner_loop</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Peel off the next-to-inner loop.</p>
<p>In the next-to-inner loop of <a class="reference internal" href="#sage.geometry.integral_points.rectangular_box_points" title="sage.geometry.integral_points.rectangular_box_points"><tt class="xref py py-func docutils literal"><span class="pre">rectangular_box_points()</span></tt></a>,
we have to repeatedly evaluate <span class="math">\(A x-A_0 x_0+b\)</span>. To speed up
computation, we pre-evaluate</p>
<div class="math">
\[c = b + \sum_{i=2} A_i x_i\]</div>
<p>and only compute <span class="math">\(A x-A_0 x_0+b = A_1 x_1 +c \geq 0\)</span> in the
next-to-inner loop.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> &#8211; the point coordinates. Only <tt class="docutils literal"><span class="pre">p[2:]</span></tt> coordinates
are potentially used by this method.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span><span class="p">,</span> <span class="n">print_cache</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7, 11) x + 2 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">print_cache</span><span class="p">(</span><span class="n">ieq</span><span class="p">)</span>
<span class="go">Cached inner loop: 3 * x_0 + 42 &gt;= 0</span>
<span class="go">Cached next-to-inner loop: 3 * x_0 + 7 * x_1 + 35 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.satisfied_as_equalities">
<tt class="descname">satisfied_as_equalities</tt><big>(</big><em>inner_loop_variable</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.satisfied_as_equalities" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inequalities (by their index) that are satisfied as
equalities.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">inner_loop_variable</span></tt> &#8211; Integer. the 0-th coordinate of
the lattice point.</li>
</ul>
<p>OUTPUT:</p>
<p>A set of integers in ascending order. Each integer is the
index of a H-representation object of the polyhedron (either a
inequality or an equation).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieqs</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">quadrant</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">satisfied_as_equalities</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">frozenset({1})</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">satisfied_as_equalities</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">frozenset({0, 1})</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">satisfied_as_equalities</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">frozenset({1})</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.swap_ineq_to_front">
<tt class="descname">swap_ineq_to_front</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.swap_ineq_to_front" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap the <tt class="docutils literal"><span class="pre">i</span></tt>-th entry of the list to the front of the list of inequalities.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">i</span></tt> &#8211; Integer. The <a class="reference internal" href="#sage.geometry.integral_points.Inequality_int" title="sage.geometry.integral_points.Inequality_int"><tt class="xref py py-class docutils literal"><span class="pre">Inequality_int</span></tt></a> to swap to the
beginnig of the list of integral inequalities.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">P_QQ</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">()</span> <span class="o">+</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iec</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P_QQ</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iec</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, -2, -2) x + 2 &gt;= 0</span>
<span class="go">integer: (-1, 4, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, 4) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, -1) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">iec</span><span class="o">.</span><span class="n">swap_ineq_to_front</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iec</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (-1, -1, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (3, -2, -2) x + 2 &gt;= 0</span>
<span class="go">integer: (-1, 4, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, 4) x + 1 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.geometry.integral_points.Inequality_generic">
<em class="property">class </em><tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">Inequality_generic</tt><a class="headerlink" href="#sage.geometry.integral_points.Inequality_generic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>An inequality whose coefficients are arbitrary Python/Sage objects</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">A</span></tt> &#8211; list of integers.</li>
<li><tt class="docutils literal"><span class="pre">b</span></tt> &#8211; integer</li>
</ul>
<p>OUTPUT:</p>
<p>Inequality <span class="math">\(A x + b \geq 0\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">Inequality_generic</span>
<span class="gp">sage: </span><span class="n">Inequality_generic</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">7</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">)</span>
<span class="go">generic: (2*pi, sqrt(3), 7/2) x + -5.50000000000000 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.geometry.integral_points.Inequality_int">
<em class="property">class </em><tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">Inequality_int</tt><a class="headerlink" href="#sage.geometry.integral_points.Inequality_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Fast version of inequality in the case that all coefficient fit
into machine ints.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">A</span></tt> &#8211; list of integers.</li>
<li><tt class="docutils literal"><span class="pre">b</span></tt> &#8211; integer</li>
<li><tt class="docutils literal"><span class="pre">max_abs_coordinates</span></tt> &#8211; the maximum of the coordinates that
one wants to evalate the coordinates on. Used for overflow
checking.</li>
</ul>
<p>OUTPUT:</p>
<p>Inequality <span class="math">\(A x + b \geq 0\)</span>. A <tt class="docutils literal"><span class="pre">OverflowError</span></tt> is raised if a
machine integer is not long enough to hold the results. A
<tt class="docutils literal"><span class="pre">ValueError</span></tt> is raised if some of the input is not integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">Inequality_int</span>
<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="go">integer: (2, 3, 7) x + -5 &gt;= 0</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">21</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">21</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OverflowError</span>: <span class="n">Dimension limit exceeded.</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Not integral.</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mf">5.2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Not integral.</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>  <span class="c"># actual error message can differ between 32 and 64 bit</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OverflowError</span>: <span class="n">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.loop_over_parallelotope_points">
<tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">loop_over_parallelotope_points</tt><big>(</big><em>e</em>, <em>d</em>, <em>VDinv</em>, <em>R</em>, <em>lattice</em>, <em>A=None</em>, <em>b=None</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.loop_over_parallelotope_points" title="Permalink to this definition">¶</a></dt>
<dd><p>The inner loop of <a class="reference internal" href="#sage.geometry.integral_points.parallelotope_points" title="sage.geometry.integral_points.parallelotope_points"><tt class="xref py py-func docutils literal"><span class="pre">parallelotope_points()</span></tt></a>.</p>
<p>INPUT:</p>
<p>See <a class="reference internal" href="#sage.geometry.integral_points.parallelotope_points" title="sage.geometry.integral_points.parallelotope_points"><tt class="xref py py-meth docutils literal"><span class="pre">parallelotope_points()</span></tt></a> for <tt class="docutils literal"><span class="pre">e</span></tt>, <tt class="docutils literal"><span class="pre">d</span></tt>, <tt class="docutils literal"><span class="pre">VDinv</span></tt>, <tt class="docutils literal"><span class="pre">R</span></tt>, <tt class="docutils literal"><span class="pre">lattice</span></tt>.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">A</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt>: Either both <tt class="docutils literal"><span class="pre">None</span></tt> or a vector and number. If
present, only the parallelotope points satisfying <span class="math">\(A x \leq b\)</span>
are returned.</li>
</ul>
<p>OUTPUT:</p>
<p>The points of the half-open parallelotope as a tuple of lattice
points.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">VDinv</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">column_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">lattice</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">loop_over_parallelotope_points</span>
<span class="gp">sage: </span><span class="n">loop_over_parallelotope_points</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">VDinv</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">lattice</span><span class="p">)</span>
<span class="go">((0, 0, 0), (1, 1, 1), (2, 2, 2))</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">loop_over_parallelotope_points</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">VDinv</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">lattice</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">((0, 0, 0), (1, 1, 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.parallelotope_points">
<tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">parallelotope_points</tt><big>(</big><em>spanning_points</em>, <em>lattice</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.parallelotope_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return integral points in the parallelotope starting at the origin
and spanned by the <tt class="docutils literal"><span class="pre">spanning_points</span></tt>.</p>
<p>See <tt class="xref py py-meth docutils literal"><span class="pre">semigroup_generators()</span></tt> for a description of the
algorithm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">spanning_points</span></tt> &#8211; a non-empty list of linearly independent
rays (<span class="math">\(\ZZ\)</span>-vectors or <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">lattice</span></tt></a> elements),
not necessarily primitive lattice points.</li>
</ul>
<p>OUTPUT:</p>
<p>The tuple of all lattice points in the half-open parallelotope
spanned by the rays <span class="math">\(r_i\)</span>,</p>
<div class="math">
\[\begin{split}\mathop{par}(\{r_i\}) =
\sum_{0\leq a_i &lt; 1} a_i r_i\end{split}\]</div>
<p>By half-open parallelotope, we mean that the
points in the facets not meeting the origin are omitted.</p>
<p>EXAMPLES:</p>
<p>Note how the points on the outward-facing factes are omitted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">parallelotope_points</span>
<span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">rays</span><span class="p">,</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">((0, 0), (1, 0), (0, 1), (1, 1))</span>
</pre></div>
</div>
<p>The rays can also be toric lattice points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">rays</span><span class="p">,</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(N(0, 0), N(1, 0), N(0, 1), N(1, 1))</span>
</pre></div>
</div>
<p>A non-smooth cone:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rays</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">lattice</span><span class="p">())</span>
<span class="go">(N(0, 0), N(1, 1))</span>
</pre></div>
</div>
<p>A <tt class="docutils literal"><span class="pre">ValueError</span></tt> is raised if the <tt class="docutils literal"><span class="pre">spanning_points</span></tt> are not
linearly independent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">rays</span><span class="p">,</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The spanning points are not linearly independent!</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">vector</span><span class="p">,[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">rays</span><span class="p">,</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">4</span><span class="p">))</span>
<span class="go">967</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.print_cache">
<tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">print_cache</tt><big>(</big><em>inequality_collection</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.print_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the cached values in <a class="reference internal" href="#sage.geometry.integral_points.Inequality_int" title="sage.geometry.integral_points.Inequality_int"><tt class="xref py py-class docutils literal"><span class="pre">Inequality_int</span></tt></a> (for
debugging/doctesting only).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span><span class="p">,</span> <span class="n">print_cache</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7) x + 2 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">print_cache</span><span class="p">(</span><span class="n">ieq</span><span class="p">)</span>
<span class="go">Cached inner loop: 3 * x_0 + 37 &gt;= 0</span>
<span class="go">Cached next-to-inner loop: 3 * x_0 + 7 * x_1 + 2 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.ray_matrix_normal_form">
<tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">ray_matrix_normal_form</tt><big>(</big><em>R</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.ray_matrix_normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Smith normal form of the ray matrix for
<a class="reference internal" href="#sage.geometry.integral_points.parallelotope_points" title="sage.geometry.integral_points.parallelotope_points"><tt class="xref py py-func docutils literal"><span class="pre">parallelotope_points()</span></tt></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">R</span></tt> &#8211; <span class="math">\(\ZZ\)</span>-matrix whose columns are the rays spanning the
parallelotope.</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple containing <tt class="docutils literal"><span class="pre">e</span></tt>, <tt class="docutils literal"><span class="pre">d</span></tt>, and <tt class="docutils literal"><span class="pre">VDinv</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">ray_matrix_normal_form</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">column_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ray_matrix_normal_form</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">([3], 3, [1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.rectangular_box_points">
<tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">rectangular_box_points</tt><big>(</big><em>box_min</em>, <em>box_max</em>, <em>polyhedron=None</em>, <em>count_only=False</em>, <em>return_saturated=False</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.rectangular_box_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral points in the lattice bounding box that are
also contained in the given polyhedron.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">box_min</span></tt> &#8211; A list of integers. The minimal value for each
coordinate of the rectangular bounding box.</li>
<li><tt class="docutils literal"><span class="pre">box_max</span></tt> &#8211; A list of integers. The maximal value for each
coordinate of the rectangular bounding box.</li>
<li><tt class="docutils literal"><span class="pre">polyhedron</span></tt> &#8211; A
<a class="reference internal" href="polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base" title="sage.geometry.polyhedron.base.Polyhedron_base"><tt class="xref py py-class docutils literal"><span class="pre">Polyhedron_base</span></tt></a>, a PPL
<a class="reference external" href="../../../libs/sage/libs/ppl.html#sage.libs.ppl.C_Polyhedron" title="(in Sage Reference Manual: C/C++ Library Interfaces v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">C_Polyhedron</span></tt></a>, or <tt class="docutils literal"><span class="pre">None</span></tt> (default).</li>
<li><tt class="docutils literal"><span class="pre">count_only</span></tt> &#8211; Boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). Whether to
return only the total number of vertices, and not their
coordinates. Enabling this option speeds up the
enumeration. Cannot be combined with the <tt class="docutils literal"><span class="pre">return_saturated</span></tt>
option.</li>
<li><tt class="docutils literal"><span class="pre">return_saturated</span></tt> &#8211; Boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>. Whether to
also return which inequalities are saturated for each point of
the polyhedron. Enabling this slows down the enumeration. Cannot
be combined with the <tt class="docutils literal"><span class="pre">count_only</span></tt> option.</li>
</ul>
<p>OUTPUT:</p>
<p>By default, this function returns a tuple containing the integral
points of the rectangular box spanned by <span class="math">\(box_min\)</span> and <span class="math">\(box_max\)</span>
and that lie inside the <tt class="docutils literal"><span class="pre">polyhedron</span></tt>. For sufficiently large
bounding boxes, this are all integral points of the polyhedron.</p>
<p>If no polyhedron is specified, all integral points of the
rectangular box are returned.</p>
<p>If <tt class="docutils literal"><span class="pre">count_only</span></tt> is specified, only the total number (an integer)
of found lattice points is returned.</p>
<p>If <tt class="docutils literal"><span class="pre">return_saturated</span></tt> is enabled, then for each integral point a
pair <tt class="docutils literal"><span class="pre">(point,</span> <span class="pre">Hrep)</span></tt> is returned where <tt class="docutils literal"><span class="pre">point</span></tt> is the point
and <tt class="docutils literal"><span class="pre">Hrep</span></tt> is the set of indices of the H-representation objects
that are saturated at the point.</p>
<p>ALGORITHM:</p>
<p>This function implements the naive algorithm towards counting
integral points. Given min and max of vertex coordinates, it
iterates over all points in the bounding box and checks whether
they lie in the polyhedron. The following optimizations are
implemented:</p>
<blockquote>
<div><ul>
<li><p class="first">Cython: Use machine integers and optimizing C/C++ compiler
where possible, arbitrary precision integers where necessary.
Bounds checking, no compile time limits.</p>
</li>
<li><p class="first">Unwind inner loop (and next-to-inner loop):</p>
<div class="math">
\[Ax\leq b
\quad \Leftrightarrow \quad
a_1 x_1 ~\leq~ b - \sum_{i=2}^d a_i x_i\]</div>
<p>so we only have to evaluate <span class="math">\(a_1 * x_1\)</span> in the inner loop.</p>
</li>
<li><p class="first">Coordinates are permuted to make the longest box edge the
inner loop. The inner loop is optimized to run very fast, so
its best to do as much work as possible there.</p>
</li>
<li><p class="first">Continuously reorder inequalities and test the most
restrictive inequalities first.</p>
</li>
<li><p class="first">Use convexity and only find first and last allowed point in
the inner loop. The points in-between must be points of the
polyhedron, too.</p>
</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">rectangular_box_points</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">((0, 0, 0), (0, 0, 1), (0, 0, 2), (0, 0, 3),</span>
<span class="go"> (0, 1, 0), (0, 1, 1), (0, 1, 2), (0, 1, 3),</span>
<span class="go"> (0, 2, 0), (0, 2, 1), (0, 2, 2), (0, 2, 3),</span>
<span class="go"> (1, 0, 0), (1, 0, 1), (1, 0, 2), (1, 0, 3),</span>
<span class="go"> (1, 1, 0), (1, 1, 1), (1, 1, 2), (1, 1, 3),</span>
<span class="go"> (1, 2, 0), (1, 2, 1), (1, 2, 2), (1, 2, 3))</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">rectangular_box_points</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">count_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">24</span>

<span class="gp">sage: </span><span class="n">cell24</span> <span class="o">=</span> <span class="n">polytopes</span><span class="o">.</span><span class="n">twenty_four_cell</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">cell24</span><span class="p">)</span>
<span class="go">((-1, 0, 0, 0), (0, -1, 0, 0), (0, 0, -1, 0), (0, 0, 0, -1),</span>
<span class="go"> (0, 0, 0, 0),</span>
<span class="go"> (0, 0, 0, 1), (0, 0, 1, 0), (0, 1, 0, 0), (1, 0, 0, 0))</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">dilated_cell24</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">cell24</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dilated_cell24</span><span class="p">)</span> <span class="p">)</span>
<span class="go">305</span>

<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">dilated_cell24</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">cell24</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dilated_cell24</span><span class="p">)</span> <span class="p">)</span>
<span class="go">3625</span>

<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dilated_cell24</span><span class="p">,</span> <span class="n">count_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3625</span>

<span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">([(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">polytope</span><span class="p">);</span> <span class="n">pts</span>
<span class="go">((-4, -3, -2, -1), (-1, 0, 0, 1), (0, 1, 1, 1), (1, 1, 1, 1), (1, 1, 3, 0),</span>
<span class="go"> (1, 2, 1, 1), (1, 2, 2, 2), (1, 3, 2, 4), (2, 1, 1, 1), (3, 1, 1, 1))</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">polytope</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span><span class="n">pts</span><span class="p">))</span> <span class="o">==</span> \
<span class="gp">... </span>  <span class="nb">set</span><span class="p">([(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>       <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>   <span class="c"># computed with PALP</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Long ints and non-integral polyhedra are explictly allowed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">()]],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">RDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">],</span> <span class="n">polytope</span><span class="p">)</span> <span class="p">)</span>
<span class="go">31</span>

<span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">])</span>
<span class="go">((0, 99999999999999999999999999999999999999999999999999),</span>
<span class="go"> (0, 100000000000000000000000000000000000000000000000000),</span>
<span class="go"> (0, 100000000000000000000000000000000000000000000000001))</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">],</span> <span class="n">halfplane</span><span class="p">)</span> <span class="p">)</span>
<span class="go">201</span>
</pre></div>
</div>
<p>Using a PPL polyhedron:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.libs.ppl</span> <span class="kn">import</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">Generator_System</span><span class="p">,</span> <span class="n">C_Polyhedron</span><span class="p">,</span> <span class="n">point</span>
<span class="gp">sage: </span><span class="n">gs</span> <span class="o">=</span> <span class="n">Generator_System</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">poly</span> <span class="o">=</span> <span class="n">C_Polyhedron</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
<span class="go">((0, 1, 0), (0, 1, 1), (0, 1, 2), (0, 1, 3), (1, 1, 0), (1, 1, 1), (1, 1, 2), (1, 1, 3),</span>
<span class="go"> (2, 1, 0), (2, 1, 1), (2, 1, 2), (2, 1, 3), (3, 1, 0), (3, 1, 1), (3, 1, 2), (3, 1, 3))</span>
</pre></div>
</div>
<p>Optionally, return the information about the saturated inequalities as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cube</span> <span class="o">=</span> <span class="n">polytopes</span><span class="o">.</span><span class="n">cube</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">An inequality (0, 0, -1) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">An inequality (0, -1, 0) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">An inequality (-1, 0, 0) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">cube</span><span class="p">,</span> <span class="n">return_saturated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(((0, 0, 0), frozenset()),</span>
<span class="go"> ((0, 0, 1), frozenset({0})),</span>
<span class="go"> ((0, 1, 0), frozenset({1})),</span>
<span class="go"> ((0, 1, 1), frozenset({0, 1})),</span>
<span class="go"> ((1, 0, 0), frozenset({2})),</span>
<span class="go"> ((1, 0, 1), frozenset({0, 2})),</span>
<span class="go"> ((1, 1, 0), frozenset({1, 2})),</span>
<span class="go"> ((1, 1, 1), frozenset({0, 1, 2})))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.simplex_points">
<tt class="descclassname">sage.geometry.integral_points.</tt><tt class="descname">simplex_points</tt><big>(</big><em>vertices</em><big>)</big><a class="headerlink" href="#sage.geometry.integral_points.simplex_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral points in a lattice simplex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; an iterable of integer coordinate vectors. The
indices of vertices that span the simplex under
consideration.</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple containing the integral point coordinates as <span class="math">\(\ZZ\)</span>-vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">simplex_points</span>
<span class="gp">sage: </span><span class="n">simplex_points</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)])</span>
<span class="go">((-2, -3, -11), (0, 0, -2), (1, 2, 3), (2, 3, 7))</span>
</pre></div>
</div>
<p>The simplex need not be full-dimensional:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">simplex</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">simplex_points</span><span class="p">(</span><span class="n">simplex</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">())</span>
<span class="go">((2, 3, 7, 5), (0, 0, -2, 5), (-2, -3, -11, 5), (1, 2, 3, 5))</span>

<span class="gp">sage: </span><span class="n">simplex_points</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="go">((2, 3, 7),)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">simplex</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">simplex</span>
<span class="go">A 4-dimensional polyhedron in ZZ^4 defined as the convex hull of 5 vertices</span>
<span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">simplex_points</span><span class="p">(</span><span class="n">simplex</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">())</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="go">49</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pts</span><span class="p">))</span>
<span class="go">49</span>

<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">simplex</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">P4mirror</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">P4mirror</span>
<span class="go">A 4-dimensional polyhedron in ZZ^4 defined as the convex hull of 5 vertices</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">simplex_points</span><span class="p">(</span><span class="n">P4mirror</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()))</span>
<span class="go">126</span>

<span class="gp">sage: </span><span class="n">vertices</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">simplex_points</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
<span class="go">((-2, -3, -11), (0, 0, -2), (1, 2, 3), (2, 3, 7))</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="hasse_diagram.html"
                                  title="previous chapter">Hasse diagrams of finite atomic and coatomic lattices.</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/geometry/integral_points.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hasse_diagram.html" title="Hasse diagrams of finite atomic and coatomic lattices."
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Geometry</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>