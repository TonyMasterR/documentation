<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Weight lattices and weight spaces &mdash; Sage Reference Manual v6.7: Combinatorics</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.7: Combinatorics" href="../../../index.html" />
    <link rel="up" title="Comprehensive Module list" href="../../../module_list.html" />
    <link rel="next" title="Weyl Character Rings" href="weyl_characters.html" />
    <link rel="prev" title="Weight lattice realizations" href="weight_lattice_realizations.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weyl_characters.html" title="Weyl Character Rings"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="weight_lattice_realizations.html" title="Weight lattice realizations"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="weight-lattices-and-weight-spaces">
<span id="sage-combinat-root-system-weight-space"></span><h1>Weight lattices and weight spaces<a class="headerlink" href="#weight-lattices-and-weight-spaces" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.root_system.weight_space"></span><dl class="class">
<dt id="sage.combinat.root_system.weight_space.WeightSpace">
<em class="property">class </em><tt class="descclassname">sage.combinat.root_system.weight_space.</tt><tt class="descname">WeightSpace</tt><big>(</big><em>root_system</em>, <em>base_ring</em>, <em>extended</em><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule" title="sage.combinat.free_module.CombinatorialFreeModule"><tt class="xref py py-class docutils literal"><span class="pre">sage.combinat.free_module.CombinatorialFreeModule</span></tt></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">root_system</span></tt> &#8211; a root system</li>
<li><tt class="docutils literal"><span class="pre">base_ring</span></tt> &#8211; a ring <span class="math">\(R\)</span></li>
<li><tt class="docutils literal"><span class="pre">extended</span></tt> &#8211; a boolean (default: False)</li>
</ul>
<p>The weight space (or lattice if <tt class="docutils literal"><span class="pre">base_ring</span></tt> is <span class="math">\(\ZZ\)</span>) of a root
system is the formal free module <span class="math">\(\bigoplus_i R \Lambda_i\)</span>
generated by the fundamental weights <span class="math">\((\Lambda_i)_{i\in I}\)</span> of the
root system.</p>
<p>This class is also used for coweight spaces (or lattices).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="root_system.html#sage.combinat.root_system.root_system.RootSystem" title="sage.combinat.root_system.root_system.RootSystem"><tt class="xref py py-meth docutils literal"><span class="pre">RootSystem()</span></tt></a></li>
<li><a class="reference internal" href="root_system.html#sage.combinat.root_system.root_system.RootSystem.weight_lattice" title="sage.combinat.root_system.root_system.RootSystem.weight_lattice"><tt class="xref py py-meth docutils literal"><span class="pre">RootSystem.weight_lattice()</span></tt></a> and <a class="reference internal" href="root_system.html#sage.combinat.root_system.root_system.RootSystem.weight_space" title="sage.combinat.root_system.root_system.RootSystem.weight_space"><tt class="xref py py-meth docutils literal"><span class="pre">RootSystem.weight_space()</span></tt></a></li>
<li><a class="reference internal" href="weight_lattice_realizations.html#sage.combinat.root_system.weight_lattice_realizations.WeightLatticeRealizations" title="sage.combinat.root_system.weight_lattice_realizations.WeightLatticeRealizations"><tt class="xref py py-meth docutils literal"><span class="pre">WeightLatticeRealizations()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Weight lattice of the Root system of type [&#39;A&#39;, 3]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {1: 2*Lambda[1] - Lambda[2], 2: -Lambda[1] + 2*Lambda[2] - Lambda[3], 3: -Lambda[2] + 2*Lambda[3]}</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Weight lattice of the Root system of type [&#39;A&#39;, 3, 1]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {0: 2*Lambda[0] -   Lambda[1]               -   Lambda[3],</span>
<span class="go">               1:  -Lambda[0] + 2*Lambda[1] -   Lambda[2],</span>
<span class="go">               2:                -Lambda[1] + 2*Lambda[2] -   Lambda[3],</span>
<span class="go">               3:  -Lambda[0]               -   Lambda[2] + 2*Lambda[3]}</span>
</pre></div>
</div>
<p>For infinite types, the Cartan matrix is singular, and therefore
the embedding of the root lattice is not faithful:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
<p>In particular, the null root is zero:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This can be compensated by extending the basis of the weight space
and slightly deforming the simple roots to make them linearly
independent, without affecting the scalar product with the
coroots. This feature is currently only implemented for affine
types. In that case, if <tt class="docutils literal"><span class="pre">extended</span></tt> is set, then the basis of the
weight space is extended by an element <span class="math">\(\delta\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span> <span class="o">=</span> <span class="bp">True</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Extended weight lattice of the Root system of type [&#39;A&#39;, 3, 1]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">{0, 1, 2, 3, &#39;delta&#39;}</span>
</pre></div>
</div>
<p>And the simple root <span class="math">\(\alpha_0\)</span> associated to the special node is
deformed as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {0: 2*Lambda[0] -   Lambda[1]               -   Lambda[3] + delta,</span>
<span class="go">               1:  -Lambda[0] + 2*Lambda[1] -   Lambda[2],</span>
<span class="go">               2:                -Lambda[1] + 2*Lambda[2] -   Lambda[3],</span>
<span class="go">               3:  -Lambda[0]               -   Lambda[2] + 2*Lambda[3]}</span>
</pre></div>
</div>
<p>Now, the null root is nonzero:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">delta</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>By a slight notational abuse, the extra basis element used to
extend the fundamental weights is called <tt class="docutils literal"><span class="pre">\delta</span></tt> in the
current implementation. However, in the literature,
<tt class="docutils literal"><span class="pre">\delta</span></tt> usually denotes instead the null root. Most of the
time, those two objects coincide, but not for type <span class="math">\(BC\)</span> (aka.
<span class="math">\(A_{2n}^{(2)}\)</span>). Therefore we currently have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*Lambda[0] - Lambda[1] + delta</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">2*delta</span>
</pre></div>
</div>
<p>whereas, with the standard notations from the literature, one
would expect to get respectively <span class="math">\(2\Lambda_0 -\Lambda_1 +1/2
\delta\)</span> and <span class="math">\(\delta\)</span>.</p>
<p>Other than this notational glitch, the implementation remains
correct for type <span class="math">\(BC\)</span>.</p>
<p>The notations may get improved in a subsequent version, which
might require changing the index of the extra basis
element. To guarantee backward compatibility in code not
included in Sage, it is recommended to use the following idiom
to get that index:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">();</span> <span class="n">F</span>
<span class="go">Finite family {&#39;delta&#39;: delta}</span>
<span class="gp">sage: </span><span class="n">index</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">index</span>
<span class="go">&#39;delta&#39;</span>
</pre></div>
</div>
<p>Then, for example, the coefficient of an element of the
extended weight lattice on that basis element can be recovered
with:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">CartanType</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">crystallographic</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="n">CartanType</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])]:</span>
<span class="gp">... </span>      <span class="n">TestSuite</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">root_system</span><span class="p">()</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">())</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">... </span>      <span class="n">TestSuite</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">root_system</span><span class="p">()</span><span class="o">.</span><span class="n">weight_space</span><span class="p">())</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">CartanType</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">affine</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="n">ct</span><span class="o">.</span><span class="n">is_implemented</span><span class="p">():</span>
<span class="gp">... </span>          <span class="n">P</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">root_system</span><span class="p">()</span><span class="o">.</span><span class="n">weight_space</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span>          <span class="n">TestSuite</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sage.combinat.root_system.weight_space.WeightSpace.Element">
<tt class="descname">Element</tt><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.combinat.root_system.weight_space.WeightSpaceElement" title="sage.combinat.root_system.weight_space.WeightSpaceElement"><tt class="xref py py-class docutils literal"><span class="pre">WeightSpaceElement</span></tt></a></p>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.weight_space.WeightSpace.basis_extension">
<tt class="descname">basis_extension</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.basis_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the basis elements used to extend the fundamental weights</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">()</span>
<span class="go">Family ()</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">()</span>
<span class="go">Finite family {&#39;delta&#39;: delta}</span>
</pre></div>
</div>
<p>This method is irrelevant for finite types:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">()</span>
<span class="go">Family ()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.weight_space.WeightSpace.fundamental_weight">
<tt class="descname">fundamental_weight</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.fundamental_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <span class="math">\(i\)</span>-th fundamental weight</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">i</span></tt> &#8211; an element of the index set or <tt class="docutils literal"><span class="pre">&quot;delta&quot;</span></tt></li>
</ul>
<p>By a slight notational abuse, for an affine type this method
also accepts <tt class="docutils literal"><span class="pre">&quot;delta&quot;</span></tt> as input, and returns the image of
<span class="math">\(\delta\)</span> of the extended weight lattice in this realization.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Lambda[1]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Lambda[1]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="s">&quot;delta&quot;</span><span class="p">)</span>
<span class="go">delta</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.weight_space.WeightSpace.is_extended">
<tt class="descname">is_extended</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.is_extended" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether this is an extended weight lattice</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_extended</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">is_extended</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.weight_space.WeightSpace.simple_root">
<tt class="descname">simple_root</tt><big>(</big><em>j</em><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.simple_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <span class="math">\(j^{th}\)</span> simple root</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-Lambda[2] + 2*Lambda[3] - Lambda[4]</span>
</pre></div>
</div>
<p>Its coefficients are given by the corresponding column of the
Cartan matrix:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span><span class="o">.</span><span class="n">cartan_matrix</span><span class="p">()[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[ 0]</span>
<span class="go">[-1]</span>
<span class="go">[ 2]</span>
<span class="go">[-1]</span>
</pre></div>
</div>
<p>Here are all simple roots:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {1:  2*Lambda[1]   - Lambda[2],</span>
<span class="go">               2:   -Lambda[1] + 2*Lambda[2]   - Lambda[3],</span>
<span class="go">               3:   -Lambda[2] + 2*Lambda[3]   - Lambda[4],</span>
<span class="go">               4:               -2*Lambda[3] + 2*Lambda[4]}</span>
</pre></div>
</div>
<p>For the extended weight lattice of an affine type, the simple
root associated to the special node is deformed by adding
<span class="math">\(\delta\)</span>, where <span class="math">\(\delta\)</span> is the null root:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*Lambda[0] - 2*Lambda[1] + delta</span>
</pre></div>
</div>
<p>In fact <span class="math">\(\delta\)</span> is really <span class="math">\(1/a_0\)</span> times the null root (see
the discussion in <a class="reference internal" href="#sage.combinat.root_system.weight_space.WeightSpace" title="sage.combinat.root_system.weight_space.WeightSpace"><tt class="xref py py-class docutils literal"><span class="pre">WeightSpace</span></tt></a>)
but this only makes a difference in type <span class="math">\(BC\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="n">CartanType</span><span class="p">([</span><span class="s">&quot;BC&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*Lambda[0] - Lambda[1] + delta</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">2*delta</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="type_affine.html#sage.combinat.root_system.type_affine.AmbientSpace.simple_root" title="sage.combinat.root_system.type_affine.AmbientSpace.simple_root"><tt class="xref py py-meth docutils literal"><span class="pre">simple_root()</span></tt></a></li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">CartanType.col_annihilator()</span></tt></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.combinat.root_system.weight_space.WeightSpaceElement">
<em class="property">class </em><tt class="descclassname">sage.combinat.root_system.weight_space.</tt><tt class="descname">WeightSpaceElement</tt><big>(</big><em>M</em>, <em>x</em><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModuleElement" title="sage.combinat.free_module.CombinatorialFreeModuleElement"><tt class="xref py py-class docutils literal"><span class="pre">sage.combinat.free_module.CombinatorialFreeModuleElement</span></tt></a></p>
<p>Create a combinatorial module element. This should never be
called directly, but only through the parent combinatorial
free module&#8217;s <tt class="xref py py-meth docutils literal"><span class="pre">__call__()</span></tt> method.</p>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">];</span> <span class="n">f</span>
<span class="go">B[&#39;a&#39;] + 3*B[&#39;c&#39;]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.combinat.root_system.weight_space.WeightSpaceElement.is_dominant">
<tt class="descname">is_dominant</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement.is_dominant" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether an element in the weight space lies in the positive cone spanned
by the basis elements (fundamental weights).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>In the extended affine weight lattice, &#8216;delta&#8217; is orthogonal to
the positive coroots, so adding or subtracting it should not
effect dominance</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">delta</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.weight_space.WeightSpaceElement.scalar">
<tt class="descname">scalar</tt><big>(</big><em>lambdacheck</em><big>)</big><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement.scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>The canonical scalar product between the weight lattice and
the coroot lattice.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>merge with_apply_multi_module_morphism</li>
<li>allow for any root space / lattice</li>
<li>define properly the return type (depends on the base rings of the two spaces)</li>
<li>make this robust for extended weight lattices (<span class="math">\(i\)</span> might be &#8220;delta&#8221;)</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lambda</span>     <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">simple_coroots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The fundamental weights and the simple coroots are dual bases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">([</span> <span class="p">[</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="gp">... </span>             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">index_set</span><span class="p">()</span> <span class="p">]</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">index_set</span><span class="p">()</span> <span class="p">])</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 1 0 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="go">[0 0 0 0 1]</span>
</pre></div>
</div>
<p>Note that the scalar product is not yet implemented between
the weight space and the coweight space; in any cases, that
won&#8217;t be the job of this method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">coweight_space</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">-Lambdacheck[1] + 2*Lambdacheck[2] - Lambdacheck[3] is not in the coroot space</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="weight_lattice_realizations.html"
                                  title="previous chapter">Weight lattice realizations</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="weyl_characters.html"
                                  title="next chapter">Weyl Character Rings</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/combinat/root_system/weight_space.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weyl_characters.html" title="Weyl Character Rings"
             >next</a> |</li>
        <li class="right" >
          <a href="weight_lattice_realizations.html" title="Weight lattice realizations"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li><a href="../../../module_list.html" >Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>