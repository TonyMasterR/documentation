<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Finite word &mdash; Sage Reference Manual v7.0: Combinatorics</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.0: Combinatorics" href="../../../index.html" />
    <link rel="up" title="Comprehensive Module list" href="../../../module_list.html" />
    <link rel="next" title="Infinite word" href="infinite_word.html" />
    <link rel="prev" title="Alphabet" href="alphabet.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="infinite_word.html" title="Infinite word"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="alphabet.html" title="Alphabet"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="finite-word">
<span id="sage-combinat-words-finite-word"></span><h1>Finite word<a class="headerlink" href="#finite-word" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.words.finite_word"></span><p>AUTHORS:</p>
<ul class="simple">
<li>Arnaud Bergeron</li>
<li>Amy Glen</li>
<li>Sébastien Labbé</li>
<li>Franco Saliola</li>
<li>Julien Leroy (March 2010): reduced_rauzy_graph</li>
</ul>
<p>EXAMPLES:</p>
<div class="section" id="creation-of-a-finite-word">
<h2>Creation of a finite word<a class="headerlink" href="#creation-of-a-finite-word" title="Permalink to this headline">¶</a></h2>
<p>Finite words from python strings, lists and tuples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abbabaab&quot;</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">word: 01101001</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="p">)</span>
<span class="go">word: a057b98</span>
</pre></div>
</div>
<p>Finite words from functions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span> <span class="p">:</span> <span class="n">n</span><span class="o">%</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="go">word: 0120120120120</span>
</pre></div>
</div>
<p>Finite words from iterators:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">count</span><span class="p">(),</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">word: 0123456789</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span> <span class="nb">iter</span><span class="p">(</span><span class="s">&#39;abbccdef&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="go">word: abbccdef</span>
</pre></div>
</div>
<p>Finite words from words via concatenation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;abcccabba&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">*</span> <span class="n">v</span>
<span class="go">word: abcccabba04883</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">*</span> <span class="n">u</span>
<span class="go">word: 04883abcccabba</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span>
<span class="go">word: abcccabba04883</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">v</span><span class="o">^</span><span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">word: abcccabbaabcccabbaabcccabba04883048</span>
</pre></div>
</div>
<p>Finite words from infinite words:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="o">^</span><span class="n">Infinity</span>
<span class="gp">sage: </span><span class="n">vv</span><span class="p">[</span><span class="mi">10000</span><span class="p">:</span><span class="mi">10015</span><span class="p">]</span>
<span class="go">word: 048830488304883</span>
</pre></div>
</div>
<p>Finite words in a specific combinatorial class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span>
<span class="go">Finite and infinite words over {&#39;a&#39;, &#39;b&#39;}</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&quot;abbabaab&quot;</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">])</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span> <span class="nb">iter</span><span class="p">(</span><span class="s">&#39;ababab&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="go">word: ababab</span>
</pre></div>
</div>
<p>Finite word as the image under a morphism:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: 4450</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 400040000554450</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">word: 4000445044504450400044504450445044500550...</span>
</pre></div>
</div>
</div>
<div class="section" id="functions-and-algorithms">
<h2>Functions and algorithms<a class="headerlink" href="#functions-and-algorithms" title="Permalink to this headline">¶</a></h2>
<p>There are more than 100 functions defined on a finite word. Here are some
of them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaabbba&#39;</span><span class="p">);</span> <span class="n">w</span>
<span class="go">word: abaabbba</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">28</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">print</span> <span class="n">w</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(ab, aabbb, a)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">w</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(a, b, a, ab, bb, a)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">st</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">suffix_tree</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">st</span>
<span class="go">Implicit Suffix Tree of the word: abaabbba</span>
<span class="gp">sage: </span><span class="n">st</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">word_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">longest_common_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaabababbbbbb&#39;</span><span class="p">))</span>
<span class="go">word: abaababa</span>
</pre></div>
</div>
<p>As matrix and many other sage objects, words have a parent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;xyxxyxyyy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over Set of Python objects of type &#39;object&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;xyxxyxyyy&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;xy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {&#39;x&#39;, &#39;y&#39;}</span>
</pre></div>
</div>
</div>
<div class="section" id="factors-and-rauzy-graphs">
<h2>Factors and Rauzy Graphs<a class="headerlink" href="#factors-and-rauzy-graphs" title="Permalink to this headline">¶</a></h2>
<p>Enumeration of factors, the successive values returned by next(it)
can appear in a different order depending on hardware. Therefore we
mark the three first results of the test random. The important test
is that the iteration stops properly on the fourth call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span><span class="o">^</span><span class="mi">7</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="c"># random</span>
<span class="go">word: 6456</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="c"># random</span>
<span class="go">word: 5645</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="c"># random</span>
<span class="go">word: 4564</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">StopIteration</span>
</pre></div>
</div>
<p>The set of factors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[word: 456, word: 564, word: 645]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[word: 4564, word: 5645, word: 6456]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">()</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">61</span>
</pre></div>
</div>
<p>Rauzy graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Looped digraph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Looped multi-digraph on 2 vertices</span>
</pre></div>
</div>
<p>Left-special and bispecial factors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">number_of_left_special_factors</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">bispecial_factors</span><span class="p">()</span>
<span class="go">[word: , word: 0, word: 010, word: 010010, word: 01001010010]</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.combinat.words.finite_word.CallableFromListOfWords">
<em class="property">class </em><tt class="descclassname">sage.combinat.words.finite_word.</tt><tt class="descname">CallableFromListOfWords</tt><a class="headerlink" href="#sage.combinat.words.finite_word.CallableFromListOfWords" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a></p>
<p>A class to create a callable from a list of words. The concatenation of
a list of words is obtained by creating a word from this callable.</p>
</dd></dl>

<dl class="class">
<dt id="sage.combinat.words.finite_word.Factorization">
<em class="property">class </em><tt class="descclassname">sage.combinat.words.finite_word.</tt><tt class="descname">Factorization</tt><a class="headerlink" href="#sage.combinat.words.finite_word.Factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt></p>
<p>A list subclass having a nicer representation for factorization of words.</p>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">combinat</span><span class="o">.</span><span class="n">words</span><span class="o">.</span><span class="n">finite_word</span><span class="o">.</span><span class="n">Factorization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.combinat.words.finite_word.FiniteWord_class">
<em class="property">class </em><tt class="descclassname">sage.combinat.words.finite_word.</tt><tt class="descname">FiniteWord_class</tt><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_word.html#sage.combinat.words.abstract_word.Word_class" title="sage.combinat.words.abstract_word.Word_class"><tt class="xref py py-class docutils literal"><span class="pre">sage.combinat.words.abstract_word.Word_class</span></tt></a></p>
<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.BWT">
<tt class="descname">BWT</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.BWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Burrows-Wheeler Transform (BWT) of self.</p>
<p>The <em>Burrows-Wheeler transform</em> of a finite word <span class="math">\(w\)</span> is obtained
from <span class="math">\(w\)</span> by first listing the conjugates of <span class="math">\(w\)</span> in lexicographic order
and then concatenating the final letters of the conjugates in this
order. See [1].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaccaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: cbaabaaca</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: bbaaa</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;bbabbaca&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: cbbbbaaa</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: bbaaaa</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: a</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Burrows, D.J. Wheeler, &#8220;A block-sorting lossless data
compression algorithm&#8221;, HP Lab Technical Report, 1994, available
at <a class="reference external" href="http://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-124.html">http://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-124.html</a></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.abelian_complexity">
<tt class="descname">abelian_complexity</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.abelian_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of abelian vectors of factors of length <tt class="docutils literal"><span class="pre">n</span></tt> of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.abelian_vector">
<tt class="descname">abelian_vector</tt><big>(</big><em>alphabet=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.abelian_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abelian vector of self counting the occurrences of each letter.</p>
<p>The vector is defined w.r.t the order of the alphabet of the
parent. See also <a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict" title="sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict"><tt class="xref py py-meth docutils literal"><span class="pre">evaluation_dict()</span></tt></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> &#8211; word having a parent on a finite alphabet</li>
<li><tt class="docutils literal"><span class="pre">alphabet</span></tt> &#8211; DEPRECATED</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;aaabbbbb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[1, 0]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
<p>The argument alphabet is deprecated:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: The argument alphabet of</span>
<span class="go">methods abelian_vector and parikh_vector is deprecated and will</span>
<span class="go">be removed in a future version of Sage. In order to fix this,</span>
<span class="go">you must define your word on a parent with a finite alphabet.</span>
<span class="go">See http://trac.sagemath.org/17058 for details.</span>
<span class="go">[4, 1, 0]</span>
</pre></div>
</div>
<p>You may fix the above deprecated use of alphabet argument this way:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[4, 1, 0]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The alphabet of the parent is infinite; define the</span>
<span class="go">word with a parent on a finite alphabet or use</span>
<span class="go">evaluation_dict() instead</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.abelian_vectors">
<tt class="descname">abelian_vectors</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.abelian_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abelian vectors of factors of length <tt class="docutils literal"><span class="pre">n</span></tt> of self.</p>
<p>The vectors are defined w.r.t the order of the alphabet of the
parent.</p>
<p>OUTPUT:</p>
<blockquote>
<div>Set of tuples</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{(1, 0, 2), (1, 1, 1), (1, 2, 0), (2, 0, 1)}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{(1, 2, 0)}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{(1, 0, 2), (2, 0, 1)}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[(0, 0)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[(0, 1), (1, 0)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">[(4, 3), (5, 2)]</span>
</pre></div>
</div>
<p>The word must be defined with a parent on a finite alphabet:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="n">count</span><span class="p">(),</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">NN</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The alphabet of the parent is infinite; define the</span>
<span class="go">word with a parent on a finite alphabet</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[(3, 0)]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[(2, 1), (3, 0)]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[(1, 2), (2, 1), (3, 0)]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[(0, 3), (1, 2), (2, 1), (3, 0)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">alphabet</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">abelian_complexity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">abelian_complexity</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_letters">
<tt class="descname">apply_permutation_to_letters</tt><big>(</big><em>permutation</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_letters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word obtained by applying the permutation
<tt class="docutils literal"><span class="pre">permutation</span></tt> of the alphabet of <tt class="docutils literal"><span class="pre">self</span></tt> to each letter of
<tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">)(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;dabc&#39;</span><span class="p">)(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">word: dcba</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">Permutation</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">PermutationGroupElement</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">word: badc</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions">
<tt class="descname">apply_permutation_to_positions</tt><big>(</big><em>permutation</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word obtained by permuting the positions of the letters
in <tt class="docutils literal"><span class="pre">self</span></tt> according to the permutation <tt class="docutils literal"><span class="pre">permutation</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">)(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;dabc&#39;</span><span class="p">)(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">(</span><span class="n">Permutation</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">(</span><span class="n">PermutationGroupElement</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">word: 3421</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.balance">
<tt class="descname">balance</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the balance of self.</p>
<p>The balance of a word is the smallest number <span class="math">\(q\)</span> such that self is
<span class="math">\(q\)</span>-balanced [1].</p>
<p>A finite or infinite word <span class="math">\(w\)</span> is said to be <span class="math">\(q\)</span>-<em>balanced</em> if for
any two factors <span class="math">\(u\)</span>, <span class="math">\(v\)</span> of <span class="math">\(w\)</span> of the same length, the difference
between the number of <span class="math">\(x\)</span>&#8216;s in each of <span class="math">\(u\)</span> and <span class="math">\(v\)</span> is at most <span class="math">\(q\)</span>
for all letters <span class="math">\(x\)</span> in the alphabet of <span class="math">\(w\)</span>. A <span class="math">\(1\)</span>-balanced word is
simply said to be balanced. See Chapter 2 of [2].</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1111111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;001010101011&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0101010101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;11112222&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1111122222&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] I. Fagnot, L. Vuillon, Generalized balances in Sturmian words,
Discrete Applied Mathematics 121 (2002), 83&#8211;101.</li>
<li>[2] M. Lothaire, Algebraic Combinatorics On Words, vol. 90 of
Encyclopedia of Mathematics and its Applications, Cambridge
University Press, U.K., 2002.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors">
<tt class="descname">bispecial_factors</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bispecial factors (of length n).</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>bispecial</em> if it is right special
and left special.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer (optional, default: None). If None, it returns
all bispecial factors.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of words.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors</span><span class="p">()</span>
<span class="go">[word: , word: 0, word: 010, word: 010010, word: 01001010010]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="go">0 [word: ]</span>
<span class="go">1 [word: 0, word: 1]</span>
<span class="go">2 [word: 01, word: 10]</span>
<span class="go">3 [word: 010, word: 101]</span>
<span class="go">4 [word: 0110, word: 1001]</span>
<span class="go">5 []</span>
<span class="go">6 [word: 011001, word: 100110]</span>
<span class="go">7 []</span>
<span class="go">8 [word: 10010110]</span>
<span class="go">9 []</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors_iterator">
<tt class="descname">bispecial_factors_iterator</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the bispecial factors (of length n).</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>bispecial</em> if it is right special
and left special.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer (optional, default: None). If None, it returns
an iterator over all bispecial factors.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors_iterator</span><span class="p">(</span><span class="n">i</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="n">i</span><span class="p">,</span><span class="n">u</span>
<span class="go">0</span>
<span class="go">1 0</span>
<span class="go">1 1</span>
<span class="go">2 01</span>
<span class="go">2 10</span>
<span class="go">3 010</span>
<span class="go">3 101</span>
<span class="go">4 0110</span>
<span class="go">4 1001</span>
<span class="go">6 011001</span>
<span class="go">6 100110</span>
<span class="go">8 10010110</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">u</span> <span class="p">:</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors_iterator</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">):</span> <span class="n">u</span>
<span class="go">word:</span>
<span class="go">word: 0</span>
<span class="go">word: 1</span>
<span class="go">word: 01</span>
<span class="go">word: 10</span>
<span class="go">word: 010</span>
<span class="go">word: 101</span>
<span class="go">word: 0110</span>
<span class="go">word: 1001</span>
<span class="go">word: 011001</span>
<span class="go">word: 100110</span>
<span class="go">word: 10010110</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.border">
<tt class="descname">border</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.border" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the longest word that is both a proper prefix and a proper
suffix of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">border</span><span class="p">()</span>
<span class="go">word: 1212</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">border</span><span class="p">()</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">border</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.charge">
<tt class="descname">charge</tt><big>(</big><em>check=True</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the charge of self.  This is defined as follows.</p>
<p>If <span class="math">\(w\)</span> is a permutation of length <span class="math">\(n\)</span>, (in other words, the evaluation
of <span class="math">\(w\)</span> is <span class="math">\((1, 1, \dots, 1)\)</span>), the statistic charge(<span class="math">\(w\)</span>) is given by
<span class="math">\(\sum_{i=1}^n c_i(w)\)</span> where <span class="math">\(c_1(w) = 0\)</span> and <span class="math">\(c_i(w)\)</span> is defined
recursively by setting <span class="math">\(p_i\)</span> equal to <span class="math">\(1\)</span> if <span class="math">\(i\)</span> appears to the right
of <span class="math">\(i-1\)</span> in <span class="math">\(w\)</span> and <span class="math">\(0\)</span> otherwise.  Then we set <span class="math">\(c_i(w) = c_{i-1}(w) +
p_i\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <span class="math">\(w\)</span> is not a permutation, but the evaluation of <span class="math">\(w\)</span> is a partition,
the charge of <span class="math">\(w\)</span> is defined to be the sum of its charge subwords
(each of which will be a permutation).  The first charge subword is
found by starting at the end of <span class="math">\(w\)</span> and moving left until the first
<span class="math">\(1\)</span> is found.  This is marked, and we continue to move to the left
until the first <span class="math">\(2\)</span> is found, wrapping around from the beginning of
the word back to the end, if necessary.  We mark this <span class="math">\(2\)</span>, and
continue on until we have marked the largest letter in <span class="math">\(w\)</span>.  The
marked letters, with relative order preserved, form the first charge
subword of <span class="math">\(w\)</span>.  This subword is removed, and the next charge subword
is found in the same manner from the remaining letters.  In the
following example, <span class="math">\(w1, w2, w3\)</span> are the charge subwords of <span class="math">\(w\)</span>.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w3</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">==</span> <span class="n">w1</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">+</span> <span class="n">w2</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">+</span> <span class="n">w3</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, if <span class="math">\(w\)</span> does not have partition content, we apply the
Lascoux-Schutzenberger standardization operators <span class="math">\(s_i\)</span> in such a
manner as to obtain a word with partition content. (The word we obtain
is independent of the choice of operators.)  The charge is then
defined to be the charge of this word:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Note that this differs from the definition of charge given in
Macdonald&#8217;s book.  The difference amounts to a choice of
reading a word from left-to-right or right-to-left.  The choice in
Sage was made to agree with the definition of a reading word of a
tableau in Sage, and seems to be the more common convention in the
literature.</p>
<p>REFERENCES:</p>
<p>[1] Ian Macdonald, <em>Symmetric Functions and Hall Polynomials</em> second
edition, 1995, Oxford University Press</p>
<p>[2] A. Lascoux, L. Lapointe, and J. Morse.  <em>Tableau atoms and a new
Macdonald positivity conjecture.</em> Duke Math Journal, <strong>116 (1)</strong>,
2003.  Available at: [<a class="reference external" href="http://arxiv.org/abs/math/0008073">http://arxiv.org/abs/math/0008073</a>]</p>
<p>[3] A. Lascoux, B. Leclerc, and J.Y. Thibon.  <em>The Plactic Monoid</em>.
Survey article available at
[<a class="reference external" href="http://www-igm.univ-mlv.fr/~jyt/ARTICLES/plactic.ps">http://www-igm.univ-mlv.fr/~jyt/ARTICLES/plactic.ps</a>]</p>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.cocharge">
<tt class="descname">cocharge</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.cocharge" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cocharge of self.  For a word <span class="math">\(w\)</span>, this can be defined as
<span class="math">\(n_{ev} - ch(w)\)</span>, where <span class="math">\(ch(w)\)</span> is the charge of <span class="math">\(w\)</span> and <span class="math">\(ev\)</span> is the
evaluation of <span class="math">\(w\)</span>, and <span class="math">\(n_{ev}\)</span> is <span class="math">\(\sum_{i&lt;j} min(ev_i, ev_j)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.coerce">
<tt class="descname">coerce</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.coerce" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to return a pair of words with a common parent; raises an
exception if this is not possible.</p>
<p>This function begins by checking if both words have the same
parent. If this is the case, then no work is done and both words
are returned as-is.</p>
<p>Otherwise it will attempt to convert other to the domain of self.
If that fails, it will attempt to convert self to the domain of
other. If both attempts fail, it raises a TypeError to signal
failure.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W1</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">);</span> <span class="n">W2</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">W1</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">);</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">W2</span><span class="p">(</span><span class="s">&#39;abba&#39;</span><span class="p">);</span> <span class="n">w3</span> <span class="o">=</span> <span class="n">W1</span><span class="p">(</span><span class="s">&#39;baab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">w2</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">w1</span><span class="o">.</span><span class="n">coerce</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">b</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">w2</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.colored_vector">
<tt class="descname">colored_vector</tt><big>(</big><em>x=0</em>, <em>y=0</em>, <em>width='default'</em>, <em>height=1</em>, <em>cmap='hsv'</em>, <em>thickness=1</em>, <em>label=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.colored_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector (Graphics object) illustrating self. Each letter
is represented by a coloured rectangle.</p>
<p>If the parent of self is a class of words over a finite alphabet,
then each letter in the alphabet is assigned a unique colour, and
this colour will be the same every time this method is called. This
is especially useful when plotting and comparing words defined on
the same alphabet.</p>
<p>If the alphabet is infinite, then the letters appearing in the word
are used as the alphabet.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">x</span></tt> - (default: 0) bottom left x-coordinate of the vector</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">y</span></tt> - (default: 0) bottom left y-coordinate of the vector</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">width</span></tt>  - (default: &#8216;default&#8217;) width of the vector. By default,
the width is the length of self.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">height</span></tt> - (default: 1) height of the vector</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">thickness</span></tt> - (default: 1) thickness of the contour</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">cmap</span></tt> - (default: &#8216;hsv&#8217;) color map; for available color map names</dt>
<dd><p class="first last">type: <tt class="docutils literal"><span class="pre">import</span> <span class="pre">matplotlib.cm;</span> <span class="pre">matplotlib.cm.datad.keys()</span></tt></p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">label</span></tt> - str (default: None) a label to add on the colored vector.</p>
</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>Graphics</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 21 graphics primitives</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Graphics object consisting of 101 graphics primitives</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 9 graphics primitives</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;autumn&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 9 graphics primitives</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Rainbow&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 23 graphics primitives</span>
</pre></div>
</div>
<p>When two words are defined under the same parent, same letters are
mapped to same colors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 32 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The empty word:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;empty&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 3 graphics primitives</span>
</pre></div>
</div>
<p>Unknown cmap:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;jolies&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Color map jolies not known</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;__doc__&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Color map __doc__ not known</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.commutes_with">
<tt class="descname">commutes_with</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.commutes_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self commutes with other, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">commutes_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">commutes_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;11&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">commutes_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;21&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.complete_return_words">
<tt class="descname">complete_return_words</tt><big>(</big><em>fact</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.complete_return_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the set of complete return words of fact in self.</p>
<p>This is the set of all factors starting by the given factor and ending
just after the next occurrence of this factor. See for instance [1].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">fact</span></tt> - a non empty finite word</li>
</ul>
<p>OUTPUT:</p>
<p>Python set of finite words</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;21331233213231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complete_return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">[word: 2132, word: 213312, word: 2332]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complete_return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;213&#39;</span><span class="p">))</span>
<span class="go">set()</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complete_return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1212&#39;</span><span class="p">))</span>
<span class="go">{word: 121212}</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] J. Justin, L. Vuillon, Return words in Sturmian and
episturmian words, Theor. Inform. Appl. 34 (2000) 343&#8211;356.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.concatenate">
<tt class="descname">concatenate</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the concatenation of self and other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - a word over the same alphabet as self</li>
</ul>
<p>EXAMPLES:</p>
<p>Concatenation may be made using <tt class="docutils literal"><span class="pre">+</span></tt> or <tt class="docutils literal"><span class="pre">*</span></tt> operations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abadafd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">*</span> <span class="n">y</span>
<span class="go">word: abadafd53587</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">+</span> <span class="n">y</span>
<span class="go">word: abadafd53587</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">word: abadafd53587</span>
</pre></div>
</div>
<p>Both words must be defined over the same alphabet:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;12223&#39;</span><span class="p">,</span> <span class="n">alphabet</span> <span class="o">=</span> <span class="s">&#39;123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">5 not in alphabet!</span>
</pre></div>
</div>
<p>Eventually, it should work:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;12223&#39;</span><span class="p">,</span> <span class="n">alphabet</span> <span class="o">=</span> <span class="s">&#39;123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span>                   <span class="c">#todo: not implemented</span>
<span class="go">word: 1222353587</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The empty word is not considered by concatenation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Word</span><span class="p">([])</span> <span class="o">*</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">))</span>
<span class="go">&lt;class &#39;sage.combinat.words.word.FiniteWord_str&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">Word</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.combinat.words.word.FiniteWord_str&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">Word</span><span class="p">([]))</span>
<span class="go">&lt;class &#39;sage.combinat.words.word.FiniteWord_str&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">Word</span><span class="p">(()))</span>
<span class="go">&lt;class &#39;sage.combinat.words.word.FiniteWord_str&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">))</span>
<span class="go">&lt;class &#39;sage.combinat.words.word.FiniteWord_list&#39;&gt;</span>
</pre></div>
</div>
<p>Concatenation of finite words with infinite words works as expected:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">repeat</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s">&#39;aba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s">&#39;infinite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">*</span><span class="n">w2</span>
<span class="go">word: ababbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb...</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Infinite words over {&#39;a&#39;, &#39;b&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.conjugate">
<tt class="descname">conjugate</tt><big>(</big><em>pos</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the conjugate at pos of self.</p>
<p>pos can be any integer, the distance used is the modulo by the length
of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 21121</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">word: 12121</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 21211</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.conjugate_position">
<tt class="descname">conjugate_position</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugate_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the position where self is conjugate with other.
Returns None if there is no such position.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12113&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate_position</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;31211&#39;</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12131&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate_position</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12113&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">conjugate_position</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We check that <a class="reference external" href="http://trac.sagemath.org/11128">trac ticket #11128</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate_position</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">length</span><span class="p">())]</span>
<span class="go">[0, 1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.conjugates">
<tt class="descname">conjugates</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of unique conjugates of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: 012345,</span>
<span class="go"> word: 123450,</span>
<span class="go"> word: 234501,</span>
<span class="go"> word: 345012,</span>
<span class="go"> word: 450123,</span>
<span class="go"> word: 501234]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;cbbca&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: cbbca, word: bbcac, word: bcacb, word: cacbb, word: acbbc]</span>
</pre></div>
</div>
<p>The result contains each conjugate only once:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcabc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: abcabc, word: bcabca, word: cabcab]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.conjugates_iterator">
<tt class="descname">conjugates_iterator</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugates_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the conjugates of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">conjugates_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span> <span class="n">w</span>
<span class="go">word: 0123</span>
<span class="go">word: 1230</span>
<span class="go">word: 2301</span>
<span class="go">word: 3012</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.count">
<tt class="descname">count</tt><big>(</big><em>letter</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of occurrences of letter in self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.critical_exponent">
<tt class="descname">critical_exponent</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.critical_exponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the critical exponent of self.</p>
<p>The <em>critical exponent</em> of a word is the supremum of the order of
all its (finite) factors. See [1].</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The implementation here uses the suffix tree to enumerate all the
factors. It should be improved.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">7/3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] F. Dejean. Sur un théorème de Thue. J. Combinatorial Theory
Ser. A 13:90–99, 1972.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.crochemore_factorization">
<tt class="descname">crochemore_factorization</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.crochemore_factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Crochemore factorization of self as an ordered list of
factors.</p>
<p>The <em>Crochemore factorization</em> of a finite word <span class="math">\(w\)</span> is the unique
factorization: <span class="math">\((x_1, x_2, \ldots, x_n)\)</span> of <span class="math">\(w\)</span> with each <span class="math">\(x_i\)</span>
satisfying either:
C1. <span class="math">\(x_i\)</span> is a letter that does not appear in <span class="math">\(u = x_1\ldots x_{i-1}\)</span>;
C2. <span class="math">\(x_i\)</span> is the longest prefix of <span class="math">\(v = x_i\ldots x_n\)</span> that also
has an occurrence beginning within <span class="math">\(u = x_1\ldots x_{i-1}\)</span>. See [1].</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is not a very good implementation, and should be improved.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abababb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(a, b, abab, b)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaababacabba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(a, b, a, aba, ba, c, ab, ba)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">y</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(0, 1, 0101, 1)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Crochemore, Recherche linéaire d&#8217;un carré dans un mot,
C. R. Acad. Sci. Paris Sér. I Math. 296 (1983) 14 781&#8211;784.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.defect">
<tt class="descname">defect</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.defect" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the defect of self.</p>
<p>The <em>defect</em> of a finite word <span class="math">\(w\)</span> is given by the difference between
the maximum number of possible palindromic factors in a word of length
<span class="math">\(|w|\)</span> and the actual number of palindromic factors contained in <span class="math">\(w\)</span>.
It is well known that the maximum number of palindromic factors in <span class="math">\(w\)</span>
is <span class="math">\(|w|+1\)</span> (see <a class="reference internal" href="#djp01" id="id1">[DJP01]</a>).</p>
<p>An optional involution on letters <tt class="docutils literal"><span class="pre">f</span></tt> can be given. In that case, the
<em>f-palindromic defect</em> (or <em>pseudopalindromic defect</em>, or
<em>theta-palindromic defect</em>) of <span class="math">\(w\)</span> is returned. It is a
generalization of defect to f-palindromes. More precisely, the defect is
<span class="math">\(D(w)=|w|+1-g_f(w)-|PAL_f(w)|\)</span>, where <span class="math">\(PAL_f(w)\)</span> denotes the set of
f-palindromic factors of <span class="math">\(w\)</span> (including the empty word) and <span class="math">\(g_f(w)\)</span> is
the number of pairs <span class="math">\(\{a, f(a)\}\)</span> such that <span class="math">\(a\)</span> is a letter, <span class="math">\(a\)</span> is not
equal to <span class="math">\(f(a)\)</span>, and <span class="math">\(a\)</span> or <span class="math">\(f(a)\)</span> occurs in <span class="math">\(w\)</span>. In the case of usual
palindromes (i.e., for <tt class="docutils literal"><span class="pre">f</span></tt> not given or equal to the identity),
<span class="math">\(g_f(w) = 0\)</span> for all <span class="math">\(w\)</span>. See <a class="reference internal" href="#bhnr04" id="id2">[BHNR04]</a> for usual palindromes and <a class="reference internal" href="#sta11" id="id3">[Sta11]</a>
for f-palindromes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism). The
default value corresponds to usual palindromes, i.e., <span class="math">\(f\)</span> equal to
the identity.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div><dl class="docutils">
<dt>integer &#8211; If f is None, the palindromic defect of self;</dt>
<dd>otherwise, the f-palindromic defect of self.</dd>
</dl>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ara&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcacba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>It is known that Sturmian words (see <a class="reference internal" href="#djp01" id="id4">[DJP01]</a>) have zero defect:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">sa</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;ab,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sb</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;a,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">sa</span><span class="o">*</span><span class="n">sb</span><span class="o">*</span><span class="n">sb</span><span class="o">*</span><span class="n">sa</span><span class="o">*</span><span class="n">sa</span><span class="o">*</span><span class="n">sa</span><span class="o">*</span><span class="n">sb</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">110</span><span class="p">:</span><span class="mi">140</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>It is even conjectured that the defect of an aperiodic word which is
a fixed point of a primitive morphism is either <span class="math">\(0\)</span> or infinite
(see <a class="reference internal" href="#bbgl08" id="id5">[BBGL08]</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">52</span>
</pre></div>
</div>
<p>For generalized defect with an involution different from the identity,
there is always a letter which is not a palindrome! This is the reason
for the modification of the definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaabbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;cabc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Other examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;000000000000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;011010011001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0101001010001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaabbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="bbgl08" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[BBGL08]</a></td><td>A. Blondin Massé, S. Brlek, A. Garon, and S. Labbé,
Combinatorial properties of f -palindromes in the Thue-Morse
sequence. Pure Math. Appl., 19(2-3):39&#8211;52, 2008.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bhnr04" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[BHNR04]</a></td><td>S. Brlek, S. Hamel, M. Nivat, C. Reutenauer, On the
Palindromic Complexity of Infinite Words, in J. Berstel, J.
Karhumaki, D. Perrin, Eds, Combinatorics on Words with Applications,
International Journal of Foundation of Computer Science, Vol. 15,
No. 2 (2004) 293&#8211;306.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="djp01" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[DJP01]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> X. Droubay, J. Justin, G. Pirillo, Episturmian words and some
constructions of de Luca and Rauzy, Theoret. Comput. Sci. 255,
(2001), no. 1&#8211;2, 539&#8211;553.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="sta11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Sta11]</a></td><td>Š. Starosta, On Theta-palindromic Richness, Theoret. Comp.
Sci. 412 (2011) 1111&#8211;1121</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.deg_inv_lex_less">
<tt class="descname">deg_inv_lex_less</tt><big>(</big><em>other</em>, <em>weights=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.deg_inv_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the word self is degree inverse lexicographically
less than other.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">deg_inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">deg_inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.deg_lex_less">
<tt class="descname">deg_lex_less</tt><big>(</big><em>other</em>, <em>weights=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.deg_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is degree lexicographically less than other,
and False otherwise. The weight of each letter in the ordered
alphabet is given by weights, which defaults to [1, 2, 3, ...].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abbb&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;baba&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;aaba&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;aaba&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.deg_rev_lex_less">
<tt class="descname">deg_rev_lex_less</tt><big>(</big><em>other</em>, <em>weights=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.deg_rev_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is degree reverse
lexicographically less than other.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">deg_rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">deg_rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">deg_rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.degree">
<tt class="descname">degree</tt><big>(</big><em>weights=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the weighted degree of self, where the weighted degree of
each letter in the ordered alphabet is given by weights, which
defaults to [1, 2, 3, ...].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">weights</span></tt> - a list or tuple, or a dictionary keyed by the
letters occurring in self.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)(</span><span class="s">&quot;aabba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;aabba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="go">34</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.delta">
<tt class="descname">delta</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image of self under the delta morphism. This is the
word composed of the length of consecutive runs of the same letter
in a given word.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;0123456789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;22112122&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word: 22112</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;555008&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word: 321</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabbabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word: 22112</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.delta_derivate">
<tt class="descname">delta_derivate</tt><big>(</big><em>W=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_derivate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the derivative under delta for self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;12211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;2112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 2</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;2211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 2</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;11222&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_left">
<tt class="descname">delta_derivate_left</tt><big>(</big><em>W=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the derivative under delta for self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;12211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;2112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 21</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;2211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 21</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;11222&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_right">
<tt class="descname">delta_derivate_right</tt><big>(</big><em>W=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_right" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the right derivative under delta for self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;12211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 122</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;2112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 12</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;2211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 2</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;11222&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 23</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.delta_inv">
<tt class="descname">delta_inv</tt><big>(</big><em>W=None</em>, <em>s=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Lifts self via the delta operator to obtain a word containing the
letters in alphabet (default is [0, 1]). The letters used in the
construction start with s (default is alphabet[0]) and cycle
through alphabet.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">alphabet</span></tt> - an iterable</li>
<li><tt class="docutils literal"><span class="pre">s</span></tt> - an object in the iterable</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">delta_inv</span><span class="p">()</span>
<span class="go">word: 112212</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">delta_inv</span><span class="p">(</span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="go">word: 1231</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">delta_inv</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 22112122</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.evaluation">
<tt class="descname">evaluation</tt><big>(</big><em>alphabet=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abelian vector of self counting the occurrences of each letter.</p>
<p>The vector is defined w.r.t the order of the alphabet of the
parent. See also <a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict" title="sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict"><tt class="xref py py-meth docutils literal"><span class="pre">evaluation_dict()</span></tt></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> &#8211; word having a parent on a finite alphabet</li>
<li><tt class="docutils literal"><span class="pre">alphabet</span></tt> &#8211; DEPRECATED</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;aaabbbbb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[1, 0]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
<p>The argument alphabet is deprecated:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: The argument alphabet of</span>
<span class="go">methods abelian_vector and parikh_vector is deprecated and will</span>
<span class="go">be removed in a future version of Sage. In order to fix this,</span>
<span class="go">you must define your word on a parent with a finite alphabet.</span>
<span class="go">See http://trac.sagemath.org/17058 for details.</span>
<span class="go">[4, 1, 0]</span>
</pre></div>
</div>
<p>You may fix the above deprecated use of alphabet argument this way:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[4, 1, 0]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The alphabet of the parent is infinite; define the</span>
<span class="go">word with a parent on a finite alphabet or use</span>
<span class="go">evaluation_dict() instead</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict">
<tt class="descname">evaluation_dict</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary keyed by the letters occurring in self with
values the number of occurrences of the letter.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 1, 4: 2}</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;badbcdb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: 1, &#39;b&#39;: 3, &#39;c&#39;: 1, &#39;d&#39;: 2}</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span> <span class="c"># keys appear in random order</span>
<span class="go">{&#39;1&#39;: 4, &#39;2&#39;: 2, &#39;3&#39;: 1}</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="s">&#39;1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="s">&#39;2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="s">&#39;3&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.evaluation_partition">
<tt class="descname">evaluation_partition</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the evaluation of the word w as a partition.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;acdabda&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_partition</span><span class="p">()</span>
<span class="go">[3, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">evaluation_partition</span><span class="p">()</span>
<span class="go">[3, 2, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.evaluation_sparse">
<tt class="descname">evaluation_sparse</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list representing the evaluation of self. The entries of
the list are two-element lists [a, n], where a is a letter
occurring in self and n is the number of occurrences of a in self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">evaluation_sparse</span><span class="p">()</span>
<span class="go">[(1, 2), (2, 2), (4, 3), (5, 1)]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abcaccab&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_sparse</span><span class="p">()</span>
<span class="go">[(&#39;a&#39;, 3), (&#39;c&#39;, 3), (&#39;b&#39;, 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.exponent">
<tt class="descname">exponent</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.exponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the exponent of self.</p>
<p>OUTPUT:</p>
<blockquote>
<div>integer &#8211; the exponent</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exponent</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exponent</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">exponent</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.factor_iterator">
<tt class="descname">factor_iterator</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.factor_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates distinct factors of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer, or <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>If <tt class="docutils literal"><span class="pre">n</span></tt> is an integer, returns an iterator over all distinct
factors of length <tt class="docutils literal"><span class="pre">n</span></tt>. If <tt class="docutils literal"><span class="pre">n</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>, returns an iterator
generating all distinct factors.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 1, word: 2, word: 3]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 1213, word: 1312, word: 2131, word: 3121]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 1213, word: 12131, word: 121312, word: 1213121, word: 13, word: 131, word: 1312, word: 13121, word: 2, word: 21, word: 213, word: 2131, word: 21312, word: 213121, word: 3, word: 31, word: 312, word: 3121]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 1, word: 2, word: 3]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 12123]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 1212, word: 12123, word: 123, word: 2, word: 21, word: 212, word: 2123, word: 23, word: 3]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">xxx</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;xxx&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: xx]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: , word: x, word: xx, word: xxx]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Word</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">e</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">e</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">e</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: ]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;cacao&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">&lt;type &#39;generator&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.factor_occurrences_in">
<tt class="descname">factor_occurrences_in</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.factor_occurrences_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over all occurrences (including overlapping ones)
of self in other in their order of appearance.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;121213211213&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">factor_occurrences_in</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">[0, 2, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.factor_set">
<tt class="descname">factor_set</tt><big>(</big><em>n=None</em>, <em>algorithm='suffix tree'</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.factor_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the set of factors (of length n) of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer or <tt class="docutils literal"><span class="pre">None</span></tt> (default: None).</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - string (default: <tt class="docutils literal"><span class="pre">'suffix</span> <span class="pre">tree'</span></tt>), takes the
following values:<ul>
<li><tt class="docutils literal"><span class="pre">'suffix</span> <span class="pre">tree'</span></tt> &#8211; construct and use the suffix tree of the word</li>
<li><tt class="docutils literal"><span class="pre">'naive'</span></tt> &#8211; algorithm uses a sliding window</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>If <tt class="docutils literal"><span class="pre">n</span></tt> is an integer, returns the set of all distinct
factors of length <tt class="docutils literal"><span class="pre">n</span></tt>. If <tt class="docutils literal"><span class="pre">n</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>, returns the set
of all distinct factors.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">())</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 2, word: 21]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;naive&#39;</span><span class="p">))</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 2, word: 21]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">length</span><span class="p">()):</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="go">[word: ]</span>
<span class="go">[word: 1, word: 2, word: 3]</span>
<span class="go">[word: 12, word: 13, word: 21, word: 31]</span>
<span class="go">[word: 121, word: 131, word: 213, word: 312]</span>
<span class="go">[word: 1213, word: 1312, word: 2131, word: 3121]</span>
<span class="go">[word: 12131, word: 13121, word: 21312]</span>
<span class="go">[word: 121312, word: 213121]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 1212, word: 12123, word: 123, word: 2, word: 21, word: 212, word: 2123, word: 23, word: 3]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;xx&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">[word: , word: x, word: xx]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Set</span><span class="p">(</span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">factor_set</span><span class="p">())</span>
<span class="go">{word: }</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">alphabet</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">S1</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;suffix tree&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S2</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;naive&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S1</span> <span class="o">==</span> <span class="n">S2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.find">
<tt class="descname">find</tt><big>(</big><em>sub</em>, <em>start=0</em>, <em>end=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the first occurrence of sub in self,
such that sub is contained within self[start:end].
Returns -1 on failure.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">sub</span></tt> - string, list, tuple or word to search for.</li>
<li><tt class="docutils literal"><span class="pre">start</span></tt> - non negative integer (default: 0) specifying
the position from which to start the search.</li>
<li><tt class="docutils literal"><span class="pre">end</span></tt> - non negative integer (default: None) specifying
the position at which the search must stop. If None, then
the search is performed up to the end of the string.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>non negative integer or -1</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">sub</span></tt> argument can also be a tuple or a list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Examples using <tt class="docutils literal"><span class="pre">start</span></tt> and <tt class="docutils literal"><span class="pre">end</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;aa&quot;</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Instances of Word_str handle string inputs as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abac&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;ba&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/12804">trac ticket #12804</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s">&quot;ababab&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s">&quot;finite&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;aa&quot;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)(</span><span class="nb">tuple</span><span class="p">(</span><span class="s">&#39;babaabaaab&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.first_pos_in">
<tt class="descname">first_pos_in</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.first_pos_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the position of the first occurrence of self in other,
or None if self is not a factor of other.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first_pos_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;131231&#39;</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first_pos_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;131231&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.foata_bijection">
<tt class="descname">foata_bijection</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.foata_bijection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return word <tt class="docutils literal"><span class="pre">self</span></tt> under the Foata bijection.</p>
<p>The Foata bijection <span class="math">\(\phi\)</span> is a bijection on the set of words
of given content (by a slight generalization of Section 2 in <a class="reference internal" href="../permutation.html#fosc78" id="id6">[FoSc78]</a>).
It can be defined by induction on the size of the word: Given a word
<span class="math">\(w_1 w_2 \cdots w_n\)</span>, start with <span class="math">\(\phi(w_1) = w_1\)</span>. At the <span class="math">\(i\)</span>-th step, if
<span class="math">\(\phi(w_1 w_2 \cdots w_i) = v_1 v_2 \cdots v_i\)</span>, we define
<span class="math">\(\phi(w_1 w_2 \cdots w_i w_{i+1})\)</span> by placing <span class="math">\(w_{i+1}\)</span> on the end of
the word <span class="math">\(v_1 v_2 \cdots v_i\)</span> and breaking the word up into blocks
as follows. If <span class="math">\(w_{i+1} \ge v_i\)</span>, place a vertical line to the right
of each <span class="math">\(v_k\)</span> for which <span class="math">\(w_{i+1} \ge v_k\)</span>. Otherwise, if
<span class="math">\(w_{i+1} &lt; v_i\)</span>, place a vertical line to the right of each <span class="math">\(v_k\)</span>
for which <span class="math">\(w_{i+1} &lt; v_k\)</span>. In either case, place a vertical line at
the start of the word as well. Now, within each block between
vertical lines, cyclically shift the entries one place to the
right.</p>
<p>For instance, to compute <span class="math">\(\phi([4,1,5,4,2,2,3])\)</span>, the sequence of
words is</p>
<ul class="simple">
<li><span class="math">\(4\)</span>,</li>
<li><span class="math">\(|4|1 \to 41\)</span>,</li>
<li><span class="math">\(|4|1|5 \to 415\)</span>,</li>
<li><span class="math">\(|415|4 \to 5414\)</span>,</li>
<li><span class="math">\(|5|4|14|2 \to 54412\)</span>,</li>
<li><span class="math">\(|5441|2|2 \to 154422\)</span>,</li>
<li><span class="math">\(|1|5442|2|3 \to 1254423\)</span>.</li>
</ul>
<p>So <span class="math">\(\phi([4,1,5,4,2,2,3]) = [1,2,5,4,4,2,3]\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../permutation.html#sage.combinat.permutation.Permutation.foata_bijection" title="sage.combinat.permutation.Permutation.foata_bijection"><tt class="xref py py-meth docutils literal"><span class="pre">Foata</span> <span class="pre">bijection</span> <span class="pre">on</span> <span class="pre">Permutations</span></tt></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 112221</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 2122212211</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 1254423</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;121314&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 231114</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1133a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 3113a1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.good_suffix_table">
<tt class="descname">good_suffix_table</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.good_suffix_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table of the maximum skip you can do in order not to miss
a possible occurrence of self in a word.</p>
<p>This is a part of the Boyer-Moore algorithm to find factors. See [1].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">good_suffix_table</span><span class="p">()</span>
<span class="go">[5, 5, 5, 5, 3, 3, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12412&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">good_suffix_table</span><span class="p">()</span>
<span class="go">[3, 3, 3, 3, 3, 1]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] R.S. Boyer, J.S. Moore, A fast string searching algorithm,
Communications of the ACM 20 (1977) 762&#8211;772.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.has_period">
<tt class="descname">has_period</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.has_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self has the period <tt class="docutils literal"><span class="pre">p</span></tt>,
False otherwise.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By convention, integers greater than the length
of self are periods of self.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - an integer to check if it is a period
of self.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.has_prefix">
<tt class="descname">has_prefix</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.has_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <tt class="docutils literal"><span class="pre">self</span></tt> has <tt class="docutils literal"><span class="pre">other</span></tt> as a prefix.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - a word, or data describing a word</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>boolean</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;abbabaabababa&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;abbab&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="s">&quot;abbab&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.has_suffix">
<tt class="descname">has_suffix</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.has_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <tt class="docutils literal"><span class="pre">self</span></tt> has <tt class="docutils literal"><span class="pre">other</span></tt> as a suffix.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some word datatype classes, like <tt class="xref py py-class docutils literal"><span class="pre">WordDatatype_str</span></tt>,
override this method.</p>
</div>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - a word, or data describing a word</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>boolean</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;abbabaabababa&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;ababa&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="s">&quot;ababa&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.implicit_suffix_tree">
<tt class="descname">implicit_suffix_tree</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.implicit_suffix_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the implicit suffix tree of self.</p>
<p>The <em>suffix tree</em> of a word <span class="math">\(w\)</span> is a compactification of the
suffix trie for <span class="math">\(w\)</span>. The compactification removes all nodes that have
exactly one incoming edge and exactly one outgoing edge. It consists of
two components: a tree and a word. Thus, instead of labelling the edges
by factors of <span class="math">\(w\)</span>, we can labelled them by indices of the occurrence of
the factors in <span class="math">\(w\)</span>.</p>
<p>See sage.combinat.words.suffix_trees.ImplicitSuffixTree? for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;cacao&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">implicit_suffix_tree</span><span class="p">()</span>
<span class="go">Implicit Suffix Tree of the word: cacao</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">implicit_suffix_tree</span><span class="p">()</span>
<span class="go">Implicit Suffix Tree of the word: 01011</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.inv_lex_less">
<tt class="descname">inv_lex_less</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.inv_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is inverse lexicographically less than other.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.inversions">
<tt class="descname">inversions</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.inversions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the inversions of self. An inversion is a pair
(i,j) of non-negative integers i &lt; j such that self[i] &gt; self[j].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[1, 5], [2, 3], [2, 4], [2, 5], [3, 5], [4, 5]]</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[0, 1], [0, 2], [0, 3], [0, 4], [1, 2]]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[1, 3], [1, 5], [2, 3], [2, 5], [4, 5]]</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;ba&#39;</span><span class="p">)(</span><span class="s">&#39;abbaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[0, 1], [0, 2], [0, 4], [3, 4]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_balanced">
<tt class="descname">is_balanced</tt><big>(</big><em>q=1</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_balanced" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is <span class="math">\(q\)</span>-balanced, and False otherwise.</p>
<p>A finite or infinite word <span class="math">\(w\)</span> is said to be <span class="math">\(q\)</span>-<em>balanced</em> if for
any two factors <span class="math">\(u\)</span>, <span class="math">\(v\)</span> of <span class="math">\(w\)</span> of the same length, the difference
between the number of <span class="math">\(x\)</span>&#8216;s in each of <span class="math">\(u\)</span> and <span class="math">\(v\)</span> is at most <span class="math">\(q\)</span>
for all letters <span class="math">\(x\)</span> in the alphabet of <span class="math">\(w\)</span>. A <span class="math">\(1\)</span>-balanced word is
simply said to be balanced. See for instance [1] and Chapter 2 of
[2].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">q</span></tt> - integer (default 1), the balance level</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>boolean &#8211; the result</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1122&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121333121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121333121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121333121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121122121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121122121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121122121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the balance level must be a positive integer</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121122121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the balance level must be a positive integer</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121122121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the balance level must be a positive integer</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] J. Cassaigne, S. Ferenczi, L.Q. Zamboni, Imbalances in
Arnoux-Rauzy sequences, Ann. Inst. Fourier (Grenoble) 50 (2000)
1265&#8211;1276.</li>
<li>[2] M. Lothaire, Algebraic Combinatorics On Words, vol. 90 of
Encyclopedia of Mathematics and its Applications, Cambridge
University Press, U.K., 2002.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_cadence">
<tt class="descname">is_cadence</tt><big>(</big><em>seq</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_cadence" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if seq is a cadence of self, and False otherwise.</p>
<p>A <em>cadence</em> is an increasing sequence of indexes that all map to
the same letter.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121132123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cadence</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121132123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cadence</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121132123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cadence</span><span class="p">([])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_christoffel">
<tt class="descname">is_christoffel</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_christoffel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a Christoffel word, and False otherwise.</p>
<p>The <em>Christoffel word</em> of slope <span class="math">\(p/q\)</span> is obtained from the Cayley 
graph of <span class="math">\(\ZZ/(p+q)\ZZ\)</span> with generator q as follows. If <span class="math">\(u 
\rightarrow v\)</span> is an edge in the Cayley graph, then, <span class="math">\(v = u + p 
\mod{p+q}\)</span>. Let <span class="math">\(a\)</span>,`b` be the alphabet of <span class="math">\(w\)</span>. Label the edge 
<span class="math">\(u \rightarrow v\)</span> by <span class="math">\(a\)</span> if u &lt; v and <span class="math">\(b\)</span> otherwise. The Christoffel 
word is the word obtained by reading the edge labels along the cycle 
beginning from 0.</p>
<p>Equivalently, <span class="math">\(w\)</span> is a Christoffel word iff <span class="math">\(w\)</span> is a symmetric 
non-empty word and <span class="math">\(w[1:n-1]\)</span> is a palindrome.</p>
<p>See for instance <a class="footnote-reference" href="#id9" id="id7">[1]</a> and <a class="footnote-reference" href="#id10" id="id8">[2]</a>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">self</span></tt> &#8211; word</p>
<p>OUTPUT:</p>
<p>Boolean &#8211; <tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is a Christoffel word, 
<tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;00100101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123123123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;00100&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">LowerChristoffelWord</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">UpperChristoffelWord</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaaaaaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[1]</a></td><td>Jean Berstel. Sturmian and episturmian words (a survey of
some recent results). In S. Bozapalidis and G. Rahonis, editors,
CAI 2007,volume 4728 of Lecture Notes in Computer Science, 
pages 23-47. Springer-Verlag, 2007.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[2]</a></td><td>J. Berstel, A. Lauve, C. R., F. Saliola, Combinatorics on
words: Christoffel words and repetitions in words, CRM Monograph 
Series, 27. American Mathematical Society, Providence, RI, 2009. 
xii+147 pp. ISBN: 978-0-8218-4480-9</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_conjugate_with">
<tt class="descname">is_conjugate_with</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_conjugate_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a conjugate of other, and False otherwise.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - a finite word</li>
</ul>
<p>OUPUT</p>
<p>bool</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mf">0.</span><span class="o">.</span><span class="mi">20</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mf">7.</span><span class="o">.</span><span class="mi">20</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">word: 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">word: 7,8,9,10,11,12,13,14,15,16,17,18,19,20,0,1,2,3,4,5,6</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Both words must be finite:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">length</span><span class="o">=</span><span class="s">&#39;unknown&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="c">#TODO: Not implemented for word of unknown length</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">wf</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">length</span><span class="o">=</span><span class="s">&#39;finite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">wf</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;11213&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;31121&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;112131&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;11213&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12131&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;11213&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We make sure that <a class="reference external" href="http://trac.sagemath.org/11128">trac ticket #11128</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaba&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaa&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_cube">
<tt class="descname">is_cube</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a cube, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;012012012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01010101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;012012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_cube_free">
<tt class="descname">is_cube_free</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_cube_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self does not contain cubes, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;32221&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We make sure that <a class="reference external" href="http://trac.sagemath.org/8490">trac ticket #8490</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;2111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;32111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_empty">
<tt class="descname">is_empty</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the length of self is zero, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([])</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_factor">
<tt class="descname">is_factor</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a factor of other, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;2113&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;123121332131233121132123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;321&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1231241231312312312&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The empty word is factor of another word:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span><span class="n">n</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_finite">
<tt class="descname">is_finite</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_finite" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([])</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_full">
<tt class="descname">is_full</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self has defect 0, and False otherwise.</p>
<p>A word is <em>full</em> (or <em>rich</em>) if its defect is zero (see [1]).
If <tt class="docutils literal"><span class="pre">f</span></tt> is given, then the f-palindromic defect is used (see [2]).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div><dl class="docutils">
<dt>boolean &#8211; If f is None, whether self is full;</dt>
<dd>otherwise, whether self is full of <span class="math">\(f\)</span>-palindromes.</dd>
</dl>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;000000000000000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;011010011001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;2194&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A simple example of an infinite word full of f-palindromes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;abc&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;ab&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">50</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">150</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] S. Brlek, S. Hamel, M. Nivat, C. Reutenauer, On the Palindromic
Complexity of Infinite Words, in J. Berstel, J. Karhumaki,
D. Perrin, Eds, Combinatorics on Words with Applications,
International Journal of Foundation of Computer Science, Vol. 15,
No. 2 (2004) 293&#8211;306.</li>
<li>[2] E. Pelantová, Š. Starosta, Infinite words rich and almost rich
in generalized palindromes, in: G. Mauri, A. Leporati (Eds.),
Developments in Language Theory, volume 6795 of Lecture Notes
in Computer Science, Springer-Verlag, Berlin, Heidelberg, 2011,
pp. 406&#8211;416</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_lyndon">
<tt class="descname">is_lyndon</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_lyndon" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is a Lyndon word, and <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise.</p>
<p>A <em>Lyndon word</em> is a non-empty word that is lexicographically
smaller than each of its proper suffixes (for the given order
on its alphabet). That is, <span class="math">\(w\)</span> is a Lyndon word if <span class="math">\(w\)</span> is non-empty
and for each factorization <span class="math">\(w = uv\)</span> (with <span class="math">\(u\)</span>, <span class="math">\(v\)</span> both non-empty),
we have <span class="math">\(w &lt; v\)</span>.</p>
<p>Equivalently, <span class="math">\(w\)</span> is a Lyndon word iff <span class="math">\(w\)</span> is a non-empty word that is
lexicographically smaller than each of its proper conjugates for the
given order on its alphabet.</p>
<p>See for instance [1].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123132133&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;122112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>A sanity check: <tt class="docutils literal"><span class="pre">LyndonWords</span></tt> generates Lyndon words, so we
filter all words of length <span class="math">\(n&lt;10\)</span> on the alphabet [1,2,3] for
Lyndon words, and compare with the <tt class="docutils literal"><span class="pre">LyndonWords</span></tt> generator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<span class="go">....:     lw1 = [w for w in Words([1,2,3], n) if w.is_lyndon()]</span>
<span class="go">....:     lw2 = LyndonWords(3,n)</span>
<span class="go">....:     if set(lw1) != set(lw2): print False</span>
</pre></div>
</div>
<p>Filter all words of length 8 on the alphabet [c,a,b] for Lyndon
words, and compare with the <a class="reference internal" href="../lyndon_word.html#sage.combinat.lyndon_word.LyndonWords" title="sage.combinat.lyndon_word.LyndonWords"><tt class="xref py py-class docutils literal"><span class="pre">LyndonWords</span></tt></a> generator after
mapping [a,b,c] to [2,3,1]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lw</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;cab&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">lw</span><span class="p">))</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">LyndonWords</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Lothaire, Combinatorics On Words, vol. 17 of Encyclopedia
of Mathematics and its Applications, Addison-Wesley, Reading,
Massachusetts, 1983.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_overlap">
<tt class="descname">is_overlap</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is an overlap, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1231231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_palindrome">
<tt class="descname">is_palindrome</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_palindrome" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a palindrome (or a <span class="math">\(f\)</span>-palindrome), and
False otherwise.</p>
<p>Let <span class="math">\(f : \Sigma \rightarrow \Sigma\)</span> be an involution that extends
to a morphism on <span class="math">\(\Sigma^*\)</span>. We say that <span class="math">\(w\in\Sigma^*\)</span> is a
<em>`f`-palindrome</em> if <span class="math">\(w=f(\tilde{w})\)</span> [1]. Also called
<em>`f`-pseudo-palindrome</em> [2].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: <tt class="docutils literal"><span class="pre">None</span></tt>) on the alphabet of self. It
must be callable on letters as well as words (e.g.
<a class="reference internal" href="morphism.html#sage.combinat.words.morphism.WordMorphism" title="sage.combinat.words.morphism.WordMorphism"><tt class="xref py py-class docutils literal"><span class="pre">WordMorphism</span></tt></a>). The
default value corresponds to usual palindromes, i.e., <span class="math">\(f\)</span> equal to
the identity.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;esope reste ici et se repose&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;esoperesteicietserepose&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;I saw I was I&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbcbba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcbdba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Some <span class="math">\(f\)</span>-palindromes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aababb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abacbacbab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aababb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">8</span><span class="p">];</span> <span class="n">w</span>
<span class="go">word: 01101001</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The word must be in the domain of the involution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aababb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">&#39;b&#39;</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>If the given involution is not an involution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">self (=a-&gt;b, b-&gt;b) is not an endomorphism</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Word</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">()</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;aba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">()</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;aba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">(</span><span class="s">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] S. Labbé, Propriétés combinatoires des <span class="math">\(f\)</span>-palindromes,
Mémoire de maîtrise en Mathématiques, Montréal, UQAM, 2008,
109 pages.</li>
<li>[2] V. Anne, L.Q. Zamboni, I. Zorca, Palindromes and Pseudo-
Palindromes in Episturmian and Pseudo-Palindromic Infinite Words,
in : S. Brlek, C. Reutenauer (Eds.), Words 2005, Publications du
LaCIM, Vol. 36 (2005) 91&#8211;100.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_prefix">
<tt class="descname">is_prefix</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a prefix of other, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;0123456789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;012345&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_primitive">
<tt class="descname">is_primitive</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is primitive, and False otherwise.</p>
<p>A finite word <span class="math">\(w\)</span> is <em>primitive</em> if it is not a positive integer
power of a shorter word.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_proper_prefix">
<tt class="descname">is_proper_prefix</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_proper_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a proper prefix of other, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_proper_suffix">
<tt class="descname">is_proper_suffix</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_proper_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a proper suffix of other, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;23&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_quasiperiodic">
<tt class="descname">is_quasiperiodic</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_quasiperiodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is quasiperiodic, and False otherwise.</p>
<p>A finite or infinite word <span class="math">\(w\)</span> is <em>quasiperiodic</em> if it can be
constructed by concatenations and superpositions of one of its proper
factors <span class="math">\(u\)</span>, which is called a <em>quasiperiod</em> of <span class="math">\(w\)</span>.
See for instance [1], [2], and [3].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaababaabaababaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abacaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] A. Apostolico, A. Ehrenfeucht, Efficient detection of
quasiperiodicities in strings, Theoret. Comput. Sci. 119 (1993)
247&#8211;265.</li>
<li>[2] S. Marcus, Quasiperiodic infinite words, Bull. Eur. Assoc.
Theor. Comput. Sci. 82 (2004) 170-174.</li>
<li>[3] A. Glen, F. Levé, G. Richomme, Quasiperiodic and Lyndon
episturmian words, Preprint, 2008, arXiv:0805.0730.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_rich">
<tt class="descname">is_rich</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_rich" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self has defect 0, and False otherwise.</p>
<p>A word is <em>full</em> (or <em>rich</em>) if its defect is zero (see [1]).
If <tt class="docutils literal"><span class="pre">f</span></tt> is given, then the f-palindromic defect is used (see [2]).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div><dl class="docutils">
<dt>boolean &#8211; If f is None, whether self is full;</dt>
<dd>otherwise, whether self is full of <span class="math">\(f\)</span>-palindromes.</dd>
</dl>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;000000000000000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;011010011001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;2194&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A simple example of an infinite word full of f-palindromes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;abc&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;ab&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">50</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">150</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] S. Brlek, S. Hamel, M. Nivat, C. Reutenauer, On the Palindromic
Complexity of Infinite Words, in J. Berstel, J. Karhumaki,
D. Perrin, Eds, Combinatorics on Words with Applications,
International Journal of Foundation of Computer Science, Vol. 15,
No. 2 (2004) 293&#8211;306.</li>
<li>[2] E. Pelantová, Š. Starosta, Infinite words rich and almost rich
in generalized palindromes, in: G. Mauri, A. Leporati (Eds.),
Developments in Language Theory, volume 6795 of Lecture Notes
in Computer Science, Springer-Verlag, Berlin, Heidelberg, 2011,
pp. 406&#8211;416</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_smooth_prefix">
<tt class="descname">is_smooth_prefix</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_smooth_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is the prefix of a smooth word, and False
otherwise.</p>
<p>Let <span class="math">\(A_k = \{1, \ldots ,k\}\)</span>, <span class="math">\(k \geq 2\)</span>. An infinite word <span class="math">\(w\)</span> in
<span class="math">\(A_k^\omega\)</span> is said to be <em>smooth</em> if and only if for all positive
integers <span class="math">\(m\)</span>, <span class="math">\(\Delta^m(w)\)</span> is in <span class="math">\(A_k^\omega\)</span>, where <span class="math">\(\Delta(w)\)</span> is
the word obtained from <span class="math">\(w\)</span> by composing the length of consecutive
runs of the same letter in <span class="math">\(w\)</span>. See for instance [1] and [2].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - must be a word over the integers to get something other
than False</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>boolean &#8211; whether self is a smooth prefix or not</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_smooth_prefix</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">is_smooth_prefix</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] S. Brlek, A. Ladouceur, A note on differentiable palindromes,
Theoret. Comput. Sci. 302 (2003) 167&#8211;178.</li>
<li>[2] S. Brlek, S. Dulucq, A. Ladouceur, L. Vuillon, Combinatorial
properties of smooth infinite words, Theoret. Comput. Sci. 352
(2006) 306&#8211;317.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_square">
<tt class="descname">is_square</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a square, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_square_free">
<tt class="descname">is_square_free</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_square_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self does not contain squares, and False
otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;31212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We make sure that <a class="reference external" href="http://trac.sagemath.org/8490">trac ticket #8490</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;3211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_sturmian_factor">
<tt class="descname">is_sturmian_factor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_sturmian_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Tells whether <tt class="docutils literal"><span class="pre">self</span></tt> is a factor of a Sturmian word.</p>
<p>The finite word <tt class="docutils literal"><span class="pre">self</span></tt> must be defined on a two-letter alphabet.</p>
<p>Equivalently, tells whether <tt class="docutils literal"><span class="pre">self</span></tt> is balanced. The
advantage over the is_balanced method is that this one runs in
linear time whereas is_balanced runs in quadratic time.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>boolean &#8211; the result.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;0111011011011101101&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;01&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">LowerMechanicalWord</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;01&#39;</span><span class="p">)[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">CharacteristicSturmianWord</span><span class="p">(</span><span class="n">random</span><span class="p">())[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;ab,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;ba,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s3</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;a,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s4</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;a,b-&gt;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span> <span class="n">w</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">,</span><span class="n">s4</span><span class="p">])(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">word: abaaabaaabaabaaabaaabaabaaabaabaaabaaaba...</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Famous words:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">KolakoskiWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="arn2002" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Arn2002]</td><td>P. Arnoux, Sturmian sequences, in Substitutions in Dynamics,
N. Pytheas Fogg (Ed.), Arithmetics, and Combinatorics (Lecture
Notes in Mathematics, Vol. 1794), 2002.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ser1985" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Ser1985]</td><td>C. Series. The geometry of Markoff numbers. The Mathematical
Intelligencer, 7(3):20–29, 1985.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="su2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[SU2009]</td><td>J. Smillie and C. Ulcigrai. Symbolic coding for linear
trajectories in the regular octagon, <a class="reference external" href="http://arxiv.org/abs/0905.0871">Arxiv 0905.0871</a>, 2009.</td></tr>
</tbody>
</table>
<p>AUTHOR:</p>
<ul class="simple">
<li>Thierry Monteil</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_subword_of">
<tt class="descname">is_subword_of</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_subword_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True is self is a subword of other, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;3211333213233321&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;11122212112122133111222332&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword" title="sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword"><tt class="xref py py-meth docutils literal"><span class="pre">longest_common_subword()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_suffix">
<tt class="descname">is_suffix</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if w is a suffix of other, and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;0123456789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;56789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;579&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_symmetric">
<tt class="descname">is_symmetric</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is symmetric (or <span class="math">\(f\)</span>-symmetric), and
False otherwise.</p>
<p>A word is <em>symmetric</em> (resp. <span class="math">\(f\)</span>-<em>symmetric</em>) if it is the
product of two palindromes (resp. <span class="math">\(f\)</span>-palindromes). See [1] and [2].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aababaabba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabbbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabbbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] S. Brlek, S. Hamel, M. Nivat, C. Reutenauer, On the Palindromic
Complexity of Infinite Words, in J. Berstel, J. Karhumaki,
D. Perrin, Eds, Combinatorics on Words with Applications,
International Journal of Foundation of Computer Science, Vol. 15,
No. 2 (2004) 293&#8211;306.</li>
<li>[2] A. de Luca, A. De Luca, Pseudopalindrome closure operators
in free monoids, Theoret. Comput. Sci. 362 (2006) 282&#8211;300.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.is_tangent">
<tt class="descname">is_tangent</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_tangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Tells whether <tt class="docutils literal"><span class="pre">self</span></tt> is a tangent word.</p>
<p>The finite word <tt class="docutils literal"><span class="pre">self</span></tt> must be defined on a two-letter alphabet.</p>
<p>A binary word is said to be <em>tangent</em> if it can appear in
infintely many cutting sequences of a smooth curve, where each
cutting sequence is observed on a progressively smaller grid.</p>
<p>This class of words strictly contains the class of 1-balanced
words, and is strictly contained in the class of 2-balanced words.</p>
<p>This method runs in linear time.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>boolean &#8211; the result.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;01110110110111011101&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;01&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some tangent words may not be balanced:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some 2-balanced words may not be tangent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Famous words:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">KolakoskiWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="mon2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Mon2010]</td><td>T. Monteil, The asymptotic language of smooth curves, talk
at LaCIM2010.</td></tr>
</tbody>
</table>
<p>AUTHOR:</p>
<ul class="simple">
<li>Thierry Monteil</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.iterated_left_palindromic_closure">
<tt class="descname">iterated_left_palindromic_closure</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.iterated_left_palindromic_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the iterated left (<span class="math">\(f\)</span>-)palindromic closure of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> &#8211; involution (default: <tt class="docutils literal"><span class="pre">None</span></tt>) on the alphabet of <tt class="docutils literal"><span class="pre">self</span></tt>.
It must be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<p>word &#8211; the left iterated <span class="math">\(f\)</span>-palindromic closure of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterated_left_palindromic_closure</span><span class="p">()</span>
<span class="go">word: 3231323</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterated_left_palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbaab</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterated_left_palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbaabbaab</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>If <tt class="docutils literal"><span class="pre">f</span></tt> is not a involution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterated_left_palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">self (=a-&gt;b, b-&gt;b) is not an endomorphism</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>A. de Luca, A. De Luca, Pseudopalindrome closure operators
in free monoids, Theoret. Comput. Sci. 362 (2006) 282&#8211;300.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.lacunas">
<tt class="descname">lacunas</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lacunas" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of all the lacunas of self.</p>
<p>A <em>lacuna</em> is a position in a word where the longest (<span class="math">\(f\)</span>-)palindromic
suffix is not unioccurrent (see [1]).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism). The
default value corresponds to usual palindromes, i.e., <span class="math">\(f\)</span> equal to
the identity.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list &#8211; list of all the lacunas of self.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lacunas</span><span class="p">()</span>
<span class="go">[7, 9]</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">lacunas</span><span class="p">()</span>
<span class="go">[8, 9, 24, 25, 32, 33, 34, 35, 36, 37, 38, 39, 96, 97, 98, 99]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">lacunas</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 2, 4, 12, 16, 17, 18, 19, 48, 49]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] A. Blondin-Massé, S. Brlek, S. Labbé, Palindromic lacunas
of the Thue-Morse word, Proc. GASCOM 2008 (June 16-20 2008,
Bibbiena, Arezzo-Italia), 53&#8211;67.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.last_position_dict">
<tt class="descname">last_position_dict</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.last_position_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary that contains the last position of each letter
in self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1231232&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">last_position_dict</span><span class="p">()</span>
<span class="go">{&#39;1&#39;: 3, &#39;2&#39;: 6, &#39;3&#39;: 5}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.left_special_factors">
<tt class="descname">left_special_factors</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.left_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the left special factors (of length n).</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>left special</em> if there are
two distinct letters <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such that <span class="math">\(au\)</span> and <span class="math">\(bu\)</span>
are factors of <span class="math">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer (optional, default: <tt class="docutils literal"><span class="pre">None</span></tt>). If <tt class="docutils literal"><span class="pre">None</span></tt>, it
returns all left special factors.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of words.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.294</span><span class="p">,</span> <span class="mf">0.1415</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">CodingOfRotationWord</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="go">0 [word: ]</span>
<span class="go">1 [word: 0]</span>
<span class="go">2 [word: 00, word: 01]</span>
<span class="go">3 [word: 000, word: 010]</span>
<span class="go">4 [word: 0000, word: 0101]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.left_special_factors_iterator">
<tt class="descname">left_special_factors_iterator</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.left_special_factors_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the left special factors (of length n).</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>left special</em> if there are
two distinct letters <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such that <span class="math">\(au\)</span> and <span class="math">\(bu\)</span>
are factors of <span class="math">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer (optional, default: None). If None, it returns
an iterator over all left special factors.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.294</span><span class="p">,</span> <span class="mf">0.1415</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">CodingOfRotationWord</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors_iterator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[word: 000, word: 010]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[word: 0000, word: 0101]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors_iterator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[word: 00000, word: 01010]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.length">
<tt class="descname">length</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of self.</p>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.words.word</span> <span class="kn">import</span> <span class="n">Word_class</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s">&#39;abba&#39;</span><span class="o">*</span><span class="mi">40</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s">&quot;finite&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">_len</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
<span class="go">160</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s">&#39;abba&#39;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">_len</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.length_border">
<tt class="descname">length_border</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.length_border" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of the border of self.</p>
<p>The <em>border</em> of a word is the longest word that is both a proper
prefix and a proper suffix of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.length_maximal_palindrome">
<tt class="descname">length_maximal_palindrome</tt><big>(</big><em>j</em>, <em>m=None</em>, <em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.length_maximal_palindrome" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of the longest palindrome centered at position j.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">j</span></tt> &#8211; rational, position of the symmetry axis of the palindrome.
Must return an integer when doubled. It is an integer when the
center of the palindrome is a letter.</li>
<li><tt class="docutils literal"><span class="pre">m</span></tt> &#8211; integer (default: None), minimal length of palindrome, if known.
The parity of <tt class="docutils literal"><span class="pre">m</span></tt> can&#8217;t be the same as the parity of <tt class="docutils literal"><span class="pre">2j</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">f</span></tt> &#8211; involution (default: None), on the alphabet. It must be
callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>The length of the longest <span class="math">\(f\)</span>-palindrome centered at position j.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01001010&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01010&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s">&#39;0-&gt;1,1-&gt;0&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01010&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s">&#39;0-&gt;1,1-&gt;0&#39;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0222220&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s">&#39;0-&gt;1,1-&gt;0,2-&gt;2&#39;</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abcdcbaxyzzyx&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">9.5</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>These are wrong inputs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">9.6</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">j must be positive, inferior to length of self</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(2*j-m-1)/2(=3/2) must be an integer, i.e., 2*j(=6) and</span>
<span class="go">m(=2) can&#39;t have the same parity</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(2*j-m-1)/2(=15/2) must be an integer, i.e., 2*j(=19) and</span>
<span class="go">m(=3) can&#39;t have the same parity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.lengths_lps">
<tt class="descname">lengths_lps</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lengths_lps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of the length of the longest palindromic
suffix (lps) for each non-empty prefix of self.</p>
<p>It corresponds to the function <span class="math">\(G_w\)</span> defined in [1].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div><dl class="docutils">
<dt>list &#8211; list of the length of the longest palindromic</dt>
<dd>suffix (lps) for each non-empty prefix of self.</dd>
</dl>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">lengths_lps</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_lps</span><span class="p">()</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_lps</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaabbaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_lps</span><span class="p">()</span>
<span class="go">[1, 1, 2, 4, 3, 3, 2, 4, 2, 4, 6, 8]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaabbaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_lps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 2, 0, 2, 2, 4, 6, 8, 4, 6, 4, 6]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">5</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span><span class="mi">8</span><span class="p">:[</span><span class="mi">5</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">lengths_lps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 2, 2, 0, 2, 4, 6, 4, 6, 8, 10, 12, 4]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] A. Blondin-Massé, S. Brlek, A. Frosini, S. Labbé,
S. Rinaldi, Reconstructing words from a fixed palindromic length
sequence, Proc. TCS 2008, 5th IFIP International Conference on
Theoretical Computer Science (September 8-10 2008, Milano,
Italia), accepted.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.lengths_maximal_palindromes">
<tt class="descname">lengths_maximal_palindromes</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lengths_maximal_palindromes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of maximal palindromes centered at each position.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list &#8211; The length of the maximal palindrome (or <span class="math">\(f\)</span>-palindrome)
with a given symmetry axis (letter or space between two letters).</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0, 1, 0, 1, 4, 1, 0, 3, 0, 3, 0, 1, 4, 1, 0, 1, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;00000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 4, 3, 2, 1, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0, 1, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 0, 2, 0, 0, 0, 2, 0, 8, 0, 2, 0, 0, 0, 2, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.lengths_unioccurrent_lps">
<tt class="descname">lengths_unioccurrent_lps</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lengths_unioccurrent_lps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of the lengths of the unioccurrent longest
(<span class="math">\(f\)</span>)-palindromic suffixes (lps) for each non-empty prefix of self. No
unioccurrent lps are indicated by None.</p>
<p>It corresponds to the function <span class="math">\(H_w\)</span> defined in [1] and [2].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism). The
default value corresponds to usual palindromes, i.e., <span class="math">\(f\)</span> equal to
the identity.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div><dl class="docutils">
<dt>list &#8211; list of the length of the unioccurrent longest palindromic</dt>
<dd>suffix (lps) for each non-empty prefix of self.
No unioccurrent lps are indicated by None.</dd>
</dl>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">()</span>
<span class="go">[1, 1, 2, 1, 1, 1, 1, None, 1, None]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">lengths_lps</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">()</span>
<span class="go">[1, 1, 2, 4, 3, 3, 2, 4, None, None, 6, 8, 10, 12, 14, 16, 6, 8, 10, 12]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[None, 2, None, 2, None, 4, 6, 8, 4, 6, 4, 6, None, 4, 6]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] A. Blondin-Massé, S. Brlek, S. Labbé, Palindromic lacunas of
the Thue-Morse word, Proc. GASCOM 2008 (June 16-20 2008, Bibbiena,
Arezzo-Italia), 53&#8211;67.</li>
<li>[2] A. Blondin-Massé, S. Brlek, A. Frosini, S. Labbé, S. Rinaldi,
Reconstructing words from a fixed palindromic length sequence,
Proc. TCS 2008, 5th IFIP International Conference on Theoretical
Computer Science (September 8-10 2008, Milano, Italia), accepted.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.letters">
<tt class="descname">letters</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.letters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of letters that appear in this word, listed in the
order of first appearance.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">letters</span><span class="p">()</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;cacao&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">letters</span><span class="p">()</span>
<span class="go">[&#39;c&#39;, &#39;a&#39;, &#39;o&#39;]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">letters</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword">
<tt class="descname">longest_common_subword</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a longest subword of <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>A subword of a word is a subset of the word&#8217;s letters, read in the
order in which they appear in the word.</p>
<p>For more information, see
<a class="reference external" href="https://en.wikipedia.org/wiki/Longest_common_subsequence_problem">Wikipedia article Longest_common_subsequence_problem</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; a word</li>
</ul>
<p>ALGORITHM:</p>
<p>For any indices <span class="math">\(i,j\)</span>, we compute the longest common subword <tt class="docutils literal"><span class="pre">lcs[i,j]</span></tt> of
<span class="math">\(self[:i]\)</span> and <span class="math">\(other[:j]\)</span>. This can be easily obtained as the longest
of</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">lcs[i-1,j]</span></tt></li>
<li><tt class="docutils literal"><span class="pre">lcs[i,j-1]</span></tt></li>
<li><tt class="docutils literal"><span class="pre">lcs[i-1,j-1]+self[i]</span></tt> if <tt class="docutils literal"><span class="pre">self[i]==other[j]</span></tt></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;ace&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v1</span><span class="o">.</span><span class="n">longest_common_subword</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="go">word: ac</span>

<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;1010101010101010101010101010101010101010&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;0011001100110011001100110011001100110011&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">.</span><span class="n">longest_common_subword</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span>
<span class="go">word: 00110011001100110011010101010</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">longest_common_subword</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">word:</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.is_subword_of" title="sage.combinat.words.finite_word.FiniteWord_class.is_subword_of"><tt class="xref py py-meth docutils literal"><span class="pre">is_subword_of()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.longest_common_suffix">
<tt class="descname">longest_common_suffix</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_common_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the longest common suffix of self and other.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;112345678&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1115678&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">word: 5678</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">word: 1115678</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">word: 5678</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">word: 112345678</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;549332345&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">word:</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>With the empty word:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">word:</span>
</pre></div>
</div>
<p>With an infinite word:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">other must be a finite word</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.lps">
<tt class="descname">lps</tt><big>(</big><em>f=None</em>, <em>l=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the longest palindromic (or <span class="math">\(f\)</span>-palindromic) suffix of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
<li><tt class="docutils literal"><span class="pre">l</span></tt> - integer (default: None) the length of the longest palindrome
suffix of self[:-1], if known.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div><dl class="docutils">
<dt>word &#8211; If f is None, the longest palindromic suffix of self;</dt>
<dd>otherwise, the longest f-palindromic suffix of self.</dd>
</dl>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 111</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;011101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 101</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;6667&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 7</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: baab</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;33412321&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">word: 12321</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Word</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="s">&#39;01101001&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 1001</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 1001</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">word: 1001</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">()</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">IndexError</span>: <span class="n">list index out of range</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">pal</span><span class="o">.</span><span class="n">length</span><span class="p">())</span>
<span class="gp">... </span>    <span class="n">pal</span>
<span class="gp">...</span>
<span class="go">word: a</span>
<span class="go">word: b</span>
<span class="go">word: bb</span>
<span class="go">word: abba</span>
<span class="go">word: bab</span>
<span class="go">word: aba</span>
<span class="go">word: aa</span>
<span class="go">word: baab</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="n">pal</span><span class="o">.</span><span class="n">length</span><span class="p">())</span>
<span class="gp">... </span>    <span class="n">pal</span>
<span class="gp">...</span>
<span class="go">word:</span>
<span class="go">word: ab</span>
<span class="go">word:</span>
<span class="go">word: ba</span>
<span class="go">word: ab</span>
<span class="go">word: baba</span>
<span class="go">word: bbabaa</span>
<span class="go">word: abbabaab</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.lps_lengths">
<tt class="descname">lps_lengths</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lps_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of the longest palindromic suffix of each prefix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list &#8211; The length of the longest palindromic (or <span class="math">\(f\)</span>-palindromic)
suffix of each prefix of self.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0, 1, 1, 2, 4, 3, 3, 2, 4]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;00000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 0, 2, 0, 2, 2, 4, 6, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.lyndon_factorization">
<tt class="descname">lyndon_factorization</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lyndon_factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Lyndon factorization of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>The <em>Lyndon factorization</em> of a finite word <span class="math">\(w\)</span> is the unique
factorization of <span class="math">\(w\)</span> as a non-increasing product of Lyndon words,
i.e., <span class="math">\(w = l_1\cdots l_n\)</span> where each <span class="math">\(l_i\)</span> is a Lyndon word and
<span class="math">\(l_1\geq \cdots \geq l_n\)</span>. See for instance [1].</p>
<p>OUTPUT:</p>
<p>the list <span class="math">\([l_1, \ldots, l_n]\)</span> of factors obtained</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;010010010001000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(01, 001, 001, 0001, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;10&#39;</span><span class="p">)(</span><span class="s">&#39;010010010001000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(0, 10010010001000)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbababbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(abb, ababb, aababb, a)</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;ba&#39;</span><span class="p">)(</span><span class="s">&#39;abbababbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(a, bbababbaaba, bba)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(1213, 12, 1)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;01&#39;</span><span class="p">)(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(01)</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;10&#39;</span><span class="p">)(</span><span class="s">&#39;01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">lynfac</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbababbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lynfac</span><span class="p">]</span>
<span class="go">[True, True, True, True]</span>
<span class="gp">sage: </span><span class="n">lynfac</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ba&#39;</span><span class="p">)(</span><span class="s">&#39;abbababbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lynfac</span><span class="p">]</span>
<span class="go">[True, True, True]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">==</span> <span class="n">prod</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] J.-P. Duval, Factorizing words over an ordered alphabet,
J. Algorithms 4 (1983) 363&#8211;381.</li>
<li>[2] G. Melancon, Factorizing infinite words using Maple,
MapleTech journal, vol. 4, no. 1, 1997, pp. 34-42.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.major_index">
<tt class="descname">major_index</tt><big>(</big><em>final_descent=False</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.major_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the major index of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>The major index of a word <span class="math">\(w\)</span> is the sum of the descents of <span class="math">\(w\)</span>.</p>
<p>With the <tt class="docutils literal"><span class="pre">final_descent</span></tt> option, the last position of a
non-empty word is also considered as a descent.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../permutation.html#sage.combinat.permutation.Permutation.major_index" title="sage.combinat.permutation.Permutation.major_index"><tt class="xref py py-meth docutils literal"><span class="pre">major</span> <span class="pre">index</span> <span class="pre">on</span> <span class="pre">Permutations</span></tt></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">major_index</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">major_index</span><span class="p">(</span><span class="n">final_descent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.minimal_period">
<tt class="descname">minimal_period</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.minimal_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the period of self.</p>
<p>Let <span class="math">\(A\)</span> be an alphabet. An integer <span class="math">\(p\geq 1\)</span> is a <em>period</em> of a
word <span class="math">\(w=a_1a_2\cdots a_n\)</span> where <span class="math">\(a_i\in A\)</span> if <span class="math">\(a_i=a_{i+p}\)</span> for
<span class="math">\(i=1,\ldots,n-p\)</span>. The smallest period of <span class="math">\(w\)</span> is called <em>the</em>
period of <span class="math">\(w\)</span>. See Chapter 1 of [1].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababac&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Lothaire, Algebraic Combinatorics On Words, vol. 90 of
Encyclopedia of Mathematics and its Applications, Cambridge
University Press, U.K., 2002.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.nb_factor_occurrences_in">
<tt class="descname">nb_factor_occurrences_in</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.nb_factor_occurrences_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of times self appears as a factor
in other.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">nb_factor_occurrences_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">The factor must be non empty</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nb_factor_occurrences_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;112332312313112332121123&#39;</span><span class="p">))</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nb_factor_occurrences_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;11233231231311233221123&#39;</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.nb_subword_occurrences_in">
<tt class="descname">nb_subword_occurrences_in</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.nb_subword_occurrences_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of times self appears in other as a subword.</p>
<p>This corresponds to the notion of <span class="math">\(binomial coefficient\)</span> of two
finite words whose properties are presented in the chapter of
Lothaire&#8217;s book written by Sakarovitch and Simon [1].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; finite word</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">tm</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">tm</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
<span class="go">2604124996</span>

<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">tm</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
<span class="go">20370432</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This code, based on [2], actually compute the number of
occurrences of all prefixes of <tt class="docutils literal"><span class="pre">self</span></tt> as subwords in all
prefixes of <tt class="docutils literal"><span class="pre">other</span></tt>.  In particular, its complexity is
bounded by <tt class="docutils literal"><span class="pre">len(self)</span> <span class="pre">*</span> <span class="pre">len(other)</span></tt>.</p>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1133432311132311112&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;4321&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1132231112233212342231112&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;3&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;122332112321213&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([]),</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Lothaire, Combinatorics on Words, Cambridge University
Press, (1997).</li>
<li>[2] Mateescu, A., Salomaa, A., Salomaa, K. and Yu, S., A
sharpening of the Parikh mapping. Theoret. Informatics Appl. 35
(2001) 551-564.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.number_of_factors">
<tt class="descname">number_of_factors</tt><big>(</big><em>n=None</em>, <em>algorithm='suffix tree'</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of distinct factors of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer, or None.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - string (default: <tt class="docutils literal"><span class="pre">'suffix</span> <span class="pre">tree'</span></tt>), takes the
following values:<ul>
<li><tt class="docutils literal"><span class="pre">'suffix</span> <span class="pre">tree'</span></tt> &#8211; construct and use the suffix tree of the word</li>
<li><tt class="docutils literal"><span class="pre">'naive'</span></tt> &#8211; algorithm uses a sliding window</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>If n is an integer, returns the number of distinct factors
of length n. If n is None, returns the total number of
distinct factors.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">13</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[1, 3, 3, 3, 2, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 2, 4, 6, 10, 12, 16, 20, 22, 24]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">22</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">101</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">blueberry</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;blueberry&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">blueberry</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">43</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">blueberry</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 6, 8, 7, 6, 5, 4, 3, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.number_of_inversions">
<tt class="descname">number_of_inversions</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_inversions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of inversions in <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>An inversion of a word <span class="math">\(w = w_1 \ldots w_n\)</span> is a pair of indices <span class="math">\((i, j)\)</span>
with <span class="math">\(i &lt; j\)</span> and <span class="math">\(w_i &gt; w_j\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../permutation.html#sage.combinat.permutation.Permutation.number_of_inversions" title="sage.combinat.permutation.Permutation.number_of_inversions"><tt class="xref py py-meth docutils literal"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">inversions</span> <span class="pre">on</span> <span class="pre">Permutations</span></tt></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_inversions</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.number_of_left_special_factors">
<tt class="descname">number_of_left_special_factors</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_left_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of left special factors of length n.</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>left special</em> if there are
two distinct letters <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such that <span class="math">\(au\)</span> and <span class="math">\(bu\)</span>
are factors of <span class="math">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer</li>
</ul>
<p>OUTPUT:</p>
<p>Non negative integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_left_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_left_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 4, 2, 4, 4, 2, 2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.number_of_right_special_factors">
<tt class="descname">number_of_right_special_factors</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_right_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of right special factors of length n.</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>right special</em> if there are
two distinct letters <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such that <span class="math">\(ua\)</span> and <span class="math">\(ub\)</span>
are factors of <span class="math">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer</li>
</ul>
<p>OUTPUT:</p>
<p>Non negative integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_right_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_right_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 4, 2, 4, 4, 2, 2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.order">
<tt class="descname">order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the order of self.</p>
<p>Let <span class="math">\(p(w)\)</span> be the period of a word <span class="math">\(w\)</span>. The positive rational number
<span class="math">\(|w|/p(w)\)</span> is the <em>order</em> of <span class="math">\(w\)</span>. See Chapter 8 of [1].</p>
<p>OUTPUT:</p>
<blockquote>
<div>rational &#8211; the order</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">8/5</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Lothaire, Algebraic Combinatorics On Words, vol. 90 of
Encyclopedia of Mathematics and its Applications, Cambridge
University Press, U.K., 2002.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.overlap_partition">
<tt class="descname">overlap_partition</tt><big>(</big><em>other</em>, <em>delay=0</em>, <em>p=None</em>, <em>involution=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.overlap_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the partition of the alphabet induced by the overlap of
self and other with the given delay.</p>
<p>The partition of the alphabet is given by the equivalence
relation obtained from the symmetric, reflexive and transitive
closure of the set of pairs of letters
<span class="math">\(R_{u,v,d} = \{ (u_k, v_{k-d}) : 0 \leq k &lt; n, 0\leq k-d &lt; m \}\)</span>
where <span class="math">\(u = u_0 u_1 \cdots u_{n-1}\)</span>, <span class="math">\(v = v_0v_1\cdots v_{m-1}\)</span> are
two words on the alphabet <span class="math">\(A\)</span> and <span class="math">\(d\)</span> is an integer.</p>
<p>The equivalence relation defined by <span class="math">\(R\)</span> is inspired from [1].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - word on the same alphabet as self</li>
<li><tt class="docutils literal"><span class="pre">delay</span></tt> - integer</li>
<li><tt class="docutils literal"><span class="pre">p</span></tt> - disjoint sets data structure (optional, default: None),
a partition of the alphabet into disjoint sets to start with.
If None, each letter start in distinct equivalence classes.</li>
<li><tt class="docutils literal"><span class="pre">involution</span></tt> - callable (optional, default: None), an
involution on the alphabet. If involution is not None, the relation
<span class="math">\(R_{u,v,d} \cup R_{involution(u),involution(v),d}\)</span> is considered.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>disjoint set data structure</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">{{0, &#39;a&#39;}, {1, &#39;b&#39;}, {2, &#39;c&#39;}, {3}, {4}, {5}}</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;}, {&#39;b&#39;}, {0, &#39;c&#39;}, {1}, {2}, {3}, {4}, {5}}</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{{0}, {1, &#39;a&#39;}, {2, &#39;b&#39;}, {3, &#39;c&#39;}, {4}, {5}}</span>
</pre></div>
</div>
<p>You can re-use the same disjoint set and do more than one overlap:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">{{&#39;a&#39;}, {&#39;b&#39;}, {0, &#39;c&#39;}, {1}, {2}, {3}, {4}, {5}}</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;}, {0, 1, &#39;b&#39;, &#39;c&#39;}, {2}, {3}, {4}, {5}}</span>
</pre></div>
</div>
<p>The function  <tt class="docutils literal"><span class="pre">overlap_partition</span></tt> can be used to study equations
on words. For example, if a word <span class="math">\(w\)</span> overlaps itself with delay <span class="math">\(d\)</span>, then
<span class="math">\(d\)</span> is a period of <span class="math">\(w\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0,1,2,3,4,5,6,7,8,9,10,11,12,13</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">w2</span>
<span class="go">word: 56789567895678</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If a word is equal to its reversal, then it is a palindrome:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">reversal</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">w2</span>
<span class="go">word: 01234567876543210</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {0, 1, 2, 3, 4, 5, 6, 7, 8, 17, 18, 19}</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the reversal of a word <span class="math">\(w\)</span> is factor of its square <span class="math">\(w^2\)</span>, then
<span class="math">\(w\)</span> is symmetric, i.e. the product of two palindromes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0123456789</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">reversal</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">w2</span>
<span class="go">word: 0110456654</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the image of the reversal of a word <span class="math">\(w\)</span> under an involution <span class="math">\(f\)</span>
is factor of its square <span class="math">\(w^2\)</span>, then <span class="math">\(w\)</span> is <span class="math">\(f\)</span>-symmetric:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">word: 1,3,5,7,9,11</span>
<span class="gp">sage: </span><span class="n">inv</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">W</span><span class="o">.</span><span class="n">alphabet</span><span class="p">()))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">reversal</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">involution</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">word: 1,-1,5,7,-7,-5</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abcdef&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s">&#39;def&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;}, {&#39;b&#39;}, {&#39;c&#39;}, {&#39;d&#39;}, {&#39;e&#39;}, {&#39;f&#39;}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;, &#39;f&#39;}, {&#39;b&#39;}, {&#39;c&#39;}, {&#39;d&#39;}, {&#39;e&#39;}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;, &#39;e&#39;}, {&#39;b&#39;, &#39;f&#39;}, {&#39;c&#39;}, {&#39;d&#39;}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;, &#39;d&#39;}, {&#39;b&#39;, &#39;e&#39;}, {&#39;c&#39;, &#39;f&#39;}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;}, {&#39;b&#39;, &#39;d&#39;}, {&#39;c&#39;, &#39;e&#39;}, {&#39;f&#39;}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;}, {&#39;b&#39;}, {&#39;c&#39;, &#39;d&#39;}, {&#39;e&#39;}, {&#39;f&#39;}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;}, {&#39;b&#39;}, {&#39;c&#39;}, {&#39;d&#39;}, {&#39;e&#39;}, {&#39;f&#39;}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">{{&#39;a&#39;}, {&#39;b&#39;}, {&#39;c&#39;}, {&#39;d&#39;}, {&#39;e&#39;}, {&#39;f&#39;}}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">word: 010101</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">{{0}, {1}}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">{{0, 1}}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">empty</span> <span class="o">=</span> <span class="n">Word</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">empty</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span> <span class="s">&#39;yo&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">delay (=yo) must be an integer</span>
<span class="gp">sage: </span><span class="n">empty</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;yo&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">p(=yo) is not a DisjointSet</span>
</pre></div>
</div>
<p>The involution input can be any callable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="mi">5</span><span class="p">])([</span><span class="o">-</span><span class="mf">5.</span><span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">inv</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">involution</span><span class="o">=</span><span class="n">inv</span><span class="p">)</span>
<span class="go">{{-4, -2, 0, 2, 4}, {-5, -3, -1, 1, 3, 5}}</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] S. Labbé, Propriétés combinatoires des <span class="math">\(f\)</span>-palindromes,
Mémoire de maîtrise en Mathématiques, Montréal, UQAM, 2008,
109 pages.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.palindrome_prefixes">
<tt class="descname">palindrome_prefixes</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindrome_prefixes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all palindrome prefixes of self.</p>
<p>OUTPUT:</p>
<blockquote>
<div>list &#8211; A list of all palindrome prefixes of self.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaaba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindrome_prefixes</span><span class="p">()</span>
<span class="go">[word: , word: a, word: aba, word: abaaba]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbbbbbbbbb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindrome_prefixes</span><span class="p">()</span>
<span class="go">[word: , word: a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.palindromes">
<tt class="descname">palindromes</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindromes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the set of all palindromic (or <span class="math">\(f\)</span>-palindromic) factors of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>set - If f is None, the set of all palindromic factors of self;
otherwise, the set of all f-palindromic factors of self.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: , word: 0, word: 00, word: 010, word: 0110, word: 1, word: 1001, word: 101, word: 11]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;00000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: , word: 0, word: 00, word: 000, word: 0000, word: 00000]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: , word: 0]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">[word: , word: ab, word: abbabaab, word: ba, word: baba, word: bbabaa]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.palindromic_closure">
<tt class="descname">palindromic_closure</tt><big>(</big><em>side='right'</em>, <em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindromic_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shortest palindrome having <tt class="docutils literal"><span class="pre">self</span></tt> as a prefix
(or as a suffix if <tt class="docutils literal"><span class="pre">side</span></tt> is <tt class="docutils literal"><span class="pre">'left'</span></tt>).</p>
<p>See [1].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">side</span></tt> &#8211; <tt class="docutils literal"><span class="pre">'right'</span></tt> or <tt class="docutils literal"><span class="pre">'left'</span></tt> (default: <tt class="docutils literal"><span class="pre">'right'</span></tt>) the
direction of the  closure</li>
<li><tt class="docutils literal"><span class="pre">f</span></tt> &#8211; involution (default: <tt class="docutils literal"><span class="pre">None</span></tt>) on the alphabet of <tt class="docutils literal"><span class="pre">self</span></tt>.
It must be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>OUTPUT:</p>
<dl class="docutils">
<dt>word &#8211; If f is <tt class="docutils literal"><span class="pre">None</span></tt>, the right palindromic closure of <tt class="docutils literal"><span class="pre">self</span></tt>;</dt>
<dd>otherwise, the right <tt class="docutils literal"><span class="pre">f</span></tt>-palindromic closure of <tt class="docutils literal"><span class="pre">self</span></tt>.
If side is <tt class="docutils literal"><span class="pre">'left'</span></tt>, the left palindromic closure.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1233&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: 123321</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12332&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: 123321</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0110343&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: 01103430110</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;0110343&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="go">word: 3430110343</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;01105678&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="go">word: 876501105678</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbaba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: abbababba</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="go">word: babaabbaba</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;c,c-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">&#39;b&#39;</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] A. de Luca, A. De Luca, Pseudopalindrome closure operators
in free monoids, Theoret. Comput. Sci. 362 (2006) 282&#8211;300.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.palindromic_lacunas_study">
<tt class="descname">palindromic_lacunas_study</tt><big>(</big><em>f=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindromic_lacunas_study" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns interesting statistics about longest (<span class="math">\(f\)</span>-)palindromic suffixes
and lacunas of self (see [1] and [2]).</p>
<p>Note that a word <span class="math">\(w\)</span> has at most <span class="math">\(|w| + 1\)</span> different palindromic factors
(see [3]). For <span class="math">\(f\)</span>-palindromes (or pseudopalidromes or theta-palindromes),
the maximum number of <span class="math">\(f\)</span>-palindromic factors is <span class="math">\(|w|+1-g_f(w)\)</span>, where
<span class="math">\(g_f(w)\)</span> is the number of pairs <span class="math">\(\{a, f(a)\}\)</span> such that <span class="math">\(a\)</span> is a letter,
<span class="math">\(a\)</span> is not equal to <span class="math">\(f(a)\)</span>, and <span class="math">\(a\)</span> or <span class="math">\(f(a)\)</span> occurs in <span class="math">\(w\)</span>, see [4].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> - involution (default: None) on the alphabet of self. It must
be callable on letters as well as words (e.g. WordMorphism). The
default value corresponds to usual palindromes, i.e., <span class="math">\(f\)</span> equal to
the identity.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">list</span></tt> - list of the length of the longest palindromic
suffix (lps) for each non-empty prefix of self;</li>
<li><tt class="docutils literal"><span class="pre">list</span></tt> - list of all the lacunas, i.e. positions where there is no
unioccurrent lps;</li>
<li><tt class="docutils literal"><span class="pre">set</span></tt> - set of palindromic factors of self.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaabbaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_lacunas_study</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[1, 1, 2, 4, 3, 3, 2, 4, 2, 4, 6, 8]</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">[8, 9]</span>
<span class="gp">sage: </span><span class="n">c</span>          <span class="c"># random order</span>
<span class="go">set([word: , word: b, word: bab, word: abba, word: bb, word: aa, word: baabbaab, word: baab, word: aba, word: aabbaa, word: a])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_lacunas_study</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[0, 2, 0, 2, 2, 4, 6, 8]</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">[0, 2, 4]</span>
<span class="gp">sage: </span><span class="n">c</span>           <span class="c"># random order</span>
<span class="go">set([word: , word: ba, word: baba, word: ab, word: bbabaa, word: abbabaab])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="n">Word</span><span class="p">(),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;ba&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;baba&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;bbabaa&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] A. Blondin-Massé, S. Brlek, S. Labbé, Palindromic lacunas
of the Thue-Morse word, Proc. GASCOM 2008 (June 16-20 2008,
Bibbiena, Arezzo-Italia), 53&#8211;67.</li>
<li>[2] A. Blondin-Massé, S. Brlek, A. Frosini, S. Labbé, S. Rinaldi,
Reconstructing words from a fixed palindromic length sequence,
Proc. TCS 2008, 5th IFIP International Conference on Theoretical
Computer Science (September 8-10 2008, Milano, Italia), accepted.</li>
<li>[3] X. Droubay, J. Justin, G. Pirillo, Episturmian words and
some constructions of de Luca and Rauzy, Theoret. Comput. Sci.
255 (2001) 539&#8211;553.</li>
<li>[4] Š. Starosta, On Theta-palindromic Richness, Theoret. Comp.
Sci. 412 (2011) 1111&#8211;1121</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.parikh_vector">
<tt class="descname">parikh_vector</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.parikh_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated: Use <a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.abelian_vector" title="sage.combinat.words.finite_word.FiniteWord_class.abelian_vector"><tt class="xref py py-func docutils literal"><span class="pre">abelian_vector()</span></tt></a> instead.
See <a class="reference external" href="http://trac.sagemath.org/17058">trac ticket #17058</a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.periods">
<tt class="descname">periods</tt><big>(</big><em>divide_length=False</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.periods" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list containing the periods of self
between <span class="math">\(1\)</span> and <span class="math">\(n - 1\)</span>, where <span class="math">\(n\)</span> is the length
of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">divide_length</span></tt> - boolean (default: False).
When set to True, then only periods that divide
the length of self are considered.</li>
</ul>
<p>OUTPUT:</p>
<p>List of positive integers</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">()</span>
<span class="go">[2, 4]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">(</span><span class="n">divide_length</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;ababa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">()</span>
<span class="go">[2, 4]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">(</span><span class="n">divide_length</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.phi">
<tt class="descname">phi</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the phi function to self and returns the result. This is
the word obtained by taking the first letter of the words obtained
by iterating delta on self.</p>
<p>OUTPUT:</p>
<blockquote>
<div>word &#8211; the result of the phi function</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 222222</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 212113</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 212113</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 21215</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;aabbabaabaabba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: a22222</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>S. Brlek, A. Ladouceur, A note on differentiable palindromes,
Theoret. Comput. Sci. 302 (2003) 167&#8211;178.</li>
<li>S. Brlek, S. Dulucq, A. Ladouceur, L. Vuillon, Combinatorial
properties of smooth infinite words, Theoret. Comput. Sci. 352
(2006) 306&#8211;317.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.phi_inv">
<tt class="descname">phi_inv</tt><big>(</big><em>W=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.phi_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the inverse of the phi function to self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - a word over the integers</li>
<li><tt class="docutils literal"><span class="pre">W</span></tt> - a parent object of words defined over integers</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>word &#8211; the inverse of the phi function</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi_inv</span><span class="p">()</span>
<span class="go">word: 22112122</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi_inv</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 2233</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.prefix_function_table">
<tt class="descname">prefix_function_table</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.prefix_function_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector containing the length of the proper prefix-suffixes
for all the non-empty prefixes of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prefix_function_table</span><span class="p">()</span>
<span class="go">[0, 0, 1, 0, 0, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1241245&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prefix_function_table</span><span class="p">()</span>
<span class="go">[0, 0, 0, 1, 2, 3, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">prefix_function_table</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.primitive">
<tt class="descname">primitive</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the primitive of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">word: 12312</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">word: 12</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.primitive_length">
<tt class="descname">primitive_length</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.primitive_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of the primitive of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive_length</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive_length</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.quasiperiods">
<tt class="descname">quasiperiods</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.quasiperiods" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the quasiperiods of self as a list ordered from shortest to
longest.</p>
<p>Let <span class="math">\(w\)</span> be a finite or infinite word. A <em>quasiperiod</em> of <span class="math">\(w\)</span> is a
proper factor <span class="math">\(u\)</span> of <span class="math">\(w\)</span> such that the occurrences of <span class="math">\(u\)</span> in <span class="math">\(w\)</span>
entirely cover <span class="math">\(w\)</span>, i.e., every position of <span class="math">\(w\)</span> falls within some
occurrence of <span class="math">\(u\)</span> in <span class="math">\(w\)</span>. See for instance [1], [2], and [3].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaababaabaababaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quasiperiods</span><span class="p">()</span>
<span class="go">[word: aba, word: abaaba, word: abaababaaba]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quasiperiods</span><span class="p">()</span>
<span class="go">[word: aba]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abacaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quasiperiods</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] A. Apostolico, A. Ehrenfeucht, Efficient detection of
quasiperiodicities in strings, Theoret. Comput. Sci. 119 (1993)
247&#8211;265.</li>
<li>[2] S. Marcus, Quasiperiodic infinite words, Bull. Eur. Assoc.
Theor. Comput. Sci. 82 (2004) 170-174.</li>
<li>[3] A. Glen, F. Levé, G. Richomme, Quasiperiodic and Lyndon
episturmian words, Preprint, 2008, arXiv:0805.0730.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.rauzy_graph">
<tt class="descname">rauzy_graph</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.rauzy_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Rauzy graph of the factors of length n of self.</p>
<p>The vertices are the factors of length <span class="math">\(n\)</span> and there is an edge from
<span class="math">\(u\)</span> to <span class="math">\(v\)</span> if <span class="math">\(ua = bv\)</span> is a factor of length <span class="math">\(n+1\)</span> for some letters
<span class="math">\(a\)</span> and <span class="math">\(b\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0123456789</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">g</span>
<span class="go">Looped digraph on 8 vertices</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[012, 123, 234, 345, 456, 567, 678, 789]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(012, 123, 3),</span>
<span class="go"> (123, 234, 4),</span>
<span class="go"> (234, 345, 5),</span>
<span class="go"> (345, 456, 6),</span>
<span class="go"> (456, 567, 7),</span>
<span class="go"> (567, 678, 8),</span>
<span class="go"> (678, 789, 9)]</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s">&#39;word: &#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Looped digraph on 9 vertices</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1111111&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: 111, word: 111, word: 1)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Looped multi-digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 0 vertices</span>
</pre></div>
</div>
<p>Multi-edges are allowed for the empty word:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abcde&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Looped multi-digraph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: , word: , word: a),</span>
<span class="go"> (word: , word: , word: b),</span>
<span class="go"> (word: , word: , word: c)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.reduced_rauzy_graph">
<tt class="descname">reduced_rauzy_graph</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.reduced_rauzy_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reduced Rauzy graph of order <span class="math">\(n\)</span> of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - non negative integer. Every vertex of a reduced
Rauzy graph of order <span class="math">\(n\)</span> is a factor of length <span class="math">\(n\)</span> of self.</li>
</ul>
<p>OUTPUT:</p>
<p>Looped multi-digraph</p>
<p>DEFINITION:</p>
<p>For infinite periodic words (resp. for finite words of type <span class="math">\(u^i
u[0:j]\)</span>), the reduced Rauzy graph of order <span class="math">\(n\)</span> (resp. for <span class="math">\(n\)</span>
smaller or equal to <span class="math">\((i-1)|u|+j\)</span>) is the directed graph whose
unique vertex is the prefix <span class="math">\(p\)</span> of length <span class="math">\(n\)</span> of self and which has
an only edge which is a loop on <span class="math">\(p\)</span> labelled by <span class="math">\(w[n+1:|w|] p\)</span>
where <span class="math">\(w\)</span> is the unique return word to <span class="math">\(p\)</span>.</p>
<p>In other cases, it is the directed graph defined as followed.  Let
<span class="math">\(G_n\)</span> be the Rauzy graph of order <span class="math">\(n\)</span> of self. The vertices are the
vertices of <span class="math">\(G_n\)</span> that are either special or not prolongable to the
right or to the left. For each couple (<span class="math">\(u\)</span>, <span class="math">\(v\)</span>) of such vertices
and each directed path in <span class="math">\(G_n\)</span> from <span class="math">\(u\)</span> to <span class="math">\(v\)</span> that contains no
other vertices that are special, there is an edge from <span class="math">\(u\)</span> to <span class="math">\(v\)</span>
in the reduced Rauzy graph of order <span class="math">\(n\)</span> whose label is the label of
the path in <span class="math">\(G_n\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the case of infinite recurrent non periodic words, this
definition correspond to the following one that can be found in
[1] and [2]  where a simple path is a path that begins with a
special factor, ends with a special factor and contains no
other vertices that are special:</p>
<p class="last">The reduced Rauzy graph of factors of length <span class="math">\(n\)</span> is obtained
from <span class="math">\(G_n\)</span> by replacing each simple path <span class="math">\(P=v_1 v_2 ...
v_{\ell}\)</span> with an edge <span class="math">\(v_1 v_{\ell}\)</span> whose label is the
concatenation of the labels of the edges of <span class="math">\(P\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0123456789</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">g</span>
<span class="go">Looped multi-digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[word: 012, word: 789]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: 012, word: 789, word: 3456789)]</span>
</pre></div>
</div>
<p>For the Fibonacci word:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span><span class="n">g</span>
<span class="go">Looped multi-digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[word: 01001010, word: 01010010]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: 01001010, word: 01010010, word: 010), (word: 01010010, word: 01001010, word: 01010), (word: 01010010, word: 01001010, word: 10)]</span>
</pre></div>
</div>
<p>For periodic words:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="n">cycle</span><span class="p">(</span><span class="s">&#39;abcd&#39;</span><span class="p">))[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: abc, word: abc, word: dabc)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped multi-digraph on 1 vertex</span>
<span class="go">Looped multi-digraph on 0 vertices</span>
</pre></div>
</div>
<p>For ultimately periodic words:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s">&#39;a-&gt;abcd,b-&gt;cd,c-&gt;cd,d-&gt;cd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)[:</span><span class="mi">100</span><span class="p">];</span> <span class="n">w</span>
<span class="go">word: abcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd...</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[word: abcdc, word: cdcdc]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: abcdc, word: cdcdc, word: dc), (word: cdcdc, word: cdcdc, word: dc)]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<p>Julien Leroy (March 2010): initial version</p>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Bucci et al.  A. De Luca, A. Glen, L. Q. Zamboni, A
connection between palindromic and factor complexity using
return words,&#8221; Advances in Applied Mathematics 42 (2009) 60-74.</li>
<li>[2] L&#8217;ubomira Balkova, Edita Pelantova, and Wolfgang Steiner.
Sequences with constant number of return words. Monatsh. Math,
155 (2008) 251-263.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.return_words">
<tt class="descname">return_words</tt><big>(</big><em>fact</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.return_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the set of return words of fact in self.</p>
<p>This is the set of all factors starting by the given factor and ending
just before the next occurrence of this factor. See [1] and [2].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">fact</span></tt> - a non empty finite word</li>
</ul>
<p>OUTPUT:</p>
<p>Python set of finite words</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;21331233213231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">))</span>
<span class="go">{word: 213, word: 21331, word: 233}</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;213&#39;</span><span class="p">))</span>
<span class="go">set()</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1212&#39;</span><span class="p">))</span>
<span class="go">{word: 12}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TM</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">TM</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">])))</span>
<span class="go">[word: 0, word: 01, word: 011]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] F. Durand, A characterization of substitutive sequences using
return words, Discrete Math. 179 (1998) 89-101.</li>
<li>[2] C. Holton, L.Q. Zamboni, Descendants of primitive substitutions,
Theory Comput. Syst. 32 (1999) 133-157.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.return_words_derivate">
<tt class="descname">return_words_derivate</tt><big>(</big><em>fact</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.return_words_derivate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the word generated by mapping a letter to each occurrence of
the return words for the given factor dropping any dangling prefix and
suffix. See for instance [1].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;12131221312313122&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">return_words_derivate</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">))</span>
<span class="go">word: 123242</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] F. Durand, A characterization of substitutive sequences using
return words, Discrete Math. 179 (1998) 89&#8211;101.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.rev_lex_less">
<tt class="descname">rev_lex_less</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.rev_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the word self is reverse
lexicographically less than other.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.reversal">
<tt class="descname">reversal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.reversal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reversal of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;124563&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reversal</span><span class="p">()</span>
<span class="go">word: 365421</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.rfind">
<tt class="descname">rfind</tt><big>(</big><em>sub</em>, <em>start=0</em>, <em>end=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.rfind" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the last occurrence of sub in self,
such that sub is contained within self[start:end].
Returns -1 on failure.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">sub</span></tt> - string, list, tuple or word to search for.</li>
<li><tt class="docutils literal"><span class="pre">start</span></tt> - non negative integer (default: 0) specifying
the position at which the search must stop.</li>
<li><tt class="docutils literal"><span class="pre">end</span></tt> - non negative integer (default: None) specifying
the position from which to start the search. If None, then
the search is performed up to the end of the string.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>non negative integer or -1</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">sub</span></tt> parameter can also be a list or a tuple:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Examples using the argument <tt class="docutils literal"><span class="pre">start</span></tt> and <tt class="docutils literal"><span class="pre">end</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Instances of Word_str handle string inputs as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abac&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/12804">trac ticket #12804</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s">&quot;abab&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s">&quot;finite&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&quot;aa&quot;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.right_special_factors">
<tt class="descname">right_special_factors</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.right_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the right special factors (of length n).</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>right special</em> if there are
two distinct letters <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such that <span class="math">\(ua\)</span> and <span class="math">\(ub\)</span>
are factors of <span class="math">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer (optional, default: None). If None, it returns
all right special factors.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of words.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="go">0 [word: ]</span>
<span class="go">1 [word: 0, word: 1]</span>
<span class="go">2 [word: 01, word: 10]</span>
<span class="go">3 [word: 001, word: 010, word: 101, word: 110]</span>
<span class="go">4 [word: 0110, word: 1001]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.right_special_factors_iterator">
<tt class="descname">right_special_factors_iterator</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.right_special_factors_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the right special factors (of length n).</p>
<p>A factor <span class="math">\(u\)</span> of a word <span class="math">\(w\)</span> is <em>right special</em> if there are
two distinct letters <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such that <span class="math">\(ua\)</span> and <span class="math">\(ub\)</span>
are factors of <span class="math">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> - integer (optional, default: None). If None, it returns
an iterator over all right special factors.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.3</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">CodingOfRotationWord</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors_iterator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[word: 010, word: 101]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[word: 0101, word: 1010]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors_iterator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[word: 00101, word: 11010]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.robinson_schensted">
<tt class="descname">robinson_schensted</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.robinson_schensted" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the semistandard tableau and standard tableau pair
obtained by running the Robinson-Schensted algorithm on <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>This can also be done by running
<a class="reference internal" href="../rsk.html#sage.combinat.rsk.RSK" title="sage.combinat.rsk.RSK"><tt class="xref py py-func docutils literal"><span class="pre">RSK()</span></tt></a> on <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">robinson_schensted</span><span class="p">()</span>
<span class="go">[[[1, 1, 1, 1, 3], [2], [3]], [[1, 2, 3, 5, 6], [4], [7]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.schuetzenberger_involution">
<tt class="descname">schuetzenberger_involution</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.schuetzenberger_involution" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Returns the Schuetzenberger involution of the word self, which is obtained
by reverting the word and then complementing all letters within the
underlying ordered alphabet. If <span class="math">\(n\)</span> is specified, the underlying
alphabet is assumed to be <span class="math">\([1,2,\ldots,n]\)</span>. If no alphabet is specified,
<span class="math">\(n\)</span> is the maximal letter appearing in self.</div></blockquote>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> &#8211; a word</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt>    &#8211; an integer specifying the maximal letter in the alphabet (optional)</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a word, the Schuetzenberger involution of self</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">();</span> <span class="n">v</span>
<span class="go">word: 7849631</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over Set of Python objects of type &#39;object&#39;</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">alphabet</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">();</span><span class="n">v</span>
<span class="go">word: 345</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {1, 2, 3, 4, 5}</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span><span class="n">v</span>
<span class="go">word: 345</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over Set of Python objects of type &#39;object&#39;</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">41</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">()</span>
<span class="go">word: 29,52,67,68,69,17,68,1,38,59</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([],</span><span class="n">alphabet</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">()</span>
<span class="go">word:</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">()</span>
<span class="go">word:</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.shifted_shuffle">
<tt class="descname">shifted_shuffle</tt><big>(</big><em>other</em>, <em>shift=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.shifted_shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the combinatorial class representing the shifted shuffle
product between words self and other. This is the same as the
shuffle product of self with the word obtained from other by
incrementing its values (i.e. its letters) by the given shift.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - finite word over the integers</li>
<li><tt class="docutils literal"><span class="pre">shift</span></tt> - integer or None (default: None) added to each letter of
other. When shift is None, it is replaced by self.length()</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>Combinatorial class of shifted shuffle products of self and
other.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sp</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">shifted_shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">sp</span>
<span class="go">Shuffle product of word: 011 and word: 344</span>
<span class="gp">sage: </span><span class="n">sp</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">shifted_shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">sp</span>
<span class="go">Shuffle product of word: 011 and word: 233</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[011233, 012133, 012313, 012331, 021133, 021313, 021331, 023113, 023131, 023311, 201133, 201313, 201331, 203113, 203131, 203311, 230113, 230131, 230311, 233011]</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s">&#39;word: &#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;aba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">shifted_shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">for shifted shuffle, words must only contain integers as letters</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.shuffle">
<tt class="descname">shuffle</tt><big>(</big><em>other</em>, <em>overlap=0</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the combinatorial class representing the shuffle product
between words self and other. This consists of all words of length
self.length()+other.length() that have both self and other as
subwords.</p>
<p>If overlap is non-zero, then the combinatorial class representing
the shuffle product with overlaps is returned. The calculation of
the shift in each overlap is done relative to the order of the
alphabet. For example, &#8220;a&#8221; shifted by &#8220;a&#8221; is &#8220;b&#8221; in the alphabet
[a, b, c] and 0 shifted by 1 in [0, 1, 2, 3] is 2.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - finite word</li>
<li><tt class="docutils literal"><span class="pre">overlap</span></tt> - (default: 0) integer or True</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>Combinatorial class of shuffle product of self and other</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ab</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cd</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;cd&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sp</span> <span class="o">=</span> <span class="n">ab</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">cd</span><span class="p">);</span> <span class="n">sp</span>
<span class="go">Shuffle product of word: ab and word: cd</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[word: abcd, word: acbd, word: acdb, word: cabd, word: cadb, word: cdab]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">Shuffle product of word: 01 and word: 01</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Shuffle product of word: 23 and word: 23</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Shuffle product of word: 01 and word: 23</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Overlapping shuffle product of word: 01 and word: 23 with 2 overlaps</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.standard_factorization">
<tt class="descname">standard_factorization</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.standard_factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the standard factorization of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>The <em>standard factorization</em> of a word <span class="math">\(w\)</span> of length greater than
<span class="math">\(1\)</span> is the factorization <span class="math">\(w = uv\)</span> where <span class="math">\(v\)</span> is the longest proper
suffix of <span class="math">\(w\)</span> that is a Lyndon word.</p>
<p>Note that if <span class="math">\(w\)</span> is a Lyndon word of length greater than 1 with
standard factorization <span class="math">\(w = uv\)</span>, then <span class="math">\(u\)</span> and <span class="math">\(v\)</span> are also Lyndon
words and <span class="math">\(u &lt; v\)</span>.</p>
<p>See for instance [1], [2] and [3].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - finite word of length greater than 1</li>
</ul>
<p>OUTPUT:</p>
<p>2-tuple <span class="math">\((u, v)\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;01&#39;</span><span class="p">)(</span><span class="s">&#39;0010110011&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 001011, word: 0011)</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">)(</span><span class="s">&#39;1223312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 12233, word: 12)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 32, word: 1)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;0010110011&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;01&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 001011, word: 0011)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;0010110011&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;10&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 001011001, word: 1)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;1223312&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 12233, word: 12)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Standard factorization not defined on words of</span>
<span class="go">length less than 2</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Standard factorization not defined on words of</span>
<span class="go">length less than 2</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] K.-T. Chen, R.H. Fox, R.C. Lyndon, Free differential calculus,
IV. The quotient groups of the lower central series, Ann. of Math.
68 (1958) 81&#8211;95.</li>
<li>[2] J.-P. Duval, Factorizing words over an ordered alphabet,
J. Algorithms 4 (1983) 363&#8211;381.</li>
<li>[3] M. Lothaire, Algebraic Combinatorics On Words, vol. 90 of
Encyclopedia of Mathematics and its Applications, Cambridge
University Press, U.K., 2002.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.standard_permutation">
<tt class="descname">standard_permutation</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.standard_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the standard permutation of the word
self on the ordered alphabet. It is defined as
the permutation with exactly the same number of
inversions as w. Equivalently, it is the permutation
of minimal length whose inverse sorts self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">word: 123221</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[1, 3, 6, 4, 5, 2]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">));</span> <span class="n">v</span>
<span class="go">word: 112223</span>
<span class="gp">sage: </span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">q</span><span class="p">:</span> <span class="n">q</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="ow">and</span> \
<span class="go">....:       q.inverse().action(w) == list(v), \</span>
<span class="go">....:       Permutations(w.length()) )</span>
<span class="go">[[1, 3, 6, 4, 5, 2]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">word: 12322121</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[1, 4, 8, 5, 6, 2, 7, 3]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: 11122223</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">word: 12322121</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[6, 2, 1, 3, 4, 7, 5, 8]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: 32222111</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ab&#39;</span><span class="p">)(</span><span class="s">&#39;abbaba&#39;</span><span class="p">);</span> <span class="n">w</span>
<span class="go">word: abbaba</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[1, 4, 5, 2, 6, 3]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: aaabbb</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;ba&#39;</span><span class="p">)(</span><span class="s">&#39;abbaba&#39;</span><span class="p">);</span> <span class="n">w</span>
<span class="go">word: abbaba</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[4, 1, 2, 5, 3, 6]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: bbbaaa</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.sturmian_desubstitute_as_possible">
<tt class="descname">sturmian_desubstitute_as_possible</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.sturmian_desubstitute_as_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Sturmian desubstitutes the word <tt class="docutils literal"><span class="pre">self</span></tt> as much as possible.</p>
<p>The finite word <tt class="docutils literal"><span class="pre">self</span></tt> must be defined on a two-letter
alphabet or use at most two-letters.</p>
<p>It can be Sturmian desubstituted if one letter appears
isolated: the Sturmian desubstitution consists in removing one
letter per run of the non-isolated letter. The accelerated
Sturmian desubstitution consists in removing a run equal to
the length of the shortest inner run from any run of the
non-isolated letter (including possible leading and trailing
runs even if they have shorter length). The (accelerated)
Sturmian desubstitution is done as much as possible. A word is
a factor of a Sturmian word if, and only if, the result is the
empty word.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A finite word defined on a two-letter alphabet.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;10111101101110111&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;01&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">u</span>
<span class="go">word: 10111101101110111</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span> <span class="p">;</span> <span class="n">v</span>
<span class="go">word: 01100101</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;azaazaaazaaazaazaaaz&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;azazaza&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;aze&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aze&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">your word must be defined on a binary alphabet or use at most two different letters</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;azaaazaazaazaaazaaza&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;azaaazaazaazaaazaaaza&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word: azzaa</span>
</pre></div>
</div>
<p>Boundary effects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;azzzzz&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;zzzzza&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaaaazaaaaaaaaa&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaaaaaaaaaaaaa&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
</pre></div>
</div>
<p>Boundary effects without alphabet:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;azzzzz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;zzzzza&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaaaazaaaaaaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;aaaaaaaaaaaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
</pre></div>
</div>
<p>Idempotence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">RandomWord</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span> <span class="p">;</span> <span class="n">r</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Thierry Monteil</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.suffix_tree">
<tt class="descname">suffix_tree</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.suffix_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for implicit_suffix_tree().</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">suffix_tree</span><span class="p">()</span>
<span class="go">Implicit Suffix Tree of the word: abbabaab</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.suffix_trie">
<tt class="descname">suffix_trie</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.suffix_trie" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the suffix trie of self.</p>
<p>The <em>suffix trie</em> of a finite word <span class="math">\(w\)</span> is a data structure
representing the factors of <span class="math">\(w\)</span>. It is a tree whose edges are
labelled with letters of <span class="math">\(w\)</span>, and whose leafs correspond to
suffixes of <span class="math">\(w\)</span>.</p>
<p>See sage.combinat.words.suffix_trees.SuffixTrie? for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&quot;cacao&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">suffix_trie</span><span class="p">()</span>
<span class="go">Suffix Trie of the word: cacao</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">suffix_trie</span><span class="p">()</span>
<span class="go">Suffix Trie of the word: 01011</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.swap">
<tt class="descname">swap</tt><big>(</big><em>i</em>, <em>j=None</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the word w with entries at positions i and
j swapped. By default, j = i+1.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 321</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 132</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: aabb</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.swap_decrease">
<tt class="descname">swap_decrease</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.swap_decrease" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the word with positions i and i+1 exchanged
if self[i] &lt; self[i+1]. Otherwise, it returns self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: 312</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 132</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="n">w</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: baba</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ba&quot;</span><span class="p">)(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: abba</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.swap_increase">
<tt class="descname">swap_increase</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.swap_increase" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the word with positions i and i+1 exchanged
if self[i] &gt; self[i+1]. Otherwise, it returns self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 123</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: 132</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="n">w</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: abba</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s">&quot;ba&quot;</span><span class="p">)(</span><span class="s">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: baba</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.to_integer_list">
<tt class="descname">to_integer_list</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.to_integer_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of integers from [0,1,...,self.length()-1] in the
same relative order as the letters in self in the parent.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_list</span><span class="p">()</span>
<span class="go">[0, 1, 1, 0, 1, 0, 0, 1]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s">&quot;cacao&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s">&quot;finite&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_list</span><span class="p">()</span>
<span class="go">[1, 0, 1, 0, 2]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_list</span><span class="p">()</span>
<span class="go">[1, 0, 0, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.to_integer_word">
<tt class="descname">to_integer_word</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.to_integer_word" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a word defined over the integers [0,1,...,self.length()-1]
whose letters are in the same relative order in the parent.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_word</span><span class="p">()</span>
<span class="go">word: 01101001</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s">&quot;cacao&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s">&quot;finite&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_word</span><span class="p">()</span>
<span class="go">word: 10102</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_word</span><span class="p">()</span>
<span class="go">word: 1002</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.to_monoid_element">
<tt class="descname">to_monoid_element</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.to_monoid_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">self</span></tt> as an element the free monoid with the same alphabet
as <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s">&#39;aabb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_monoid_element</span><span class="p">()</span>
<span class="go">a^2*b^2</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_monoid_element</span><span class="p">()</span>
<span class="go">a^2*b^2</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <tt class="docutils literal"><span class="pre">w</span> <span class="pre">==</span> <span class="pre">w.to_monoid_element().to_word()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">to_monoid_element</span><span class="p">()</span><span class="o">.</span><span class="n">to_word</span><span class="p">()</span> <span class="o">==</span> <span class="n">w</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">Words</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.finite_word.FiniteWord_class.topological_entropy">
<tt class="descname">topological_entropy</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.topological_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the topological entropy for the factors of length n.</p>
<p>The topological entropy of a sequence <span class="math">\(u\)</span> is defined as the
exponential growth rate of the complexity of <span class="math">\(u\)</span> as the length
increases: <span class="math">\(H_{top}(u)=\lim_{n\to\infty}\frac{\log_d(p_u(n))}{n}\)</span>
where <span class="math">\(d\)</span> denotes the cardinality of the alphabet and <span class="math">\(p_u(n)\)</span> is
the complexity function, i.e. the number of factors of length <span class="math">\(n\)</span>
in the sequence <span class="math">\(u\)</span> [1].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - a word defined over a finite alphabet</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> - positive integer</li>
</ul>
<p>OUTPUT:</p>
<p>real number (a symbolic expression)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">t</span>
<span class="go">1/3*log(7)/log(2)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">0.935784974019201</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">topo</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">(</span><span class="n">topo</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0 1.0000</span>
<span class="go">5 0.71699</span>
<span class="go">10 0.48074</span>
<span class="go">15 0.36396</span>
<span class="go">20 0.28774</span>
<span class="go">25 0.23628</span>
<span class="go">30 0.20075</span>
<span class="go">35 0.17270</span>
<span class="go">40 0.14827</span>
</pre></div>
</div>
<p>If no alphabet is specified, an error is raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The word must be defined over a finite alphabet</span>
</pre></div>
</div>
<p>The following is ok:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/3*log(18)/log(20)</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<blockquote>
<div>[1] N. Pytheas Fogg, Substitutions in Dynamics, Arithmetics,
and Combinatorics, Lecture Notes in Mathematics 1794, Springer
Verlag. V. Berthe, S. Ferenczi, C. Mauduit and A. Siegel, Eds.
(2002).</div></blockquote>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Finite word</a><ul>
<li><a class="reference internal" href="#creation-of-a-finite-word">Creation of a finite word</a></li>
<li><a class="reference internal" href="#functions-and-algorithms">Functions and algorithms</a></li>
<li><a class="reference internal" href="#factors-and-rauzy-graphs">Factors and Rauzy Graphs</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="alphabet.html"
                                  title="previous chapter">Alphabet</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="infinite_word.html"
                                  title="next chapter">Infinite word</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/combinat/words/finite_word.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="infinite_word.html" title="Infinite word"
             >next</a> |</li>
        <li class="right" >
          <a href="alphabet.html" title="Alphabet"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li><a href="../../../module_list.html" >Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>