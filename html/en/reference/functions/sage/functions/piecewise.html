<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Piecewise-defined Functions &mdash; Sage Reference Manual v6.10: Functions</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.10: Functions" href="../../index.html" />
    <link rel="next" title="Spike Functions" href="spike_function.html" />
    <link rel="prev" title="Number-Theoretic Functions" href="transcendental.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spike_function.html" title="Spike Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="transcendental.html" title="Number-Theoretic Functions"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Functions</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="piecewise-defined-functions">
<span id="sage-functions-piecewise"></span><h1>Piecewise-defined Functions<a class="headerlink" href="#piecewise-defined-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.functions.piecewise"></span><p>Sage implements a very simple class of piecewise-defined functions.
Functions may be any type of symbolic expression. Infinite
intervals are not supported. The endpoints of each interval must
line up.</p>
<p>TODO:</p>
<ul class="simple">
<li>Implement max/min location and values,</li>
<li>Need: parent object - ring of piecewise functions</li>
<li>This class should derive from an element-type class, and should
define <tt class="docutils literal"><span class="pre">_add_</span></tt>, <tt class="docutils literal"><span class="pre">_mul_</span></tt>, etc. That will automatically take care
of left multiplication and proper coercion. The coercion mentioned
below for scalar mult on right is bad, since it only allows ints and
rationals. The right way is to use an element class and only define
<tt class="docutils literal"><span class="pre">_mul_</span></tt>, and have a parent, so anything gets coerced properly.</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner (2006-04): initial version</li>
<li>David Joyner (2006-09): added __eq__, extend_by_zero_to, unextend,
convolution, trapezoid, trapezoid_integral_approximation,
riemann_sum, riemann_sum_integral_approximation, tangent_line fixed
bugs in __mul__, __add__</li>
<li>David Joyner (2007-03): adding Hann filter for FS, added general FS
filter methods for computing and plotting, added options to plotting
of FS (eg, specifying rgb values are now allowed). Fixed bug in
documentation reported by Pablo De Napoli.</li>
<li>David Joyner (2007-09): bug fixes due to behaviour of
SymbolicArithmetic</li>
<li>David Joyner (2008-04): fixed docstring bugs reported by J Morrow; added
support for Laplace transform of functions with infinite support.</li>
<li>David Joyner (2008-07): fixed a left multiplication bug reported by
C. Boncelet (by defining __rmul__ = __mul__).</li>
<li>Paul Butler (2009-01): added indefinite integration and default_variable</li>
</ul>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">f</span>
<span class="go">Piecewise defined function with 1 parts, [[(0, 1), 2]]</span>
</pre></div>
</div>
<dl class="function">
<dt id="sage.functions.piecewise.Piecewise">
<tt class="descclassname">sage.functions.piecewise.</tt><tt class="descname">Piecewise</tt><big>(</big><em>list_of_pairs</em>, <em>var=None</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.Piecewise" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a piecewise function from a list of (interval, function)
pairs.</p>
<p><tt class="docutils literal"><span class="pre">list_of_pairs</span></tt> is a list of pairs (I, fcn), where
fcn is a Sage function (such as a polynomial over RR, or functions
using the lambda notation), and I is an interval such as I = (1,3).
Two consecutive intervals must share a common endpoint.</p>
<p>If the optional <tt class="docutils literal"><span class="pre">var</span></tt> is specified, then any symbolic expressions
in the list will be converted to symbolic functions using
<tt class="docutils literal"><span class="pre">fcn.function(var)</span></tt>.  (This says which variable is considered to
be &#8220;piecewise&#8221;.)</p>
<p>We assume that these definitions are consistent (ie, no checking is
done).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]],</span> <span class="n">x</span><span class="p">);</span> <span class="n">f</span>
<span class="go">Piecewise defined function with 2 parts, [[(0, 1), x |--&gt; x], [(1, 2), x |--&gt; x^2]]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
<span class="go">0.900000000000000</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span>
<span class="go">1.21000000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.functions.piecewise.PiecewisePolynomial">
<em class="property">class </em><tt class="descclassname">sage.functions.piecewise.</tt><tt class="descname">PiecewisePolynomial</tt><big>(</big><em>list_of_pairs</em>, <em>var=None</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a piecewise function from a list of (interval, function)
pairs.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.base_ring">
<tt class="descname">base_ring</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.base_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the base ring of the function pieces.   This
is useful when this class is extended.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">base_ring</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f3</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">156</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3036</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">26208</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">f3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.convolution">
<tt class="descname">convolution</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the convolution function,
<span class="math">\(f*g(t)=\int_{-\infty}^\infty f(u)g(t-u)du\)</span>, for compactly
supported <span class="math">\(f,g\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">]])</span>  <span class="c">## example 0</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span> <span class="n">R</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="gp">sage: </span><span class="c"># Type show(P+Q+R) to view</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">]])</span>  <span class="c">## example 1</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span> <span class="n">R</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="gp">sage: </span><span class="c"># Type show(P+Q+R) to view</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">]])</span>                             <span class="c">## example 2</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Piecewise defined function with 3 parts, [[(-1, 1), 0], [(1, 2), -3/2*x], [(2, 4), -3/2*x]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">convolution</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Piecewise defined function with 5 parts, [[(-1, 1), x + 1], [(1, 2), 3], [(2, 3), x], [(3, 4), -x + 8], [(4, 5), -2*x + 10]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.cosine_series_coefficient">
<tt class="descname">cosine_series_coefficient</tt><big>(</big><em>n</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.cosine_series_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the n-th cosine series coefficient of
<span class="math">\(\cos(n\pi x/L)\)</span>, <span class="math">\(a_n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - the function f(x), defined over 0 x L (no
checking is done to insure this)</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer n=0</li>
<li><tt class="docutils literal"><span class="pre">L</span></tt> - (the period)/2</li>
</ul>
<p>OUTPUT:
<span class="math">\(a_n = \frac{2}{L}\int_{-L}^L f(x)\cos(n\pi x/L)dx\)</span> such
that</p>
<div class="math">
\[\begin{split}f(x) \sim \frac{a_0}{2} +                     \sum_{n=1}^\infty a_n\cos(\frac{n\pi x}{L}),\ \ 0&lt;x&lt;L.\end{split}\]</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosine_series_coefficient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosine_series_coefficient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-4/9/pi^2</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosine_series_coefficient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosine_series_coefficient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">2/pi</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosine_series_coefficient</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">2/37/pi</span>
<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosine_series_coefficient</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">1/3*pi^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.critical_points">
<tt class="descname">critical_points</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.critical_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the critical points of this piecewise function.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Uses maxima, which prints the warning to use results with
caution. Only works for piecewise functions whose parts are
polynomials with real critical not occurring on the
interval endpoints.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f3</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">156</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3036</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">26208</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">f3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">e</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">critical_points</span><span class="p">()))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Use variables other than x (<a class="reference external" href="http://trac.sagemath.org/13836">trac ticket #13836</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f3</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">156</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3036</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">26208</span><span class="o">*</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">f3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">e</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">critical_points</span><span class="p">()))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.default_variable">
<tt class="descname">default_variable</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.default_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the default variable. The default variable is defined as the
first variable in the first piece that has a variable. If no pieces have
a variable (each piece is a constant value), <span class="math">\(x\)</span> is returned.</p>
<p>The result is cached.</p>
<p>AUTHOR: Paul Butler</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">default_variable</span><span class="p">()</span>
<span class="go">x</span>

<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">f1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">default_variable</span><span class="p">()</span>
<span class="go">y</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.derivative">
<tt class="descname">derivative</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the derivative (as computed by maxima)
Piecewise(I,`(d/dx)(self|_I)`), as I runs over the
intervals belonging to self. self must be piecewise polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">Piecewise defined function with 2 parts, [[(0, 1), x |--&gt; 0], [(1, 2), x |--&gt; -1]]</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">Piecewise defined function with 2 parts, [[(0, 1/2*pi), x |--&gt; 0], [(1/2*pi, pi), x |--&gt; 0]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)]],</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">Piecewise defined function with 1 parts, [[(0, 1), x |--&gt; 2]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.domain">
<tt class="descname">domain</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the domain of the function.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">(0, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.end_points">
<tt class="descname">end_points</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.end_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all interval endpoints for this function.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">end_points</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.extend_by_zero_to">
<tt class="descname">extend_by_zero_to</tt><big>(</big><em>xmin=-1000</em>, <em>xmax=1000</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.extend_by_zero_to" title="Permalink to this definition">¶</a></dt>
<dd><p>This function simply returns the piecewise defined function which
is extended by 0 so it is defined on all of (xmin,xmax). This is
needed to add two piecewise functions in a reasonable way.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">extend_by_zero_to</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Piecewise defined function with 4 parts, [[(-1, 0), 0], [(0, 1), x |--&gt; 1], [(1, 2), x |--&gt; -x + 1], [(2, 3), 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.fourier_series_cosine_coefficient">
<tt class="descname">fourier_series_cosine_coefficient</tt><big>(</big><em>n</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.fourier_series_cosine_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the n-th Fourier series coefficient of
<span class="math">\(\cos(n\pi x/L)\)</span>, <span class="math">\(a_n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - the function f(x), defined over -L x L</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer n=0</li>
<li><tt class="docutils literal"><span class="pre">L</span></tt> - (the period)/2</li>
</ul>
<p>OUTPUT:
<span class="math">\(a_n = \frac{1}{L}\int_{-L}^L f(x)\cos(n\pi x/L)dx\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_cosine_coefficient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">pi^(-2)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_cosine_coefficient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_cosine_coefficient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">-3/5/pi</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum">
<tt class="descname">fourier_series_partial_sum</tt><big>(</big><em>N</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the partial sum</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} + \sum_{n=1}^N [a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>as a string.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">cos(2*pi*x)/pi^2 - 4*cos(pi*x)/pi^2 + 1/3</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">-3*cos(x)/pi - 3*sin(2*x)/pi + 3*sin(x)/pi - 1/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum_cesaro">
<tt class="descname">fourier_series_partial_sum_cesaro</tt><big>(</big><em>N</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum_cesaro" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Cesaro partial sum</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} + \sum_{n=1}^N (1-n/N)*[a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>as a string. This is a &#8220;smoother&#8221; partial sum - the Gibbs
phenomenon is mollified.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum_cesaro</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1/3*cos(2*pi*x)/pi^2 - 8/3*cos(pi*x)/pi^2 + 1/3</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum_cesaro</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">-2*cos(x)/pi - sin(2*x)/pi + 2*sin(x)/pi - 1/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum_filtered">
<tt class="descname">fourier_series_partial_sum_filtered</tt><big>(</big><em>N</em>, <em>L</em>, <em>F</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum_filtered" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the &#8220;filtered&#8221; partial sum</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} + \sum_{n=1}^N F_n*[a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>as a string, where <span class="math">\(F = [F_1,F_2, ..., F_{N}]\)</span> is a list
of length <span class="math">\(N\)</span> consisting of real numbers. This can be used
to plot FS solutions to the heat and wave PDEs.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum_filtered</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">cos(2*pi*x)/pi^2 - 4*cos(pi*x)/pi^2 + 1/3</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum_filtered</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-3*cos(x)/pi - 3*sin(2*x)/pi + 3*sin(x)/pi - 1/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum_hann">
<tt class="descname">fourier_series_partial_sum_hann</tt><big>(</big><em>N</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.fourier_series_partial_sum_hann" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Hann-filtered partial sum (named after von Hann, not
Hamming)</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} + \sum_{n=1}^N H_N(n)*[a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>as a string, where <span class="math">\(H_N(x) = (1+\cos(\pi x/N))/2\)</span>. This is
a &#8220;smoother&#8221; partial sum - the Gibbs phenomenon is mollified.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum_hann</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1/4*cos(2*pi*x)/pi^2 - 3*cos(pi*x)/pi^2 + 1/3</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_partial_sum_hann</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">-9/4*cos(x)/pi - 3/4*sin(2*x)/pi + 9/4*sin(x)/pi - 1/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.fourier_series_sine_coefficient">
<tt class="descname">fourier_series_sine_coefficient</tt><big>(</big><em>n</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.fourier_series_sine_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the n-th Fourier series coefficient of
<span class="math">\(\sin(n\pi x/L)\)</span>, <span class="math">\(b_n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - the function f(x), defined over -L x L</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer n0</li>
<li><tt class="docutils literal"><span class="pre">L</span></tt> - (the period)/2</li>
</ul>
<p>OUTPUT:
<span class="math">\(b_n = \frac{1}{L}\int_{-L}^L f(x)\sin(n\pi x/L)dx\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_sine_coefficient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># L=1, n=2</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.fourier_series_value">
<tt class="descname">fourier_series_value</tt><big>(</big><em>x</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.fourier_series_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the Fourier series coefficient of self at
<span class="math">\(x\)</span>,</p>
<div class="math">
\[\begin{split}f(x) \sim \frac{a_0}{2} +                     \sum_{n=1}^\infty [a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],         \ \ \ -L&lt;x&lt;L.\end{split}\]</div>
<p>This method applies to piecewise non-polynomial functions as well.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - the function f(x), defined over -L x L</li>
<li><tt class="docutils literal"><span class="pre">x</span></tt> - a real number</li>
<li><tt class="docutils literal"><span class="pre">L</span></tt> - (the period)/2</li>
</ul>
<p>OUTPUT: <span class="math">\((f^*(x+)+f^*(x-)/2\)</span>, where <span class="math">\(f^*\)</span> denotes
the function <span class="math">\(f\)</span> extended to <span class="math">\(\RR\)</span> with period
<span class="math">\(2L\)</span> (Dirichlet&#8217;s Theorem for Fourier series).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1/2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1/2*sin(20) + 1/2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1/2*sin(20) + 1/2</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="mi">0</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fourier_series_value</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span>
<span class="go">1/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.functions">
<tt class="descname">functions</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of functions (the &#8220;pieces&#8221;).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">functions</span><span class="p">()</span>
<span class="go">[x |--&gt; 1, x |--&gt; -x + 1, x |--&gt; e^x, x |--&gt; sin(2*x)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.integral">
<tt class="descname">integral</tt><big>(</big><em>x=None</em>, <em>a=None</em>, <em>b=None</em>, <em>definite=False</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, returns the indefinite integral of the function.
If definite=True is given, returns the definite integral.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>Paul Butler</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">definite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">1/2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">definite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">1/2*pi</span>

<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">f1</span><span class="p">],</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">Piecewise defined function with 2 parts, [[(-2, 0), x |--&gt; 2*x + 4], [(0, 3), x |--&gt; -1/2*x^2 + 3*x + 4]]</span>

<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f5</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f4</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f5</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">Piecewise defined function with 5 parts, [[(-4, -3), y |--&gt; -y - 4], [(-3, -2), y |--&gt; 1/2*y^2 + 3*y + 7/2], [(-2, 0), y |--&gt; -1/2*y^2 - y - 1/2], [(0, 2), y |--&gt; 1/3*y^3 - y - 1/2], [(2, 3), y |--&gt; 3*y - 35/6]]</span>
</pre></div>
</div>
<p>Ensure results are consistent with FTC:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">19/6</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">19/6</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">definite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">19/6</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">infinity</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="n">f1</span><span class="p">],</span> <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">f2</span><span class="p">],</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">infinity</span><span class="p">),</span> <span class="n">f3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">Piecewise defined function with 3 parts, [[(-Infinity, -3), y |--&gt; 1/3*y^3 + 3*y^2 + 9*y + 9], [(-3, 0), y |--&gt; 1/2*y^2 + 3*y + 9/2], [(0, +Infinity), y |--&gt; 3*y + 9/2]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">infinity</span><span class="p">,</span> <span class="n">infinity</span><span class="p">),</span> <span class="n">f1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">definite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">Piecewise defined function with 1 parts, [[(-Infinity, +Infinity), x |--&gt; -1/2*((sgn(x) - 1)*e^(2*x) - 2*e^x*sgn(x) + sgn(x) + 1)*e^(-x) - 1]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">Piecewise defined function with 1 parts, [[(0, 5), x |--&gt; sin(x)]]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Verify that piecewise integrals of zero work (trac #10841):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">SR</span><span class="p">(</span><span class="mi">0</span><span class="p">)]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.intervals">
<tt class="descname">intervals</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>A piecewise non-polynomial example.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">intervals</span><span class="p">()</span>
<span class="go">[(0, 1), (1, 2), (2, 3), (3, 10)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.laplace">
<tt class="descname">laplace</tt><big>(</big><em>x='x'</em>, <em>s='t'</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Laplace transform of self with respect to the variable
var.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - variable of self</li>
<li><tt class="docutils literal"><span class="pre">s</span></tt> - variable of Laplace transform.</li>
</ul>
<p>We assume that a piecewise function is 0 outside of its domain and
that the left-most endpoint of the domain is 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x, s, w&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">-e^(-s)/s + (s + 1)*e^(-2*s)/s^2 + 1/s - e^(-s)/s^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="go">-e^(-w)/w + (w + 1)*e^(-2*w)/w^2 + 1/w - e^(-w)/w^2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;y, t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">(t + 1)*e^(-2*t)/t^2 - e^(-t)/t^2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">t</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="n">infinity</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="go">(s + 1)*e^(-s)/s^2 + 2*e^(-s)/s - 1/s^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.length">
<tt class="descname">length</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of pieces of this function.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.list">
<tt class="descname">list</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pieces of this function as a list of functions.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[[(0, 1), x |--&gt; 1], [(1, 2), x |--&gt; -x + 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.plot">
<tt class="descname">plot</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the plot of self.</p>
<p>Keyword arguments are passed onto the plot command for each piece
of the function. E.g., the plot_points keyword affects each
segment of the plot.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">Graphics object consisting of 4 graphics primitives</span>
</pre></div>
</div>
<p>Remember: to view this, type show(P) or P.save(&#8220;path/myplot.png&#8221;)
and then open it in a graphics viewer such as GIMP.</p>
<p>TESTS:</p>
<p>We should not add each piece to the legend individually, since
this creates duplicates (<a class="reference external" href="http://trac.sagemath.org/12651">trac ticket #12651</a>). This tests that only
one of the graphics objects in the plot has a non-<tt class="docutils literal"><span class="pre">None</span></tt>
<tt class="docutils literal"><span class="pre">legend_label</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">f1</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend_label</span><span class="o">=</span><span class="s">&#39;$f(x)$&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">line</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">_objects</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">options</span><span class="p">()[</span><span class="s">&#39;legend_label&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum">
<tt class="descname">plot_fourier_series_partial_sum</tt><big>(</big><em>N</em>, <em>L</em>, <em>xmin</em>, <em>xmax</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the partial sum</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} +  sum_{n=1}^N [a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>over xmin x xmin.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>   <span class="c"># long time</span>
</pre></div>
</div>
<p>Remember, to view this type show(P) or P.save(&#8220;path/myplot.png&#8221;)
and then open it in a graphics viewer such as GIMP.</p>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum_cesaro">
<tt class="descname">plot_fourier_series_partial_sum_cesaro</tt><big>(</big><em>N</em>, <em>L</em>, <em>xmin</em>, <em>xmax</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum_cesaro" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the partial sum</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} +                     \sum_{n=1}^N (1-n/N)*[a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>over xmin x xmin. This is a &#8220;smoother&#8221; partial sum - the Gibbs
phenomenon is mollified.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum_cesaro</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum_cesaro</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>   <span class="c"># long time</span>
</pre></div>
</div>
<p>Remember, to view this type show(P) or P.save(&#8220;path/myplot.png&#8221;)
and then open it in a graphics viewer such as GIMP.</p>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum_filtered">
<tt class="descname">plot_fourier_series_partial_sum_filtered</tt><big>(</big><em>N</em>, <em>L</em>, <em>F</em>, <em>xmin</em>, <em>xmax</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum_filtered" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the partial sum</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} +                     \sum_{n=1}^N F_n*[a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>over xmin x xmin, where <span class="math">\(F = [F_1,F_2, ..., F_{N}]\)</span> is a
list of length <span class="math">\(N\)</span> consisting of real numbers. This can be
used to plot FS solutions to the heat and wave PDEs.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum_filtered</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum_filtered</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="n">pi</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>   <span class="c"># long time</span>
</pre></div>
</div>
<p>Remember, to view this type show(P) or P.save(&#8220;path/myplot.png&#8221;)
and then open it in a graphics viewer such as GIMP.</p>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum_hann">
<tt class="descname">plot_fourier_series_partial_sum_hann</tt><big>(</big><em>N</em>, <em>L</em>, <em>xmin</em>, <em>xmax</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.plot_fourier_series_partial_sum_hann" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the partial sum</p>
<div class="math">
\[f(x) \sim \frac{a_0}{2} + \sum_{n=1}^N H_N(n)*[a_n\cos(\frac{n\pi x}{L}) + b_n\sin(\frac{n\pi x}{L})],\]</div>
<p>over xmin x xmin, where H_N(x) = (0.5)+(0.5)*cos(x*pi/N) is the
N-th Hann filter.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum_hann</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot_fourier_series_partial_sum_hann</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>   <span class="c"># long time</span>
</pre></div>
</div>
<p>Remember, to view this type show(P) or P.save(&#8220;path/myplot.png&#8221;)
and then open it in a graphics viewer such as GIMP.</p>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.riemann_sum">
<tt class="descname">riemann_sum</tt><big>(</big><em>N</em>, <em>mode=None</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.riemann_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the piecewise line function defined by the Riemann sums in
numerical integration based on a subdivision into N subintervals.
Set mode=&#8221;midpoint&#8221; for the height of the rectangles to be
determined by the midpoint of the subinterval; set mode=&#8221;right&#8221; for
the height of the rectangles to be determined by the right-hand
endpoint of the subinterval; the default is mode=&#8221;left&#8221; (the height
of the rectangles to be determined by the left-hand endpoint of
the subinterval).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">riemann_sum</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&quot;midpoint&quot;</span><span class="p">)</span>
<span class="go">Piecewise defined function with 6 parts, [[(0, 1/3), 1/36], [(1/3, 2/3), 1/4], [(2/3, 1), 25/36], [(1, 4/3), 131/36], [(4/3, 5/3), 11/4], [(5/3, 2), 59/36]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)]])</span>
<span class="gp">sage: </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">riemann_sum</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">add</span><span class="p">([</span><span class="n">line</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">)]],</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span><span class="n">f</span> <span class="ow">in</span> <span class="n">rsf</span><span class="o">.</span><span class="n">list</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">+</span> <span class="n">L</span>
<span class="go">Graphics object consisting of 15 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)]],</span> <span class="n">x</span><span class="p">)</span> <span class="c">## example 3</span>
<span class="gp">sage: </span><span class="n">rsf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">riemann_sum</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">rsf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">add</span><span class="p">([</span><span class="n">line</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">)]],</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span><span class="n">f</span> <span class="ow">in</span> <span class="n">rsf</span><span class="o">.</span><span class="n">list</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">+</span> <span class="n">L</span>
<span class="go">Graphics object consisting of 17 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.riemann_sum_integral_approximation">
<tt class="descname">riemann_sum_integral_approximation</tt><big>(</big><em>N</em>, <em>mode=None</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.riemann_sum_integral_approximation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the piecewise line function defined by the Riemann sums in
numerical integration based on a subdivision into N subintervals.</p>
<p>Set mode=&#8221;midpoint&#8221; for the height of the rectangles to be
determined by the midpoint of the subinterval; set mode=&#8221;right&#8221; for
the height of the rectangles to be determined by the right-hand
endpoint of the subinterval; the default is mode=&#8221;left&#8221; (the height
of the rectangles to be determined by the left-hand endpoint of
the subinterval).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>                   <span class="c">## example 1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">riemann_sum_integral_approximation</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">17/6</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">riemann_sum_integral_approximation</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">)</span>
<span class="go">19/6</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">riemann_sum_integral_approximation</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&quot;midpoint&quot;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">definite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.sine_series_coefficient">
<tt class="descname">sine_series_coefficient</tt><big>(</big><em>n</em>, <em>L</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.sine_series_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the n-th sine series coefficient of
<span class="math">\(\sin(n\pi x/L)\)</span>, <span class="math">\(b_n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> - the function f(x), defined over 0 x L (no
checking is done to insure this)</li>
<li><tt class="docutils literal"><span class="pre">n</span></tt> - an integer n0</li>
<li><tt class="docutils literal"><span class="pre">L</span></tt> - (the period)/2</li>
</ul>
<p>OUTPUT:</p>
<p><span class="math">\(b_n = \frac{2}{L}\int_{-L}^L f(x)\sin(n\pi x/L)dx\)</span> such
that</p>
<div class="math">
\[\begin{split}f(x) \sim \sum_{n=1}^\infty b_n\sin(\frac{n\pi x}{L}),\ \ 0&lt;x&lt;L.\end{split}\]</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sine_series_coefficient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sine_series_coefficient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4/3/pi</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.tangent_line">
<tt class="descname">tangent_line</tt><big>(</big><em>pt</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.tangent_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the linear function defining the tangent line of the
piecewise function self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">tf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tangent_line</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span> <span class="c">## tangent line at x=0.9</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span>
<span class="go">Graphics object consisting of 4 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.trapezoid">
<tt class="descname">trapezoid</tt><big>(</big><em>N</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.trapezoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the piecewise line function defined by the trapezoid rule
for numerical integration based on a subdivision into N
subintervals.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="mi">5</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Piecewise defined function with 4 parts, [[(0, 1/2), 1/2*x], [(1/2, 1), 9/2*x - 2], [(1, 3/2), 1/2*x + 2], [(3/2, 2), -7/2*x + 8]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">tf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">add</span><span class="p">([</span><span class="n">line</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)]],</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span><span class="n">f</span> <span class="ow">in</span> <span class="n">tf</span><span class="o">.</span><span class="n">list</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">+</span><span class="n">Q</span><span class="o">+</span><span class="n">L</span>
<span class="go">Graphics object consisting of 9 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">]])</span> <span class="c">## example 3</span>
<span class="gp">sage: </span><span class="n">tf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">add</span><span class="p">([</span><span class="n">line</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)]],</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span><span class="n">f</span> <span class="ow">in</span> <span class="n">tf</span><span class="o">.</span><span class="n">list</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">+</span><span class="n">Q</span><span class="o">+</span><span class="n">L</span>
<span class="go">Graphics object consisting of 13 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Use variables other than x (<a class="reference external" href="http://trac.sagemath.org/13836">trac ticket #13836</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="mi">5</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Piecewise defined function with 4 parts, [[(0, 1/2), 1/2*y], [(1/2, 1), 9/2*y - 2], [(1, 3/2), 1/2*y + 2], [(3/2, 2), -7/2*y + 8]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.trapezoid_integral_approximation">
<tt class="descname">trapezoid_integral_approximation</tt><big>(</big><em>N</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.trapezoid_integral_approximation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the approximation given by the trapezoid rule for numerical
integration based on a subdivision into N subintervals.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>                      <span class="c">## example 1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ta</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">trapezoid_integral_approximation</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s">&#39;trapezoid approximation = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">ta</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">definite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tt</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s">&#39;area under curve = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">tt</span>
<span class="go">Graphics object consisting of 10 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>  <span class="c">## example 2</span>
<span class="gp">sage: </span><span class="n">tf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ta</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">trapezoid_integral_approximation</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s">&#39;trapezoid approximation = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">ta</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">definite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tt</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s">&#39;area under curve = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">+</span><span class="n">Q</span><span class="o">+</span><span class="n">t</span><span class="o">+</span><span class="n">tt</span>
<span class="go">Graphics object consisting of 8 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.unextend">
<tt class="descname">unextend</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.unextend" title="Permalink to this definition">¶</a></dt>
<dd><p>This removes any parts in the front or back of the function which
is zero (the inverse to extend_by_zero_to).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">],[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">extend_by_zero_to</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="n">e</span>
<span class="go">Piecewise defined function with 4 parts, [[(-10, -3), 0], [(-3, -1), x + 3], [(-1, 1), -x^2 + 1], [(1, 10), 0]]</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">unextend</span><span class="p">();</span> <span class="n">d</span>
<span class="go">Piecewise defined function with 2 parts, [[(-3, -1), x + 3], [(-1, 1), -x^2 + 1]]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">==</span><span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.functions.piecewise.PiecewisePolynomial.which_function">
<tt class="descname">which_function</tt><big>(</big><em>x0</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.PiecewisePolynomial.which_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the function piece used to evaluate self at x0.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">z</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f4</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f2</span><span class="p">],[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">f3</span><span class="p">],[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">f4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">which_function</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x |--&gt; -x + 1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.functions.piecewise.piecewise">
<tt class="descclassname">sage.functions.piecewise.</tt><tt class="descname">piecewise</tt><big>(</big><em>list_of_pairs</em>, <em>var=None</em><big>)</big><a class="headerlink" href="#sage.functions.piecewise.piecewise" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a piecewise function from a list of (interval, function)
pairs.</p>
<p><tt class="docutils literal"><span class="pre">list_of_pairs</span></tt> is a list of pairs (I, fcn), where
fcn is a Sage function (such as a polynomial over RR, or functions
using the lambda notation), and I is an interval such as I = (1,3).
Two consecutive intervals must share a common endpoint.</p>
<p>If the optional <tt class="docutils literal"><span class="pre">var</span></tt> is specified, then any symbolic expressions
in the list will be converted to symbolic functions using
<tt class="docutils literal"><span class="pre">fcn.function(var)</span></tt>.  (This says which variable is considered to
be &#8220;piecewise&#8221;.)</p>
<p>We assume that these definitions are consistent (ie, no checking is
done).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">f1</span><span class="p">],[(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="p">),</span><span class="n">f2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">([[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]],</span> <span class="n">x</span><span class="p">);</span> <span class="n">f</span>
<span class="go">Piecewise defined function with 2 parts, [[(0, 1), x |--&gt; x], [(1, 2), x |--&gt; x^2]]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
<span class="go">0.900000000000000</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span>
<span class="go">1.21000000000000</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="transcendental.html"
                                  title="previous chapter">Number-Theoretic Functions</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="spike_function.html"
                                  title="next chapter">Spike Functions</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/functions/piecewise.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spike_function.html" title="Spike Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="transcendental.html" title="Number-Theoretic Functions"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Functions</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>