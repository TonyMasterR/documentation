<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Counting Primes &mdash; Sage Reference Manual v6.10: Functions</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.10: Functions" href="../../index.html" />
    <link rel="next" title="Symbolic Minimum and Maximum" href="min_max.html" />
    <link rel="prev" title="Generalized Functions" href="generalized.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="min_max.html" title="Symbolic Minimum and Maximum"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="generalized.html" title="Generalized Functions"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Functions</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="counting-primes">
<span id="sage-functions-prime-pi"></span><h1>Counting Primes<a class="headerlink" href="#counting-primes" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.functions.prime_pi"></span><p>AUTHORS:</p>
<ul class="simple">
<li>R. Andrew Ohana (2009): initial version of efficient prime_pi</li>
<li>William Stein (2009): fix plot method</li>
<li>R. Andrew Ohana (2011): complete rewrite, ~5x speedup</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">prime_pi</span><span class="o">.</span><span class="n">PrimePi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">prime_pi</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">==</span> <span class="n">z</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.functions.prime_pi.PrimePi">
<em class="property">class </em><tt class="descclassname">sage.functions.prime_pi.</tt><tt class="descname">PrimePi</tt><a class="headerlink" href="#sage.functions.prime_pi.PrimePi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../calculus/sage/symbolic/function.html#sage.symbolic.function.BuiltinFunction" title="(in Sage Reference Manual: Symbolic Calculus v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">sage.symbolic.function.BuiltinFunction</span></tt></a></p>
<p>The prime counting function, which counts the number of primes less
than or equal to a given value.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - a real number</li>
<li><tt class="docutils literal"><span class="pre">prime_bound</span></tt> - (default 0) a real number &lt; 2^32, <tt class="docutils literal"><span class="pre">prime_pi</span></tt> will
make sure to use all the primes up to <tt class="docutils literal"><span class="pre">prime_bound</span></tt> (although,
possibly more) in computing <tt class="docutils literal"><span class="pre">prime_pi</span></tt>, this can potentially
speedup the time of computation, at a cost to memory usage.</li>
</ul>
<p>OUTPUT:</p>
<p>integer &#8211; the number of primes <span class="math">\(\leq\)</span> <tt class="docutils literal"><span class="pre">x</span></tt></p>
<p>EXAMPLES:</p>
<p>These examples test common inputs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">25</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">168</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="go">9592</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">500509</span><span class="p">)</span>
<span class="go">41581</span>
</pre></div>
</div>
<p>These examples test a variety of odd inputs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2357</span><span class="p">))</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="mi">30957</span><span class="p">,</span> <span class="mi">9750979</span><span class="p">))</span>
<span class="go">3337</span>
</pre></div>
</div>
<p>We test non-trivial <tt class="docutils literal"><span class="pre">prime_bound</span></tt> values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="go">9592</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">500509</span><span class="p">,</span> <span class="mi">50051</span><span class="p">)</span>
<span class="go">41581</span>
</pre></div>
</div>
<p>The following test is to verify that ticket #4670 has been essentially
resolved:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">prime_pi</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span>
<span class="go">455052511</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">prime_pi</span></tt> function also has a special plotting method, so it
plots quickly and perfectly as a step function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">prime_pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>Uses a recursive implementation, using the optimizations described in
<a class="reference internal" href="#rao2011" id="id1">[RAO2011]</a>.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="rao2011" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[RAO2011]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id3">3</a>)</em> R.A. Ohana. On Prime Counting in Abelian Number Fields.
<a class="reference external" href="http://wstein.org/home/ohanar/papers/abelian_prime_counting/main.pdf">http://wstein.org/home/ohanar/papers/abelian_prime_counting/main.pdf</a>.</td></tr>
</tbody>
</table>
<p>AUTHOR:</p>
<ul class="simple">
<li>R. Andrew Ohana (2011)</li>
</ul>
<dl class="method">
<dt id="sage.functions.prime_pi.PrimePi.plot">
<tt class="descname">plot</tt><big>(</big><em>xmin=0</em>, <em>xmax=100</em>, <em>vertical_lines=True</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.functions.prime_pi.PrimePi.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a plot of the prime counting function from <tt class="docutils literal"><span class="pre">xmin</span></tt> to <tt class="docutils literal"><span class="pre">xmax</span></tt>.
All additional arguments are passed on to the line command.</p>
<p>WARNING: we draw the plot of <tt class="docutils literal"><span class="pre">prime_pi</span></tt> as a stairstep function with
explicitly drawn vertical lines where the function jumps. Technically
there should not be any vertical lines, but they make the graph look
much better, so we include them. Use the option <tt class="docutils literal"><span class="pre">vertical_lines=False</span></tt>
to turn these off.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">plot</span><span class="p">(</span><span class="n">prime_pi</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">prime_pi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2501</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vertical_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Graphics object consisting of 16 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.functions.prime_pi.legendre_phi">
<tt class="descclassname">sage.functions.prime_pi.</tt><tt class="descname">legendre_phi</tt><big>(</big><em>x</em>, <em>a</em><big>)</big><a class="headerlink" href="#sage.functions.prime_pi.legendre_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Legendre&#8217;s formula, also known as the partial sieve function, is a useful
combinatorial function for computing the prime counting function (the
<tt class="docutils literal"><span class="pre">prime_pi</span></tt> method in Sage). It counts the number of positive integers
<span class="math">\(\leq\)</span> <tt class="docutils literal"><span class="pre">x</span></tt> that are not divisible by the first <tt class="docutils literal"><span class="pre">a</span></tt> primes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> &#8211; a real number</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> &#8211; a non-negative integer</li>
</ul>
<p>OUTPUT:</p>
<p>integer &#8211; the number of positive integers <span class="math">\(\leq\)</span> <tt class="docutils literal"><span class="pre">x</span></tt> that are not
divisible by the first <tt class="docutils literal"><span class="pre">a</span></tt> primes</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">29375</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">14688</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">91753</span><span class="p">,</span> <span class="mi">5973</span><span class="p">)</span>
<span class="go">2893</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">),</span> <span class="mi">92372</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">4215701455</span><span class="p">,</span> <span class="mi">6450023226</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>Uses a recursive implementation, using the optimizations described in
<a class="reference internal" href="#rao2011" id="id2">[RAO2011]</a>.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>R. Andrew Ohana (2011)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.functions.prime_pi.partial_sieve_function">
<tt class="descclassname">sage.functions.prime_pi.</tt><tt class="descname">partial_sieve_function</tt><big>(</big><em>x</em>, <em>a</em><big>)</big><a class="headerlink" href="#sage.functions.prime_pi.partial_sieve_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Legendre&#8217;s formula, also known as the partial sieve function, is a useful
combinatorial function for computing the prime counting function (the
<tt class="docutils literal"><span class="pre">prime_pi</span></tt> method in Sage). It counts the number of positive integers
<span class="math">\(\leq\)</span> <tt class="docutils literal"><span class="pre">x</span></tt> that are not divisible by the first <tt class="docutils literal"><span class="pre">a</span></tt> primes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> &#8211; a real number</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> &#8211; a non-negative integer</li>
</ul>
<p>OUTPUT:</p>
<p>integer &#8211; the number of positive integers <span class="math">\(\leq\)</span> <tt class="docutils literal"><span class="pre">x</span></tt> that are not
divisible by the first <tt class="docutils literal"><span class="pre">a</span></tt> primes</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">29375</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">14688</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">91753</span><span class="p">,</span> <span class="mi">5973</span><span class="p">)</span>
<span class="go">2893</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">),</span> <span class="mi">92372</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">legendre_phi</span><span class="p">(</span><span class="mi">4215701455</span><span class="p">,</span> <span class="mi">6450023226</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>Uses a recursive implementation, using the optimizations described in
<a class="reference internal" href="#rao2011" id="id3">[RAO2011]</a>.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>R. Andrew Ohana (2011)</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="generalized.html"
                                  title="previous chapter">Generalized Functions</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="min_max.html"
                                  title="next chapter">Symbolic Minimum and Maximum</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/functions/prime_pi.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="min_max.html" title="Symbolic Minimum and Maximum"
             >next</a> |</li>
        <li class="right" >
          <a href="generalized.html" title="Generalized Functions"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Functions</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>