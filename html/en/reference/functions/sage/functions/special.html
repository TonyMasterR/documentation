<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Special Functions &mdash; Sage Reference Manual v6.7: Functions</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.7: Functions" href="../../index.html" />
    <link rel="next" title="Hypergeometric Functions" href="hypergeometric.html" />
    <link rel="prev" title="Other functions" href="other.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypergeometric.html" title="Hypergeometric Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="other.html" title="Other functions"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Functions</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="special-functions">
<span id="sage-functions-special"></span><h1>Special Functions<a class="headerlink" href="#special-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.functions.special"></span><p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner (2006-13-06): initial version</li>
<li>David Joyner (2006-30-10): bug fixes to pari wrappers of Bessel
functions, hypergeometric_U</li>
<li>William Stein (2008-02): Impose some sanity checks.</li>
<li>David Joyner (2008-04-23): addition of elliptic integrals</li>
</ul>
<p>This module provides easy access to many of Maxima and PARI&#8217;s
special functions.</p>
<p>Maxima&#8217;s special functions package (which includes spherical
harmonic functions, spherical Bessel functions (of the 1st and 2nd
kind), and spherical Hankel functions (of the 1st and 2nd kind))
was written by Barton Willis of the University of Nebraska at
Kearney. It is released under the terms of the General Public
License (GPL).</p>
<p>Support for elliptic functions and integrals was written by Raymond
Toy. It is placed under the terms of the General Public License
(GPL) that governs the distribution of Maxima.</p>
<p>Next, we summarize some of the properties of the functions
implemented here.</p>
<ul>
<li><p class="first">Spherical harmonics: Laplace&#8217;s equation in spherical coordinates
is:</p>
<div class="math">
\[{\frac{1}{r^2}}{\frac{\partial}{\partial r}}   \left(r^2 {\frac{\partial f}{\partial r}}\right) +   {\frac{1}{r^2}\sin\theta}{\frac{\partial}{\partial \theta}}   \left(\sin\theta {\frac{\partial f}{\partial \theta}}\right) +   {\frac{1}{r^2\sin^2\theta}}{\frac{\partial^2 f}{\partial \varphi^2}} = 0.\]</div>
<p>Note that the spherical coordinates <span class="math">\(\theta\)</span> and
<span class="math">\(\varphi\)</span> are defined here as follows: <span class="math">\(\theta\)</span> is
the colatitude or polar angle, ranging from
<span class="math">\(0\leq\theta\leq\pi\)</span> and <span class="math">\(\varphi\)</span> the azimuth or
longitude, ranging from <span class="math">\(0\leq\varphi&lt;2\pi\)</span>.</p>
<p>The general solution which remains finite towards infinity is a
linear combination of functions of the form</p>
<div class="math">
\[r^{-1-\ell} \cos (m \varphi) P_\ell^m (\cos{\theta} )\]</div>
<p>and</p>
<div class="math">
\[r^{-1-\ell} \sin (m \varphi) P_\ell^m (\cos{\theta} )\]</div>
<p>where <span class="math">\(P_\ell^m\)</span> are the associated Legendre polynomials,
and with integer parameters <span class="math">\(\ell \ge 0\)</span> and <span class="math">\(m\)</span>
from <span class="math">\(0\)</span> to <span class="math">\(\ell\)</span>. Put in another way, the
solutions with integer parameters <span class="math">\(\ell \ge 0\)</span> and
<span class="math">\(- \ell\leq m\leq \ell\)</span>, can be written as linear
combinations of:</p>
<div class="math">
\[U_{\ell,m}(r,\theta , \varphi ) = r^{-1-\ell} Y_\ell^m( \theta , \varphi )\]</div>
<p>where the functions <span class="math">\(Y\)</span> are the spherical harmonic
functions with parameters <span class="math">\(\ell\)</span>, <span class="math">\(m\)</span>, which can be
written as:</p>
<div class="math">
\[Y_\ell^m( \theta , \varphi )     = \sqrt{{\frac{(2\ell+1)}{4\pi}}{\frac{(\ell-m)!}{(\ell+m)!}}}       \cdot e^{i m \varphi } \cdot P_\ell^m ( \cos{\theta} ) .\]</div>
<p>The spherical harmonics obey the normalisation condition</p>
<div class="math">
\[\int_{\theta=0}^\pi\int_{\varphi=0}^{2\pi} Y_\ell^mY_{\ell'}^{m'*}\,d\Omega =\delta_{\ell\ell'}\delta_{mm'}\quad\quad d\Omega =\sin\theta\,d\varphi\,d\theta .\]</div>
</li>
<li><p class="first">When solving for separable solutions of Laplace&#8217;s equation in
spherical coordinates, the radial equation has the form:</p>
<div class="math">
\[x^2 \frac{d^2 y}{dx^2} + 2x \frac{dy}{dx} + [x^2 - n(n+1)]y = 0.\]</div>
<p>The spherical Bessel functions <span class="math">\(j_n\)</span> and <span class="math">\(y_n\)</span>,
are two linearly independent solutions to this equation. They are
related to the ordinary Bessel functions <span class="math">\(J_n\)</span> and
<span class="math">\(Y_n\)</span> by:</p>
<div class="math">
\[j_n(x) = \sqrt{\frac{\pi}{2x}} J_{n+1/2}(x),\]</div>
<div class="math">
\[y_n(x) = \sqrt{\frac{\pi}{2x}} Y_{n+1/2}(x)     = (-1)^{n+1} \sqrt{\frac{\pi}{2x}} J_{-n-1/2}(x).\]</div>
</li>
<li><p class="first">For <span class="math">\(x&gt;0\)</span>, the confluent hypergeometric function
<span class="math">\(y = U(a,b,x)\)</span> is defined to be the solution to Kummer&#8217;s
differential equation</p>
<div class="math">
\[xy'' + (b-x)y' - ay = 0,\]</div>
<p>which satisfies <span class="math">\(U(a,b,x) \sim x^{-a}\)</span>, as
<span class="math">\(x\rightarrow \infty\)</span>. (There is a linearly independent
solution, called Kummer&#8217;s function <span class="math">\(M(a,b,x)\)</span>, which is not
implemented.)</p>
<ul>
<li><p class="first">The incomplete elliptic integrals (of the first kind, etc.) are:</p>
<div class="math">
\[\begin{split}\begin{array}{c} \displaystyle\int_0^\phi \frac{1}{\sqrt{1 - m\sin(x)^2}}\, dx,\\ \displaystyle\int_0^\phi \sqrt{1 - m\sin(x)^2}\, dx,\\ \displaystyle\int_0^\phi \frac{\sqrt{1-mt^2}}{\sqrt(1 - t^2)}\, dx,\\ \displaystyle\int_0^\phi \frac{1}{\sqrt{1 - m\sin(x)^2\sqrt{1 - n\sin(x)^2}}}\, dx, \end{array}\end{split}\]</div>
<p>and the complete ones are obtained by taking <span class="math">\(\phi =\pi/2\)</span>.</p>
</li>
</ul>
</li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li>Abramowitz and Stegun: Handbook of Mathematical Functions,
<a class="reference external" href="http://www.math.sfu.ca/~cbm/aands/">http://www.math.sfu.ca/~cbm/aands/</a></li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Spherical_harmonics">http://en.wikipedia.org/wiki/Spherical_harmonics</a></li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Helmholtz_equation">http://en.wikipedia.org/wiki/Helmholtz_equation</a></li>
<li>Online Encyclopedia of Special Function
<a class="reference external" href="http://algo.inria.fr/esf/index.html">http://algo.inria.fr/esf/index.html</a></li>
</ul>
<p>TODO: Resolve weird bug in commented out code in hypergeometric_U
below.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner and William Stein</li>
</ul>
<p>Added 16-02-2008 (wdj): optional calls to scipy and replace all
&#8216;#random&#8217; by &#8216;...&#8217; (both at the request of William Stein)</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">SciPy&#8217;s versions are poorly documented and seem less
accurate than the Maxima and PARI versions; typically they are limited
by hardware floats precision.</p>
</div>
<dl class="class">
<dt id="sage.functions.special.EllipticE">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">EllipticE</tt><a class="headerlink" href="#sage.functions.special.EllipticE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.functions.special.MaximaFunction" title="sage.functions.special.MaximaFunction"><tt class="xref py py-class docutils literal"><span class="pre">sage.functions.special.MaximaFunction</span></tt></a></p>
<p>This returns the value of the &#8220;incomplete elliptic integral of the
second kind,&#8221;</p>
<div class="math">
\[\int_0^\phi \sqrt{1 - m\sin(x)^2}\, dx,\]</div>
<p>i.e., <tt class="docutils literal"><span class="pre">integrate(sqrt(1</span> <span class="pre">-</span> <span class="pre">m*sin(x)^2),</span> <span class="pre">x,</span> <span class="pre">0,</span> <span class="pre">phi)</span></tt>.  Taking <span class="math">\(\phi
= \pi/2\)</span> gives <tt class="docutils literal"><span class="pre">elliptic_ec</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&quot;z&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="c"># this is still wrong: must be abs(sin(z)) + 2*round(z/pi)</span>
<span class="gp">sage: </span><span class="n">elliptic_e</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">2*round(z/pi) + sin(z)</span>
<span class="gp">sage: </span><span class="n">elliptic_e</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">z</span>
<span class="gp">sage: </span><span class="n">elliptic_e</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="c"># abs tol 2e-15</span>
<span class="go">0.498011394498832</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.functions.special.EllipticEC">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">EllipticEC</tt><a class="headerlink" href="#sage.functions.special.EllipticEC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.functions.special.MaximaFunction" title="sage.functions.special.MaximaFunction"><tt class="xref py py-class docutils literal"><span class="pre">sage.functions.special.MaximaFunction</span></tt></a></p>
<p>This returns the value of the &#8220;complete elliptic integral of the
second kind,&#8221;</p>
<div class="math">
\[\int_0^{\pi/2} \sqrt{1 - m\sin(x)^2}\, dx.\]</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">elliptic_ec</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">1.53075763689776</span>
<span class="gp">sage: </span><span class="n">elliptic_ec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="go">1/2*(elliptic_ec(x) - elliptic_kc(x))/x</span>

<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">elliptic_ec</span><span class="p">))</span>
<span class="go">elliptic_ec</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.functions.special.EllipticEU">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">EllipticEU</tt><a class="headerlink" href="#sage.functions.special.EllipticEU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.functions.special.MaximaFunction" title="sage.functions.special.MaximaFunction"><tt class="xref py py-class docutils literal"><span class="pre">sage.functions.special.MaximaFunction</span></tt></a></p>
<p>Return the value of the &#8220;incomplete elliptic integral of the
second kind,&#8221;</p>
<div class="math">
\[\int_0^u \mathrm{dn}(x,m)^2\, dx = \int_0^\tau
{\sqrt{1-m x^2}\over\sqrt{1-x^2}}\, dx.\]</div>
<p>where <span class="math">\(\tau = \mathrm{sn}(u, m)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">elliptic_eu</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="go">0.496054551286597</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.functions.special.EllipticF">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">EllipticF</tt><a class="headerlink" href="#sage.functions.special.EllipticF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.functions.special.MaximaFunction" title="sage.functions.special.MaximaFunction"><tt class="xref py py-class docutils literal"><span class="pre">sage.functions.special.MaximaFunction</span></tt></a></p>
<p>This returns the value of the &#8220;incomplete elliptic integral of the
first kind,&#8221;</p>
<div class="math">
\[\int_0^\phi \frac{dx}{\sqrt{1 - m\sin(x)^2}},\]</div>
<p>i.e., <tt class="docutils literal"><span class="pre">integrate(1/sqrt(1</span> <span class="pre">-</span> <span class="pre">m*sin(x)^2),</span> <span class="pre">x,</span> <span class="pre">0,</span> <span class="pre">phi)</span></tt>.  Taking
<span class="math">\(\phi = \pi/2\)</span> gives <tt class="docutils literal"><span class="pre">elliptic_kc</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&quot;z&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">elliptic_f</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">z</span>
<span class="gp">sage: </span><span class="n">elliptic_f</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">log(tan(1/4*pi + 1/2*z))</span>
<span class="gp">sage: </span><span class="n">elliptic_f</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="go">0.200132506747543</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.functions.special.EllipticKC">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">EllipticKC</tt><a class="headerlink" href="#sage.functions.special.EllipticKC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.functions.special.MaximaFunction" title="sage.functions.special.MaximaFunction"><tt class="xref py py-class docutils literal"><span class="pre">sage.functions.special.MaximaFunction</span></tt></a></p>
<p>This returns the value of the &#8220;complete elliptic integral of the
first kind,&#8221;</p>
<div class="math">
\[\int_0^{\pi/2} \frac{dx}{\sqrt{1 - m\sin(x)^2}}.\]</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">elliptic_kc</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">1.85407467730137</span>
<span class="gp">sage: </span><span class="n">elliptic_f</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">1.85407467730137</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.functions.special.EllipticPi">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">EllipticPi</tt><a class="headerlink" href="#sage.functions.special.EllipticPi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.functions.special.MaximaFunction" title="sage.functions.special.MaximaFunction"><tt class="xref py py-class docutils literal"><span class="pre">sage.functions.special.MaximaFunction</span></tt></a></p>
<p>This returns the value of the &#8220;incomplete elliptic integral of the
third kind,&#8221;</p>
<div class="math">
\[\text{elliptic\_pi}(n, t, m) = \int_0^t \frac{dx}{(1 - n \sin(x)^2)
\sqrt{1 - m \sin(x)^2}}.\]</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; a real number, called the &#8220;characteristic&#8221;</li>
<li><tt class="docutils literal"><span class="pre">t</span></tt> &#8211; a real number, called the &#8220;amplitude&#8221;</li>
<li><tt class="docutils literal"><span class="pre">m</span></tt> &#8211; a real number, called the &#8220;parameter&#8221;</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span><span class="p">(</span><span class="n">elliptic_pi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">1.14779357469632</span>
</pre></div>
</div>
<p>Compare the value computed by Maxima to the definition as a definite integral
(using GSL):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">elliptic_pi</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="go">0.200665068220979</span>
<span class="gp">sage: </span><span class="n">numerical_integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="go">(0.2006650682209791, 2.227829789769088e-15)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Numerical evaluation and symbolic manipulation are provided by <a class="reference external" href="http://maxima.sourceforge.net/docs/manual/en/maxima_16.html#SEC91">Maxima</a>.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li>Abramowitz and Stegun: Handbook of Mathematical Functions, section 17.7
<a class="reference external" href="http://www.math.sfu.ca/~cbm/aands/">http://www.math.sfu.ca/~cbm/aands/</a></li>
<li>Elliptic Functions in <a class="reference external" href="http://maxima.sourceforge.net/docs/manual/en/maxima_16.html#SEC91">Maxima</a></li>
</ul>
</dd></dl>

<dl class="class">
<dt id="sage.functions.special.MaximaFunction">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">MaximaFunction</tt><big>(</big><em>name</em>, <em>nargs=2</em>, <em>conversions={}</em><big>)</big><a class="headerlink" href="#sage.functions.special.MaximaFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../calculus/sage/symbolic/function.html#sage.symbolic.function.BuiltinFunction" title="(in Sage Reference Manual: Symbolic Calculus v6.7)"><tt class="xref py py-class docutils literal"><span class="pre">sage.symbolic.function.BuiltinFunction</span></tt></a></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.functions.special</span> <span class="kn">import</span> <span class="n">MaximaFunction</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">MaximaFunction</span><span class="p">(</span><span class="s">&quot;jacobi_sn&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">tanh(1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">0.470750473655657</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.functions.special.SphericalHarmonic">
<em class="property">class </em><tt class="descclassname">sage.functions.special.</tt><tt class="descname">SphericalHarmonic</tt><a class="headerlink" href="#sage.functions.special.SphericalHarmonic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../calculus/sage/symbolic/function.html#sage.symbolic.function.BuiltinFunction" title="(in Sage Reference Manual: Symbolic Calculus v6.7)"><tt class="xref py py-class docutils literal"><span class="pre">sage.symbolic.function.BuiltinFunction</span></tt></a></p>
<p>Returns the spherical harmonic function <span class="math">\(Y_n^m(\theta, \varphi)\)</span>.</p>
<p>For integers <span class="math">\(n &gt; -1\)</span>, <span class="math">\(|m| \leq n\)</span>, simplification is done automatically.
Numeric evaluation is supported for complex <span class="math">\(n\)</span> and <span class="math">\(m\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x, y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">spherical_harmonic</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">15/4*sqrt(7/30)*cos(x)*e^(2*I*y)*sin(x)^2/sqrt(pi)</span>
<span class="gp">sage: </span><span class="n">spherical_harmonic</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">15/4*sqrt(7/30)*cos(1)*e^(4*I)*sin(1)^2/sqrt(pi)</span>
<span class="gp">sage: </span><span class="n">spherical_harmonic</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">I</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-0.351154337307488 - 0.415562233975369*I</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">spherical_harmonic</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">Y_{3}^{2}\left(x, y\right)</span>
<span class="gp">sage: </span><span class="n">spherical_harmonic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.elliptic_j">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">elliptic_j</tt><big>(</big><em>z</em><big>)</big><a class="headerlink" href="#sage.functions.special.elliptic_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the elliptic modular <span class="math">\(j\)</span>-function evaluated at <span class="math">\(z\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">z</span></tt> (complex) &#8211; a complex number with positive imaginary part.</li>
</ul>
<p>OUTPUT:</p>
<p>(complex) The value of <span class="math">\(j(z)\)</span>.</p>
<p>ALGORITHM:</p>
<p>Calls the <tt class="docutils literal"><span class="pre">pari</span></tt> function <tt class="docutils literal"><span class="pre">ellj()</span></tt>.</p>
<p>AUTHOR:</p>
<p>John Cremona</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre>   sage: elliptic_j(CC(i))
   1728.00000000000
   sage: elliptic_j(sqrt(-2.0))
   8000.00000000000
   sage: z = ComplexField(100)(1,sqrt(11))/2
   sage: elliptic_j(z)
   -32768.000...
   sage: elliptic_j(z).real().round()
   -32768

::

   sage: tau = (1 + sqrt(-163))/2
   sage: (-elliptic_j(tau.n(100)).real().round())^(1/3)
   640320
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.error_fcn">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">error_fcn</tt><big>(</big><em>t</em><big>)</big><a class="headerlink" href="#sage.functions.special.error_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>The complementary error function
<span class="math">\(\frac{2}{\sqrt{\pi}}\int_t^\infty e^{-x^2} dx\)</span> (t belongs
to RR).  This function is currently always
evaluated immediately.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">error_fcn</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">2.15197367124989e-17</span>
<span class="gp">sage: </span><span class="n">error_fcn</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">0.47950012218695346231725334611</span>
</pre></div>
</div>
<p>Note this is literally equal to <span class="math">\(1 - erf(t)\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="mi">1</span> <span class="o">-</span> <span class="n">error_fcn</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">0.520499877813047</span>
<span class="gp">sage: </span><span class="n">erf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">0.520499877813047</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.hypergeometric_U">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">hypergeometric_U</tt><big>(</big><em>alpha</em>, <em>beta</em>, <em>x</em>, <em>algorithm='pari'</em>, <em>prec=53</em><big>)</big><a class="headerlink" href="#sage.functions.special.hypergeometric_U" title="Permalink to this definition">¶</a></dt>
<dd><p>Default is a wrap of PARI&#8217;s hyperu(alpha,beta,x) function.
Optionally, algorithm = &#8220;scipy&#8221; can be used.</p>
<p>The confluent hypergeometric function <span class="math">\(y = U(a,b,x)\)</span> is
defined to be the solution to Kummer&#8217;s differential equation</p>
<div class="math">
\[xy'' + (b-x)y' - ay = 0.\]</div>
<p>This satisfies <span class="math">\(U(a,b,x) \sim x^{-a}\)</span>, as
<span class="math">\(x\rightarrow \infty\)</span>, and is sometimes denoted
<tt class="docutils literal"><span class="pre">x^{-a}2_F_0(a,1+a-b,-1/x)</span></tt>. This is not the same as Kummer&#8217;s
<span class="math">\(M\)</span>-hypergeometric function, denoted sometimes as
<tt class="docutils literal"><span class="pre">_1F_1(alpha,beta,x)</span></tt>, though it satisfies the same DE that
<span class="math">\(U\)</span> does.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the literature, both are called &#8220;Kummer confluent
hypergeometric&#8221; functions.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">hypergeometric_U</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;scipy&quot;</span><span class="p">)</span>
<span class="go">0.596347362323...</span>
<span class="gp">sage: </span><span class="n">hypergeometric_U</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0.59634736232319...</span>
<span class="gp">sage: </span><span class="n">hypergeometric_U</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;pari&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="go">0.59634736232319407434...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.maxima_function">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">maxima_function</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#sage.functions.special.maxima_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function which is evaluated both symbolically and
numerically via Maxima.  In particular, it returns an instance
of <a class="reference internal" href="#sage.functions.special.MaximaFunction" title="sage.functions.special.MaximaFunction"><tt class="xref py py-class docutils literal"><span class="pre">MaximaFunction</span></tt></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is cached so that duplicate copies of the same
function are not created.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">spherical_hankel2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="go">-e</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.meval">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">meval</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.functions.special.meval" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">x</span></tt> evaluated in Maxima, then returned to Sage.</p>
<p>This is used to evaluate several of these special functions.</p>
<p>TEST:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.functions.special</span> <span class="kn">import</span> <span class="n">spherical_bessel_J</span>
<span class="gp">sage: </span><span class="n">spherical_bessel_J</span><span class="p">(</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">)</span>      <span class="c"># rel tol 1e-10</span>
<span class="go">0.2986374970757335</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.spherical_bessel_J">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">spherical_bessel_J</tt><big>(</big><em>n</em>, <em>var</em>, <em>algorithm='maxima'</em><big>)</big><a class="headerlink" href="#sage.functions.special.spherical_bessel_J" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spherical Bessel function of the first kind for
integers n &gt;= 1.</p>
<p>Reference: AS 10.1.8 page 437 and AS 10.1.15 page 439.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">spherical_bessel_J</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="go">((3/x^2 - 1)*sin(x) - 3*cos(x)/x)/x</span>
<span class="gp">sage: </span><span class="n">spherical_bessel_J</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;scipy&#39;</span><span class="p">)</span>
<span class="go">-0.12277149950007...</span>
<span class="gp">sage: </span><span class="n">spherical_bessel_J</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;scipy&#39;</span><span class="p">)</span>
<span class="go">0.345677499762355...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.spherical_bessel_Y">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">spherical_bessel_Y</tt><big>(</big><em>n</em>, <em>var</em>, <em>algorithm='maxima'</em><big>)</big><a class="headerlink" href="#sage.functions.special.spherical_bessel_Y" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spherical Bessel function of the second kind for
integers n -1.</p>
<p>Reference: AS 10.1.9 page 437 and AS 10.1.15 page 439.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">spherical_bessel_Y</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="go">-((3/x^2 - 1)*cos(x) + 3*sin(x)/x)/x</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.spherical_hankel1">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">spherical_hankel1</tt><big>(</big><em>n</em>, <em>var</em><big>)</big><a class="headerlink" href="#sage.functions.special.spherical_hankel1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spherical Hankel function of the first kind for
integers <span class="math">\(n &gt; -1\)</span>, written as a string. Reference: AS
10.1.36 page 439.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">spherical_hankel1</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">(I*x^2 - 3*x - 3*I)*e^(I*x)/x^3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.functions.special.spherical_hankel2">
<tt class="descclassname">sage.functions.special.</tt><tt class="descname">spherical_hankel2</tt><big>(</big><em>n</em>, <em>x</em><big>)</big><a class="headerlink" href="#sage.functions.special.spherical_hankel2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spherical Hankel function of the second kind for
integers <span class="math">\(n &gt; -1\)</span>, written as a string. Reference: AS 10.1.17 page
439.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">spherical_hankel2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">(-I*x^2 - 3*x + 3*I)*e^(-I*x)/x^3</span>
</pre></div>
</div>
<p>Here I = sqrt(-1).</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="other.html"
                                  title="previous chapter">Other functions</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="hypergeometric.html"
                                  title="next chapter">Hypergeometric Functions</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/functions/special.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypergeometric.html" title="Hypergeometric Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="other.html" title="Other functions"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Functions</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>