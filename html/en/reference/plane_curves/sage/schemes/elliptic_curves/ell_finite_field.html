<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Elliptic curves over finite fields &mdash; Sage Reference Manual v6.10: Plane curves</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '6.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.10: Plane curves" href="../../../index.html" />
    <link rel="next" title="Formal groups of elliptic curves" href="formal_group.html" />
    <link rel="prev" title="Elliptic curves over a general field" href="ell_field.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formal_group.html" title="Formal groups of elliptic curves"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ell_field.html" title="Elliptic curves over a general field"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="elliptic-curves-over-finite-fields">
<span id="sage-schemes-elliptic-curves-ell-finite-field"></span><h1>Elliptic curves over finite fields<a class="headerlink" href="#elliptic-curves-over-finite-fields" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.ell_finite_field"></span><p>AUTHORS:</p>
<ul class="simple">
<li>William Stein (2005): Initial version</li>
<li>Robert Bradshaw et al....</li>
<li>John Cremona (2008-02): Point counting and group structure for
non-prime fields, Frobenius endomorphism and order, elliptic logs</li>
<li>Mariah Lenox (2011-03): Added set_order method</li>
</ul>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.ell_finite_field.</tt><tt class="descname">EllipticCurve_finite_field</tt><big>(</big><em>K</em>, <em>ainvs</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="ell_field.html#sage.schemes.elliptic_curves.ell_field.EllipticCurve_field" title="sage.schemes.elliptic_curves.ell_field.EllipticCurve_field"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.ell_field.EllipticCurve_field</span></tt></a>, <a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html#sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field" title="sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field</span></tt></a></p>
<p>Elliptic curve over a finite field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2  = x^3 + 2*x + 3 over Finite Field of size 101</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">Elliptic Curve defined by y^2  = x^3 + 2*x + 3 over Finite Field in a of size 101^2</span>
</pre></div>
</div>
<p>Elliptic curves over <span class="math">\(\ZZ/N\ZZ\)</span> with <span class="math">\(N\)</span> prime are of type
&#8220;elliptic curve over a finite field&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 3 over Ring of integers modulo 101</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of schemes over Ring of integers modulo 101</span>
</pre></div>
</div>
<p>Elliptic curves over <span class="math">\(\ZZ/N\ZZ\)</span> with <span class="math">\(N\)</span> composite are of type
&#8220;generic elliptic curve&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">95</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 3 over Ring of integers modulo 95</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_generic.EllipticCurve_generic_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of schemes over Ring of integers modulo 95</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">skip</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;_test_elements&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.abelian_group">
<tt class="descname">abelian_group</tt><big>(</big><em>debug=False</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.abelian_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the abelian group structure of the group of points on this
elliptic curve.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The algorithm is definitely <em>not</em> intended for use with
<em>large</em> finite fields! The factorization of the orders of
elements must be feasible. Also, baby-step-giant-step
methods are used which have space and time requirements
which are <span class="math">\(O(\sqrt{q})\)</span>.</p>
</div>
<p>Also, the algorithm uses random points on the curve and hence the
generators are likely to differ from one run to another; but the
group is cached so the generators will not change in any one run of
Sage.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">debug</span></tt> - (default: False): if True, print
debugging messages</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an abelian group</li>
<li>tuple of images of each of the generators of the abelian
group as points on this curve</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>John Cremona</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
<span class="go">Additive abelian group isomorphic to Z/10 embedded in Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 2*x + 5 over Finite Field of size 11</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">41</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
<span class="go">Additive abelian group isomorphic to Z/22 + Z/2 ...</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
<span class="go">Additive abelian group isomorphic to Z/26 + Z/26 ...</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">48</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">89</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">76</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">24</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
<span class="go">Additive abelian group isomorphic to Z/1031352 ...</span>
</pre></div>
</div>
<p>The group can be trivial:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
<span class="go">Trivial group embedded in Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 + x + 1 over Finite Field of size 2</span>
</pre></div>
</div>
<p>Of course, there are plenty of points if we extend the field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">extension_degree</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1267650600228231653296516890625</span>
</pre></div>
</div>
<p>This tests the patch for trac #3111, using 10 primes randomly
selected:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5927</span><span class="p">,</span> <span class="mi">2297</span><span class="p">,</span> <span class="mi">1571</span><span class="p">,</span> <span class="mi">1709</span><span class="p">,</span> <span class="mi">3851</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">3253</span><span class="p">,</span> <span class="mi">5783</span><span class="p">,</span> <span class="mi">3499</span><span class="p">,</span> <span class="mi">4817</span><span class="p">]:</span>
<span class="gp">... </span>      <span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>  <span class="c"># long time (19s on sage.math, 2011)</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="mi">389</span><span class="p">:</span>
<span class="gp">... </span>          <span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
</pre></div>
</div>
<p>This tests that the bug reported in trac #3926 has been fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OK</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">10007</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">OKmodP</span> <span class="o">=</span> <span class="n">OK</span><span class="o">.</span><span class="n">residue_field</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Emod</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">OKmodP</span><span class="p">);</span> <span class="n">Emod</span>
<span class="go">Elliptic Curve defined by y^2  = x^3 + ibar*x + (ibar+3) over Residue field in ibar of Fractional ideal (10007)</span>
<span class="gp">sage: </span><span class="n">Emod</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span> <span class="c">#random generators</span>
<span class="go">(Multiplicative Abelian group isomorphic to C50067594 x C2,</span>
<span class="go">((3152*ibar + 7679 : 7330*ibar + 7913 : 1), (8466*ibar + 1770 : 0 : 1)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality">
<tt class="descname">cardinality</tt><big>(</big><em>algorithm='pari'</em>, <em>extension_degree=1</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of points on this elliptic curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; string (default: <tt class="docutils literal"><span class="pre">'pari'</span></tt>), used only for
point counting over prime fields:<ul>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> &#8211; use the baby-step giant-step or
Schoof-Elkies-Atkin methods as implemented in the PARI
C-library function <tt class="docutils literal"><span class="pre">ellap</span></tt></li>
<li><tt class="docutils literal"><span class="pre">'bsgs'</span></tt> &#8211; use the baby-step giant-step method as
implemented in Sage, with the Cremona-Sutherland version
of Mestre&#8217;s trick</li>
<li><tt class="docutils literal"><span class="pre">'all'</span></tt> &#8211; compute cardinality with both <tt class="docutils literal"><span class="pre">'pari'</span></tt> and
<tt class="docutils literal"><span class="pre">'bsgs'</span></tt>; return result if they agree or raise a
<tt class="docutils literal"><span class="pre">RuntimeError</span></tt> if they do not</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">extension_degree</span></tt> &#8211; an integer <span class="math">\(d\)</span> (default: 1): if the
base field is <span class="math">\(\GF{q}\)</span>, return the cardinality of <tt class="docutils literal"><span class="pre">self</span></tt>
over the extension <span class="math">\(\GF{q^d}\)</span> of degree <span class="math">\(d\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>The order of the group of rational points of <tt class="docutils literal"><span class="pre">self</span></tt> over its
base field, or over an extension field of degree <span class="math">\(d\)</span> as above.
The result is cached.</p>
<p>Over prime fields, one of the above algorithms is used. Over
non-prime fields, the serious point counting is done on a standard
curve with the same <span class="math">\(j\)</span>-invariant over the field <span class="math">\(\GF{p}(j)\)</span>, then
lifted to the base field, and finally account is taken of twists.</p>
<p>For <span class="math">\(j = 0\)</span> and <span class="math">\(j = 1728\)</span> special formulas are used instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">29</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">38</span>
</pre></div>
</div>
<p>An even bigger extension (which we check against Magma):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">515377520732011331036459693969645888996929981504</span>
<span class="gp">sage: </span><span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&quot;Order(EllipticCurve([GF(3^100)|1,2,3,4,5]))&quot;</span><span class="p">)</span>    <span class="c"># optional - magma</span>
<span class="go">&#39;515377520732011331036459693969645888996929981504&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10007</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">10076</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10007</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">10076</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">)),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">100000000011093199520</span>
</pre></div>
</div>
<p>The cardinality is cached:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">128</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">137806123398222701841183371720896367762643312000384671846835266941791510341065565176497846502742959856128</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10009</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;foobar&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm is not known</span>
</pre></div>
</div>
<p>If the cardinality has already been computed, then the <tt class="docutils literal"><span class="pre">algorithm</span></tt>
keyword is ignored:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10007</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">10076</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;foobar&#39;</span><span class="p">)</span>
<span class="go">10076</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality_bsgs">
<tt class="descname">cardinality_bsgs</tt><big>(</big><em>verbose=False</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality_bsgs" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return the cardinality of self over the base field. Will be called
by user function cardinality only when necessary, i.e. when the
j_invariant is not in the prime field.</p>
<p>ALGORITHM: A variant of &#8220;Mestre&#8217;s trick&#8221; extended to all finite
fields by Cremona and Sutherland, 2008.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>The Mestre-Schoof-Cremona-Sutherland algorithm may fail for
a small finite number of curves over <span class="math">\(F_q\)</span> for <span class="math">\(q\)</span> at most 49, so
for <span class="math">\(q&lt;50\)</span> we use an exhaustive count.</li>
<li>Quadratic twists are not implemented in characteristic 2
when <span class="math">\(j=0 (=1728)\)</span>; but this case is treated separately.</li>
</ol>
</div>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_bsgs</span><span class="p">()</span>
<span class="go">1020</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_bsgs</span><span class="p">()</span>
<span class="go">64</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">48</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">89</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">76</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">24</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_bsgs</span><span class="p">()</span>
<span class="go">1031352</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality_exhaustive">
<tt class="descname">cardinality_exhaustive</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality_exhaustive" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cardinality of self over the base field. Simply adds up
the number of points with each x-coordinate: only used for small
field sizes!</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_exhaustive</span><span class="p">()</span>
<span class="go">1020</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_exhaustive</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality_pari">
<tt class="descname">cardinality_pari</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.cardinality_pari" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cardinality of self over the (prime) base field using PARI.</p>
<p>The result is not cached.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_pari</span><span class="p">()</span>
<span class="go">1020</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_pari</span><span class="p">()</span>
<span class="go">999945</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality_pari</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">cardinality_pari() only works over prime fields.</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">3486794310</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.count_points">
<tt class="descname">count_points</tt><big>(</big><em>n=1</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.count_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cardinality of this elliptic curve over the base field or extensions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> (int) &#8211; a positive integer</li>
</ul>
<p>OUTPUT:</p>
<p>If <span class="math">\(n=1\)</span>, returns the cardinality of the curve over its base field.</p>
<p>If <span class="math">\(n&gt;1\)</span>, returns a list <span class="math">\([c_1, c_2, ..., c_n]\)</span> where <span class="math">\(c_d\)</span> is
the cardinality of the curve over the extension of degree <span class="math">\(d\)</span>
of its base field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">101</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">count_points</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">96</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">count_points</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[96, 10368, 1031904, 104053248, 10509895776]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">10295</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">count_points</span><span class="p">()</span>
<span class="go">10295</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">count_points</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">10295</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">count_points</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[10295, 104072155, 1061518108880, 10828567126268595, 110462212555439192375]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.frobenius">
<tt class="descname">frobenius</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.frobenius" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the frobenius of self as an element of a quadratic order</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This computes the curve cardinality, which may be
time-consuming.</p>
</div>
<p>Frobenius is only determined up to conjugacy.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">frobenius</span><span class="p">()</span>
<span class="go">phi</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">frobenius</span><span class="p">()</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^2 - 4*x + 11</span>
</pre></div>
</div>
<p>For some supersingular curves, Frobenius is in Z:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">frobenius</span><span class="p">()</span>
<span class="go">-5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.frobenius_order">
<tt class="descname">frobenius_order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.frobenius_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadratic order Z[phi] where phi is the Frobenius
endomorphism of the elliptic curve</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This computes the curve cardinality, which may be
time-consuming.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">frobenius_order</span><span class="p">()</span>
<span class="go">Order in Number Field in phi with defining polynomial x^2 - 4*x + 11</span>
</pre></div>
</div>
<p>For some supersingular curves, Frobenius is in Z and the Frobenius
order is Z:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">frobenius_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">Order in Number Field in phi with defining polynomial x + 5</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.frobenius_polynomial">
<tt class="descname">frobenius_polynomial</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.frobenius_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the characteristic polynomial of Frobenius.</p>
<p>The Frobenius endomorphism of the elliptic curve has quadratic
characteristic polynomial. In most cases this is irreducible and
defines an imaginary quadratic order; for some supersingular
curves, Frobenius is an integer a and the polynomial is
<span class="math">\((x-a)^2\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This computes the curve cardinality, which may be
time-consuming.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">frobenius_polynomial</span><span class="p">()</span>
<span class="go">x^2 - 4*x + 11</span>
</pre></div>
</div>
<p>For some supersingular curves, Frobenius is in Z and the polynomial
is a square:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">frobenius_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + 5)^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.gens">
<tt class="descname">gens</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of length up to 2 of points which generate the
abelian group of points on this elliptic curve. See
abelian_group() for limitations.</p>
<p>The algorithm uses random points on the curve, and hence the
generators are likely to differ from one run to another; but they
are cached so will be consistent in any one run of Sage.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>John Cremona</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>                           <span class="c"># random output</span>
<span class="go">((0 : 7 : 1),)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">41</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="c"># random output</span>
<span class="go">((21 : 1 : 1), (8 : 0 : 1))</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">pts</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">order</span><span class="p">()</span><span class="o">==</span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.is_isogenous">
<tt class="descname">is_isogenous</tt><big>(</big><em>other</em>, <em>field=None</em>, <em>proof=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.is_isogenous" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether or not self is isogenous to other</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; another elliptic curve.</li>
<li><tt class="docutils literal"><span class="pre">field</span></tt> (default None) &#8211; a field containing the base
fields of the two elliptic curves into which the two curves
may be extended to test if they are isogenous over this
field. By default is_isogenous will not try to find this
field unless one of the curves can be extended into the base
field of the other, in which case it will test over the
larger base field.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> (default True) &#8211; this parameter is here only to
be consistent with versions for other types of elliptic
curves.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if there is an isogeny from curve <tt class="docutils literal"><span class="pre">self</span></tt> to
curve <tt class="docutils literal"><span class="pre">other</span></tt> defined over <tt class="docutils literal"><span class="pre">field</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]);</span> <span class="n">E1</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 7 over Finite Field in a of size 11^2</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Second argument is not an Elliptic Curve.</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">E2</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 3*x + 1 over Finite Field in b of size 7^3</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The base fields must have the same characteristic.</span>

<span class="gp">sage: </span><span class="n">E3</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">E3</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 4*x + 3 over Finite Field in c of size 11^2</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">E4</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">),[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">E4</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 6*x + 5 over Finite Field in d of size 11^6</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E4</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E5</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">7</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">),[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">E5</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 4*x + 2 over Finite Field in e of size 11^7</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Curves have different base fields: use the field parameter.</span>
</pre></div>
</div>
<p>When the field is given:</p>
<blockquote>
<div>sage: E1 = EllipticCurve(GF(13^2,&#8217;a&#8217;),[2,7]); E1
Elliptic Curve defined by y^2 = x^3 + 2*x + 7 over Finite Field in a of size 13^2
sage: E1.is_isogenous(5,GF(13^6,&#8217;f&#8217;))
Traceback (most recent call last):
...
ValueError: Second argument is not an Elliptic Curve.
sage: E6 = EllipticCurve(GF(11^3,&#8217;g&#8217;),[9,3]); E6
Elliptic Curve defined by y^2 = x^3 + 9*x + 3 over Finite Field in g of size 11^3
sage: E1.is_isogenous(E6,QQ)
Traceback (most recent call last):
...
ValueError: The base fields must have the same characteristic.
sage: E7 = EllipticCurve(GF(13^5,&#8217;h&#8217;),[2,9]); E7
Elliptic Curve defined by y^2 = x^3 + 2*x + 9 over Finite Field in h of size 13^5
sage: E1.is_isogenous(E7,GF(13^4,&#8217;i&#8217;))
Traceback (most recent call last):
...
ValueError: Field must be an extension of the base fields of both curves
sage: E1.is_isogenous(E7,GF(13^10,&#8217;j&#8217;))
False
sage: E1.is_isogenous(E7,GF(13^30,&#8217;j&#8217;))
False</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.is_ordinary">
<tt class="descname">is_ordinary</tt><big>(</big><em>proof=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.is_ordinary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve is ordinary, else False.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proof</span></tt> (boolean, default True) &#8211; If True, returns a
proved result.  If False, then a return value of True is
certain but a return value of False may be based on a
probabilistic test.  See the documentaion of the function
<a class="reference internal" href="#sage.schemes.elliptic_curves.ell_finite_field.is_j_supersingular" title="sage.schemes.elliptic_curves.ell_finite_field.is_j_supersingular"><tt class="xref py py-meth docutils literal"><span class="pre">is_j_supersingular()</span></tt></a> for more details.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">66</span><span class="p">))</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">99</span><span class="p">))</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.is_supersingular">
<tt class="descname">is_supersingular</tt><big>(</big><em>proof=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.is_supersingular" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve is supersingular, else False.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proof</span></tt> (boolean, default True) &#8211; If True, returns a
proved result.  If False, then a return value of False is
certain but a return value of True may be based on a
probabilistic test.  See the documentaion of the function
<a class="reference internal" href="#sage.schemes.elliptic_curves.ell_finite_field.is_j_supersingular" title="sage.schemes.elliptic_curves.ell_finite_field.is_j_supersingular"><tt class="xref py py-meth docutils literal"><span class="pre">is_j_supersingular()</span></tt></a> for more details.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">is_supersingular</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span><span class="o">.</span><span class="n">is_supersingular</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">66</span><span class="p">))</span><span class="o">.</span><span class="n">is_supersingular</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">99</span><span class="p">))</span><span class="o">.</span><span class="n">is_supersingular</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_finite_field</span> <span class="kn">import</span> <span class="n">supersingular_j_polynomial</span><span class="p">,</span> <span class="n">is_j_supersingular</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ssjlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1728</span><span class="p">)]</span> <span class="o">+</span> <span class="n">supersingular_j_polynomial</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">([</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">F</span> <span class="k">if</span> <span class="n">is_j_supersingular</span><span class="p">(</span><span class="n">j</span><span class="p">)])</span> <span class="o">==</span> <span class="n">Set</span><span class="p">(</span><span class="n">ssjlist</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.order">
<tt class="descname">order</tt><big>(</big><em>algorithm='pari'</em>, <em>extension_degree=1</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of points on this elliptic curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; string (default: <tt class="docutils literal"><span class="pre">'pari'</span></tt>), used only for
point counting over prime fields:<ul>
<li><tt class="docutils literal"><span class="pre">'pari'</span></tt> &#8211; use the baby-step giant-step or
Schoof-Elkies-Atkin methods as implemented in the PARI
C-library function <tt class="docutils literal"><span class="pre">ellap</span></tt></li>
<li><tt class="docutils literal"><span class="pre">'bsgs'</span></tt> &#8211; use the baby-step giant-step method as
implemented in Sage, with the Cremona-Sutherland version
of Mestre&#8217;s trick</li>
<li><tt class="docutils literal"><span class="pre">'all'</span></tt> &#8211; compute cardinality with both <tt class="docutils literal"><span class="pre">'pari'</span></tt> and
<tt class="docutils literal"><span class="pre">'bsgs'</span></tt>; return result if they agree or raise a
<tt class="docutils literal"><span class="pre">RuntimeError</span></tt> if they do not</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">extension_degree</span></tt> &#8211; an integer <span class="math">\(d\)</span> (default: 1): if the
base field is <span class="math">\(\GF{q}\)</span>, return the cardinality of <tt class="docutils literal"><span class="pre">self</span></tt>
over the extension <span class="math">\(\GF{q^d}\)</span> of degree <span class="math">\(d\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>The order of the group of rational points of <tt class="docutils literal"><span class="pre">self</span></tt> over its
base field, or over an extension field of degree <span class="math">\(d\)</span> as above.
The result is cached.</p>
<p>Over prime fields, one of the above algorithms is used. Over
non-prime fields, the serious point counting is done on a standard
curve with the same <span class="math">\(j\)</span>-invariant over the field <span class="math">\(\GF{p}(j)\)</span>, then
lifted to the base field, and finally account is taken of twists.</p>
<p>For <span class="math">\(j = 0\)</span> and <span class="math">\(j = 1728\)</span> special formulas are used instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">29</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">38</span>
</pre></div>
</div>
<p>An even bigger extension (which we check against Magma):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">515377520732011331036459693969645888996929981504</span>
<span class="gp">sage: </span><span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&quot;Order(EllipticCurve([GF(3^100)|1,2,3,4,5]))&quot;</span><span class="p">)</span>    <span class="c"># optional - magma</span>
<span class="go">&#39;515377520732011331036459693969645888996929981504&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10007</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">10076</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10007</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">10076</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">)),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">100000000011093199520</span>
</pre></div>
</div>
<p>The cardinality is cached:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">128</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">137806123398222701841183371720896367762643312000384671846835266941791510341065565176497846502742959856128</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10009</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;foobar&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm is not known</span>
</pre></div>
</div>
<p>If the cardinality has already been computed, then the <tt class="docutils literal"><span class="pre">algorithm</span></tt>
keyword is ignored:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">10007</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">10076</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;foobar&#39;</span><span class="p">)</span>
<span class="go">10076</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.plot">
<tt class="descname">plot</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a graph of this elliptic curve over a prime finite field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwds</span></tt> - all other options are passed
to the circle graphing primitive.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.points">
<tt class="descname">points</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.points" title="Permalink to this definition">¶</a></dt>
<dd><p>All the points on this elliptic curve. The list of points is cached
so subsequent calls are free.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a_sub_p</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">a_sub_p</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a_sub_p</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">[(0 : 1 : 0), (1 : 0 : 1), (4 : 1 : 1), (4 : 4 : 1)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a_sub_p</span><span class="o">**</span><span class="mi">2</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">();</span> <span class="n">w</span>
<span class="go">[(0 : 1 : 0), (0 : 2*a + 4 : 1), (0 : 3*a + 1 : 1), (1 : 0 : 1), (2 : 2*a + 4 : 1), (2 : 3*a + 1 : 1), (3 : 2*a + 4 : 1), (3 : 3*a + 1 : 1), (4 : 1 : 1), (4 : 4 : 1), (a : 1 : 1), (a : 4 : 1), (a + 2 : a + 1 : 1), (a + 2 : 4*a + 4 : 1), (a + 3 : a : 1), (a + 3 : 4*a : 1), (a + 4 : 0 : 1), (2*a : 2*a : 1), (2*a : 3*a : 1), (2*a + 4 : a + 1 : 1), (2*a + 4 : 4*a + 4 : 1), (3*a + 1 : a + 3 : 1), (3*a + 1 : 4*a + 2 : 1), (3*a + 2 : 2*a + 3 : 1), (3*a + 2 : 3*a + 2 : 1), (4*a : 0 : 1), (4*a + 1 : 1 : 1), (4*a + 1 : 4 : 1), (4*a + 3 : a + 3 : 1), (4*a + 3 : 4*a + 2 : 1), (4*a + 4 : a + 4 : 1), (4*a + 4 : 4*a + 1 : 1)]</span>
</pre></div>
</div>
<p>Note that the returned list is an immutable sorted Sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">object is immutable; please change a copy instead.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.random_element">
<tt class="descname">random_element</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.random_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random point on this elliptic curve, uniformly chosen
among all rational points.</p>
<p>ALGORITHM:</p>
<p>Choose the point at infinity with probability <span class="math">\(1/(2q + 1)\)</span>.
Otherwise, take a random element from the field as x-coordinate
and compute the possible y-coordinates. Return the i&#8217;th
possible y-coordinate, where i is randomly chosen to be 0 or 1.
If the i&#8217;th y-coordinate does not exist (either there is no
point with the given x-coordinate or we hit a 2-torsion point
with i == 1), try again.</p>
<p>This gives a uniform distribution because you can imagine
<span class="math">\(2q + 1\)</span> buckets, one for the point at infinity and 2 for each
element of the field (representing the x-coordinates). This
gives a 1-to-1 map of elliptic curve points into buckets. At
every iteration, we simply choose a random bucket until we find
a bucket containing a point.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>Jeroen Demeyer (2014-09-09): choose points uniformly random,
see <a class="reference external" href="http://trac.sagemath.org/16951">trac ticket #16951</a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(16740 : 12486 : 1)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="ow">in</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(5*a^4 + 3*a^3 + 2*a^2 + a + 4 : 2*a^4 + 3*a^3 + 4*a^2 + a + 5 : 1)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="ow">in</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(a^4 + a : a^4 + a^3 + a^2 : 1)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="ow">in</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Ensure that the entire point set is reachable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>See trac #8311:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.random_point">
<tt class="descname">random_point</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.random_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random point on this elliptic curve, uniformly chosen
among all rational points.</p>
<p>ALGORITHM:</p>
<p>Choose the point at infinity with probability <span class="math">\(1/(2q + 1)\)</span>.
Otherwise, take a random element from the field as x-coordinate
and compute the possible y-coordinates. Return the i&#8217;th
possible y-coordinate, where i is randomly chosen to be 0 or 1.
If the i&#8217;th y-coordinate does not exist (either there is no
point with the given x-coordinate or we hit a 2-torsion point
with i == 1), try again.</p>
<p>This gives a uniform distribution because you can imagine
<span class="math">\(2q + 1\)</span> buckets, one for the point at infinity and 2 for each
element of the field (representing the x-coordinates). This
gives a 1-to-1 map of elliptic curve points into buckets. At
every iteration, we simply choose a random bucket until we find
a bucket containing a point.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>Jeroen Demeyer (2014-09-09): choose points uniformly random,
see <a class="reference external" href="http://trac.sagemath.org/16951">trac ticket #16951</a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(16740 : 12486 : 1)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="ow">in</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(5*a^4 + 3*a^3 + 2*a^2 + a + 4 : 2*a^4 + 3*a^3 + 4*a^2 + a + 5 : 1)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="ow">in</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(a^4 + a : a^4 + a^3 + a^2 : 1)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="ow">in</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Ensure that the entire point set is reachable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>See trac #8311:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.rational_points">
<tt class="descname">rational_points</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.rational_points" title="Permalink to this definition">¶</a></dt>
<dd><p>All the points on this elliptic curve. The list of points is cached
so subsequent calls are free.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a_sub_p</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">a_sub_p</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a_sub_p</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">[(0 : 1 : 0), (1 : 0 : 1), (4 : 1 : 1), (4 : 4 : 1)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a_sub_p</span><span class="o">**</span><span class="mi">2</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">();</span> <span class="n">w</span>
<span class="go">[(0 : 1 : 0), (0 : 2*a + 4 : 1), (0 : 3*a + 1 : 1), (1 : 0 : 1), (2 : 2*a + 4 : 1), (2 : 3*a + 1 : 1), (3 : 2*a + 4 : 1), (3 : 3*a + 1 : 1), (4 : 1 : 1), (4 : 4 : 1), (a : 1 : 1), (a : 4 : 1), (a + 2 : a + 1 : 1), (a + 2 : 4*a + 4 : 1), (a + 3 : a : 1), (a + 3 : 4*a : 1), (a + 4 : 0 : 1), (2*a : 2*a : 1), (2*a : 3*a : 1), (2*a + 4 : a + 1 : 1), (2*a + 4 : 4*a + 4 : 1), (3*a + 1 : a + 3 : 1), (3*a + 1 : 4*a + 2 : 1), (3*a + 2 : 2*a + 3 : 1), (3*a + 2 : 3*a + 2 : 1), (4*a : 0 : 1), (4*a + 1 : 1 : 1), (4*a + 1 : 4 : 1), (4*a + 3 : a + 3 : 1), (4*a + 3 : 4*a + 2 : 1), (4*a + 4 : a + 4 : 1), (4*a + 4 : 4*a + 1 : 1)]</span>
</pre></div>
</div>
<p>Note that the returned list is an immutable sorted Sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">object is immutable; please change a copy instead.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.set_order">
<tt class="descname">set_order</tt><big>(</big><em>value</em>, <em>num_checks=8</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.set_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the value of self._order to value.</p>
<p>Use this when you know a priori the order of the curve to
avoid a potentially expensive order calculation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value</span></tt> - Integer in the Hasse-Weil range for this
curve.</li>
<li><tt class="docutils literal"><span class="pre">num_checks</span></tt> - Integer (default: 8) number of times to
check whether value*(a random point on this curve) is
equal to the identity.</li>
</ul>
<p>OUTPUT:</p>
<p>None</p>
<p>EXAMPLES:</p>
<p>This example illustrates basic usage.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
<p>We now give a more interesting case, the NIST-P521 curve. Its
order is too big to calculate with Sage, and takes a long time
using other packages, so it is very useful here.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">521</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">prev_proof_state</span> <span class="o">=</span> <span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="c"># turn off primality checking</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="mi">1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="n">B</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">*</span> <span class="n">G</span>  <span class="c"># This takes practically no time.</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="n">prev_proof_state</span><span class="p">)</span> <span class="c"># restore state</span>
</pre></div>
</div>
<p>It is an error to pass a value which is not an integer in the
Hasse-Weil range:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="s">&quot;hi&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value hi illegal (not an integer in the Hasse range)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mf">3.14159</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value 3.14159000000000 illegal (not an integer in the Hasse range)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value 0 illegal (not an integer in the Hasse range)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value 1000 illegal (not an integer in the Hasse range)</span>
</pre></div>
</div>
<p>It is also very likely an error to pass a value which is not
the actual order of this curve. How unlikely is determined by
num_checks, the factorization of the actual order, and the
actual group structure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value 11 illegal (multiple of random point not the identity)</span>
</pre></div>
</div>
<p>However, set_order can be fooled, though it&#8217;s not likely in
&#8220;real cases of interest&#8221;. For instance, the order can be set
to a multiple of the actual order:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="c"># 12 just fits in the Hasse range</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">12</span>
</pre></div>
</div>
<p>Or, the order can be set incorrectly along with num_checks set
too small:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_checks</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">WARNING: No checking done in set_order</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The value of num_checks must be an integer. Negative values
are interpreted as zero, which means don&#8217;t do any checking:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_checks</span><span class="o">=-</span><span class="mi">12</span><span class="p">)</span>
<span class="go">WARNING: No checking done in set_order</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The implementation is based on the fact that orders of elliptic curves
are cached in the (pseudo-private) _order slot.</p>
<p>AUTHORS:</p>
<blockquote>
<div><ul class="simple">
<li>Mariah Lenox (2011-02-16)</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.trace_of_frobenius">
<tt class="descname">trace_of_frobenius</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field.trace_of_frobenius" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the trace of Frobenius acting on this elliptic curve.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This computes the curve cardinality, which may be
time-consuming.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">trace_of_frobenius</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">trace_of_frobenius</span><span class="p">()</span>
<span class="go">802</span>
</pre></div>
</div>
<p>The following shows that the issue from trac #2849 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">trace_of_frobenius</span><span class="p">()</span>
<span class="go">-27</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.is_j_supersingular">
<tt class="descclassname">sage.schemes.elliptic_curves.ell_finite_field.</tt><tt class="descname">is_j_supersingular</tt><big>(</big><em>j</em>, <em>proof=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.is_j_supersingular" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if <span class="math">\(j\)</span> is a supersingular <span class="math">\(j\)</span>-invariant.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">j</span></tt> (finite field element) &#8211; an element of a finite field</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> (boolean, default True) &#8211; If True, returns a proved
result.  If False, then a return value of False is certain but a
return value of True may be based on a probabilistic test.  See
the ALGORITHM section below for more details.</li>
</ul>
<p>OUTPUT:</p>
<p>(boolean) True if <span class="math">\(j\)</span> is supersingular, else False.</p>
<p>ALGORITHM:</p>
<p>For small characteristics <span class="math">\(p\)</span> we check whether the <span class="math">\(j\)</span>-invariant
is in a precomputed list of supersingular values.  Otherwise we
next check the <span class="math">\(j\)</span>-invariant.  If <span class="math">\(j=0\)</span>, the curve is
supersingular if and only if <span class="math">\(p=2\)</span> or <span class="math">\(p\equiv3\pmod{4}\)</span>; if
<span class="math">\(j=1728\)</span>, the curve is supersingular if and only if <span class="math">\(p=3\)</span> or
<span class="math">\(p\equiv2\pmod{3}\)</span>.  Next, if the base field is the prime field
<span class="math">\({\rm GF}(p)\)</span>, we check that <span class="math">\((p+1)P=0\)</span> for several random points
<span class="math">\(P\)</span>, returning False if any fail: supersingular curves over <span class="math">\({\rm
GF}(p)\)</span> have cardinality <span class="math">\(p+1\)</span>.  If Proof is false we now return
True.  Otherwise we compute the cardinality and return True if and
only if it is divisible by <span class="math">\(p\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_finite_field</span> <span class="kn">import</span> <span class="n">is_j_supersingular</span><span class="p">,</span> <span class="n">supersingular_j_polynomials</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_j_supersingular</span><span class="p">(</span><span class="n">j</span><span class="p">)])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">30</span><span class="p">)]</span>
<span class="go">[(2, [0]), (3, [0]), (5, [0]), (7, [6]), (11, [0, 1]), (13, [5]), (17, [0, 8]), (19, [7, 18]), (23, [0, 3, 19]), (29, [0, 2, 25])]</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">GF</span><span class="p">(</span><span class="mi">109</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_j_supersingular</span><span class="p">(</span><span class="n">j</span><span class="p">)]</span>
<span class="go">[17, 41, 43]</span>
<span class="gp">sage: </span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">109</span><span class="p">),</span><span class="s">&#39;j&#39;</span><span class="p">)(</span><span class="n">supersingular_j_polynomials</span><span class="p">[</span><span class="mi">109</span><span class="p">])</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(43, 1), (41, 1), (17, 1)]</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_j_supersingular</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)(</span><span class="mi">0</span><span class="p">))]</span>
<span class="go">[2, 3, 5, 11, 17, 23, 29, 41, 47, 53, 59, 71, 83, 89]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_j_supersingular</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)(</span><span class="mi">1728</span><span class="p">))]</span>
<span class="go">[2, 3, 7, 11, 19, 23, 31, 43, 47, 59, 67, 71, 79, 83]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_j_supersingular</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)(</span><span class="mi">123456</span><span class="p">))]</span>
<span class="go">[2, 3, 59, 89]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_finite_field.supersingular_j_polynomial">
<tt class="descclassname">sage.schemes.elliptic_curves.ell_finite_field.</tt><tt class="descname">supersingular_j_polynomial</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_finite_field.supersingular_j_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a polynomial whose roots are the supersingular <span class="math">\(j\)</span>-invariants
in characteristic <span class="math">\(p\)</span>, other than 0, 1728.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(p\)</span> (integer) &#8211; a prime number.</li>
</ul>
<p>ALGORITHM:</p>
<p>First compute H(X) whose roots are the Legendre
<span class="math">\(\lambda\)</span>-invariants of supersingular curves (Silverman V.4.1(b))
in charactersitic <span class="math">\(p\)</span>.  Then, using a resultant computation with
the polynomial relating <span class="math">\(\lambda\)</span> and <span class="math">\(j\)</span> (Silverman III.1.7(b)),
we recover the polynomial (in variable <tt class="docutils literal"><span class="pre">j</span></tt>) whose roots are the
<span class="math">\(j\)</span>-invariants.  Factors of <span class="math">\(j\)</span> and <span class="math">\(j-1728\)</span> are removed if
present.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_finite_field</span> <span class="kn">import</span> <span class="n">supersingular_j_polynomial</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">supersingular_j_polynomial</span><span class="p">(</span><span class="mi">67</span><span class="p">);</span> <span class="n">f</span>
<span class="go">j^5 + 53*j^4 + 4*j^3 + 47*j^2 + 36*j + 8</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(j + 1) * (j^2 + 8*j + 45) * (j^2 + 44*j + 24)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">supersingular_j_polynomial</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">30</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, j + 8, j + 9, j + 12, j + 4, j^2 + 2*j + 21]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">supersingular_j_polynomial</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p (=6) should be a prime number</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="ell_field.html"
                                  title="previous chapter">Elliptic curves over a general field</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="formal_group.html"
                                  title="next chapter">Formal groups of elliptic curves</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/ell_finite_field.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formal_group.html" title="Formal groups of elliptic curves"
             >next</a> |</li>
        <li class="right" >
          <a href="ell_field.html" title="Elliptic curves over a general field"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>