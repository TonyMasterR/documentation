<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Generic graphs (common to directed/undirected) &mdash; Sage Reference Manual v6.10: Graph Theory</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.10: Graph Theory" href="../../index.html" />
    <link rel="next" title="Undirected graphs" href="graph.html" />
    <link rel="prev" title="Graph Theory" href="../../index.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Undirected graphs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Graph Theory"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Graph Theory</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="generic-graphs-common-to-directed-undirected">
<span id="sage-graphs-generic-graph"></span><h1>Generic graphs (common to directed/undirected)<a class="headerlink" href="#generic-graphs-common-to-directed-undirected" title="Permalink to this headline">Â¶</a></h1>
<span class="target" id="module-sage.graphs.generic_graph"></span><p>This module implements the base class for graphs and digraphs, and methods that
can be applied on both. Here is what it can do:</p>
<p><strong>Basic Graph operations:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.networkx_graph" title="sage.graphs.generic_graph.GenericGraph.networkx_graph"><tt class="xref py py-meth docutils literal"><span class="pre">networkx_graph()</span></tt></a></td>
<td>Create a new NetworkX graph from the Sage graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.igraph_graph" title="sage.graphs.generic_graph.GenericGraph.igraph_graph"><tt class="xref py py-meth docutils literal"><span class="pre">igraph_graph()</span></tt></a></td>
<td>Create a new igraph graph from the Sage graph</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.to_dictionary" title="sage.graphs.generic_graph.GenericGraph.to_dictionary"><tt class="xref py py-meth docutils literal"><span class="pre">to_dictionary()</span></tt></a></td>
<td>Create a dictionary encoding the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.copy" title="sage.graphs.generic_graph.GenericGraph.copy"><tt class="xref py py-meth docutils literal"><span class="pre">copy()</span></tt></a></td>
<td>Return a copy of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.export_to_file" title="sage.graphs.generic_graph.GenericGraph.export_to_file"><tt class="xref py py-meth docutils literal"><span class="pre">export_to_file()</span></tt></a></td>
<td>Export the graph to a file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.adjacency_matrix" title="sage.graphs.generic_graph.GenericGraph.adjacency_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">adjacency_matrix()</span></tt></a></td>
<td>Return the adjacency matrix of the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.incidence_matrix" title="sage.graphs.generic_graph.GenericGraph.incidence_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">incidence_matrix()</span></tt></a></td>
<td>Return an incidence matrix of the (di)graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.distance_matrix" title="sage.graphs.generic_graph.GenericGraph.distance_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">distance_matrix()</span></tt></a></td>
<td>Return the distance matrix of the (strongly) connected (di)graph</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.weighted_adjacency_matrix" title="sage.graphs.generic_graph.GenericGraph.weighted_adjacency_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">weighted_adjacency_matrix()</span></tt></a></td>
<td>Return the weighted adjacency matrix of the graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix" title="sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">kirchhoff_matrix()</span></tt></a></td>
<td>Return the Kirchhoff matrix (a.k.a. the Laplacian) of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.has_loops" title="sage.graphs.generic_graph.GenericGraph.has_loops"><tt class="xref py py-meth docutils literal"><span class="pre">has_loops()</span></tt></a></td>
<td>Return whether there are loops in the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.allows_loops" title="sage.graphs.generic_graph.GenericGraph.allows_loops"><tt class="xref py py-meth docutils literal"><span class="pre">allows_loops()</span></tt></a></td>
<td>Return whether loops are permitted in the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.allow_loops" title="sage.graphs.generic_graph.GenericGraph.allow_loops"><tt class="xref py py-meth docutils literal"><span class="pre">allow_loops()</span></tt></a></td>
<td>Change whether loops are permitted in the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.loops" title="sage.graphs.generic_graph.GenericGraph.loops"><tt class="xref py py-meth docutils literal"><span class="pre">loops()</span></tt></a></td>
<td>Return any loops in the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.has_multiple_edges" title="sage.graphs.generic_graph.GenericGraph.has_multiple_edges"><tt class="xref py py-meth docutils literal"><span class="pre">has_multiple_edges()</span></tt></a></td>
<td>Return whether there are multiple edges in the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.allows_multiple_edges" title="sage.graphs.generic_graph.GenericGraph.allows_multiple_edges"><tt class="xref py py-meth docutils literal"><span class="pre">allows_multiple_edges()</span></tt></a></td>
<td>Return whether multiple edges are permitted in the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.allow_multiple_edges" title="sage.graphs.generic_graph.GenericGraph.allow_multiple_edges"><tt class="xref py py-meth docutils literal"><span class="pre">allow_multiple_edges()</span></tt></a></td>
<td>Change whether multiple edges are permitted in the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.multiple_edges" title="sage.graphs.generic_graph.GenericGraph.multiple_edges"><tt class="xref py py-meth docutils literal"><span class="pre">multiple_edges()</span></tt></a></td>
<td>Return any multiple edges in the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.name" title="sage.graphs.generic_graph.GenericGraph.name"><tt class="xref py py-meth docutils literal"><span class="pre">name()</span></tt></a></td>
<td>Return or sets the graph&#8217;s name.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_immutable" title="sage.graphs.generic_graph.GenericGraph.is_immutable"><tt class="xref py py-meth docutils literal"><span class="pre">is_immutable()</span></tt></a></td>
<td>Return whether the graph is immutable.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.weighted" title="sage.graphs.generic_graph.GenericGraph.weighted"><tt class="xref py py-meth docutils literal"><span class="pre">weighted()</span></tt></a></td>
<td>Whether the (di)graph is to be considered as a weighted (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.antisymmetric" title="sage.graphs.generic_graph.GenericGraph.antisymmetric"><tt class="xref py py-meth docutils literal"><span class="pre">antisymmetric()</span></tt></a></td>
<td>Test whether the graph is antisymmetric</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.density" title="sage.graphs.generic_graph.GenericGraph.density"><tt class="xref py py-meth docutils literal"><span class="pre">density()</span></tt></a></td>
<td>Return the density</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.order" title="sage.graphs.generic_graph.GenericGraph.order"><tt class="xref py py-meth docutils literal"><span class="pre">order()</span></tt></a></td>
<td>Return the number of vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.size" title="sage.graphs.generic_graph.GenericGraph.size"><tt class="xref py py-meth docutils literal"><span class="pre">size()</span></tt></a></td>
<td>Return the number of edges.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.add_vertex" title="sage.graphs.generic_graph.GenericGraph.add_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">add_vertex()</span></tt></a></td>
<td>Create an isolated vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.add_vertices" title="sage.graphs.generic_graph.GenericGraph.add_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">add_vertices()</span></tt></a></td>
<td>Add vertices to the (di)graph from an iterable container</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.delete_vertex" title="sage.graphs.generic_graph.GenericGraph.delete_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">delete_vertex()</span></tt></a></td>
<td>Delete a vertex, removing all incident edges.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.delete_vertices" title="sage.graphs.generic_graph.GenericGraph.delete_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">delete_vertices()</span></tt></a></td>
<td>Remove vertices from the (di)graph taken from an iterable container of vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.has_vertex" title="sage.graphs.generic_graph.GenericGraph.has_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">has_vertex()</span></tt></a></td>
<td>Return <tt class="docutils literal"><span class="pre">True</span></tt> if vertex is one of the vertices of this graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.random_vertex" title="sage.graphs.generic_graph.GenericGraph.random_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">random_vertex()</span></tt></a></td>
<td>Return a random vertex of self.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.random_edge" title="sage.graphs.generic_graph.GenericGraph.random_edge"><tt class="xref py py-meth docutils literal"><span class="pre">random_edge()</span></tt></a></td>
<td>Return a random edge of self.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertex_boundary" title="sage.graphs.generic_graph.GenericGraph.vertex_boundary"><tt class="xref py py-meth docutils literal"><span class="pre">vertex_boundary()</span></tt></a></td>
<td>Return a list of all vertices in the external boundary of vertices1, intersected with vertices2.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_vertices" title="sage.graphs.generic_graph.GenericGraph.set_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">set_vertices()</span></tt></a></td>
<td>Associate arbitrary objects with each vertex</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_vertex" title="sage.graphs.generic_graph.GenericGraph.set_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">set_vertex()</span></tt></a></td>
<td>Associate an arbitrary object with a vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.get_vertex" title="sage.graphs.generic_graph.GenericGraph.get_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">get_vertex()</span></tt></a></td>
<td>Retrieve the object associated with a given vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.get_vertices" title="sage.graphs.generic_graph.GenericGraph.get_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">get_vertices()</span></tt></a></td>
<td>Return a dictionary of the objects associated to each vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.loop_vertices" title="sage.graphs.generic_graph.GenericGraph.loop_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">loop_vertices()</span></tt></a></td>
<td>Return a list of vertices with loops.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertex_iterator" title="sage.graphs.generic_graph.GenericGraph.vertex_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">vertex_iterator()</span></tt></a></td>
<td>Return an iterator over the vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.neighbor_iterator" title="sage.graphs.generic_graph.GenericGraph.neighbor_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">neighbor_iterator()</span></tt></a></td>
<td>Return an iterator over neighbors of vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertices" title="sage.graphs.generic_graph.GenericGraph.vertices"><tt class="xref py py-meth docutils literal"><span class="pre">vertices()</span></tt></a></td>
<td>Return a list of the vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.neighbors" title="sage.graphs.generic_graph.GenericGraph.neighbors"><tt class="xref py py-meth docutils literal"><span class="pre">neighbors()</span></tt></a></td>
<td>Return a list of neighbors (in and out if directed) of vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.merge_vertices" title="sage.graphs.generic_graph.GenericGraph.merge_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">merge_vertices()</span></tt></a></td>
<td>Merge vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.add_edge" title="sage.graphs.generic_graph.GenericGraph.add_edge"><tt class="xref py py-meth docutils literal"><span class="pre">add_edge()</span></tt></a></td>
<td>Add an edge from u and v.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.add_edges" title="sage.graphs.generic_graph.GenericGraph.add_edges"><tt class="xref py py-meth docutils literal"><span class="pre">add_edges()</span></tt></a></td>
<td>Add edges from an iterable container.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subdivide_edge" title="sage.graphs.generic_graph.GenericGraph.subdivide_edge"><tt class="xref py py-meth docutils literal"><span class="pre">subdivide_edge()</span></tt></a></td>
<td>Subdivide an edge <span class="math">\(k\)</span> times.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subdivide_edges" title="sage.graphs.generic_graph.GenericGraph.subdivide_edges"><tt class="xref py py-meth docutils literal"><span class="pre">subdivide_edges()</span></tt></a></td>
<td>Subdivide k times edges from an iterable container.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.delete_edge" title="sage.graphs.generic_graph.GenericGraph.delete_edge"><tt class="xref py py-meth docutils literal"><span class="pre">delete_edge()</span></tt></a></td>
<td>Delete the edge from u to v</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.delete_edges" title="sage.graphs.generic_graph.GenericGraph.delete_edges"><tt class="xref py py-meth docutils literal"><span class="pre">delete_edges()</span></tt></a></td>
<td>Delete edges from an iterable container.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.delete_multiedge" title="sage.graphs.generic_graph.GenericGraph.delete_multiedge"><tt class="xref py py-meth docutils literal"><span class="pre">delete_multiedge()</span></tt></a></td>
<td>Delete all edges from u and v.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_edge_label" title="sage.graphs.generic_graph.GenericGraph.set_edge_label"><tt class="xref py py-meth docutils literal"><span class="pre">set_edge_label()</span></tt></a></td>
<td>Set the edge label of a given edge.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.has_edge" title="sage.graphs.generic_graph.GenericGraph.has_edge"><tt class="xref py py-meth docutils literal"><span class="pre">has_edge()</span></tt></a></td>
<td>Return True if (u, v) is an edge, False otherwise.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edges" title="sage.graphs.generic_graph.GenericGraph.edges"><tt class="xref py py-meth docutils literal"><span class="pre">edges()</span></tt></a></td>
<td>Return a list of edges.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_boundary" title="sage.graphs.generic_graph.GenericGraph.edge_boundary"><tt class="xref py py-meth docutils literal"><span class="pre">edge_boundary()</span></tt></a></td>
<td>Return a list of edges <span class="math">\((u,v,l)\)</span> with <span class="math">\(u\)</span> in <tt class="docutils literal"><span class="pre">vertices1</span></tt></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_iterator" title="sage.graphs.generic_graph.GenericGraph.edge_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">edge_iterator()</span></tt></a></td>
<td>Return an iterator over edges.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edges_incident" title="sage.graphs.generic_graph.GenericGraph.edges_incident"><tt class="xref py py-meth docutils literal"><span class="pre">edges_incident()</span></tt></a></td>
<td>Return incident edges to some vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_label" title="sage.graphs.generic_graph.GenericGraph.edge_label"><tt class="xref py py-meth docutils literal"><span class="pre">edge_label()</span></tt></a></td>
<td>Return the label of an edge.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_labels" title="sage.graphs.generic_graph.GenericGraph.edge_labels"><tt class="xref py py-meth docutils literal"><span class="pre">edge_labels()</span></tt></a></td>
<td>Return a list of edge labels.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.remove_multiple_edges" title="sage.graphs.generic_graph.GenericGraph.remove_multiple_edges"><tt class="xref py py-meth docutils literal"><span class="pre">remove_multiple_edges()</span></tt></a></td>
<td>Remove all multiple edges, retaining one edge for each.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.remove_loops" title="sage.graphs.generic_graph.GenericGraph.remove_loops"><tt class="xref py py-meth docutils literal"><span class="pre">remove_loops()</span></tt></a></td>
<td>Remove loops on vertices in vertices. If vertices is None, removes all loops.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.loop_edges" title="sage.graphs.generic_graph.GenericGraph.loop_edges"><tt class="xref py py-meth docutils literal"><span class="pre">loop_edges()</span></tt></a></td>
<td>Returns a list of all loops in the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.number_of_loops" title="sage.graphs.generic_graph.GenericGraph.number_of_loops"><tt class="xref py py-meth docutils literal"><span class="pre">number_of_loops()</span></tt></a></td>
<td>Return the number of edges that are loops.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.clear" title="sage.graphs.generic_graph.GenericGraph.clear"><tt class="xref py py-meth docutils literal"><span class="pre">clear()</span></tt></a></td>
<td>Empty the graph of vertices and edges and removes name, associated objects, and position information.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.degree" title="sage.graphs.generic_graph.GenericGraph.degree"><tt class="xref py py-meth docutils literal"><span class="pre">degree()</span></tt></a></td>
<td>Return the degree (in + out for digraphs) of a vertex or of vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.average_degree" title="sage.graphs.generic_graph.GenericGraph.average_degree"><tt class="xref py py-meth docutils literal"><span class="pre">average_degree()</span></tt></a></td>
<td>Return the average degree of the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.degree_histogram" title="sage.graphs.generic_graph.GenericGraph.degree_histogram"><tt class="xref py py-meth docutils literal"><span class="pre">degree_histogram()</span></tt></a></td>
<td>Return a list, whose ith entry is the frequency of degree i.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.degree_iterator" title="sage.graphs.generic_graph.GenericGraph.degree_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">degree_iterator()</span></tt></a></td>
<td>Return an iterator over the degrees of the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.degree_sequence" title="sage.graphs.generic_graph.GenericGraph.degree_sequence"><tt class="xref py py-meth docutils literal"><span class="pre">degree_sequence()</span></tt></a></td>
<td>Return the degree sequence of this (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.random_subgraph" title="sage.graphs.generic_graph.GenericGraph.random_subgraph"><tt class="xref py py-meth docutils literal"><span class="pre">random_subgraph()</span></tt></a></td>
<td>Return a random subgraph that contains each vertex with prob. p.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.add_cycle" title="sage.graphs.generic_graph.GenericGraph.add_cycle"><tt class="xref py py-meth docutils literal"><span class="pre">add_cycle()</span></tt></a></td>
<td>Add a cycle to the graph with the given vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.add_path" title="sage.graphs.generic_graph.GenericGraph.add_path"><tt class="xref py py-meth docutils literal"><span class="pre">add_path()</span></tt></a></td>
<td>Add a cycle to the graph with the given vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.complement" title="sage.graphs.generic_graph.GenericGraph.complement"><tt class="xref py py-meth docutils literal"><span class="pre">complement()</span></tt></a></td>
<td>Return the complement of the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.line_graph" title="sage.graphs.generic_graph.GenericGraph.line_graph"><tt class="xref py py-meth docutils literal"><span class="pre">line_graph()</span></tt></a></td>
<td>Return the line graph of the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.to_simple" title="sage.graphs.generic_graph.GenericGraph.to_simple"><tt class="xref py py-meth docutils literal"><span class="pre">to_simple()</span></tt></a></td>
<td>Return a simple version of itself (i.e., undirected and loops and multiple edges are removed).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.disjoint_union" title="sage.graphs.generic_graph.GenericGraph.disjoint_union"><tt class="xref py py-meth docutils literal"><span class="pre">disjoint_union()</span></tt></a></td>
<td>Return the disjoint union of self and other.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.union" title="sage.graphs.generic_graph.GenericGraph.union"><tt class="xref py py-meth docutils literal"><span class="pre">union()</span></tt></a></td>
<td>Return the union of self and other.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.relabel" title="sage.graphs.generic_graph.GenericGraph.relabel"><tt class="xref py py-meth docutils literal"><span class="pre">relabel()</span></tt></a></td>
<td>Relabel the vertices of <tt class="docutils literal"><span class="pre">self</span></tt></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.degree_to_cell" title="sage.graphs.generic_graph.GenericGraph.degree_to_cell"><tt class="xref py py-meth docutils literal"><span class="pre">degree_to_cell()</span></tt></a></td>
<td>Return the number of edges from vertex to an edge in cell.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph" title="sage.graphs.generic_graph.GenericGraph.subgraph"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph()</span></tt></a></td>
<td>Return the subgraph containing the given vertices and edges.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_subgraph" title="sage.graphs.generic_graph.GenericGraph.is_subgraph"><tt class="xref py py-meth docutils literal"><span class="pre">is_subgraph()</span></tt></a></td>
<td>Test whether self is a subgraph of other.</td>
</tr>
</tbody>
</table>
<p><strong>Graph products:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.cartesian_product" title="sage.graphs.generic_graph.GenericGraph.cartesian_product"><tt class="xref py py-meth docutils literal"><span class="pre">cartesian_product()</span></tt></a></td>
<td>Return the Cartesian product of self and other.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.tensor_product" title="sage.graphs.generic_graph.GenericGraph.tensor_product"><tt class="xref py py-meth docutils literal"><span class="pre">tensor_product()</span></tt></a></td>
<td>Return the tensor product, also called the categorical product, of self and other.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.lexicographic_product" title="sage.graphs.generic_graph.GenericGraph.lexicographic_product"><tt class="xref py py-meth docutils literal"><span class="pre">lexicographic_product()</span></tt></a></td>
<td>Return the lexicographic product of self and other.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.strong_product" title="sage.graphs.generic_graph.GenericGraph.strong_product"><tt class="xref py py-meth docutils literal"><span class="pre">strong_product()</span></tt></a></td>
<td>Return the strong product of self and other.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.disjunctive_product" title="sage.graphs.generic_graph.GenericGraph.disjunctive_product"><tt class="xref py py-meth docutils literal"><span class="pre">disjunctive_product()</span></tt></a></td>
<td>Return the disjunctive product of self and other.</td>
</tr>
</tbody>
</table>
<p><strong>Paths and cycles:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eulerian_orientation" title="sage.graphs.generic_graph.GenericGraph.eulerian_orientation"><tt class="xref py py-meth docutils literal"><span class="pre">eulerian_orientation()</span></tt></a></td>
<td>Return a DiGraph which is an Eulerian orientation of the current graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eulerian_circuit" title="sage.graphs.generic_graph.GenericGraph.eulerian_circuit"><tt class="xref py py-meth docutils literal"><span class="pre">eulerian_circuit()</span></tt></a></td>
<td>Return a list of edges forming an eulerian circuit if one exists.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.cycle_basis" title="sage.graphs.generic_graph.GenericGraph.cycle_basis"><tt class="xref py py-meth docutils literal"><span class="pre">cycle_basis()</span></tt></a></td>
<td>Return a list of cycles which form a basis of the cycle space of <tt class="docutils literal"><span class="pre">self</span></tt>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.all_paths" title="sage.graphs.generic_graph.GenericGraph.all_paths"><tt class="xref py py-meth docutils literal"><span class="pre">all_paths()</span></tt></a></td>
<td>Return a list of all paths (also lists) between a pair of vertices in the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.triangles_count" title="sage.graphs.generic_graph.GenericGraph.triangles_count"><tt class="xref py py-meth docutils literal"><span class="pre">triangles_count()</span></tt></a></td>
<td>Return the number of triangles in the (di)graph.</td>
</tr>
</tbody>
</table>
<p><strong>Linear algebra:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.spectrum" title="sage.graphs.generic_graph.GenericGraph.spectrum"><tt class="xref py py-meth docutils literal"><span class="pre">spectrum()</span></tt></a></td>
<td>Return a list of the eigenvalues of the adjacency matrix.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eigenvectors" title="sage.graphs.generic_graph.GenericGraph.eigenvectors"><tt class="xref py py-meth docutils literal"><span class="pre">eigenvectors()</span></tt></a></td>
<td>Return the <em>right</em> eigenvectors of the adjacency matrix of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eigenspaces" title="sage.graphs.generic_graph.GenericGraph.eigenspaces"><tt class="xref py py-meth docutils literal"><span class="pre">eigenspaces()</span></tt></a></td>
<td>Return the <em>right</em> eigenspaces of the adjacency matrix of the graph.</td>
</tr>
</tbody>
</table>
<p><strong>Some metrics:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.cluster_triangles" title="sage.graphs.generic_graph.GenericGraph.cluster_triangles"><tt class="xref py py-meth docutils literal"><span class="pre">cluster_triangles()</span></tt></a></td>
<td>Return the number of triangles for nbunch of vertices as a dictionary keyed by vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.clustering_average" title="sage.graphs.generic_graph.GenericGraph.clustering_average"><tt class="xref py py-meth docutils literal"><span class="pre">clustering_average()</span></tt></a></td>
<td>Return the average clustering coefficient.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.clustering_coeff" title="sage.graphs.generic_graph.GenericGraph.clustering_coeff"><tt class="xref py py-meth docutils literal"><span class="pre">clustering_coeff()</span></tt></a></td>
<td>Return the clustering coefficient for each vertex in nbunch</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.cluster_transitivity" title="sage.graphs.generic_graph.GenericGraph.cluster_transitivity"><tt class="xref py py-meth docutils literal"><span class="pre">cluster_transitivity()</span></tt></a></td>
<td>Return the transitivity (fraction of transitive triangles) of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.szeged_index" title="sage.graphs.generic_graph.GenericGraph.szeged_index"><tt class="xref py py-meth docutils literal"><span class="pre">szeged_index()</span></tt></a></td>
<td>Return the Szeged index of the graph.</td>
</tr>
</tbody>
</table>
<p><strong>Automorphism group:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.coarsest_equitable_refinement" title="sage.graphs.generic_graph.GenericGraph.coarsest_equitable_refinement"><tt class="xref py py-meth docutils literal"><span class="pre">coarsest_equitable_refinement()</span></tt></a></td>
<td>Return the coarsest partition which is finer than the input partition, and equitable with respect to self.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.automorphism_group" title="sage.graphs.generic_graph.GenericGraph.automorphism_group"><tt class="xref py py-meth docutils literal"><span class="pre">automorphism_group()</span></tt></a></td>
<td>Return the largest subgroup of the automorphism group of the (di)graph whose orbit partition is finer than the partition given.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_vertex_transitive" title="sage.graphs.generic_graph.GenericGraph.is_vertex_transitive"><tt class="xref py py-meth docutils literal"><span class="pre">is_vertex_transitive()</span></tt></a></td>
<td>Return whether the automorphism group of self is transitive within the partition provided</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_isomorphic" title="sage.graphs.generic_graph.GenericGraph.is_isomorphic"><tt class="xref py py-meth docutils literal"><span class="pre">is_isomorphic()</span></tt></a></td>
<td>Test for isomorphism between self and other.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.canonical_label" title="sage.graphs.generic_graph.GenericGraph.canonical_label"><tt class="xref py py-meth docutils literal"><span class="pre">canonical_label()</span></tt></a></td>
<td>Return the unique graph on <span class="math">\(\{0,1,...,n-1\}\)</span> ( <tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">self.order()</span></tt> ) which 1) is isomorphic to self 2) is invariant in the isomorphism class.</td>
</tr>
</tbody>
</table>
<p><strong>Graph properties:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_eulerian" title="sage.graphs.generic_graph.GenericGraph.is_eulerian"><tt class="xref py py-meth docutils literal"><span class="pre">is_eulerian()</span></tt></a></td>
<td>Return <tt class="docutils literal"><span class="pre">True</span></tt> if the graph has a (closed) tour that visits each edge exactly once.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_planar" title="sage.graphs.generic_graph.GenericGraph.is_planar"><tt class="xref py py-meth docutils literal"><span class="pre">is_planar()</span></tt></a></td>
<td>Test whether the graph is planar.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_circular_planar" title="sage.graphs.generic_graph.GenericGraph.is_circular_planar"><tt class="xref py py-meth docutils literal"><span class="pre">is_circular_planar()</span></tt></a></td>
<td>Test whether the graph is circular planar (outerplanar)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_regular" title="sage.graphs.generic_graph.GenericGraph.is_regular"><tt class="xref py py-meth docutils literal"><span class="pre">is_regular()</span></tt></a></td>
<td>Return <tt class="docutils literal"><span class="pre">True</span></tt> if this graph is (<span class="math">\(k\)</span>-)regular.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_chordal" title="sage.graphs.generic_graph.GenericGraph.is_chordal"><tt class="xref py py-meth docutils literal"><span class="pre">is_chordal()</span></tt></a></td>
<td>Test whether the given graph is chordal.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_circulant" title="sage.graphs.generic_graph.GenericGraph.is_circulant"><tt class="xref py py-meth docutils literal"><span class="pre">is_circulant()</span></tt></a></td>
<td>Test whether the graph is a circulant graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_interval" title="sage.graphs.generic_graph.GenericGraph.is_interval"><tt class="xref py py-meth docutils literal"><span class="pre">is_interval()</span></tt></a></td>
<td>Check whether self is an interval graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_gallai_tree" title="sage.graphs.generic_graph.GenericGraph.is_gallai_tree"><tt class="xref py py-meth docutils literal"><span class="pre">is_gallai_tree()</span></tt></a></td>
<td>Return whether the current graph is a Gallai tree.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_clique" title="sage.graphs.generic_graph.GenericGraph.is_clique"><tt class="xref py py-meth docutils literal"><span class="pre">is_clique()</span></tt></a></td>
<td>Test whether a set of vertices is a clique</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_independent_set" title="sage.graphs.generic_graph.GenericGraph.is_independent_set"><tt class="xref py py-meth docutils literal"><span class="pre">is_independent_set()</span></tt></a></td>
<td>Test whether a set of vertices is an independent set</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_transitively_reduced" title="sage.graphs.generic_graph.GenericGraph.is_transitively_reduced"><tt class="xref py py-meth docutils literal"><span class="pre">is_transitively_reduced()</span></tt></a></td>
<td>Test whether the digraph is transitively reduced.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_equitable" title="sage.graphs.generic_graph.GenericGraph.is_equitable"><tt class="xref py py-meth docutils literal"><span class="pre">is_equitable()</span></tt></a></td>
<td>Check whether the given partition is equitable with respect to self.</td>
</tr>
</tbody>
</table>
<p><strong>Traversals:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.breadth_first_search" title="sage.graphs.generic_graph.GenericGraph.breadth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">breadth_first_search()</span></tt></a></td>
<td>Return an iterator over the vertices in a breadth-first ordering.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.depth_first_search" title="sage.graphs.generic_graph.GenericGraph.depth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">depth_first_search()</span></tt></a></td>
<td>Return an iterator over the vertices in a depth-first ordering.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.lex_BFS" title="sage.graphs.generic_graph.GenericGraph.lex_BFS"><tt class="xref py py-meth docutils literal"><span class="pre">lex_BFS()</span></tt></a></td>
<td>Perform a Lex BFS on the graph.</td>
</tr>
</tbody>
</table>
<p><strong>Distances:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.centrality_betweenness" title="sage.graphs.generic_graph.GenericGraph.centrality_betweenness"><tt class="xref py py-meth docutils literal"><span class="pre">centrality_betweenness()</span></tt></a></td>
<td>Return the betweenness centrality</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.centrality_closeness" title="sage.graphs.generic_graph.GenericGraph.centrality_closeness"><tt class="xref py py-meth docutils literal"><span class="pre">centrality_closeness()</span></tt></a></td>
<td>Returns the closeness centrality (1/average distance to all vertices)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.distance" title="sage.graphs.generic_graph.GenericGraph.distance"><tt class="xref py py-meth docutils literal"><span class="pre">distance()</span></tt></a></td>
<td>Return the (directed) distance from u to v in the (di)graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.distance_all_pairs" title="sage.graphs.generic_graph.GenericGraph.distance_all_pairs"><tt class="xref py py-meth docutils literal"><span class="pre">distance_all_pairs()</span></tt></a></td>
<td>Return the distances between all pairs of vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.distances_distribution" title="sage.graphs.generic_graph.GenericGraph.distances_distribution"><tt class="xref py py-meth docutils literal"><span class="pre">distances_distribution()</span></tt></a></td>
<td>Return the distances distribution of the (di)graph in a dictionary.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eccentricity" title="sage.graphs.generic_graph.GenericGraph.eccentricity"><tt class="xref py py-meth docutils literal"><span class="pre">eccentricity()</span></tt></a></td>
<td>Return the eccentricity of vertex (or vertices) v.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.radius" title="sage.graphs.generic_graph.GenericGraph.radius"><tt class="xref py py-meth docutils literal"><span class="pre">radius()</span></tt></a></td>
<td>Return the radius of the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.center" title="sage.graphs.generic_graph.GenericGraph.center"><tt class="xref py py-meth docutils literal"><span class="pre">center()</span></tt></a></td>
<td>Return the set of vertices in the center of the graph</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.diameter" title="sage.graphs.generic_graph.GenericGraph.diameter"><tt class="xref py py-meth docutils literal"><span class="pre">diameter()</span></tt></a></td>
<td>Return the largest distance between any two vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.distance_graph" title="sage.graphs.generic_graph.GenericGraph.distance_graph"><tt class="xref py py-meth docutils literal"><span class="pre">distance_graph()</span></tt></a></td>
<td>Return the graph on the same vertex set as the original graph but vertices are adjacent in the returned graph if and only if they are at specified distances in the original graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.girth" title="sage.graphs.generic_graph.GenericGraph.girth"><tt class="xref py py-meth docutils literal"><span class="pre">girth()</span></tt></a></td>
<td>Compute the girth of the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.periphery" title="sage.graphs.generic_graph.GenericGraph.periphery"><tt class="xref py py-meth docutils literal"><span class="pre">periphery()</span></tt></a></td>
<td>Return the set of vertices in the periphery</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path" title="sage.graphs.generic_graph.GenericGraph.shortest_path"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path()</span></tt></a></td>
<td>Return a list of vertices representing some shortest path from <span class="math">\(u\)</span> to <span class="math">\(v\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_length" title="sage.graphs.generic_graph.GenericGraph.shortest_path_length"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path_length()</span></tt></a></td>
<td>Return the minimal length of paths from u to v</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a></td>
<td>Return a dictionary associating to each vertex v a shortest path from u to v, if it exists.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_lengths" title="sage.graphs.generic_graph.GenericGraph.shortest_path_lengths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path_lengths()</span></tt></a></td>
<td>Return a dictionary of shortest path lengths keyed by targets that are connected by a path from u.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs" title="sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path_all_pairs()</span></tt></a></td>
<td>Compute a shortest path between each pair of vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.wiener_index" title="sage.graphs.generic_graph.GenericGraph.wiener_index"><tt class="xref py py-meth docutils literal"><span class="pre">wiener_index()</span></tt></a></td>
<td>Return the Wiener index of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.average_distance" title="sage.graphs.generic_graph.GenericGraph.average_distance"><tt class="xref py py-meth docutils literal"><span class="pre">average_distance()</span></tt></a></td>
<td>Return the average distance between vertices of the graph.</td>
</tr>
</tbody>
</table>
<p><strong>Flows, connectivity, trees:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_connected" title="sage.graphs.generic_graph.GenericGraph.is_connected"><tt class="xref py py-meth docutils literal"><span class="pre">is_connected()</span></tt></a></td>
<td>Test whether the (di)graph is connected.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.connected_components" title="sage.graphs.generic_graph.GenericGraph.connected_components"><tt class="xref py py-meth docutils literal"><span class="pre">connected_components()</span></tt></a></td>
<td>Return the list of connected components</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.connected_components_number" title="sage.graphs.generic_graph.GenericGraph.connected_components_number"><tt class="xref py py-meth docutils literal"><span class="pre">connected_components_number()</span></tt></a></td>
<td>Return the number of connected components.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.connected_components_subgraphs" title="sage.graphs.generic_graph.GenericGraph.connected_components_subgraphs"><tt class="xref py py-meth docutils literal"><span class="pre">connected_components_subgraphs()</span></tt></a></td>
<td>Return a list of connected components as graph objects.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.connected_component_containing_vertex" title="sage.graphs.generic_graph.GenericGraph.connected_component_containing_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">connected_component_containing_vertex()</span></tt></a></td>
<td>Return a list of the vertices connected to vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.connected_components_sizes" title="sage.graphs.generic_graph.GenericGraph.connected_components_sizes"><tt class="xref py py-meth docutils literal"><span class="pre">connected_components_sizes()</span></tt></a></td>
<td>Return the sizes of the connected components as a list.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.blocks_and_cut_vertices" title="sage.graphs.generic_graph.GenericGraph.blocks_and_cut_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">blocks_and_cut_vertices()</span></tt></a></td>
<td>Compute the blocks and cut vertices of the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.blocks_and_cuts_tree" title="sage.graphs.generic_graph.GenericGraph.blocks_and_cuts_tree"><tt class="xref py py-meth docutils literal"><span class="pre">blocks_and_cuts_tree()</span></tt></a></td>
<td>Compute the blocks-and-cuts tree of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_cut_edge" title="sage.graphs.generic_graph.GenericGraph.is_cut_edge"><tt class="xref py py-meth docutils literal"><span class="pre">is_cut_edge()</span></tt></a></td>
<td>Return True if the input edge is a cut-edge or a bridge.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_cut_vertex" title="sage.graphs.generic_graph.GenericGraph.is_cut_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">is_cut_vertex()</span></tt></a></td>
<td>Return True if the input vertex is a cut-vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_cut" title="sage.graphs.generic_graph.GenericGraph.edge_cut"><tt class="xref py py-meth docutils literal"><span class="pre">edge_cut()</span></tt></a></td>
<td>Return a minimum edge cut between vertices <span class="math">\(s\)</span> and <span class="math">\(t\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertex_cut" title="sage.graphs.generic_graph.GenericGraph.vertex_cut"><tt class="xref py py-meth docutils literal"><span class="pre">vertex_cut()</span></tt></a></td>
<td>Return a minimum vertex cut between non-adjacent vertices <span class="math">\(s\)</span> and <span class="math">\(t\)</span></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.flow" title="sage.graphs.generic_graph.GenericGraph.flow"><tt class="xref py py-meth docutils literal"><span class="pre">flow()</span></tt></a></td>
<td>Return a maximum flow in the graph from <tt class="docutils literal"><span class="pre">x</span></tt> to <tt class="docutils literal"><span class="pre">y</span></tt></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_disjoint_paths" title="sage.graphs.generic_graph.GenericGraph.edge_disjoint_paths"><tt class="xref py py-meth docutils literal"><span class="pre">edge_disjoint_paths()</span></tt></a></td>
<td>Returns a list of edge-disjoint paths between two vertices</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertex_disjoint_paths" title="sage.graphs.generic_graph.GenericGraph.vertex_disjoint_paths"><tt class="xref py py-meth docutils literal"><span class="pre">vertex_disjoint_paths()</span></tt></a></td>
<td>Return a list of vertex-disjoint paths between two vertices as given by Menger&#8217;s theorem.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_connectivity" title="sage.graphs.generic_graph.GenericGraph.edge_connectivity"><tt class="xref py py-meth docutils literal"><span class="pre">edge_connectivity()</span></tt></a></td>
<td>Return the edge connectivity of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertex_connectivity" title="sage.graphs.generic_graph.GenericGraph.vertex_connectivity"><tt class="xref py py-meth docutils literal"><span class="pre">vertex_connectivity()</span></tt></a></td>
<td>Return the vertex connectivity of the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.transitive_closure" title="sage.graphs.generic_graph.GenericGraph.transitive_closure"><tt class="xref py py-meth docutils literal"><span class="pre">transitive_closure()</span></tt></a></td>
<td>Compute the transitive closure of a graph and returns it.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.transitive_reduction" title="sage.graphs.generic_graph.GenericGraph.transitive_reduction"><tt class="xref py py-meth docutils literal"><span class="pre">transitive_reduction()</span></tt></a></td>
<td>Return a transitive reduction of a graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><tt class="xref py py-meth docutils literal"><span class="pre">min_spanning_tree()</span></tt></a></td>
<td>Return the edges of a minimum spanning tree.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.spanning_trees_count" title="sage.graphs.generic_graph.GenericGraph.spanning_trees_count"><tt class="xref py py-meth docutils literal"><span class="pre">spanning_trees_count()</span></tt></a></td>
<td>Return the number of spanning trees in a graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.dominator_tree" title="sage.graphs.generic_graph.GenericGraph.dominator_tree"><tt class="xref py py-meth docutils literal"><span class="pre">dominator_tree()</span></tt></a></td>
<td>Returns a dominator tree of the graph.</td>
</tr>
</tbody>
</table>
<p><strong>Plot/embedding-related methods:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_embedding" title="sage.graphs.generic_graph.GenericGraph.set_embedding"><tt class="xref py py-meth docutils literal"><span class="pre">set_embedding()</span></tt></a></td>
<td>Set a combinatorial embedding dictionary to <tt class="docutils literal"><span class="pre">_embedding</span></tt> attribute.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.get_embedding" title="sage.graphs.generic_graph.GenericGraph.get_embedding"><tt class="xref py py-meth docutils literal"><span class="pre">get_embedding()</span></tt></a></td>
<td>Return the attribute _embedding if it exists.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.faces" title="sage.graphs.generic_graph.GenericGraph.faces"><tt class="xref py py-meth docutils literal"><span class="pre">faces()</span></tt></a></td>
<td>Return the faces of an embedded graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.get_pos" title="sage.graphs.generic_graph.GenericGraph.get_pos"><tt class="xref py py-meth docutils literal"><span class="pre">get_pos()</span></tt></a></td>
<td>Return the position dictionary</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_pos" title="sage.graphs.generic_graph.GenericGraph.set_pos"><tt class="xref py py-meth docutils literal"><span class="pre">set_pos()</span></tt></a></td>
<td>Set the position dictionary.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_planar_positions" title="sage.graphs.generic_graph.GenericGraph.set_planar_positions"><tt class="xref py py-meth docutils literal"><span class="pre">set_planar_positions()</span></tt></a></td>
<td>Compute a planar layout for self using Schnyder&#8217;s algorithm</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_planar" title="sage.graphs.generic_graph.GenericGraph.layout_planar"><tt class="xref py py-meth docutils literal"><span class="pre">layout_planar()</span></tt></a></td>
<td>Use Schnyder&#8217;s algorithm to compute a planar layout for self.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_drawn_free_of_edge_crossings" title="sage.graphs.generic_graph.GenericGraph.is_drawn_free_of_edge_crossings"><tt class="xref py py-meth docutils literal"><span class="pre">is_drawn_free_of_edge_crossings()</span></tt></a></td>
<td>Test whether the position dictionary gives a planar embedding.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.latex_options" title="sage.graphs.generic_graph.GenericGraph.latex_options"><tt class="xref py py-meth docutils literal"><span class="pre">latex_options()</span></tt></a></td>
<td>Return an instance of <a class="reference internal" href="graph_latex.html#sage.graphs.graph_latex.GraphLatex" title="sage.graphs.graph_latex.GraphLatex"><tt class="xref py py-class docutils literal"><span class="pre">GraphLatex</span></tt></a> for the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_latex_options" title="sage.graphs.generic_graph.GenericGraph.set_latex_options"><tt class="xref py py-meth docutils literal"><span class="pre">set_latex_options()</span></tt></a></td>
<td>Set multiple options for rendering a graph with LaTeX.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout" title="sage.graphs.generic_graph.GenericGraph.layout"><tt class="xref py py-meth docutils literal"><span class="pre">layout()</span></tt></a></td>
<td>Return a layout for the vertices of this graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_spring" title="sage.graphs.generic_graph.GenericGraph.layout_spring"><tt class="xref py py-meth docutils literal"><span class="pre">layout_spring()</span></tt></a></td>
<td>Compute a spring layout for this graph</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><tt class="xref py py-meth docutils literal"><span class="pre">layout_ranked()</span></tt></a></td>
<td>Compute a ranked layout for this graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_extend_randomly" title="sage.graphs.generic_graph.GenericGraph.layout_extend_randomly"><tt class="xref py py-meth docutils literal"><span class="pre">layout_extend_randomly()</span></tt></a></td>
<td>Extend randomly a partial layout</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_circular" title="sage.graphs.generic_graph.GenericGraph.layout_circular"><tt class="xref py py-meth docutils literal"><span class="pre">layout_circular()</span></tt></a></td>
<td>Compute a circular layout for this graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_tree" title="sage.graphs.generic_graph.GenericGraph.layout_tree"><tt class="xref py py-meth docutils literal"><span class="pre">layout_tree()</span></tt></a></td>
<td>Compute an ordered tree layout for this graph, which should be a tree (no non-oriented cycles).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_graphviz" title="sage.graphs.generic_graph.GenericGraph.layout_graphviz"><tt class="xref py py-meth docutils literal"><span class="pre">layout_graphviz()</span></tt></a></td>
<td>Call <tt class="docutils literal"><span class="pre">graphviz</span></tt> to compute a layout of the vertices of this graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.graphplot" title="sage.graphs.generic_graph.GenericGraph.graphplot"><tt class="xref py py-meth docutils literal"><span class="pre">graphplot()</span></tt></a></td>
<td>Return a GraphPlot object.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.plot" title="sage.graphs.generic_graph.GenericGraph.plot"><tt class="xref py py-meth docutils literal"><span class="pre">plot()</span></tt></a></td>
<td>Return a graphics object representing the (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.show" title="sage.graphs.generic_graph.GenericGraph.show"><tt class="xref py py-meth docutils literal"><span class="pre">show()</span></tt></a></td>
<td>Show the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.plot3d" title="sage.graphs.generic_graph.GenericGraph.plot3d"><tt class="xref py py-meth docutils literal"><span class="pre">plot3d()</span></tt></a></td>
<td>Plot the graph in three dimensions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.show3d" title="sage.graphs.generic_graph.GenericGraph.show3d"><tt class="xref py py-meth docutils literal"><span class="pre">show3d()</span></tt></a></td>
<td>Plot the graph using Tachyon, and shows the resulting plot.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.graphviz_string" title="sage.graphs.generic_graph.GenericGraph.graphviz_string"><tt class="xref py py-meth docutils literal"><span class="pre">graphviz_string()</span></tt></a></td>
<td>Return a representation in the dot language.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.graphviz_to_file_named" title="sage.graphs.generic_graph.GenericGraph.graphviz_to_file_named"><tt class="xref py py-meth docutils literal"><span class="pre">graphviz_to_file_named()</span></tt></a></td>
<td>Write a representation in the dot in a file.</td>
</tr>
</tbody>
</table>
<p><strong>Algorithmically hard stuff:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.steiner_tree" title="sage.graphs.generic_graph.GenericGraph.steiner_tree"><tt class="xref py py-meth docutils literal"><span class="pre">steiner_tree()</span></tt></a></td>
<td>Return a tree of minimum weight connecting the given set of vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_disjoint_spanning_trees" title="sage.graphs.generic_graph.GenericGraph.edge_disjoint_spanning_trees"><tt class="xref py py-meth docutils literal"><span class="pre">edge_disjoint_spanning_trees()</span></tt></a></td>
<td>Return the desired number of edge-disjoint spanning trees/arborescences.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.feedback_vertex_set" title="sage.graphs.generic_graph.GenericGraph.feedback_vertex_set"><tt class="xref py py-meth docutils literal"><span class="pre">feedback_vertex_set()</span></tt></a></td>
<td>Compute the minimum feedback vertex set of a (di)graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.multiway_cut" title="sage.graphs.generic_graph.GenericGraph.multiway_cut"><tt class="xref py py-meth docutils literal"><span class="pre">multiway_cut()</span></tt></a></td>
<td>Return a minimum edge multiway cut</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.max_cut" title="sage.graphs.generic_graph.GenericGraph.max_cut"><tt class="xref py py-meth docutils literal"><span class="pre">max_cut()</span></tt></a></td>
<td>Return a maximum edge cut of the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.longest_path" title="sage.graphs.generic_graph.GenericGraph.longest_path"><tt class="xref py py-meth docutils literal"><span class="pre">longest_path()</span></tt></a></td>
<td>Return a longest path of <tt class="docutils literal"><span class="pre">self</span></tt>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.traveling_salesman_problem" title="sage.graphs.generic_graph.GenericGraph.traveling_salesman_problem"><tt class="xref py py-meth docutils literal"><span class="pre">traveling_salesman_problem()</span></tt></a></td>
<td>Solve the traveling salesman problem (TSP)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_hamiltonian" title="sage.graphs.generic_graph.GenericGraph.is_hamiltonian"><tt class="xref py py-meth docutils literal"><span class="pre">is_hamiltonian()</span></tt></a></td>
<td>Test whether the current graph is Hamiltonian.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.hamiltonian_cycle" title="sage.graphs.generic_graph.GenericGraph.hamiltonian_cycle"><tt class="xref py py-meth docutils literal"><span class="pre">hamiltonian_cycle()</span></tt></a></td>
<td>Return a Hamiltonian cycle/circuit of the current graph/digraph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.multicommodity_flow" title="sage.graphs.generic_graph.GenericGraph.multicommodity_flow"><tt class="xref py py-meth docutils literal"><span class="pre">multicommodity_flow()</span></tt></a></td>
<td>Solve a multicommodity flow problem.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths" title="sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths"><tt class="xref py py-meth docutils literal"><span class="pre">disjoint_routed_paths()</span></tt></a></td>
<td>Return a set of disjoint routed paths.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.dominating_set" title="sage.graphs.generic_graph.GenericGraph.dominating_set"><tt class="xref py py-meth docutils literal"><span class="pre">dominating_set()</span></tt></a></td>
<td>Return a minimum dominating set of the graph</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search" title="sage.graphs.generic_graph.GenericGraph.subgraph_search"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search()</span></tt></a></td>
<td>Return a copy of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_count" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_count"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_count()</span></tt></a></td>
<td>Return the number of labelled occurences of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_iterator()</span></tt></a></td>
<td>Return an iterator over the labelled copies of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.characteristic_polynomial" title="sage.graphs.generic_graph.GenericGraph.characteristic_polynomial"><tt class="xref py py-meth docutils literal"><span class="pre">characteristic_polynomial()</span></tt></a></td>
<td>Return the characteristic polynomial of the adjacency matrix of the (di)graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.genus" title="sage.graphs.generic_graph.GenericGraph.genus"><tt class="xref py py-meth docutils literal"><span class="pre">genus()</span></tt></a></td>
<td>Return the minimal genus of the graph.</td>
</tr>
</tbody>
</table>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">Â¶</a></h2>
<dl class="class">
<dt id="sage.graphs.generic_graph.GenericGraph">
<em class="property">class </em><tt class="descclassname">sage.graphs.generic_graph.</tt><tt class="descname">GenericGraph</tt><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="generic_graph_pyx.html#sage.graphs.generic_graph_pyx.GenericGraph_pyx" title="sage.graphs.generic_graph_pyx.GenericGraph_pyx"><tt class="xref py py-class docutils literal"><span class="pre">sage.graphs.generic_graph_pyx.GenericGraph_pyx</span></tt></a></p>
<p>Base class for graphs and digraphs.</p>
<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.__eq__">
<tt class="descname">__eq__</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.__eq__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compare self and other for equality.</p>
<p>Do not call this method directly. That is, for <tt class="docutils literal"><span class="pre">G.__eq__(H)</span></tt>
write <tt class="docutils literal"><span class="pre">G</span> <span class="pre">==</span> <span class="pre">H</span></tt>.</p>
<dl class="docutils">
<dt>Two graphs are considered equal if the following hold:</dt>
<dd><ul class="first last simple">
<li>they are either both directed, or both undirected;</li>
<li>they have the same settings for loops, multiedges, and
weightedness;</li>
<li>they have the same set of vertices;</li>
<li>they have the same (multi)set of arrows/edges, where labels
of arrows/edges are taken into account if <em>and only if</em>
the graphs are considered weighted. See
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.weighted" title="sage.graphs.generic_graph.GenericGraph.weighted"><tt class="xref py py-meth docutils literal"><span class="pre">weighted()</span></tt></a>.</li>
</ul>
</dd>
</dl>
<p>Note that this is <em>not</em> an isomorphism test.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">9999</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span> <span class="c"># most often true</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">0</span><span class="p">]}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span> <span class="c"># most often false</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note that graphs must be considered weighted, or Sage will not pay
attention to edge label data in equality testing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">foo</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">foo</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">bar</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bar</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">foo</span> <span class="o">==</span> <span class="n">bar</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">foo</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">foo</span> <span class="o">==</span> <span class="n">bar</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">bar</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">foo</span> <span class="o">==</span> <span class="n">bar</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.add_cycle">
<tt class="descname">add_cycle</tt><big>(</big><em>vertices</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.add_cycle" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Adds a cycle to the graph with the given vertices. If the vertices
are already present, only the edges are added.</p>
<p>For digraphs, adds the directed cycle, whose orientation is
determined by the list. Adds edges (vertices[u], vertices[u+1]) and
(vertices[-1], vertices[0]).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; a list of indices for the vertices of
the cycle to be added.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">G</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_cycle</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_cycle</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_cycle</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 2, None), (2, 3, None), (3, 0, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.add_edge">
<tt class="descname">add_edge</tt><big>(</big><em>u</em>, <em>v=None</em>, <em>label=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.add_edge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Adds an edge from u and v.</p>
<p>INPUT: The following forms are all accepted:</p>
<ul class="simple">
<li>G.add_edge( 1, 2 )</li>
<li>G.add_edge( (1, 2) )</li>
<li>G.add_edges( [ (1, 2) ])</li>
<li>G.add_edge( 1, 2, &#8216;label&#8217; )</li>
<li>G.add_edge( (1, 2, &#8216;label&#8217;) )</li>
<li>G.add_edges( [ (1, 2, &#8216;label&#8217;) ] )</li>
</ul>
<p>WARNING: The following intuitive input results in nonintuitive
output:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">networkx_graph</span><span class="p">()</span><span class="o">.</span><span class="n">adj</span>           <span class="c"># random output order</span>
<span class="go">{&#39;label&#39;: {(1, 2): None}, (1, 2): {&#39;label&#39;: None}}</span>
</pre></div>
</div>
<p>Use one of these instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;label&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">networkx_graph</span><span class="p">()</span><span class="o">.</span><span class="n">adj</span>           <span class="c"># random output order</span>
<span class="go">{1: {2: &#39;label&#39;}, 2: {1: &#39;label&#39;}}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">networkx_graph</span><span class="p">()</span><span class="o">.</span><span class="n">adj</span>           <span class="c"># random output order</span>
<span class="go">{1: {2: &#39;label&#39;}, 2: {1: &#39;label&#39;}}</span>
</pre></div>
</div>
<p>The following syntax is supported, but note that you must use
the <tt class="docutils literal"><span class="pre">label</span></tt> keyword:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;label&#39;)]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(&#39;label&#39;, (1, 2), None)]</span>
</pre></div>
</div>
<p>Vertex name cannot be None, so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.add_edges">
<tt class="descname">add_edges</tt><big>(</big><em>edges</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.add_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Add edges from an iterable container.</p>
<p>All elements of <tt class="docutils literal"><span class="pre">edges</span></tt> must follow the same format, i.e. have the
same length.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="n">G</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">()</span> <span class="p">);</span> <span class="n">H</span>
<span class="go">Graph on 20 vertices</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="n">G</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">()</span> <span class="p">);</span> <span class="n">H</span>
<span class="go">Digraph on 20 vertices</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="nb">iter</span><span class="p">([]))</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 2, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.add_path">
<tt class="descname">add_path</tt><big>(</big><em>vertices</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.add_path" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Adds a path to the graph with the given vertices. If the vertices
are already present, only the edges are added.</p>
<p>For digraphs, adds the directed path vertices[0], ...,
vertices[-1].</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - a list of indices for the vertices of
the path to be added.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">G</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 2, None), (2, 3, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.add_vertex">
<tt class="descname">add_vertex</tt><big>(</big><em>name=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.add_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Creates an isolated vertex. If the vertex already exists, then
nothing is done.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> - Name of the new vertex. If no name is
specified, then the vertex will be represented by the least integer
not already representing a vertex. Name must be an immutable
object, and cannot be None.</li>
</ul>
<p>As it is implemented now, if a graph <span class="math">\(G\)</span> has a large number
of vertices with numeric labels, then G.add_vertex() could
potentially be slow, if name is None.</p>
<p>OUTPUT:</p>
<p>If <tt class="docutils literal"><span class="pre">name``=``None</span></tt>, the new vertex name is returned. <tt class="docutils literal"><span class="pre">None</span></tt> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">();</span> <span class="n">G</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">();</span> <span class="n">G</span>
<span class="go">0</span>
<span class="go">Graph on 1 vertex</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">();</span> <span class="n">D</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">();</span> <span class="n">D</span>
<span class="go">0</span>
<span class="go">Digraph on 1 vertex</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.add_vertices">
<tt class="descname">add_vertices</tt><big>(</big><em>vertices</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.add_vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Add vertices to the (di)graph from an iterable container of
vertices. Vertices that already exist in the graph will not be
added again.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt>: iterator of vertex labels. A new label is created, used and returned in
the output list for all <tt class="docutils literal"><span class="pre">None</span></tt> values in <tt class="docutils literal"><span class="pre">vertices</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<p>Generated names of new vertices if there is at least one <tt class="docutils literal"><span class="pre">None</span></tt> value
present in <tt class="docutils literal"><span class="pre">vertices</span></tt>. <tt class="docutils literal"><span class="pre">None</span></tt> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[0, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.adjacency_matrix">
<tt class="descname">adjacency_matrix</tt><big>(</big><em>sparse=None</em>, <em>vertices=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.adjacency_matrix" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the adjacency matrix of the (di)graph.</p>
<p>The matrix returned is over the integers. If a different ring is
desired, use either <a class="reference external" href="../../../matrices/sage/matrix/matrix0.html#sage.matrix.matrix0.Matrix.change_ring" title="(in Sage Reference Manual: Matrices and Spaces of Matrices v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">sage.matrix.matrix0.Matrix.change_ring()</span></tt></a> method or <tt class="xref py py-func docutils literal"><span class="pre">matrix()</span></tt>
function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">sparse</span></tt> - whether to represent with a sparse matrix</li>
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> (list) &#8211; the ordering of the vertices defining how they
should appear in the matrix. By default, the ordering given by
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertices" title="sage.graphs.generic_graph.GenericGraph.vertices"><tt class="xref py py-meth docutils literal"><span class="pre">GenericGraph.vertices()</span></tt></a> is used.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 0 1 0 0 0 1 0 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0]</span>
<span class="go">[0 1 1 0 0 0 0 1 0 0 0 1 0 0 0 0]</span>
<span class="go">[1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 1 0 0 1 0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 1 0 1 0 0 1 0 0 0 0 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 1 1 0 0 0 0 0 0 0 0 1]</span>
<span class="go">[1 0 0 0 0 0 0 0 0 1 1 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 0 0 0 0 1 0 0 1 0 1 0 0]</span>
<span class="go">[0 0 1 0 0 0 0 0 1 0 0 1 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 1 0 0 0 1 0 0 0 0 1 1 0]</span>
<span class="go">[0 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">G</span><span class="p">)</span> <span class="c"># matrix over GF(2)</span>
<span class="go">[0 1 1 0 1 0 0 0 1 0 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0]</span>
<span class="go">[0 1 1 0 0 0 0 1 0 0 0 1 0 0 0 0]</span>
<span class="go">[1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 1 0 0 1 0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 1 0 1 0 0 1 0 0 0 0 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 1 1 0 0 0 0 0 0 0 0 1]</span>
<span class="go">[1 0 0 0 0 0 0 0 0 1 1 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 0 0 0 0 1 0 0 1 0 1 0 0]</span>
<span class="go">[0 0 1 0 0 0 0 0 1 0 0 1 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 1 0 0 0 1 0 0 0 0 1 1 0]</span>
<span class="go">[0 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 1 0 0]</span>
<span class="go">[1 0 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 1 0]</span>
<span class="go">[1 0 0 0 0 1]</span>
<span class="go">[0 1 0 0 0 0]</span>
</pre></div>
</div>
<p>A different ordering of the vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[0 0 1 1 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="go">[1 0 0 0 1]</span>
<span class="go">[1 1 0 0 0]</span>
<span class="go">[0 0 1 0 0]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 256 by 256 dense matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 512 by 512 sparse matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)]</span><span class="o">+</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 501 by 501 dense matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">``vertices`` must be a permutation of the vertices</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">``vertices`` must be a permutation of the vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.all_paths">
<tt class="descname">all_paths</tt><big>(</big><em>start</em>, <em>end</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.all_paths" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of all paths (also lists) between a pair of
vertices (start, end) in the (di)graph. If <tt class="docutils literal"><span class="pre">start</span></tt> is the same
vertex as <tt class="docutils literal"><span class="pre">end</span></tt>, then <tt class="docutils literal"><span class="pre">[[start]]</span></tt> is returned &#8211; a list
containing the 1-vertex, 0-edge path &#8220;<tt class="docutils literal"><span class="pre">start</span></tt>&#8221;.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">eg1</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">eg1</span><span class="o">.</span><span class="n">all_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[[0, 1, 4, 5, 6], [0, 2, 4, 5, 6]]</span>
<span class="gp">sage: </span><span class="n">eg2</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">eg2</span><span class="o">.</span><span class="n">all_paths</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[[1, 0, 4],</span>
<span class="go"> [1, 0, 5, 7, 2, 3, 4],</span>
<span class="go"> [1, 0, 5, 7, 2, 3, 8, 6, 9, 4],</span>
<span class="go"> [1, 0, 5, 7, 9, 4],</span>
<span class="go"> [1, 0, 5, 7, 9, 6, 8, 3, 4],</span>
<span class="go"> [1, 0, 5, 8, 3, 2, 7, 9, 4],</span>
<span class="go"> [1, 0, 5, 8, 3, 4],</span>
<span class="go"> [1, 0, 5, 8, 6, 9, 4],</span>
<span class="go"> [1, 0, 5, 8, 6, 9, 7, 2, 3, 4],</span>
<span class="go"> [1, 2, 3, 4],</span>
<span class="go"> [1, 2, 3, 8, 5, 0, 4],</span>
<span class="go"> [1, 2, 3, 8, 5, 7, 9, 4],</span>
<span class="go"> [1, 2, 3, 8, 6, 9, 4],</span>
<span class="go"> [1, 2, 3, 8, 6, 9, 7, 5, 0, 4],</span>
<span class="go"> [1, 2, 7, 5, 0, 4],</span>
<span class="go"> [1, 2, 7, 5, 8, 3, 4],</span>
<span class="go"> [1, 2, 7, 5, 8, 6, 9, 4],</span>
<span class="go"> [1, 2, 7, 9, 4],</span>
<span class="go"> [1, 2, 7, 9, 6, 8, 3, 4],</span>
<span class="go"> [1, 2, 7, 9, 6, 8, 5, 0, 4],</span>
<span class="go"> [1, 6, 8, 3, 2, 7, 5, 0, 4],</span>
<span class="go"> [1, 6, 8, 3, 2, 7, 9, 4],</span>
<span class="go"> [1, 6, 8, 3, 4],</span>
<span class="go"> [1, 6, 8, 5, 0, 4],</span>
<span class="go"> [1, 6, 8, 5, 7, 2, 3, 4],</span>
<span class="go"> [1, 6, 8, 5, 7, 9, 4],</span>
<span class="go"> [1, 6, 9, 4],</span>
<span class="go"> [1, 6, 9, 7, 2, 3, 4],</span>
<span class="go"> [1, 6, 9, 7, 2, 3, 8, 5, 0, 4],</span>
<span class="go"> [1, 6, 9, 7, 5, 0, 4],</span>
<span class="go"> [1, 6, 9, 7, 5, 8, 3, 4]]</span>
<span class="gp">sage: </span><span class="n">dg</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">dg</span><span class="o">.</span><span class="n">all_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[[0, 1, 3], [0, 3]]</span>
<span class="gp">sage: </span><span class="n">ug</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">ug</span><span class="o">.</span><span class="n">all_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[[0, 1, 3], [0, 2, 3], [0, 3]]</span>
</pre></div>
</div>
<p>Starting and ending at the same vertex (see <a class="reference external" href="http://trac.sagemath.org/13006">trac ticket #13006</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">all_paths</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[2]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.allow_loops">
<tt class="descname">allow_loops</tt><big>(</big><em>new</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.allow_loops" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Changes whether loops are permitted in the (di)graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">new</span></tt> - boolean.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Looped graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Looped digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.allow_multiple_edges">
<tt class="descname">allow_multiple_edges</tt><big>(</big><em>new</em>, <em>check=True</em>, <em>keep_label='any'</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.allow_multiple_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Changes whether multiple edges are permitted in the (di)graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">new</span></tt> (boolean): if <tt class="docutils literal"><span class="pre">True</span></tt>, the new graph will allow multiple
edges.</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> (boolean): if <tt class="docutils literal"><span class="pre">True</span></tt> and <tt class="docutils literal"><span class="pre">new</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, we remove
all multiple edges from the graph.</li>
<li><tt class="docutils literal"><span class="pre">keep_label</span></tt> (<tt class="docutils literal"><span class="pre">'any','min','max'</span></tt>): used only if <tt class="docutils literal"><span class="pre">new</span></tt> is
<tt class="docutils literal"><span class="pre">False</span></tt> and <tt class="docutils literal"><span class="pre">check</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>. If there are multiple edges with
different labels, this variable defines which label should be kept:
any label (<tt class="docutils literal"><span class="pre">'any'</span></tt>), the smallest label (<tt class="docutils literal"><span class="pre">'min'</span></tt>), or the largest
(<tt class="docutils literal"><span class="pre">'max'</span></tt>).</li>
</ul>
<p>EXAMPLES:</p>
<p>The standard behavior with undirected graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Multi-graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, 1), (0, 1, 2), (0, 1, 3)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 1)]</span>
</pre></div>
</div>
<p>If we ask for the minimum label:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">keep_label</span><span class="o">=</span><span class="s">&#39;min&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 1)]</span>
</pre></div>
</div>
<p>If we ask for the maximum label:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">keep_label</span><span class="o">=</span><span class="s">&#39;max&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 3)]</span>
</pre></div>
</div>
<p>The standard behavior with digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Multi-digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.allows_loops">
<tt class="descname">allows_loops</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.allows_loops" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns whether loops are permitted in the (di)graph.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Looped graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Looped digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.allows_multiple_edges">
<tt class="descname">allows_multiple_edges</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.allows_multiple_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns whether multiple edges are permitted in the (di)graph.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Multi-graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None)]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Multi-digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.am">
<tt class="descname">am</tt><big>(</big><em>sparse=None</em>, <em>vertices=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.am" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the adjacency matrix of the (di)graph.</p>
<p>The matrix returned is over the integers. If a different ring is
desired, use either <a class="reference external" href="../../../matrices/sage/matrix/matrix0.html#sage.matrix.matrix0.Matrix.change_ring" title="(in Sage Reference Manual: Matrices and Spaces of Matrices v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">sage.matrix.matrix0.Matrix.change_ring()</span></tt></a> method or <tt class="xref py py-func docutils literal"><span class="pre">matrix()</span></tt>
function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">sparse</span></tt> - whether to represent with a sparse matrix</li>
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> (list) &#8211; the ordering of the vertices defining how they
should appear in the matrix. By default, the ordering given by
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertices" title="sage.graphs.generic_graph.GenericGraph.vertices"><tt class="xref py py-meth docutils literal"><span class="pre">GenericGraph.vertices()</span></tt></a> is used.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 0 1 0 0 0 1 0 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0]</span>
<span class="go">[0 1 1 0 0 0 0 1 0 0 0 1 0 0 0 0]</span>
<span class="go">[1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 1 0 0 1 0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 1 0 1 0 0 1 0 0 0 0 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 1 1 0 0 0 0 0 0 0 0 1]</span>
<span class="go">[1 0 0 0 0 0 0 0 0 1 1 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 0 0 0 0 1 0 0 1 0 1 0 0]</span>
<span class="go">[0 0 1 0 0 0 0 0 1 0 0 1 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 1 0 0 0 1 0 0 0 0 1 1 0]</span>
<span class="go">[0 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">G</span><span class="p">)</span> <span class="c"># matrix over GF(2)</span>
<span class="go">[0 1 1 0 1 0 0 0 1 0 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0]</span>
<span class="go">[0 1 1 0 0 0 0 1 0 0 0 1 0 0 0 0]</span>
<span class="go">[1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 1 0 0 1 0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 1 0 1 0 0 1 0 0 0 0 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 1 1 0 0 0 0 0 0 0 0 1]</span>
<span class="go">[1 0 0 0 0 0 0 0 0 1 1 0 1 0 0 0]</span>
<span class="go">[0 1 0 0 0 0 0 0 1 0 0 1 0 1 0 0]</span>
<span class="go">[0 0 1 0 0 0 0 0 1 0 0 1 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 1 0 0 0 1 0 0 0 0 1 1 0]</span>
<span class="go">[0 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 1 0 0]</span>
<span class="go">[1 0 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 1 0]</span>
<span class="go">[1 0 0 0 0 1]</span>
<span class="go">[0 1 0 0 0 0]</span>
</pre></div>
</div>
<p>A different ordering of the vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[0 0 1 1 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="go">[1 0 0 0 1]</span>
<span class="go">[1 1 0 0 0]</span>
<span class="go">[0 0 1 0 0]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 256 by 256 dense matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 512 by 512 sparse matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)]</span><span class="o">+</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 501 by 501 dense matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">``vertices`` must be a permutation of the vertices</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">``vertices`` must be a permutation of the vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.antisymmetric">
<tt class="descname">antisymmetric</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.antisymmetric" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether the graph is antisymmetric.</p>
<p>A graph represents an antisymmetric relation if there being a path
from a vertex x to a vertex y implies that there is not a path from
y to x unless x=y.</p>
<p>A directed acyclic graph is antisymmetric. An undirected graph is
never antisymmetric unless it is just a union of isolated
vertices.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">antisymmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNR</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">antisymmetric</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.automorphism_group">
<tt class="descname">automorphism_group</tt><big>(</big><em>partition=None</em>, <em>verbosity=0</em>, <em>edge_labels=False</em>, <em>order=False</em>, <em>return_group=True</em>, <em>orbits=False</em>, <em>algorithm=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.automorphism_group" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the largest subgroup of the automorphism group of the
(di)graph whose orbit partition is finer than the partition given.
If no partition is given, the unit partition is used and the entire
automorphism group is given.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">partition</span></tt> - default is the unit partition,
otherwise computes the subgroup of the full automorphism group
respecting the partition.</li>
<li><tt class="docutils literal"><span class="pre">edge_labels</span></tt> - default False, otherwise allows
only permutations respecting edge labels. Note that this option
is not supported if <tt class="docutils literal"><span class="pre">algorithm=&quot;bliss&quot;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">order</span></tt> - (default False) if True, compute the
order of the automorphism group</li>
<li><tt class="docutils literal"><span class="pre">return_group</span></tt> - default True</li>
<li><tt class="docutils literal"><span class="pre">orbits</span></tt> - returns the orbits of the group acting
on the vertices of the graph</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;bliss&quot;</span></tt> the automorphism group is
computed using the optional package bliss
(<a class="reference external" href="http://www.tcs.tkk.fi/Software/bliss/index.html">http://www.tcs.tkk.fi/Software/bliss/index.html</a>).  Setting it to
&#8220;sage&#8221; uses Sage&#8217;s implementation. If set to <tt class="docutils literal"><span class="pre">None</span></tt> (default), bliss
is used when available.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Since <a class="reference external" href="http://trac.sagemath.org/14319">trac ticket #14319</a> the domain of the automorphism group is equal to
the graph&#8217;s vertex set, and the <tt class="docutils literal"><span class="pre">translation</span></tt> argument has become
useless.</p>
</div>
<p>OUTPUT: The order of the output is group, order, orbits. However, there
are options to turn each of these on or off.</p>
<p>EXAMPLES:</p>
<p>Graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs_query</span> <span class="o">=</span> <span class="n">GraphQuery</span><span class="p">(</span><span class="n">display_cols</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;graph6&#39;</span><span class="p">],</span><span class="n">num_vertices</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">graphs_query</span><span class="o">.</span><span class="n">get_graphs_list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">graphs_list</span><span class="o">.</span><span class="n">show_graphs</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">G</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="gp">... </span>   <span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(24, [(2,3), (1,2), (0,1)])</span>
<span class="go">(4, [(2,3), (0,1)])</span>
<span class="go">(2, [(1,2)])</span>
<span class="go">(6, [(1,2), (0,1)])</span>
<span class="go">(6, [(2,3), (1,2)])</span>
<span class="go">(8, [(1,2), (0,1)(2,3)])</span>
<span class="go">(2, [(0,1)(2,3)])</span>
<span class="go">(2, [(1,2)])</span>
<span class="go">(8, [(2,3), (0,1), (0,2)(1,3)])</span>
<span class="go">(4, [(2,3), (0,1)])</span>
<span class="go">(24, [(2,3), (1,2), (0,1)])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">character_table</span><span class="p">()</span> <span class="c"># random order of rows, thus abs() below</span>
<span class="gp">sage: </span><span class="n">QQ</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">determinant</span><span class="p">())</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">712483534798848</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">384</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A5</span> <span class="o">=</span> <span class="n">AlternatingGroup</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z2</span> <span class="o">=</span> <span class="n">CyclicPermutationGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">A5</span><span class="o">.</span><span class="n">direct_product</span><span class="p">(</span><span class="n">Z2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#see documentation for direct_product to explain the [0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Multigraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Permutation Group with generators [(&#39;a&#39;,&#39;b&#39;)]</span>
</pre></div>
</div>
<p>Digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Permutation Group with generators [(0,1,2,3,4)]</span>
</pre></div>
</div>
<p>Edge labeled graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Permutation Group with generators [(1,4)(2,3)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span> <span class="p">:</span> <span class="p">{</span><span class="mi">1</span> <span class="p">:</span> <span class="mi">7</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Permutation Group with generators [(0,1)]</span>

<span class="gp">sage: </span><span class="n">foo</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bar</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;c_graph&#39;</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">foo</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">bar</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">foo</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Permutation Group with generators [()]</span>
<span class="gp">sage: </span><span class="n">foo</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Permutation Group with generators [(0,3)(1,2)]</span>
<span class="gp">sage: </span><span class="n">bar</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Permutation Group with generators [()]</span>
</pre></div>
</div>
<p>You can also ask for just the order of the group:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">return_group</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">120</span>
</pre></div>
</div>
<p>Or, just the orbits (note that each graph here is vertex transitive)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">return_group</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">orbits</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">partition</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span> <span class="n">return_group</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">orbits</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">[[0], [2, 3, 6, 7, 8, 9], [1, 4, 5]]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">orbits</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_group</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">[[&#39;000&#39;, &#39;001&#39;, &#39;010&#39;, &#39;011&#39;, &#39;100&#39;, &#39;101&#39;, &#39;110&#39;, &#39;111&#39;]]</span>
</pre></div>
</div>
<p>One can also use the faster algorithm for computing the automorphism
group of the graph - bliss:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HallJankoGraph</span><span class="p">()</span>                   <span class="c"># optional - bliss</span>
<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>                   <span class="c"># optional - bliss</span>
<span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;bliss&#39;</span><span class="p">)</span>  <span class="c"># optional - bliss</span>
<span class="gp">sage: </span><span class="n">A1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>                          <span class="c"># optional - bliss</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We get a KeyError when given an invalid partition (<a class="reference external" href="http://trac.sagemath.org/6087">trac ticket #6087</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">relabel</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">partition</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">6</span>
</pre></div>
</div>
<p>Labeled automorphism group:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">Permutation Group with generators [(&#39;01&#39;,&#39;02&#39;)(&#39;10&#39;,&#39;20&#39;)(&#39;11&#39;,&#39;22&#39;)(&#39;12&#39;,&#39;21&#39;), (&#39;00&#39;,&#39;11&#39;)(&#39;01&#39;,&#39;10&#39;)(&#39;02&#39;,&#39;12&#39;)(&#39;20&#39;,&#39;21&#39;)]</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">edges</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">Permutation Group with generators [(&#39;01&#39;,&#39;02&#39;)(&#39;10&#39;,&#39;20&#39;)(&#39;11&#39;,&#39;22&#39;)(&#39;12&#39;,&#39;21&#39;)]</span>
</pre></div>
</div>
<p>The labeling is correct:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ag</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ag</span><span class="o">.</span><span class="n">orbit</span><span class="p">((</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">),</span><span class="n">action</span><span class="o">=</span><span class="s">&quot;OnPairs&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">30</span><span class="p">:</span>
<span class="gp">... </span>          <span class="k">print</span> <span class="s">&quot;ARggggggggggggg !!!&quot;</span>
</pre></div>
</div>
<p>Empty group, correct domain:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">:[]})</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Permutation Group with generators [()]</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">:[]})</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">{&#39;a&#39;, &#39;b&#39;}</span>
</pre></div>
</div>
<p>We can check that the subgroups are labelled correctly
(<a class="reference external" href="http://trac.sagemath.org/15656">trac ticket #15656</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G1</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="s">&#39;:H`ECw@HGXGAGUG`e&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">G1</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">subgroups</span><span class="p">()</span>
<span class="go">[Subgroup of (Permutation Group with generators [(0,7)(1,4)(2,3)(6,8)]) generated by [()],</span>
<span class="go">Subgroup of (Permutation Group with generators [(0,7)(1,4)(2,3)(6,8)]) generated by [(0,7)(1,4)(2,3)(6,8)]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.average_degree">
<tt class="descname">average_degree</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.average_degree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the average degree of the graph.</p>
<p>The average degree of a graph <span class="math">\(G=(V,E)\)</span> is equal to
<tt class="docutils literal"><span class="pre">\frac</span> <span class="pre">{2|E|}{|V|}</span></tt>.</p>
<p>EXAMPLES:</p>
<p>The average degree of a regular graph is equal to the
degree of any vertex:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">average_degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The average degree of a tree is always strictly less than
<span class="math">\(2\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tree</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">tree</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">tree</span><span class="o">.</span><span class="n">average_degree</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For any graph, it is equal to <tt class="docutils literal"><span class="pre">\frac</span> <span class="pre">{2|E|}{|V|}</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="o">.</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">average_degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.average_distance">
<tt class="descname">average_distance</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.average_distance" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the average distance between vertices of the graph.</p>
<p>Formally, for a graph <span class="math">\(G\)</span> this value is equal to
<span class="math">\(\frac 1 {n(n-1)} \sum_{u,v\in G} d(u,v)\)</span> where <span class="math">\(d(u,v)\)</span>
denotes the distance between vertices <span class="math">\(u\)</span> and <span class="math">\(v\)</span> and <span class="math">\(n\)</span>
is the number of vertices in <span class="math">\(G\)</span>.</p>
<p>For more information on the input variables and more examples, we refer
to <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.wiener_index" title="sage.graphs.generic_graph.GenericGraph.wiener_index"><tt class="xref py py-meth docutils literal"><span class="pre">wiener_index()</span></tt></a> and
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs" title="sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path_all_pairs()</span></tt></a>,
which have very similar input variables.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - the Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - the Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> for
unweighted graphs, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>, otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>EXAMPLE:</p>
<p>From <a class="reference internal" href="#gyll93" id="id1">[GYLL93]</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">average_distance</span><span class="p">()</span><span class="o">==</span><span class="n">w</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="gyll93" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[GYLL93]</a></td><td>I. Gutman, Y.-N. Yeh, S.-L. Lee, and Y.-L. Luo. Some recent
results in the theory of the Wiener number. <em>Indian Journal of
Chemistry</em>, 32A:651&#8211;661, 1993.</td></tr>
</tbody>
</table>
<p>TEST:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">average_distance</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The graph must have at least two vertices for this value to be defined</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.blocks_and_cut_vertices">
<tt class="descname">blocks_and_cut_vertices</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.blocks_and_cut_vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes the blocks and cut vertices of the graph.</p>
<p>In the case of a digraph, this computation is done on the underlying
graph.</p>
<p>A cut vertex is one whose deletion increases the number of
connected components. A block is a maximal induced subgraph which
itself has no cut vertices. Two distinct blocks cannot overlap in
more than a single cut vertex.</p>
<p>OUTPUT: <tt class="docutils literal"><span class="pre">(</span> <span class="pre">B,</span> <span class="pre">C</span> <span class="pre">)</span></tt>, where <tt class="docutils literal"><span class="pre">B</span></tt> is a list of blocks- each is
a list of vertices and the blocks are the corresponding induced
subgraphs-and <tt class="docutils literal"><span class="pre">C</span></tt> is a list of cut vertices.</p>
<p>ALGORITHM:</p>
<blockquote>
<div>We implement the algorithm proposed by Tarjan in <a class="reference internal" href="#tarjan72" id="id2">[Tarjan72]</a>. The
original version is recursive. We emulate the recursion using a stack.</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.blocks_and_cuts_tree" title="sage.graphs.generic_graph.GenericGraph.blocks_and_cuts_tree"><tt class="xref py py-meth docutils literal"><span class="pre">blocks_and_cuts_tree()</span></tt></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]], [])</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([[4, 5], [3, 4], [2, 3], [1, 2], [0, 1]], [1, 2, 3, 4])</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([[0, 1, 2, 3, 4, 5, 6]], [])</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">KrackhardtKiteGraph</span><span class="p">()</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([[8, 9], [7, 8], [0, 1, 2, 3, 4, 5, 6, 7]], [7, 8])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">Graph</span><span class="p">()</span>  <span class="c"># make a bowtie graph where 0 is a cut vertex</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([[0, 1, 2], [0, 3, 4]], [0])</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">StarGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([[0, 1], [0, 2], [0, 3]], [0])</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([], [])</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="go">([[0]], [])</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">blocks_and_cut_vertices</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">...</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="tarjan72" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Tarjan72]</a></td><td>R.E. Tarjan. Depth-First Search and Linear Graph
Algorithms. SIAM J. Comput. 1(2): 146-160 (1972).</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.blocks_and_cuts_tree">
<tt class="descname">blocks_and_cuts_tree</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.blocks_and_cuts_tree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the blocks-and-cuts tree of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>This new graph has two different kinds of vertices, some representing
the blocks (type B) and some other the cut vertices of the graph
<tt class="docutils literal"><span class="pre">self</span></tt> (type C).</p>
<p>There is an edge between a vertex <span class="math">\(u\)</span> of type B and a vertex <span class="math">\(v\)</span> of type
C if the cut-vertex corresponding to <span class="math">\(v\)</span> is in the block corresponding
to <span class="math">\(u\)</span>.</p>
<p>The resulting graph is a tree, with the additional characteristic
property that the distance between two leaves is even.</p>
<p>When <tt class="docutils literal"><span class="pre">self</span></tt> is biconnected, the tree is reduced to a single node of
type <span class="math">\(B\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.blocks_and_cut_vertices" title="sage.graphs.generic_graph.GenericGraph.blocks_and_cut_vertices"><tt class="xref py py-meth docutils literal"><span class="pre">blocks_and_cut_vertices()</span></tt></a></p>
</div>
<p>EXAMPLES:</p>
<blockquote>
<div>sage: T = graphs.KrackhardtKiteGraph().blocks_and_cuts_tree(); T
Graph on 5 vertices
sage: T.is_isomorphic(graphs.PathGraph(5))
True</div></blockquote>
<p>The distance between two leaves is even:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomTree</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">blocks_and_cuts_tree</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">T</span> <span class="k">if</span> <span class="n">T</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">leaves</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The tree of a biconnected graph has a single vertex, of type <span class="math">\(B\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">blocks_and_cuts_tree</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(&#39;B&#39;, (0, 1, 2, 3, 4, 5, 6, 7, 8, 9))]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="harpri" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[HarPri]</td><td>F. Harary and G. Prins. The block-cutpoint-tree of
a graph. Publ. Math. Debrecen 13 1966 103-107.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gallai" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Gallai]</td><td>T. Gallai, Elementare Relationen bezueglich der
Glieder und trennenden Punkte von Graphen, Magyar
Tud. Akad. Mat. Kutato Int. Kozl. 9 (1964) 235-236</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.breadth_first_search">
<tt class="descname">breadth_first_search</tt><big>(</big><em>start</em>, <em>ignore_direction=False</em>, <em>distance=None</em>, <em>neighbors=None</em>, <em>report_distance=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.breadth_first_search" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over the vertices in a breadth-first ordering.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">start</span></tt> &#8211; vertex or list of vertices from which to start
the traversal.</li>
<li><tt class="docutils literal"><span class="pre">ignore_direction</span></tt> &#8211; (default <tt class="docutils literal"><span class="pre">False</span></tt>) only applies to
directed graphs. If <tt class="docutils literal"><span class="pre">True</span></tt>, searches across edges in either
direction.</li>
<li><tt class="docutils literal"><span class="pre">distance</span></tt> &#8211; the maximum distance from the <tt class="docutils literal"><span class="pre">start</span></tt> nodes
to traverse. The <tt class="docutils literal"><span class="pre">start</span></tt> nodes are distance zero from
themselves.</li>
<li><tt class="docutils literal"><span class="pre">neighbors</span></tt> &#8211; a function giving the neighbors of a vertex.
The function should take a vertex and return a list of
vertices.  For a graph, <tt class="docutils literal"><span class="pre">neighbors</span></tt> is by default the
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.neighbors" title="sage.graphs.generic_graph.GenericGraph.neighbors"><tt class="xref py py-meth docutils literal"><span class="pre">neighbors()</span></tt></a> function of the graph.  For a digraph,
the <tt class="docutils literal"><span class="pre">neighbors</span></tt> function defaults to the
<a class="reference internal" href="digraph.html#sage.graphs.digraph.DiGraph.neighbor_out_iterator" title="sage.graphs.digraph.DiGraph.neighbor_out_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">neighbor_out_iterator()</span></tt></a> function of the graph.</li>
<li><tt class="docutils literal"><span class="pre">report_distance</span></tt> &#8211; (default <tt class="docutils literal"><span class="pre">False</span></tt>) If <tt class="docutils literal"><span class="pre">True</span></tt>,
reports pairs (vertex, distance) where distance is the
distance from the <tt class="docutils literal"><span class="pre">start</span></tt> nodes. If <tt class="docutils literal"><span class="pre">False</span></tt> only the
vertices are reported.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="base/c_graph.html#sage.graphs.base.c_graph.CGraphBackend.breadth_first_search" title="sage.graphs.base.c_graph.CGraphBackend.breadth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">breadth_first_search</span></tt></a>
&#8211; breadth-first search for fast compiled graphs.</li>
<li><a class="reference internal" href="base/c_graph.html#sage.graphs.base.c_graph.CGraphBackend.depth_first_search" title="sage.graphs.base.c_graph.CGraphBackend.depth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">depth_first_search</span></tt></a>
&#8211; depth-first search for fast compiled graphs.</li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.depth_first_search" title="sage.graphs.generic_graph.GenericGraph.depth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">depth_first_search()</span></tt></a> &#8211; depth-first search for generic graphs.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0, 1, 4, 2, 3]</span>
</pre></div>
</div>
<p>By default, the edge direction of a digraph is respected, but this
can be overridden by the <tt class="docutils literal"><span class="pre">ignore_direction</span></tt> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[0, 1, 2, 3, 7, 4, 5, 6]</span>
</pre></div>
</div>
<p>You can specify a maximum distance in which to search. A
distance of zero returns the <tt class="docutils literal"><span class="pre">start</span></tt> vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">distance</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">distance</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[0, 1, 2, 3]</span>
</pre></div>
</div>
<p>Multiple starting vertices can be specified in a list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]))</span>
<span class="go">[0, 6, 1, 2, 3, 7, 4, 5]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">distance</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0, 6]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">distance</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[0, 6, 1, 2, 3, 7]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">ignore_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">distance</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[6, 3, 7, 0, 5]</span>
</pre></div>
</div>
<p>More generally, you can specify a <tt class="docutils literal"><span class="pre">neighbors</span></tt> function. For
example, you can traverse the graph backwards by setting
<tt class="docutils literal"><span class="pre">neighbors</span></tt> to be the <a class="reference internal" href="digraph.html#sage.graphs.digraph.DiGraph.neighbors_in" title="sage.graphs.digraph.DiGraph.neighbors_in"><tt class="xref py py-meth docutils literal"><span class="pre">neighbors_in()</span></tt></a> function of the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_in</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[5, 1, 2, 0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_out</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[5, 7, 0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[5, 1, 2, 7, 0, 4, 6]</span>
</pre></div>
</div>
<p>It is possible (<a class="reference external" href="http://trac.sagemath.org/16470">trac ticket #16470</a>) using the keyword
<tt class="docutils literal"><span class="pre">report_distance</span></tt> to get pairs (vertex, distance) encoding
the distance to the starting vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">report_distance</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[(0, 0), (1, 1), (4, 1), (5, 1), (2, 2), (6, 2), (3, 2), (9, 2),</span>
<span class="go">(7, 2), (8, 2)]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">report_distance</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">[0, 1, 4, 5, 2, 6, 3, 9, 7, 8]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbor_in_iterator</span><span class="p">,</span> <span class="n">report_distance</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[(4, 0), (3, 1), (0, 2), (2, 2), (1, 3)]</span>

<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">report_distance</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[(0, 0), (1, 0), (3, 1), (2, 1)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[0, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.canonical_label">
<tt class="descname">canonical_label</tt><big>(</big><em>partition=None</em>, <em>certify=False</em>, <em>verbosity=0</em>, <em>edge_labels=False</em>, <em>algorithm=None</em>, <em>return_graph=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.canonical_label" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a graph on <span class="math">\(\{0,1,...,n-1\}\)</span> ( <tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">self.order()</span></tt> ) which</p>
<ul class="simple">
<li>is isomorphic to self,</li>
<li>is invariant in the isomorphism class.</li>
</ul>
<p>In other words, given two graphs <tt class="docutils literal"><span class="pre">G</span></tt> and <tt class="docutils literal"><span class="pre">H</span></tt> which are isomorphic,
suppose <tt class="docutils literal"><span class="pre">G_c</span></tt> and <tt class="docutils literal"><span class="pre">H_c</span></tt> are the graphs returned by
<tt class="docutils literal"><span class="pre">canonical_label</span></tt>. Then the following hold:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">G_c</span> <span class="pre">==</span> <span class="pre">H_c</span></tt></li>
<li><tt class="docutils literal"><span class="pre">G_c.adjacency_matrix()</span> <span class="pre">==</span> <span class="pre">H_c.adjacency_matrix()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">G_c.graph6_string()</span> <span class="pre">==</span> <span class="pre">H_c.graph6_string()</span></tt></li>
</ul>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">partition</span></tt> - if given, the canonical label with
respect to this set partition will be computed. The default is the unit
set partition.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">certify</span></tt> - if True, a dictionary mapping from the
(di)graph to its canonical label will be given.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">verbosity</span></tt> - gets passed to nice: prints helpful
output.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">edge_labels</span></tt> - default False, otherwise allows
only permutations respecting edge labels.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> - If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;bliss&quot;</span></tt> the automorphism group is
computed using the optional package bliss
(<a class="reference external" href="http://www.tcs.tkk.fi/Software/bliss/index.html">http://www.tcs.tkk.fi/Software/bliss/index.html</a>). Setting it to
&#8220;sage&#8221; uses Sage&#8217;s implementation. If set to <tt class="docutils literal"><span class="pre">None</span></tt> (default), bliss
is used when available.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure you always compare canonical forms obtained by the
same algorithm.</p>
</div>
</div></blockquote>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">return_graph</span></tt> - If <tt class="docutils literal"><span class="pre">return_graph</span> <span class="pre">=</span> <span class="pre">'False'</span></tt> do not return the</dt>
<dd><p class="first last">canonical graph.</p>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Dodecahedron: Graph on 20 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">certify</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">(Dodecahedron: Graph on 20 vertices, {0: 0, 1: 19, 2: 16, 3: 15, 4: 9, 5: 1, 6: 10, 7: 8, 8: 14, 9: 12, 10: 17, 11: 11, 12: 5, 13: 6, 14: 2, 15: 4, 16: 3, 17: 7, 18: 13, 19: 18})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Multigraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">()</span>
<span class="go">Multi-graph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="s">&#39;A?&#39;</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s">&#39;c_graph&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">()</span>
<span class="go">Graph on 2 vertices</span>
</pre></div>
</div>
<p>Digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DP</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;sage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 0 0 0 0 0 0 1 1 1]</span>
<span class="go">[0 0 0 0 1 0 1 0 0 1]</span>
<span class="go">[0 0 0 1 0 0 1 0 1 0]</span>
<span class="go">[0 0 1 0 0 1 0 0 0 1]</span>
<span class="go">[0 1 0 0 0 1 0 0 1 0]</span>
<span class="go">[0 0 0 1 1 0 0 1 0 0]</span>
<span class="go">[0 1 1 0 0 0 0 1 0 0]</span>
<span class="go">[1 0 0 0 0 1 1 0 0 0]</span>
<span class="go">[1 0 1 0 1 0 0 0 0 0]</span>
<span class="go">[1 1 0 1 0 0 0 0 0 0]</span>
</pre></div>
</div>
<p>Edge labeled graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Graph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">certify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(Graph on 5 vertices, {0: 4, 1: 3, 2: 0, 3: 1, 4: 2})</span>
</pre></div>
</div>
<p>Check for immutable graphs (<a class="reference external" href="http://trac.sagemath.org/16602">trac ticket #16602</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Graph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2]</span>
</pre></div>
</div>
<p>Canonical forms can be computed by bliss as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>                                       <span class="c"># optional - bliss</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>                                                  <span class="c"># optional - bliss</span>
<span class="gp">sage: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">return_graph</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;bliss&#39;</span><span class="p">)</span>  <span class="c"># optional - bliss</span>
<span class="gp">sage: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">return_graph</span><span class="o">=</span><span class="n">false</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;bliss&#39;</span><span class="p">)</span>  <span class="c"># optional - bliss</span>
<span class="gp">sage: </span><span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span>                                                      <span class="c"># optional - bliss</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.cartesian_product">
<tt class="descname">cartesian_product</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.cartesian_product" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the Cartesian product of self and other.</p>
<p>The Cartesian product of <span class="math">\(G\)</span> and <span class="math">\(H\)</span> is the graph <span class="math">\(L\)</span> with vertex set
<span class="math">\(V(L)\)</span> equal to the Cartesian product of the vertices <span class="math">\(V(G)\)</span> and <span class="math">\(V(H)\)</span>,
and <span class="math">\(((u,v), (w,x))\)</span> is an edge iff either - <span class="math">\((u, w)\)</span> is an edge of self
and <span class="math">\(v = x\)</span>, or - <span class="math">\((v, x)\)</span> is an edge of other and <span class="math">\(u = w\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="graph_decompositions/graph_products.html#sage.graphs.graph_decompositions.graph_products.is_cartesian_product" title="sage.graphs.graph_decompositions.graph_products.is_cartesian_product"><tt class="xref py py-meth docutils literal"><span class="pre">is_cartesian_product()</span></tt></a>
&#8211; factorization of graphs according to the cartesian product</li>
<li><a class="reference internal" href="graph_decompositions/graph_products.html#module-sage.graphs.graph_decompositions.graph_products" title="sage.graphs.graph_decompositions.graph_products"><tt class="xref py py-mod docutils literal"><span class="pre">graph_products</span></tt></a>
&#8211; a module on graph products.</li>
</ul>
</div>
<p>TESTS:</p>
<p>Cartesian product of graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">C1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C1</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (0, &#39;b&#39;)), ((0, &#39;a&#39;), (1, &#39;a&#39;)), ((0, &#39;b&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;a&#39;)), ((1, &#39;b&#39;), (2, &#39;b&#39;)), ((2, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Construction of a Toroidal grid:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">graphs</span><span class="o">.</span><span class="n">ToroidalGrid2dGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Cartesian product of digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="mi">2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;aa&#39;), (0, &#39;aa&#39;)), ((0, &#39;aa&#39;), (0, &#39;ab&#39;)), ((0, &#39;aa&#39;), (1, &#39;aa&#39;)), ((0, &#39;ab&#39;), (0, &#39;ba&#39;)), ((0, &#39;ab&#39;), (0, &#39;bb&#39;)), ((0, &#39;ab&#39;), (1, &#39;ab&#39;)), ((0, &#39;ba&#39;), (0, &#39;aa&#39;)), ((0, &#39;ba&#39;), (0, &#39;ab&#39;)), ((0, &#39;ba&#39;), (1, &#39;ba&#39;)), ((0, &#39;bb&#39;), (0, &#39;ba&#39;)), ((0, &#39;bb&#39;), (0, &#39;bb&#39;)), ((0, &#39;bb&#39;), (1, &#39;bb&#39;)), ((1, &#39;aa&#39;), (1, &#39;aa&#39;)), ((1, &#39;aa&#39;), (1, &#39;ab&#39;)), ((1, &#39;ab&#39;), (1, &#39;ba&#39;)), ((1, &#39;ab&#39;), (1, &#39;bb&#39;)), ((1, &#39;ba&#39;), (1, &#39;aa&#39;)), ((1, &#39;ba&#39;), (1, &#39;ab&#39;)), ((1, &#39;bb&#39;), (1, &#39;ba&#39;)), ((1, &#39;bb&#39;), (1, &#39;bb&#39;))]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">strongly_connected_components_digraph</span><span class="p">()</span><span class="o">.</span><span class="n">num_verts</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">strongly_connected_component_containing_vertex</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;aa&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">Q</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.categorical_product">
<tt class="descname">categorical_product</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.categorical_product" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the tensor product of self and other.</p>
<p>The tensor product of <span class="math">\(G\)</span> and <span class="math">\(H\)</span> is the graph <span class="math">\(L\)</span> with vertex set
<span class="math">\(V(L)\)</span> equal to the Cartesian product of the vertices <span class="math">\(V(G)\)</span> and <span class="math">\(V(H)\)</span>,
and <span class="math">\(((u,v), (w,x))\)</span> is an edge iff - <span class="math">\((u, w)\)</span> is an edge of self, and -
<span class="math">\((v, x)\)</span> is an edge of other.</p>
<p>The tensor product is also known as the categorical product and the
kronecker product (refering to the kronecker matrix product). See
<a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_product">Wikipedia article on the Kronecker product</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">T</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 21 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">T</span>
<span class="go">Graph on 200 vertices</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">900</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 1101 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Tensor product of graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (1, &#39;b&#39;)), ((0, &#39;b&#39;), (1, &#39;a&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;)), ((1, &#39;b&#39;), (2, &#39;a&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">H</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Tensor product of digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">J</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The tensor product of two DeBruijn digraphs of same diameter is a DeBruijn digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">B1</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B2</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">B1</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span> <span class="n">B2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.center">
<tt class="descname">center</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.center" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the set of vertices in the center, i.e. whose eccentricity
is equal to the radius of the (di)graph.</p>
<p>In other words, the center is the set of vertices achieving the
minimum eccentricity.</p>
<p>For more information and examples on how to use input variables,
see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a> and
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eccentricity" title="sage.graphs.generic_graph.GenericGraph.eccentricity"><tt class="xref py py-meth docutils literal"><span class="pre">eccentricity()</span></tt></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, edge weights are taken into account; if
False, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - a Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - a Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> for
unweighted graphs, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>, otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DiamondGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
<span class="go">[1, 2]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">center</span><span class="p">())</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">StarGraph</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.centrality_betweenness">
<tt class="descname">centrality_betweenness</tt><big>(</big><em>k=None</em>, <em>normalized=True</em>, <em>weight=None</em>, <em>endpoints=False</em>, <em>seed=None</em>, <em>exact=False</em>, <em>algorithm=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.centrality_betweenness" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the betweenness centrality (fraction of number of
shortest paths that go through each vertex) as a dictionary
keyed by vertices. The betweenness is normalized by default to
be in range (0,1).</p>
<p>Measures of the centrality of a vertex within a graph determine
the relative importance of that vertex to its graph. Vertices
that occur on more shortest paths between other vertices have
higher betweenness than vertices that occur on less.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">normalized</span></tt> - boolean (default True) - if set to False,
result is not normalized.</li>
<li><tt class="docutils literal"><span class="pre">k</span></tt> - integer or None (default None) - if set to an integer, use
<tt class="docutils literal"><span class="pre">k</span></tt> node samples to estimate betweenness. Higher values give better
approximations. Not available when <tt class="docutils literal"><span class="pre">algorithm=&quot;Sage&quot;</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">weight</span></tt> - None or string. If set to a string, use that attribute of
the nodes as weight. <tt class="docutils literal"><span class="pre">weight</span> <span class="pre">=</span> <span class="pre">True</span></tt> is equivalent to <tt class="docutils literal"><span class="pre">weight</span> <span class="pre">=</span>
<span class="pre">&quot;weight&quot;</span></tt>. Not available when <tt class="docutils literal"><span class="pre">algorithm=&quot;Sage&quot;</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">endpoints</span></tt> - Boolean. If set to True it includes the endpoints in
the shortest paths count. Not available when <tt class="docutils literal"><span class="pre">algorithm=&quot;Sage&quot;</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">exact</span></tt> (boolean, default: <tt class="docutils literal"><span class="pre">False</span></tt>) &#8211; whether to compute over
rationals or on <tt class="docutils literal"><span class="pre">double</span></tt> C variables. Not available when
<tt class="docutils literal"><span class="pre">algorithm=&quot;NetworkX&quot;</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; can be either <tt class="docutils literal"><span class="pre">&quot;Sage&quot;</span></tt> (see
<a class="reference internal" href="centrality.html#module-sage.graphs.centrality" title="sage.graphs.centrality"><tt class="xref py py-mod docutils literal"><span class="pre">centrality</span></tt></a>), <tt class="docutils literal"><span class="pre">&quot;NetworkX&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;None&quot;</span></tt>. In the
latter case, Sage&#8217;s algorithm will be used whenever possible.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.centrality_degree" title="sage.graphs.graph.Graph.centrality_degree"><tt class="xref py py-meth docutils literal"><span class="pre">centrality_degree()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.centrality_closeness" title="sage.graphs.generic_graph.GenericGraph.centrality_closeness"><tt class="xref py py-meth docutils literal"><span class="pre">centrality_closeness()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">ChvatalGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">centrality_betweenness</span><span class="p">()</span> <span class="c"># abs tol 1e-10</span>
<span class="go">{0: 0.06969696969696969, 1: 0.06969696969696969,</span>
<span class="go"> 2: 0.0606060606060606, 3: 0.0606060606060606,</span>
<span class="go"> 4: 0.06969696969696969, 5: 0.06969696969696969,</span>
<span class="go"> 6: 0.0606060606060606, 7: 0.0606060606060606,</span>
<span class="go"> 8: 0.0606060606060606, 9: 0.0606060606060606,</span>
<span class="go"> 10: 0.0606060606060606, 11: 0.0606060606060606}</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">centrality_betweenness</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c"># abs tol 1e-10</span>
<span class="go">{0: 3.833333333333333, 1: 3.833333333333333, 2: 3.333333333333333,</span>
<span class="go"> 3: 3.333333333333333, 4: 3.833333333333333, 5: 3.833333333333333,</span>
<span class="go"> 6: 3.333333333333333, 7: 3.333333333333333, 8: 3.333333333333333,</span>
<span class="go"> 9: 3.333333333333333, 10: 3.333333333333333,</span>
<span class="go"> 11: 3.333333333333333}</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">centrality_betweenness</span><span class="p">()</span> <span class="c"># abs tol abs 1e-10</span>
<span class="go">{0: 0.16666666666666666, 1: 0.16666666666666666, 2: 0.0, 3: 0.0}</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">tests</span> <span class="o">=</span> <span class="p">([</span><span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span><span class="o">+</span>
<span class="go">....:          [digraphs.RandomDirectedGNP(30,.1) for i in range(10)])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
<span class="go">....:     r1 = g.centrality_betweenness(algorithm=&quot;Sage&quot;,exact=0)</span>
<span class="go">....:     r2 = g.centrality_betweenness(algorithm=&quot;Sage&quot;,exact=1)</span>
<span class="go">....:     r3 = g.centrality_betweenness(algorithm=&quot;NetworkX&quot;)</span>
<span class="go">....:     for x in g:</span>
<span class="go">....:         if max([r1[x],r2[x],r3[x]])-min([r1[x],r2[x],r3[x]]) &gt; 0.01:</span>
<span class="go">....:             print &quot;Error&quot;,x,[r1[x],r2[x],r3[x]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.centrality_closeness">
<tt class="descname">centrality_closeness</tt><big>(</big><em>vert=None</em>, <em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.centrality_closeness" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the closeness centrality of all vertices in variable <tt class="docutils literal"><span class="pre">vert</span></tt>.</p>
<p>In a (strongly) connected graph, the closeness centrality of a vertex
<span class="math">\(v\)</span> is equal
to the inverse of the average distance between <span class="math">\(v\)</span> and other vertices.
If the graph is disconnected, the closeness centrality of <span class="math">\(v\)</span> is
multiplied by the fraction of reachable vertices in the graph:
this way, central vertices should also reach several other vertices
in the graph <a class="reference internal" href="#olj14" id="id3">[OLJ14]</a>. In formulas,</p>
<div class="math">
\[c(v)=\frac{r(v)-1}{\sum_{w \in R(v)} d(v,w)}\frac{r(v)-1}{n-1}\]</div>
<p>where <span class="math">\(R(v)\)</span> is the set of vertices reachable from <span class="math">\(v\)</span>, and
<span class="math">\(r(v)\)</span> is the cardinality of <span class="math">\(R(v)\)</span>.</p>
<p>&#8216;Closeness
centrality may be defined as the total graph-theoretic distance of
a given vertex from all other vertices... Closeness is an inverse
measure of centrality in that a larger value indicates a less
central actor while a smaller value indicates a more central
actor,&#8217; <a class="reference internal" href="#borgatti95" id="id4">[Borgatti95]</a>.</p>
<p>For more information, see the <a class="reference external" href="https://en.wikipedia.org/wiki/Centrality">Wikipedia article Centrality</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vert</span></tt> - the vertex or the list of vertices we want to analyze. If
<tt class="docutils literal"><span class="pre">None</span></tt> (default), all vertices are considered.</li>
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt>: performs a BFS from each vertex that has to be analyzed.
Does not work with edge weights.</li>
<li><tt class="docutils literal"><span class="pre">'NetworkX'</span></tt>: the NetworkX algorithm (works only with positive
weights).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - the Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt> and
all centralities are needed.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - the Python implementation of
the Floyd-Warshall algorithm. Works only if all centralities are
needed, but it can deal with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> if
<tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt> otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>OUTPUT:</p>
<p>If <tt class="docutils literal"><span class="pre">vert</span></tt> is a vertex, the closeness centrality of that vertex.
Otherwise, a dictionary associating to each vertex in <tt class="docutils literal"><span class="pre">vert</span></tt> its
closeness centrality. If a vertex has (out)degree 0, its closeness
centrality is not defined, and the vertex is not included in the output.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="centrality.html#sage.graphs.centrality.centrality_closeness_top_k" title="sage.graphs.centrality.centrality_closeness_top_k"><tt class="xref py py-func docutils literal"><span class="pre">centrality_closeness_top_k()</span></tt></a></li>
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.centrality_degree" title="sage.graphs.graph.Graph.centrality_degree"><tt class="xref py py-meth docutils literal"><span class="pre">centrality_degree()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.centrality_betweenness" title="sage.graphs.generic_graph.GenericGraph.centrality_betweenness"><tt class="xref py py-meth docutils literal"><span class="pre">centrality_betweenness()</span></tt></a></li>
</ul>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="borgatti95" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[Borgatti95]</a></td><td>Stephen P. Borgatti. (1995). Centrality and AIDS.
[Online] Available:
<a class="reference external" href="http://www.analytictech.com/networks/centaids.htm">http://www.analytictech.com/networks/centaids.htm</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="olj14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[OLJ14]</a></td><td>Paul W. Olsen, Alan G. Labouseur, Jeong-Hyon Hwang.
Efficient Top-k Closeness Centrality Search
Proceedings of the IEEE 30th International Conference on Data
Engineering (ICDE), 2014</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<p>Standard examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">ChvatalGraph</span><span class="p">())</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">()</span>
<span class="go">{0: 0.61111111111111..., 1: 0.61111111111111..., 2: 0.61111111111111..., 3: 0.61111111111111..., 4: 0.61111111111111..., 5: 0.61111111111111..., 6: 0.61111111111111..., 7: 0.61111111111111..., 8: 0.61111111111111..., 9: 0.61111111111111..., 10: 0.61111111111111..., 11: 0.61111111111111...}</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">(</span><span class="n">vert</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">{0: 1.0, 1: 0.3333333333333333}</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">()</span>
<span class="go">{0: 1.0, 1: 1.0, 2: 0.75, 3: 0.75}</span>
</pre></div>
</div>
<p>In a (strongly) connected (di)graph, the closeness centrality of <span class="math">\(v\)</span>
is inverse of the average distance between <span class="math">\(v\)</span> and all other vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0.4</span>
<span class="gp">sage: </span><span class="n">dist</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
<span class="go">0.4</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0.4</span>
<span class="gp">sage: </span><span class="n">dist</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
<span class="go">0.4</span>
</pre></div>
</div>
<p>If a vertex has (out)degree 0, its closeness centrality is not defined:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">g</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
<p>Weighted graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">weight_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="mi">10</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>                          <span class="c"># tol abs 1e-12</span>
<span class="go">{(0, 0): 0.75, (0, 1): 0.75}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">centrality_closeness</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight_function</span><span class="p">)</span> <span class="c"># tol abs 1e-12</span>
<span class="go">0.075</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The result does not depend on the algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>                           <span class="c"># long time</span>
<span class="go">....:     n = random.randint(2,20)</span>
<span class="go">....:     m = random.randint(0, n*(n-1)/2)</span>
<span class="go">....:     g = graphs.RandomGNM(n,m)</span>
<span class="go">....:     c1 = g.centrality_closeness(algorithm=&#39;BFS&#39;)</span>
<span class="go">....:     c2 = g.centrality_closeness(algorithm=&#39;NetworkX&#39;)</span>
<span class="go">....:     c3 = g.centrality_closeness(algorithm=&#39;Dijkstra_Boost&#39;)</span>
<span class="go">....:     c4 = g.centrality_closeness(algorithm=&#39;Floyd-Warshall-Cython&#39;)</span>
<span class="go">....:     c5 = g.centrality_closeness(algorithm=&#39;Floyd-Warshall-Python&#39;)</span>
<span class="go">....:     c6 = g.centrality_closeness(algorithm=&#39;Johnson_Boost&#39;)</span>
<span class="go">....:     assert(len(c1)==len(c2)==len(c3)==len(c4)==len(c5)==len(c6))</span>
<span class="go">....:     c = [c1,c2,c3,c4,c5,c6]</span>
<span class="go">....:     for (ci,cj) in itertools.combinations(c, 2):</span>
<span class="go">....:         assert(sum([abs(ci[v] - cj[v]) for v in g.vertices() if g.degree(v) != 0]) &lt; 1e-12)</span>
</pre></div>
</div>
<p>Directed graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>                           <span class="c"># long time</span>
<span class="go">....:     n = random.randint(2,20)</span>
<span class="go">....:     m = random.randint(0, n*(n-1)/2)</span>
<span class="go">....:     g = digraphs.RandomDirectedGNM(n,m)</span>
<span class="go">....:     c1 = g.centrality_closeness(algorithm=&#39;BFS&#39;)</span>
<span class="go">....:     c2 = g.centrality_closeness(algorithm=&#39;NetworkX&#39;)</span>
<span class="go">....:     c3 = g.centrality_closeness(algorithm=&#39;Dijkstra_Boost&#39;)</span>
<span class="go">....:     c4 = g.centrality_closeness(algorithm=&#39;Floyd-Warshall-Cython&#39;)</span>
<span class="go">....:     c5 = g.centrality_closeness(algorithm=&#39;Floyd-Warshall-Python&#39;)</span>
<span class="go">....:     c6 = g.centrality_closeness(algorithm=&#39;Johnson_Boost&#39;)</span>
<span class="go">....:     assert(len(c1)==len(c2)==len(c3)==len(c4)==len(c5)==len(c6))</span>
<span class="go">....:     c = [c1,c2,c3,c4,c5,c6]</span>
<span class="go">....:     for (ci,cj) in itertools.combinations(c, 2):</span>
<span class="go">....:         assert(sum([abs(ci[v] - cj[v]) for v in g.vertices() if g.out_degree(v) != 0]) &lt; 1e-12)</span>
</pre></div>
</div>
<p>Weighted graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>                           <span class="c"># long time</span>
<span class="go">....:     n = random.randint(2,20)</span>
<span class="go">....:     m = random.randint(0, n*(n-1)/2)</span>
<span class="go">....:     g = graphs.RandomGNM(n,m)</span>
<span class="go">....:     for v,w in g.edges(labels=False):</span>
<span class="go">....:         g.set_edge_label(v,w,float(random.uniform(1,100)))</span>
<span class="go">....:     c1 = g.centrality_closeness(by_weight=True, algorithm=&#39;NetworkX&#39;)</span>
<span class="go">....:     c2 = g.centrality_closeness(by_weight=True, algorithm=&#39;Dijkstra_Boost&#39;)</span>
<span class="go">....:     c3 = g.centrality_closeness(by_weight=True, algorithm=&#39;Floyd-Warshall-Python&#39;)</span>
<span class="go">....:     c4 = g.centrality_closeness(by_weight=True, algorithm=&#39;Johnson_Boost&#39;)</span>
<span class="go">....:     assert(len(c1)==len(c2)==len(c3)==len(c4))</span>
<span class="go">....:     c = [c1,c2,c3,c4]</span>
<span class="go">....:     for (ci,cj) in itertools.combinations(c, 2):</span>
<span class="go">....:         assert(sum([abs(ci[v] - cj[v]) for v in g.vertices() if g.degree(v) != 0]) &lt; 1e-12)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.characteristic_polynomial">
<tt class="descname">characteristic_polynomial</tt><big>(</big><em>var='x'</em>, <em>laplacian=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.characteristic_polynomial" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the characteristic polynomial of the adjacency matrix of
the (di)graph.</p>
<p>Let <span class="math">\(G\)</span> be a (simple) graph with adjacency matrix <span class="math">\(A\)</span>. Let <span class="math">\(I\)</span> be the
identity matrix of dimensions the same as <span class="math">\(A\)</span>. The characteristic
polynomial of <span class="math">\(G\)</span> is defined as the determinant <span class="math">\(\det(xI - A)\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">characteristic_polynomial</span></tt> and <tt class="docutils literal"><span class="pre">charpoly</span></tt> are aliases and
thus provide exactly the same method.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">'x'</span></tt>) the variable of the characteristic
polynomial.</li>
<li><tt class="docutils literal"><span class="pre">laplacian</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) if <tt class="docutils literal"><span class="pre">True</span></tt>, use the
Laplacian matrix.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix" title="sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">kirchhoff_matrix()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.laplacian_matrix" title="sage.graphs.generic_graph.GenericGraph.laplacian_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">laplacian_matrix()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span>
<span class="go">x^10 - 15*x^8 + 75*x^6 - 24*x^5 - 165*x^4 + 120*x^3 + 120*x^2 - 160*x + 48</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^10 - 15*x^8 + 75*x^6 - 24*x^5 - 165*x^4 + 120*x^3 + 120*x^2 - 160*x + 48</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">(</span><span class="n">laplacian</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">x^10 - 30*x^9 + 390*x^8 - 2880*x^7 + 13305*x^6 -</span>
<span class="go">39882*x^5 + 77640*x^4 - 94800*x^3 + 66000*x^2 - 20000*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.charpoly">
<tt class="descname">charpoly</tt><big>(</big><em>var='x'</em>, <em>laplacian=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.charpoly" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the characteristic polynomial of the adjacency matrix of
the (di)graph.</p>
<p>Let <span class="math">\(G\)</span> be a (simple) graph with adjacency matrix <span class="math">\(A\)</span>. Let <span class="math">\(I\)</span> be the
identity matrix of dimensions the same as <span class="math">\(A\)</span>. The characteristic
polynomial of <span class="math">\(G\)</span> is defined as the determinant <span class="math">\(\det(xI - A)\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">characteristic_polynomial</span></tt> and <tt class="docutils literal"><span class="pre">charpoly</span></tt> are aliases and
thus provide exactly the same method.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">'x'</span></tt>) the variable of the characteristic
polynomial.</li>
<li><tt class="docutils literal"><span class="pre">laplacian</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) if <tt class="docutils literal"><span class="pre">True</span></tt>, use the
Laplacian matrix.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix" title="sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">kirchhoff_matrix()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.laplacian_matrix" title="sage.graphs.generic_graph.GenericGraph.laplacian_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">laplacian_matrix()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span>
<span class="go">x^10 - 15*x^8 + 75*x^6 - 24*x^5 - 165*x^4 + 120*x^3 + 120*x^2 - 160*x + 48</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^10 - 15*x^8 + 75*x^6 - 24*x^5 - 165*x^4 + 120*x^3 + 120*x^2 - 160*x + 48</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">(</span><span class="n">laplacian</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">x^10 - 30*x^9 + 390*x^8 - 2880*x^7 + 13305*x^6 -</span>
<span class="go">39882*x^5 + 77640*x^4 - 94800*x^3 + 66000*x^2 - 20000*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.clear" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Empties the graph of vertices and edges and removes name, associated
objects, and position information.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="n">G</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;vertex0&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">();</span> <span class="n">G</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">4</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">_pos</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="go">&#39;Cycle graph&#39;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;vertex0&#39;</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;c_graph&#39;</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">order</span><span class="p">();</span> <span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">0</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">_pos</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;c_graph&#39;</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">order</span><span class="p">();</span> <span class="n">H</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">0</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">_pos</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.cluster_transitivity">
<tt class="descname">cluster_transitivity</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.cluster_transitivity" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the transitivity (fraction of transitive triangles) of the
graph.</p>
<p>Transitivity is the fraction of all existing triangles and all
connected triples (triads), <span class="math">\(T = 3\times\text{triangles}
/ \text{triads}\)</span>.</p>
<p>See also section &#8220;Clustering&#8221; in chapter &#8220;Algorithms&#8221; of <a class="reference internal" href="#hssnx" id="id5">[HSSNX]</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">cluster_transitivity</span><span class="p">()</span>
<span class="go">0.25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.cluster_triangles">
<tt class="descname">cluster_triangles</tt><big>(</big><em>nbunch=None</em>, <em>with_labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.cluster_triangles" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of triangles for the set <span class="math">\(nbunch\)</span> of vertices
as a dictionary keyed by vertex.</p>
<p>See also section &#8220;Clustering&#8221; in chapter &#8220;Algorithms&#8221; of <a class="reference internal" href="#hssnx" id="id6">[HSSNX]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">nbunch</span></tt> - The vertices to inspect. If <tt class="docutils literal"><span class="pre">nbunch=None</span></tt>,
returns data for all vertices in the graph.</li>
</ul>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="hssnx" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[HSSNX]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id6">2</a>, <a class="fn-backref" href="#id7">3</a>, <a class="fn-backref" href="#id8">4</a>)</em> Aric Hagberg, Dan Schult and Pieter Swart. NetworkX
documentation. [Online] Available:
<a class="reference external" href="http://networkx.github.io/documentation/latest/reference/index.html">http://networkx.github.io/documentation/latest/reference/index.html</a></td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">cluster_triangles</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">cluster_triangles</span><span class="p">()</span>
<span class="go">{0: 1, 1: 1, 2: 0, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 0, 9: 1, 10: 1, 11: 0}</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">cluster_triangles</span><span class="p">(</span><span class="n">nbunch</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">{0: 1, 1: 1, 2: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.clustering_average">
<tt class="descname">clustering_average</tt><big>(</big><em>implementation=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.clustering_average" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the average clustering coefficient.</p>
<p>The clustering coefficient of a node <span class="math">\(i\)</span> is the fraction
of existing triangles containing node <span class="math">\(i\)</span> and all
possible triangles containing <span class="math">\(i\)</span>: <span class="math">\(c_i = T(i) / \binom {k_i} 2\)</span>
where <span class="math">\(T(i)\)</span> is the number of existing triangles through <span class="math">\(i\)</span>, and
<span class="math">\(k_i\)</span> is the degree of vertex <span class="math">\(i\)</span>.</p>
<p>A coefficient for the whole graph is the average of the <span class="math">\(c_i\)</span>.</p>
<p>See also section &#8220;Clustering&#8221; in chapter &#8220;Algorithms&#8221; of <a class="reference internal" href="#hssnx" id="id7">[HSSNX]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">implementation</span></tt> - one of <tt class="docutils literal"><span class="pre">'boost'</span></tt>, <tt class="docutils literal"><span class="pre">'sparse_copy'</span></tt>,
<tt class="docutils literal"><span class="pre">'dense_copy'</span></tt>, <tt class="docutils literal"><span class="pre">'networkx'</span></tt> or <tt class="docutils literal"><span class="pre">None</span></tt> (default). In the latter
case, the best algorithm available is used. Note that only
<tt class="docutils literal"><span class="pre">'networkx'</span></tt> supports directed graphs.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">clustering_average</span><span class="p">()</span>
<span class="go">1/4</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">clustering_average</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;networkx&#39;</span><span class="p">)</span>
<span class="go">0.25</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Boost does not work with DiGraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">clustering_average</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;boost&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This value of &#39;implementation&#39; is invalid for directed graphs</span>
</pre></div>
</div>
<p>The result is the same with all implementations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNM</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">clustering_average</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="n">impl</span><span class="p">)</span>
<span class="go">....:           for impl in [&#39;boost&#39;,&#39;sparse_copy&#39;,&#39;dense_copy&#39;,&#39;networkx&#39;]]</span>
<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="c"># tol abs 1e-12</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.clustering_coeff">
<tt class="descname">clustering_coeff</tt><big>(</big><em>nodes=None</em>, <em>weight=False</em>, <em>implementation=None</em>, <em>return_vertex_weights=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.clustering_coeff" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the clustering coefficient for each vertex in <tt class="docutils literal"><span class="pre">nodes</span></tt> as
a dictionary keyed by vertex.</p>
<p>For an unweighted graph, the clustering coefficient of a node <span class="math">\(i\)</span>
is the fraction of existing triangles containing node <span class="math">\(i\)</span> and all
possible triangles containing <span class="math">\(i\)</span>: <span class="math">\(c_i = T(i) / \binom {k_i} 2\)</span>
where <span class="math">\(T(i)\)</span> is the number of existing triangles through <span class="math">\(i\)</span>, and
<span class="math">\(k_i\)</span> is the degree of vertex <span class="math">\(i\)</span>.</p>
<p>For weighted graphs the clustering is defined as the geometric
average of the subgraph edge weights, normalized by the
maximum weight in the network.</p>
<p>The value of <span class="math">\(c_i\)</span> is assigned <span class="math">\(0\)</span> if <span class="math">\(k_i &lt; 2\)</span>.</p>
<p>See also section &#8220;Clustering&#8221; in chapter &#8220;Algorithms&#8221; of <a class="reference internal" href="#hssnx" id="id8">[HSSNX]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">nodes</span></tt> - the vertices to inspect (default <tt class="docutils literal"><span class="pre">None</span></tt>, returns data
on all vertices in graph)</li>
<li><tt class="docutils literal"><span class="pre">weight</span></tt> - string or boolean (default is <tt class="docutils literal"><span class="pre">False</span></tt>). If it is
a string it used the indicated edge property as weight.
<tt class="docutils literal"><span class="pre">weight</span> <span class="pre">=</span> <span class="pre">True</span></tt> is equivalent to <tt class="docutils literal"><span class="pre">weight</span> <span class="pre">=</span> <span class="pre">'weight'</span></tt></li>
<li><tt class="docutils literal"><span class="pre">implementation</span></tt> - one of <tt class="docutils literal"><span class="pre">'boost'</span></tt>, <tt class="docutils literal"><span class="pre">'sparse_copy'</span></tt>,
<tt class="docutils literal"><span class="pre">'dense_copy'</span></tt>, <tt class="docutils literal"><span class="pre">'networkx'</span></tt> or <tt class="docutils literal"><span class="pre">None</span></tt> (default). In the latter
case, the best algorithm available is used. Note that only
<tt class="docutils literal"><span class="pre">'networkx'</span></tt> supports directed or weighted graphs, and that
<tt class="docutils literal"><span class="pre">'sparse_copy'</span></tt> and <tt class="docutils literal"><span class="pre">'dense_copy'</span></tt> do not support <tt class="docutils literal"><span class="pre">node</span></tt>
different from <tt class="docutils literal"><span class="pre">None</span></tt></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">()</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">()</span>
<span class="go">{0: 1/3, 1: 1/3, 2: 0, 3: 1/3, 4: 1/3, 5: 1/3,</span>
<span class="go"> 6: 1/3, 7: 1/3, 8: 0, 9: 1/3, 10: 1/3, 11: 0}</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 0.3333333333333333, 1: 0.3333333333333333, 2: 0.0,</span>
<span class="go">3: 0.3333333333333333, 4: 0.3333333333333333,</span>
<span class="go">5: 0.3333333333333333, 6: 0.3333333333333333,</span>
<span class="go">7: 0.3333333333333333, 8: 0.0, 9: 0.3333333333333333,</span>
<span class="go">10: 0.3333333333333333, 11: 0.0}</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">{0: 0.3333333333333333, 1: 0.3333333333333333, 2: 0.0}</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">())</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 0.3333333333333333, 1: 0.3333333333333333, 2: 0.0}</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]))</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">{(0, 0): 0.0, (0, 1): 0.0, (2, 2): 0.0}</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that the option &#8216;return_vertex_weights&#8217; is deprecated:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">()</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_vertex_weights</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: The option &#39;return_vertex_weights&#39;</span>
<span class="go">has been deprecated and is ignored.</span>
<span class="go">See http://trac.sagemath.org/17134 for details.</span>
<span class="go">{0: 0.3333333333333333, 1: 0.3333333333333333, 2: 0.0}</span>
</pre></div>
</div>
<p>Boost does not work with weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">FruchtGraph</span><span class="p">()</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;boost&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This value of &#39;implementation&#39; is invalid for directed/weighted graphs</span>
</pre></div>
</div>
<p>Boost does not work with DiGraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;boost&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This value of &#39;implementation&#39; is invalid for directed/weighted graphs</span>
</pre></div>
</div>
<p>Check that the result is the same with all implementations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNM</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s">&quot;abcdefghik&quot;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">clustering_coeff</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="n">impl</span><span class="p">)</span>
<span class="go">....:           for impl in [&#39;boost&#39;,&#39;sparse_copy&#39;,&#39;dense_copy&#39;,&#39;networkx&#39;]]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
<span class="go">....:     coeffs_v = [c[v] for c in coeffs]</span>
<span class="go">....:     if max(coeffs_v) - min(coeffs_v) &gt; 1E-12:</span>
<span class="go">....:         print &quot;Error for v=&quot;,v</span>
<span class="go">....:         print &quot;min=&quot;,min(coeffs_v),&quot;max=&quot;,max(coeffs_v)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.coarsest_equitable_refinement">
<tt class="descname">coarsest_equitable_refinement</tt><big>(</big><em>partition</em>, <em>sparse=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.coarsest_equitable_refinement" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the coarsest partition which is finer than the input
partition, and equitable with respect to self.</p>
<p>A partition is equitable with respect to a graph if for every pair
of cells C1, C2 of the partition, the number of edges from a vertex
of C1 to C2 is the same, over all vertices in C1.</p>
<p>A partition P1 is finer than P2 (P2 is coarser than P1) if every
cell of P1 is a subset of a cell of P2.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">partition</span></tt> - a list of lists</li>
<li><tt class="docutils literal"><span class="pre">sparse</span></tt> - (default False) whether to use sparse
or dense representation- for small graphs, use dense for speed</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">coarsest_equitable_refinement</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)])</span>
<span class="go">[[0], [2, 3, 6, 7, 8, 9], [1, 4, 5]]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">verts</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Pi</span> <span class="o">=</span> <span class="p">[</span><span class="n">verts</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">verts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
<span class="gp">sage: </span><span class="n">Pi</span>
<span class="go">[[&#39;000&#39;], [&#39;001&#39;, &#39;010&#39;, &#39;011&#39;, &#39;100&#39;, &#39;101&#39;, &#39;110&#39;, &#39;111&#39;]]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">coarsest_equitable_refinement</span><span class="p">(</span><span class="n">Pi</span><span class="p">)</span>
<span class="go">[[&#39;000&#39;], [&#39;011&#39;, &#39;101&#39;, &#39;110&#39;], [&#39;111&#39;], [&#39;001&#39;, &#39;010&#39;, &#39;100&#39;]]</span>
</pre></div>
</div>
<p>Note that given an equitable partition, this function returns that
partition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">prt</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">coarsest_equitable_refinement</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
<span class="go">[[0], [1, 4, 5], [2, 3, 6, 7, 8, 9]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">WheelGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prt</span> <span class="o">=</span> <span class="p">[[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]]</span>
<span class="gp">sage: </span><span class="n">ss</span><span class="o">.</span><span class="n">coarsest_equitable_refinement</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Partition ([[(0, 1)], [(0, 2), (0, 3), (0, 4), (1, 2), (1, 4)], [(2, 3), (3, 4)]]) is not valid for this graph: vertices are incorrect.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">WheelGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ss</span><span class="o">.</span><span class="n">coarsest_equitable_refinement</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
<span class="go">[[(0, 1)], [(1, 2), (1, 4)], [(0, 3)], [(0, 2), (0, 4)], [(2, 3), (3, 4)]]</span>
</pre></div>
</div>
<p>ALGORITHM: Brendan D. McKay&#8217;s Master&#8217;s Thesis, University of
Melbourne, 1976.</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.complement">
<tt class="descname">complement</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.complement" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the complement of the (di)graph.</p>
<p>The complement of a graph has the same vertices, but exactly those
edges that are not in the original graph. This is not well defined
for graphs with multiple edges.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 26 graphics primitives</span>
<span class="gp">sage: </span><span class="n">PC</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">PC</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 41 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 2, None), (1, 3, None)]</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span>
<span class="go">complement(Cycle graph): Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This method is not known to work on graphs with</span>
<span class="go">multiedges. Perhaps this method can be updated to handle them, but</span>
<span class="go">in the meantime if you want to use it please disallow multiedges</span>
<span class="go">using allow_multiple_edges().</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We check that <a class="reference external" href="http://trac.sagemath.org/15699">trac ticket #15699</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span>
<span class="go">complement(Path graph): Graph on 5 vertices</span>
</pre></div>
</div>
<p>The name is not updated when there was none in the first place:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">());</span> <span class="n">g</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span>
<span class="go">Graph on 10 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.connected_component_containing_vertex">
<tt class="descname">connected_component_containing_vertex</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.connected_component_containing_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of the vertices connected to vertex.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">connected_component_containing_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">connected_component_containing_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.connected_components">
<tt class="descname">connected_components</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.connected_components" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the list of connected components.</p>
<p>Returns a list of lists of vertices, each list representing a
connected component. The list is ordered from largest to smallest
component.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">connected_components</span><span class="p">()</span>
<span class="go">[[0, 1, 2, 3], [4, 5, 6]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">connected_components</span><span class="p">()</span>
<span class="go">[[0, 1, 2, 3], [4, 5, 6]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.connected_components_number">
<tt class="descname">connected_components_number</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.connected_components_number" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of connected components.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">connected_components_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">connected_components_number</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.connected_components_sizes">
<tt class="descname">connected_components_sizes</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.connected_components_sizes" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the sizes of the connected components as a list.</p>
<p>The list is sorted from largest to lower values.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">graphs</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>    <span class="k">print</span> <span class="n">x</span><span class="o">.</span><span class="n">connected_components_sizes</span><span class="p">()</span>
<span class="go">[1, 1, 1]</span>
<span class="go">[2, 1]</span>
<span class="go">[3]</span>
<span class="go">[3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.connected_components_subgraphs">
<tt class="descname">connected_components_subgraphs</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.connected_components_subgraphs" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of connected components as graph objects.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">connected_components_subgraphs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">graphs_list</span><span class="o">.</span><span class="n">show_graphs</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">connected_components_subgraphs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">graphs_list</span><span class="o">.</span><span class="n">show_graphs</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.copy">
<tt class="descname">copy</tt><big>(</big><em>weighted=None</em>, <em>implementation='c_graph'</em>, <em>data_structure=None</em>, <em>sparse=None</em>, <em>immutable=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.copy" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Change the graph implementation</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">weighted</span></tt> boolean (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; weightedness for
the copy. Might change the equality class if not <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">sparse</span></tt> (boolean) &#8211; <tt class="docutils literal"><span class="pre">sparse=True</span></tt> is an alias for
<tt class="docutils literal"><span class="pre">data_structure=&quot;sparse&quot;</span></tt>, and <tt class="docutils literal"><span class="pre">sparse=False</span></tt> is an alias for
<tt class="docutils literal"><span class="pre">data_structure=&quot;dense&quot;</span></tt>. Only used when
<tt class="docutils literal"><span class="pre">implementation='c_graph'</span></tt> and <tt class="docutils literal"><span class="pre">data_structure=None</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">data_structure</span></tt> &#8211; one of <tt class="docutils literal"><span class="pre">&quot;sparse&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;static_sparse&quot;</span></tt>, or
<tt class="docutils literal"><span class="pre">&quot;dense&quot;</span></tt>. See the documentation of <a class="reference internal" href="graph.html#sage.graphs.graph.Graph" title="sage.graphs.graph.Graph"><tt class="xref py py-class docutils literal"><span class="pre">Graph</span></tt></a> or
<a class="reference internal" href="digraph.html#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><tt class="xref py py-class docutils literal"><span class="pre">DiGraph</span></tt></a>. Only used when <tt class="docutils literal"><span class="pre">implementation='c_graph'</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">immutable</span></tt> (boolean) &#8211; whether to create a mutable/immutable
copy. Only used when <tt class="docutils literal"><span class="pre">implementation='c_graph'</span></tt> and
<tt class="docutils literal"><span class="pre">data_structure=None</span></tt>.<ul>
<li><tt class="docutils literal"><span class="pre">immutable=None</span></tt> (default) means that the graph and its copy will
behave the same way.</li>
<li><tt class="docutils literal"><span class="pre">immutable=True</span></tt> is a shortcut for
<tt class="docutils literal"><span class="pre">data_structure='static_sparse'</span></tt> and <tt class="docutils literal"><span class="pre">implementation='c_graph'</span></tt></li>
<li><tt class="docutils literal"><span class="pre">immutable=False</span></tt> sets <tt class="docutils literal"><span class="pre">implementation</span></tt> to <tt class="docutils literal"><span class="pre">'c_graph'</span></tt>. When
<tt class="docutils literal"><span class="pre">immutable=False</span></tt> is used to copy an immutable graph, the data
structure used is <tt class="docutils literal"><span class="pre">&quot;sparse&quot;</span></tt> unless anything else is specified.</li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the graph uses
<a class="reference internal" href="base/static_sparse_backend.html#sage.graphs.base.static_sparse_backend.StaticSparseBackend" title="sage.graphs.base.static_sparse_backend.StaticSparseBackend"><tt class="xref py py-class docutils literal"><span class="pre">StaticSparseBackend</span></tt></a>
and the <tt class="docutils literal"><span class="pre">_immutable</span></tt> flag, then <tt class="docutils literal"><span class="pre">self</span></tt> is returned rather than a
copy (unless one of the optional arguments is used).</p>
</div>
<p>OUTPUT:</p>
<p>A Graph object.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please use this method only if you need to copy but change the
underlying implementation or weightedness.  Otherwise simply
do <tt class="docutils literal"><span class="pre">copy(g)</span></tt> instead of <tt class="docutils literal"><span class="pre">g.copy()</span></tt>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If <tt class="docutils literal"><span class="pre">weighted</span></tt> is passed and is not the weightedness of the
original, then the copy will not equal the original.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]},</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">==</span><span class="n">copy</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]},</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">==</span><span class="n">copy</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that vertex associations are also kept:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">(),</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">FlowerSnark</span><span class="p">(),</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">MoebiusKantorGraph</span><span class="p">(),</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span> <span class="p">}</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T2</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Dodecahedron: Graph on 20 vertices</span>
</pre></div>
</div>
<p>Notice that the copy is at least as deep as the objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T2</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="n">T</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Examples of the keywords in use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;c_graph&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">==</span> <span class="n">G</span><span class="p">;</span> <span class="n">H</span> <span class="ow">is</span> <span class="n">G</span>
<span class="go">True</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G1</span><span class="o">==</span><span class="n">G</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G1</span> <span class="ow">is</span> <span class="n">G</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="ow">is</span> <span class="n">G</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Argument <tt class="docutils literal"><span class="pre">weighted</span></tt> affects the equality class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">weighted</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H2</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(),</span> <span class="n">H1</span><span class="o">.</span><span class="n">weighted</span><span class="p">(),</span> <span class="n">H2</span><span class="o">.</span><span class="n">weighted</span><span class="p">()]</span>
<span class="go">[False, False, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">G</span> <span class="o">==</span> <span class="n">H1</span><span class="p">,</span> <span class="n">G</span> <span class="o">==</span> <span class="n">H2</span><span class="p">,</span> <span class="n">H1</span> <span class="o">==</span> <span class="n">H2</span><span class="p">]</span>
<span class="go">[True, False, False]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">G</span> <span class="o">==</span> <span class="n">H1</span><span class="p">,</span> <span class="n">G</span> <span class="o">==</span> <span class="n">H2</span><span class="p">,</span> <span class="n">H1</span> <span class="o">==</span> <span class="n">H2</span><span class="p">]</span>
<span class="go">[False, True, False]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We make copies of the <tt class="docutils literal"><span class="pre">_pos</span></tt> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">_pos</span> <span class="ow">is</span> <span class="n">g</span><span class="o">.</span><span class="n">_pos</span>
<span class="go">False</span>
</pre></div>
</div>
<p>We make sure that one can make immutable copies by providing the
<tt class="docutils literal"><span class="pre">data_structure</span></tt> optional argument, and that copying an immutable graph
returns the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">hash</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">This graph is mutable, and thus not hashable. Create an</span>
<span class="go">immutable copy by `g.copy(immutable=True)`</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">hash</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">1833517720</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">==</span><span class="n">G</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">g</span> <span class="ow">is</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">g</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">copy</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">immutable=True</span></tt> is a short-cut for <tt class="docutils literal"><span class="pre">data_structure='static_sparse'</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="ow">is</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data_structure</span><span class="o">=</span><span class="s">&#39;static_sparse&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If a graph pretends to be immutable, but does not use the static sparse
backend, then the copy is not identic with the graph, even though it is
considered to be hashable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Poset</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]),</span> <span class="n">linear_extension</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">facade</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">hasse_diagram</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">_immutable</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">sage: </span><span class="nb">hash</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>   <span class="c"># random</span>
<span class="go">-1843552882</span>
<span class="gp">sage: </span><span class="n">copy</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="ow">is</span> <span class="n">H</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Bad input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;sparse&quot;</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You cannot define &#39;immutable&#39; or &#39;sparse&#39; when &#39;data_structure&#39; has a value.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;sparse&quot;</span><span class="p">,</span> <span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You cannot define &#39;immutable&#39; or &#39;sparse&#39; when &#39;data_structure&#39; has a value.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">There is no dense immutable backend at the moment.</span>
</pre></div>
</div>
<p>Which backend?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;sparse&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.sparse_graph.SparseGraphBackend&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;dense&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.dense_graph.DenseGraphBackend&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;static_sparse&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.static_sparse_backend.StaticSparseBackend&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.static_sparse_backend.StaticSparseBackend&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.static_sparse_backend.StaticSparseBackend&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.sparse_graph.SparseGraphBackend&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.sparse_graph.SparseGraphBackend&#39;&gt;</span>
</pre></div>
</div>
<p>Fake immutable graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">_immutable</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.sparse_graph.SparseGraphBackend&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.cycle_basis">
<tt class="descname">cycle_basis</tt><big>(</big><em>output='vertex'</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.cycle_basis" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of cycles which form a basis of the cycle space
of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>A basis of cycles of a graph is a minimal collection of cycles
(considered as sets of edges) such that the edge set of any
cycle in the graph can be written as a <span class="math">\(Z/2Z\)</span> sum of the
cycles in the basis.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">output</span></tt> (<tt class="docutils literal"><span class="pre">'vertex'</span></tt> (default) or <tt class="docutils literal"><span class="pre">'edge'</span></tt>) &#8211; whether
every cycle is given as a list of vertices or a list of
edges.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of lists, each of them representing the vertices (or
the edges) of a cycle in a basis.</p>
<p>ALGORITHM:</p>
<p>Uses the NetworkX library for graphs without multiple edges.</p>
<p>Otherwise, by the standard algorithm using a spanning tree.</p>
<p>EXAMPLE:</p>
<p>A cycle basis in Petersen&#8217;s Graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">()</span>
<span class="go">[[1, 2, 7, 5, 0], [8, 3, 2, 7, 5], [4, 3, 2, 7, 5, 0], [4, 9, 7, 5, 0], [8, 6, 9, 7, 5], [1, 6, 9, 7, 5, 0]]</span>
</pre></div>
</div>
<p>One can also get the result as a list of lists of edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s">&#39;edge&#39;</span><span class="p">)</span>
<span class="go">[[(1, 2, None), (2, 7, None), (7, 5, None), (5, 0, None),</span>
<span class="go">(0, 1, None)], [(8, 3, None), (3, 2, None), (2, 7, None),</span>
<span class="go">(7, 5, None), (5, 8, None)], [(4, 3, None), (3, 2, None),</span>
<span class="go">(2, 7, None), (7, 5, None), (5, 0, None), (0, 4, None)],</span>
<span class="go">[(4, 9, None), (9, 7, None), (7, 5, None), (5, 0, None),</span>
<span class="go">(0, 4, None)], [(8, 6, None), (6, 9, None), (9, 7, None),</span>
<span class="go">(7, 5, None), (5, 8, None)], [(1, 6, None), (6, 9, None),</span>
<span class="go">(9, 7, None), (7, 5, None), (5, 0, None), (0, 1, None)]]</span>
</pre></div>
</div>
<p>Checking the given cycles are algebraically free:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="o">.</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">basis</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">()</span>
</pre></div>
</div>
<p>Building the space of (directed) edges over <span class="math">\(Z/2Z\)</span>. On the way,
building a dictionary associating an unique vector to each
undirected edge:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">edge_space</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">m</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">edge_vector</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">),</span> <span class="n">edge_space</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">),</span><span class="n">vec</span> <span class="ow">in</span> <span class="n">edge_vector</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>     <span class="n">edge_vector</span><span class="p">[(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">)]</span> <span class="o">=</span> <span class="n">vec</span>
</pre></div>
</div>
<p>Defining a lambda function associating a vector to the
vertices of a cycle:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">vertices_to_edges</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">cycle_to_vector</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">sum</span><span class="p">(</span> <span class="n">edge_vector</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">vertices_to_edges</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>Finally checking the cycles are a free set:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">basis_as_vectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cycle_to_vector</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">basis</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">edge_space</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">basis_as_vectors</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For undirected graphs with multiple edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">()</span>
<span class="go">[[0, 2], [2, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s">&#39;edge&#39;</span><span class="p">)</span>
<span class="go">[[(0, 2, &#39;a&#39;), (2, 0, &#39;b&#39;)], [(2, 1, &#39;d&#39;), (1, 0, &#39;c&#39;),</span>
<span class="go">(0, 2, &#39;a&#39;)]]</span>
</pre></div>
</div>
<p>Disconnected graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_cycle</span><span class="p">([</span><span class="s">&quot;Hey&quot;</span><span class="p">,</span> <span class="s">&quot;Wuuhuu&quot;</span><span class="p">,</span> <span class="s">&quot;Really ?&quot;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">()</span>
<span class="go">[[0, 2], [2, 1, 0], [&#39;Really ?&#39;, &#39;Hey&#39;, &#39;Wuuhuu&#39;]]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s">&#39;edge&#39;</span><span class="p">)</span>
<span class="go">[[(0, 2, &#39;a&#39;), (2, 0, &#39;b&#39;)], [(2, 1, &#39;d&#39;), (1, 0, &#39;c&#39;), (0, 2, &#39;a&#39;)],</span>
<span class="go">[(&#39;Really ?&#39;, &#39;Hey&#39;, None), (&#39;Hey&#39;, &#39;Wuuhuu&#39;, None), (&#39;Wuuhuu&#39;, &#39;Really ?&#39;, None)]]</span>
</pre></div>
</div>
<p>Graph that allows multiple edges but does not contain any:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">()</span>
<span class="go">[[2, 1, 0]]</span>
</pre></div>
</div>
<p>Not yet implemented for directed graphs with multiple edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cycle_basis</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">not implemented for directed graphs</span>
<span class="go">with multiple edges</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.degree">
<tt class="descname">degree</tt><big>(</big><em>vertices=None</em>, <em>labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.degree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Gives the degree (in + out for digraphs) of a vertex or of
vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - If vertices is a single vertex,
returns the number of neighbors of vertex. If vertices is an
iterable container of vertices, returns a list of degrees. If
vertices is None, same as listing all vertices.</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> - see OUTPUT</li>
</ul>
<p>OUTPUT: Single vertex- an integer. Multiple vertices- a list of
integers. If labels is True, then returns a dictionary mapping each
vertex to its degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">[8, 8, 8, 8, 8, 8, 8, 8, 8]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 5, 1: 4, 2: 3}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">[5, 4, 3, 3, 3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.degree_histogram">
<tt class="descname">degree_histogram</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.degree_histogram" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list, whose ith entry is the frequency of degree i.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">degree_histogram</span><span class="p">()</span>
<span class="go">[0, 0, 4, 34, 70]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">degree_histogram</span><span class="p">()</span>
<span class="go">[0, 0, 0, 0, 4, 0, 34, 0, 70]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.degree_iterator">
<tt class="descname">degree_iterator</tt><big>(</big><em>vertices=None</em>, <em>labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.degree_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns an iterator over the degrees of the (di)graph.</p>
<p>In the case of a digraph, the degree is defined as the sum of the
in-degree and the out-degree, i.e. the total number of edges incident to
a given vertex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">labels</span></tt> (boolean) &#8211; if set to <tt class="docutils literal"><span class="pre">False</span></tt> (default) the method
returns an iterator over degrees. Otherwise it returns an iterator
over tuples (vertex, degree).</li>
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - if specified, restrict to this
subset.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree_iterator</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">3</span>
<span class="go">4</span>
<span class="go">2</span>
<span class="gp">...</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">((0, 1), 3)</span>
<span class="go">((1, 2), 4)</span>
<span class="go">((0, 0), 2)</span>
<span class="gp">...</span>
<span class="go">((0, 3), 2)</span>
<span class="go">((0, 2), 3)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">degree_iterator</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">6</span>
<span class="go">6</span>
<span class="gp">...</span>
<span class="go">4</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">degree_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">((0, 1), 6)</span>
<span class="go">((1, 2), 6)</span>
<span class="gp">...</span>
<span class="go">((1, 0), 4)</span>
<span class="go">((0, 2), 6)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.degree_sequence">
<tt class="descname">degree_sequence</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.degree_sequence" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the degree sequence of this (di)graph.</p>
<p>EXAMPLES:</p>
<p>The degree sequence of an undirected graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">degree_sequence</span><span class="p">()</span>
<span class="go">[4, 3, 3, 2, 2]</span>
</pre></div>
</div>
<p>The degree sequence of a digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">degree_sequence</span><span class="p">()</span>
<span class="go">[5, 3, 3, 3, 3, 3]</span>
</pre></div>
</div>
<p>Degree sequences of some common graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">degree_sequence</span><span class="p">()</span>
<span class="go">[3, 3, 3, 3, 3, 3, 3, 3, 3, 3]</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">HouseGraph</span><span class="p">()</span><span class="o">.</span><span class="n">degree_sequence</span><span class="p">()</span>
<span class="go">[3, 3, 2, 2, 2]</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">FlowerSnark</span><span class="p">()</span><span class="o">.</span><span class="n">degree_sequence</span><span class="p">()</span>
<span class="go">[3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.degree_to_cell">
<tt class="descname">degree_to_cell</tt><big>(</big><em>vertex</em>, <em>cell</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.degree_to_cell" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of edges from vertex to an edge in cell. In the
case of a digraph, returns a tuple (in_degree, out_degree).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cell</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">degree_to_cell</span><span class="p">(</span><span class="s">&#39;011&#39;</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">degree_to_cell</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">cell</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">degree_to_cell</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">degree_to_cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="go">(2, 0)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">degree_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="go">(0, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.delete_edge">
<tt class="descname">delete_edge</tt><big>(</big><em>u</em>, <em>v=None</em>, <em>label=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.delete_edge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Delete the edge from u to v, returning silently if vertices or edge
does not exist.</p>
<p>INPUT: The following forms are all accepted:</p>
<ul class="simple">
<li>G.delete_edge( 1, 2 )</li>
<li>G.delete_edge( (1, 2) )</li>
<li>G.delete_edges( [ (1, 2) ] )</li>
<li>G.delete_edge( 1, 2, &#8216;label&#8217; )</li>
<li>G.delete_edge( (1, 2, &#8216;label&#8217;) )</li>
<li>G.delete_edges( [ (1, 2, &#8216;label&#8217;) ] )</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&#39;c_graph&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">171</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">167</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;label&#39;</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&#39;label&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s">&#39;label&#39;</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">167</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">342</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;label&#39;</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&#39;label&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s">&#39;label&#39;</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="c"># correct!</span>
<span class="go">338</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="p">)</span> <span class="c"># correct!</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.delete_edges">
<tt class="descname">delete_edges</tt><big>(</big><em>edges</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.delete_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Delete edges from an iterable container.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K12</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K4</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K12</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">66</span>
<span class="gp">sage: </span><span class="n">K12</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">K4</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K12</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">60</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K12</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K4</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K12</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">132</span>
<span class="gp">sage: </span><span class="n">K12</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">K4</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K12</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">120</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.delete_multiedge">
<tt class="descname">delete_multiedge</tt><big>(</big><em>u</em>, <em>v</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.delete_multiedge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Deletes all edges from u and v.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None), (1, 2, None), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_multiedge</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, None), (2, 3, None)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="bp">None</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 1), (0, 1, 2), (0, 1, 3), (1, 0, None), (1, 2, None), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_multiedge</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, None), (1, 2, None), (2, 3, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.delete_vertex">
<tt class="descname">delete_vertex</tt><big>(</big><em>vertex</em>, <em>in_order=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.delete_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Deletes vertex, removing all incident edges. Deleting a
non-existent vertex will raise an exception.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">in_order</span></tt> - (default False) If True, this
deletes the ith vertex in the sorted list of vertices, i.e.
G.vertices()[i]</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">WheelGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4, 5]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Vertex (0) not in the graph.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(0, 1), (0, 2), (0, 3), (1, 2), (1, 3), (2, 3)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">in_order</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(0, 2), (0, 3), (1, 2), (1, 3), (2, 3)]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s">&#39;no delete&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s">&#39;delete&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">()</span>
<span class="go">{0: &#39;no delete&#39;, 2: None, 3: None, 4: None}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="go">{0: (0, 0), 2: (2, 0), 3: (3, 0), 4: (4, 0)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.delete_vertices">
<tt class="descname">delete_vertices</tt><big>(</big><em>vertices</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.delete_vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Remove vertices from the (di)graph taken from an iterable container
of vertices. Deleting a non-existent vertex will raise an
exception.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">D</span>
<span class="go">Digraph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Vertex (1) not in the graph.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.density">
<tt class="descname">density</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.density" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the density (number of edges divided by number of possible
edges).</p>
<p>In the case of a multigraph, raises an error, since there is an
infinite number of possible edges.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">d</span><span class="p">);</span> <span class="n">G</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="go">1/3</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]</span> <span class="p">});</span> <span class="n">G</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]</span> <span class="p">});</span> <span class="n">G</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="go">1/2</span>
</pre></div>
</div>
<p>Note that there are more possible edges on a looped graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="go">1/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.depth_first_search">
<tt class="descname">depth_first_search</tt><big>(</big><em>start</em>, <em>ignore_direction=False</em>, <em>distance=None</em>, <em>neighbors=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.depth_first_search" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over the vertices in a depth-first ordering.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">start</span></tt> - vertex or list of vertices from which to start
the traversal</li>
<li><tt class="docutils literal"><span class="pre">ignore_direction</span></tt> - (default False) only applies to
directed graphs. If True, searches across edges in either
direction.</li>
<li><tt class="docutils literal"><span class="pre">distance</span></tt> - Deprecated. Broken, do not use.</li>
<li><tt class="docutils literal"><span class="pre">neighbors</span></tt> - a function giving the neighbors of a vertex.
The function should take a vertex and return a list of
vertices.  For a graph, <tt class="docutils literal"><span class="pre">neighbors</span></tt> is by default the
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.neighbors" title="sage.graphs.generic_graph.GenericGraph.neighbors"><tt class="xref py py-meth docutils literal"><span class="pre">neighbors()</span></tt></a> function of the graph.  For a digraph,
the <tt class="docutils literal"><span class="pre">neighbors</span></tt> function defaults to the
<a class="reference internal" href="digraph.html#sage.graphs.digraph.DiGraph.neighbor_out_iterator" title="sage.graphs.digraph.DiGraph.neighbor_out_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">neighbor_out_iterator()</span></tt></a> function of the graph.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.breadth_first_search" title="sage.graphs.generic_graph.GenericGraph.breadth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">breadth_first_search()</span></tt></a></li>
<li><a class="reference internal" href="base/c_graph.html#sage.graphs.base.c_graph.CGraphBackend.breadth_first_search" title="sage.graphs.base.c_graph.CGraphBackend.breadth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">breadth_first_search</span></tt></a>
&#8211; breadth-first search for fast compiled graphs.</li>
<li><a class="reference internal" href="base/c_graph.html#sage.graphs.base.c_graph.CGraphBackend.depth_first_search" title="sage.graphs.base.c_graph.CGraphBackend.depth_first_search"><tt class="xref py py-meth docutils literal"><span class="pre">depth_first_search</span></tt></a>
&#8211; depth-first search for fast compiled graphs.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0, 4, 3, 2, 1]</span>
</pre></div>
</div>
<p>By default, the edge direction of a digraph is respected, but this
can be overridden by the <tt class="docutils literal"><span class="pre">ignore_direction</span></tt> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0, 3, 6, 7, 2, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[0, 7, 6, 3, 5, 2, 1, 4]</span>
</pre></div>
</div>
<p>Multiple starting vertices can be specified in a list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">[0, 3, 6, 7, 2, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]))</span>
<span class="go">[0, 3, 6, 7, 2, 5, 1, 4]</span>
</pre></div>
</div>
<p>More generally, you can specify a <tt class="docutils literal"><span class="pre">neighbors</span></tt> function.  For
example, you can traverse the graph backwards by setting
<tt class="docutils literal"><span class="pre">neighbors</span></tt> to be the <a class="reference internal" href="digraph.html#sage.graphs.digraph.DiGraph.neighbors_in" title="sage.graphs.digraph.DiGraph.neighbors_in"><tt class="xref py py-meth docutils literal"><span class="pre">neighbors_in()</span></tt></a> function of the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_in</span><span class="p">))</span>
<span class="go">[5, 4, 3, 2, 1, 0, 24, 23, 22]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_in</span><span class="p">))</span>
<span class="go">[5, 24, 4, 23, 3, 22, 2, 1, 0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_out</span><span class="p">))</span>
<span class="go">[5, 6, 7, 8, 9, 33, 34, 35]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">breadth_first_search</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_out</span><span class="p">))</span>
<span class="go">[5, 33, 6, 34, 7, 35, 8, 9]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">depth_first_search</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[0, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.diameter">
<tt class="descname">diameter</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.diameter" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the diameter of the (di)graph.</p>
<p>The diameter is defined to be the maximum distance between two vertices.
It is infinite if the (di)graph is not (strongly) connected.</p>
<p>For more information and examples on how to use input variables,
see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a> and
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eccentricity" title="sage.graphs.generic_graph.GenericGraph.eccentricity"><tt class="xref py py-meth docutils literal"><span class="pre">eccentricity()</span></tt></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, edge weights are taken into account; if
False, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - a Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - a Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'standard'</span></tt>, <tt class="docutils literal"><span class="pre">'2sweep'</span></tt>, <tt class="docutils literal"><span class="pre">'multi-sweep'</span></tt>, <tt class="docutils literal"><span class="pre">'iFUB'</span></tt>: these
algorithms are implemented in
<a class="reference internal" href="distances_all_pairs.html#sage.graphs.distances_all_pairs.diameter" title="sage.graphs.distances_all_pairs.diameter"><tt class="xref py py-func docutils literal"><span class="pre">sage.graphs.distances_all_pairs.diameter()</span></tt></a>
They work only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>. See the function
documentation for more information.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'iFUB'</span></tt> if
<tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>, otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>EXAMPLES: The more symmetric a graph is, the smaller (diameter -
radius) is.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">BarbellGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">radius</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">diameter</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">OctahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">radius</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">diameter</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>TEST:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">diameter</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This method has no meaning on empty graphs.</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">diameter</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;iFUB&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;weight&#39;</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;iFUB&#39; does not work on weighted graphs.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths">
<tt class="descname">disjoint_routed_paths</tt><big>(</big><em>pairs</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a set of disjoint routed paths.</p>
<p>Given a set of pairs <span class="math">\((s_i,t_i)\)</span>, a set
of disjoint routed paths is a set of
<span class="math">\(s_i-t_i\)</span> paths which can interset at their endpoints
and are vertex-disjoint otherwise.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pairs</span></tt> &#8211; list of pairs of vertices</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; Specify a Linear Program solver to be used.
If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used.
function of <tt class="docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt>. See the documentation  of <tt class="docutils literal"><span class="pre">MixedIntegerLinearProgram.solve</span></tt>
for more informations.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> (integer) &#8211; sets the level of verbosity. Set to <span class="math">\(0\)</span>
by default (quiet).</li>
</ul>
<p>EXAMPLE:</p>
<p>Given a grid, finding two vertex-disjoint
paths, the first one from the top-left corner
to the bottom-left corner, and the second from
the top-right corner to the bottom-right corner
is easy</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">disjoint_routed_paths</span><span class="p">(</span> <span class="p">[((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">))])</span>
</pre></div>
</div>
<p>Though there is obviously no solution to the problem
in which each corner is sending information to the opposite
one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">disjoint_routed_paths</span><span class="p">(</span> <span class="p">[((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">))])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">The disjoint routed paths do not exist.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.disjoint_union">
<tt class="descname">disjoint_union</tt><big>(</big><em>other</em>, <em>verbose_relabel=None</em>, <em>labels='pairs'</em>, <em>immutable=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.disjoint_union" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the disjoint union of self and other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">verbose_relabel</span></tt> - deprecated.</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> - (defaults to &#8216;pairs&#8217;) If set to &#8216;pairs&#8217;, each
element <tt class="docutils literal"><span class="pre">v</span></tt> in the first graph will be named <tt class="docutils literal"><span class="pre">(0,v)</span></tt> and
each element <tt class="docutils literal"><span class="pre">u</span></tt> in <tt class="docutils literal"><span class="pre">other</span></tt> will be named <tt class="docutils literal"><span class="pre">(1,u)</span></tt> in
the result. If set to &#8216;integers&#8217;, the elements of the result
will be relabeled with consecutive integers.</li>
<li><tt class="docutils literal"><span class="pre">immutable</span></tt> (boolean) &#8211; whether to create a mutable/immutable
disjoint union. <tt class="docutils literal"><span class="pre">immutable=None</span></tt> (default) means that the graphs
and their disjoint union will behave the same way.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.union" title="sage.graphs.generic_graph.GenericGraph.union"><tt class="xref py py-meth docutils literal"><span class="pre">union()</span></tt></a></li>
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.join" title="sage.graphs.graph.Graph.join"><tt class="xref py py-meth docutils literal"><span class="pre">join()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">disjoint_union</span><span class="p">(</span><span class="n">H</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Cycle graph disjoint_union Cycle graph: Graph on 7 vertices</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (1, 3)]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">disjoint_union</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="s">&#39;integers&#39;</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Cycle graph disjoint_union Cycle graph: Graph on 7 vertices</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">Graph</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;Custom path&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="go">&#39;Custom path&#39;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">disjoint_union</span><span class="p">(</span><span class="n">H</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Custom path disjoint_union Cycle graph: Graph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(0, &#39;a&#39;), (0, &#39;b&#39;), (1, 0), (1, 1), (1, 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.disjunctive_product">
<tt class="descname">disjunctive_product</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.disjunctive_product" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the disjunctive product of self and other.</p>
<p>The disjunctive product of <span class="math">\(G\)</span> and <span class="math">\(H\)</span> is the graph <span class="math">\(L\)</span> with vertex set
<span class="math">\(V(L)=V(G)\times V(H)\)</span>, and <span class="math">\(((u,v), (w,x))\)</span> is an edge iff either :</p>
<ul class="simple">
<li><span class="math">\((u, w)\)</span> is an edge of <span class="math">\(G\)</span>, or</li>
<li><span class="math">\((v, x)\)</span> is an edge of <span class="math">\(H\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">disjunctive_product</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">disjunctive_product</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 46 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Disjunctive product of graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">disjunctive_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (0, &#39;b&#39;)), ((0, &#39;a&#39;), (1, &#39;a&#39;)), ((0, &#39;a&#39;), (1, &#39;b&#39;)), ((0, &#39;a&#39;), (2, &#39;b&#39;)), ((0, &#39;b&#39;), (1, &#39;a&#39;)), ((0, &#39;b&#39;), (1, &#39;b&#39;)), ((0, &#39;b&#39;), (2, &#39;a&#39;)), ((1, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;a&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;)), ((1, &#39;b&#39;), (2, &#39;a&#39;)), ((1, &#39;b&#39;), (2, &#39;b&#39;)), ((2, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">H</span><span class="o">.</span><span class="n">disjunctive_product</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Disjunctive product of digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">disjunctive_product</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (0, &#39;b&#39;)), ((0, &#39;a&#39;), (1, &#39;a&#39;)), ((0, &#39;a&#39;), (1, &#39;b&#39;)), ((0, &#39;a&#39;), (2, &#39;b&#39;)), ((0, &#39;b&#39;), (1, &#39;a&#39;)), ((0, &#39;b&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (0, &#39;b&#39;)), ((1, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;a&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;)), ((1, &#39;b&#39;), (2, &#39;a&#39;)), ((1, &#39;b&#39;), (2, &#39;b&#39;)), ((2, &#39;a&#39;), (0, &#39;b&#39;)), ((2, &#39;a&#39;), (1, &#39;b&#39;)), ((2, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">J</span><span class="o">.</span><span class="n">disjunctive_product</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.distance">
<tt class="descname">distance</tt><big>(</big><em>u</em>, <em>v</em>, <em>by_weight=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.distance" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the (directed) distance from u to v in the (di)graph, i.e.
the length of the shortest path from u to v.</p>
<p>This method simply calls
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_length" title="sage.graphs.generic_graph.GenericGraph.shortest_path_length"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path_length()</span></tt></a>,
with default arguments. For more information, and for more option, we
refer to that method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> - if <tt class="docutils literal"><span class="pre">False</span></tt>, the graph is considered unweighted, and
the distance is the number of edges in a shortest path. If <tt class="docutils literal"><span class="pre">True</span></tt>,
the distance is the sum of edge labels (which are assumed to be
numbers).</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}},</span> <span class="n">sparse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.distance_all_pairs">
<tt class="descname">distance_all_pairs</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.distance_all_pairs" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the distances between all pairs of vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - the Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - the Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> if
<tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>OUTPUT:</p>
<p>A doubly indexed dictionary</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is a Cython version of this method that is usually
much faster for large graphs, as most of the time is
actually spent building the final double
dictionary. Everything on the subject is to be found in the
<a class="reference internal" href="distances_all_pairs.html#module-sage.graphs.distances_all_pairs" title="sage.graphs.distances_all_pairs"><tt class="xref py py-mod docutils literal"><span class="pre">distances_all_pairs</span></tt></a> module.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This algorithm simply calls
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs" title="sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs"><tt class="xref py py-meth docutils literal"><span class="pre">GenericGraph.shortest_path_all_pairs()</span></tt></a>, and we suggest to look
at that method for more information and examples.</p>
</div>
<p>EXAMPLES:</p>
<p>The Petersen Graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">g</span><span class="o">.</span><span class="n">distance_all_pairs</span><span class="p">()</span>
<span class="go">{0: {0: 0, 1: 1, 2: 2, 3: 2, 4: 1, 5: 1, 6: 2, 7: 2, 8: 2, 9: 2}, 1: {0: 1, 1: 0, 2: 1, 3: 2, 4: 2, 5: 2, 6: 1, 7: 2, 8: 2, 9: 2}, 2: {0: 2, 1: 1, 2: 0, 3: 1, 4: 2, 5: 2, 6: 2, 7: 1, 8: 2, 9: 2}, 3: {0: 2, 1: 2, 2: 1, 3: 0, 4: 1, 5: 2, 6: 2, 7: 2, 8: 1, 9: 2}, 4: {0: 1, 1: 2, 2: 2, 3: 1, 4: 0, 5: 2, 6: 2, 7: 2, 8: 2, 9: 1}, 5: {0: 1, 1: 2, 2: 2, 3: 2, 4: 2, 5: 0, 6: 2, 7: 1, 8: 1, 9: 2}, 6: {0: 2, 1: 1, 2: 2, 3: 2, 4: 2, 5: 2, 6: 0, 7: 2, 8: 1, 9: 1}, 7: {0: 2, 1: 2, 2: 1, 3: 2, 4: 2, 5: 1, 6: 2, 7: 0, 8: 2, 9: 1}, 8: {0: 2, 1: 2, 2: 2, 3: 1, 4: 2, 5: 1, 6: 1, 7: 2, 8: 0, 9: 2}, 9: {0: 2, 1: 2, 2: 2, 3: 2, 4: 1, 5: 2, 6: 1, 7: 1, 8: 2, 9: 0}}</span>
</pre></div>
</div>
<p>Testing on Random Graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">distances</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">distance_all_pairs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.distance_matrix" title="sage.graphs.generic_graph.GenericGraph.distance_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">distance_matrix()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs" title="sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path_all_pairs()</span></tt></a></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.distance_graph">
<tt class="descname">distance_graph</tt><big>(</big><em>dist</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.distance_graph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the graph on the same vertex set as
the original graph but vertices are adjacent
in the returned graph if and only if they are
at specified distances in the original graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dist</span></tt> is a nonnegative integer or
a list of nonnegative integers.
<tt class="docutils literal"><span class="pre">Infinity</span></tt> may be used here to describe
vertex pairs in separate components.</li>
</ul>
<p>OUTPUT:</p>
<p>The returned value is an undirected graph.  The
vertex set is identical to the calling graph, but edges
of the returned graph join vertices whose distance in
the calling graph are present in the input <tt class="docutils literal"><span class="pre">dist</span></tt>.
Loops will only be present if distance 0 is included.  If
the original graph has a position dictionary specifying
locations of vertices for plotting, then this information
is copied over to the distance graph.  In some instances
this layout may not be the best, and might even be confusing
when edges run on top of each other due to symmetries
chosen for the layout.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 0 0 1 0 1]</span>
<span class="go">[0 0 1 0 1 0]</span>
<span class="go">[0 1 0 0 0 1]</span>
<span class="go">[1 0 0 0 1 0]</span>
<span class="go">[0 1 0 1 0 0]</span>
<span class="go">[1 0 1 0 0 0]</span>
</pre></div>
</div>
<p>To obtain the graph where vertices are adjacent if their
distance apart is <tt class="docutils literal"><span class="pre">d</span></tt> or less use a <tt class="docutils literal"><span class="pre">range()</span></tt> command
to create the input, using <tt class="docutils literal"><span class="pre">d+1</span></tt> as the input to <tt class="docutils literal"><span class="pre">range</span></tt>.
Notice that this will include distance 0 and hence place a loop
at each vertex.  To avoid this, use <tt class="docutils literal"><span class="pre">range(1,d+1)</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">OddGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">diameter</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">num_verts</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A complete collection of distance graphs will have
adjacency matrices that sum to the matrix of all ones.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">all_ones</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">P</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">am</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">all_ones</span> <span class="o">==</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">400</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Four-bit strings differing in one bit is the same as
four-bit strings differing in three bits.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The graph of eight-bit strings, adjacent if different
in an odd number of bits.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">sum</span><span class="p">([</span><span class="n">binomial</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">degrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">degrees</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">degree_histogram</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example of using <tt class="docutils literal"><span class="pre">Infinity</span></tt> as the distance in
a graph that is not connected.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">disjoint_union</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="n">Infinity</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 0 0 1 1]</span>
<span class="go">[0 0 0 1 1]</span>
<span class="go">[0 0 0 1 1]</span>
<span class="go">[1 1 1 0 0]</span>
<span class="go">[1 1 1 0 0]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Empty input, or unachievable distances silently yield empty graphs.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">([])</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>It is an error to provide a distance that is not an integer type.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="s">&#39;junk&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unable to convert &#39;junk&#39; to an integer</span>
</pre></div>
</div>
<p>It is an error to provide a negative distance.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Distance graph for a negative distance (d=-3) is not defined</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<p>Rob Beezer, 2009-11-25</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.distance_matrix">
<tt class="descname">distance_matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.distance_matrix" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the distance matrix of the (strongly) connected (di)graph.</p>
<p>The distance matrix of a (strongly) connected (di)graph is a matrix whose
rows and columns are indexed with the vertices of the (di) graph. The
intersection of a row and column contains the respective distance between
the vertices indexed at these position.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The ordering of vertices in the matrix has no reason to correspond
to the order of vertices in
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertices" title="sage.graphs.generic_graph.GenericGraph.vertices"><tt class="xref py py-meth docutils literal"><span class="pre">vertices()</span></tt></a>. In
particular, if two integers <span class="math">\(i,j\)</span> are vertices of a graph <span class="math">\(G\)</span> with
distance matrix <tt class="docutils literal"><span class="pre">M</span></tt>, then <tt class="docutils literal"><span class="pre">M[i][i]</span></tt> is not necessarily the
distance between vertices <span class="math">\(i\)</span> and <span class="math">\(j\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 2 1 2 2 3]</span>
<span class="go">[1 0 2 1 2 1 3 2]</span>
<span class="go">[1 2 0 1 2 3 1 2]</span>
<span class="go">[2 1 1 0 3 2 2 1]</span>
<span class="go">[1 2 2 3 0 1 1 2]</span>
<span class="go">[2 1 3 2 1 0 2 1]</span>
<span class="go">[2 3 1 2 1 2 0 1]</span>
<span class="go">[3 2 2 1 2 1 1 0]</span>
</pre></div>
</div>
<p>The well known result of Graham and Pollak states that the determinant of
the distance matrix of any tree of order n is (-1)^{n-1}(n-1)2^{n-2}</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">^</span><span class="mi">8</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">graphs</span><span class="o">.</span><span class="n">trees</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.distance_all_pairs" title="sage.graphs.generic_graph.GenericGraph.distance_all_pairs"><tt class="xref py py-meth docutils literal"><span class="pre">distance_all_pairs()</span></tt></a>
&#8211; computes the distance between any two vertices.</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.distances_distribution">
<tt class="descname">distances_distribution</tt><big>(</big><em>G</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.distances_distribution" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the distances distribution of the (di)graph in a dictionary.</p>
<p>This method <em>ignores all edge labels</em>, so that the distance considered is
the topological distance.</p>
<p>OUTPUT:</p>
<blockquote>
<div>A dictionary <tt class="docutils literal"><span class="pre">d</span></tt> such that the number of pairs of vertices at distance
<tt class="docutils literal"><span class="pre">k</span></tt> (if any) is equal to <span class="math">\(d[k] \cdot |V(G)| \cdot (|V(G)|-1)\)</span>.</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We consider that two vertices that do not belong to the same connected
component are at infinite distance, and we do not take the trivial pairs
of vertices <span class="math">\((v, v)\)</span> at distance <span class="math">\(0\)</span> into account. Empty (di)graphs and
(di)graphs of order 1 have no paths and so we return the empty
dictionary <tt class="docutils literal"><span class="pre">{}</span></tt>.</p>
</div>
<p>EXAMPLES:</p>
<p>An empty Graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>A Graph of order 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>A Graph of order 2 without edge:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{+Infinity: 1}</span>
</pre></div>
</div>
<p>The Petersen Graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{1: 1/3, 2: 2/3}</span>
</pre></div>
</div>
<p>A graph with multiple disconnected components:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s">&#39;good&#39;</span><span class="p">,</span><span class="s">&#39;wine&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{1: 8/33, 2: 5/11, +Infinity: 10/33}</span>
</pre></div>
</div>
<p>The de Bruijn digraph dB(2,3):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{1: 1/4, 2: 11/28, 3: 5/14}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.dominating_set">
<tt class="descname">dominating_set</tt><big>(</big><em>independent=False</em>, <em>total=False</em>, <em>value_only=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.dominating_set" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a minimum dominating set of the graph
represented by the list of its vertices. For more information, see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Dominating_set">Wikipedia article on dominating sets</a>.</p>
<p>A minimum dominating set <span class="math">\(S\)</span> of a graph <span class="math">\(G\)</span> is
a set of its vertices of minimal cardinality such
that any vertex of <span class="math">\(G\)</span> is in <span class="math">\(S\)</span> or has one of its neighbors
in <span class="math">\(S\)</span>.</p>
<p>As an optimization problem, it can be expressed as:</p>
<div class="math">
\[\begin{split}\mbox{Minimize : }&amp;\sum_{v\in G} b_v\\
\mbox{Such that : }&amp;\forall v \in G, b_v+\sum_{(u,v)\in G.edges()} b_u\geq 1\\
&amp;\forall x\in G, b_x\mbox{ is a binary variable}\end{split}\]</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">independent</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). If
<tt class="docutils literal"><span class="pre">independent=True</span></tt>, computes a minimum independent dominating set.</li>
<li><tt class="docutils literal"><span class="pre">total</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). If
<tt class="docutils literal"><span class="pre">total=True</span></tt>, computes a total dominating set.</li>
<li><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>If <tt class="docutils literal"><span class="pre">True</span></tt>, only the cardinality of a minimum
dominating set is returned.</li>
<li>If <tt class="docutils literal"><span class="pre">False</span></tt> (default), a minimum dominating set
is returned as the list of its vertices.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>EXAMPLES:</p>
<p>A basic illustration on a <tt class="docutils literal"><span class="pre">PappusGraph</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PappusGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">dominating_set</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>If we build a graph from two disjoint stars, then link their centers
we will find a difference between the cardinality of an independent set
and a stable independent set:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">graphs</span><span class="o">.</span><span class="n">StarGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">dominating_set</span><span class="p">())</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">dominating_set</span><span class="p">(</span><span class="n">independent</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">6</span>
</pre></div>
</div>
<p>The total dominating set of the Petersen graph has cardinality 4:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">dominating_set</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The dominating set is calculated for both the directed and undirected
graphs (modification introduced in <a class="reference external" href="http://trac.sagemath.org/17905">trac ticket #17905</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">dominating_set</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">dominating_set</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.dominator_tree">
<tt class="descname">dominator_tree</tt><big>(</big><em>g</em>, <em>root</em>, <em>return_dict=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.dominator_tree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Uses Boost to compute the dominator tree of <tt class="docutils literal"><span class="pre">g</span></tt>, rooted at <tt class="docutils literal"><span class="pre">root</span></tt>.</p>
<p>A node <span class="math">\(d\)</span> dominates a node <span class="math">\(n\)</span> if every path from the entry node
<tt class="docutils literal"><span class="pre">root</span></tt> to <span class="math">\(n\)</span> must go through <span class="math">\(d\)</span>. The immediate dominator of a node
<span class="math">\(n\)</span> is the unique node that strictly dominates <span class="math">\(n\)</span> but does not dominate
any other node that dominates <span class="math">\(n\)</span>. A dominator tree is a tree where each
node&#8217;s children are those nodes it immediately dominates. For more
information, see <a class="reference external" href="https://en.wikipedia.org/wiki/Dominator_(graph_theory)">Wikipedia article Dominator_(graph_theory)</a>.</p>
<p>If the graph is connected and undirected, the parent of a vertex <span class="math">\(v\)</span> is:</p>
<blockquote>
<div><ul class="simple">
<li>the root if <span class="math">\(v\)</span> is in the same biconnected component as the root;</li>
<li>the first cut vertex in a path from <span class="math">\(v\)</span> to the root, otherwise.</li>
</ul>
</div></blockquote>
<p>If the graph is not connected, the dominator tree of the whole graph is
equal to the dominator tree of the connected component of the root.</p>
<p>If the graph is directed, computing a dominator tree is more complicated,
and it needs time <span class="math">\(O(m\log m)\)</span>, where <span class="math">\(m\)</span> is the number of edges. The
implementation provided by Boost is the most general one, so it needs time
<span class="math">\(O(m\log m)\)</span> even for undirected graphs.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">g</span></tt> (generic_graph) - the input graph.</li>
<li><tt class="docutils literal"><span class="pre">root</span></tt> (vertex) - the root of the dominator tree.</li>
<li><tt class="docutils literal"><span class="pre">return_dict</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the function returns a
dictionary associating to each vertex its parent in the dominator
tree. If <tt class="docutils literal"><span class="pre">False</span></tt> (default), it returns the whole tree, as a <tt class="docutils literal"><span class="pre">Graph</span></tt>
or a <tt class="docutils literal"><span class="pre">DiGraph</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<p>The dominator tree, as a graph or as a dictionary, depending on the
value of <tt class="docutils literal"><span class="pre">return_dict</span></tt>. If the output is a dictionary, it will contain
<tt class="docutils literal"><span class="pre">None</span></tt> in correspondence of <tt class="docutils literal"><span class="pre">root</span></tt> and of vertices that are not
reachable from <tt class="docutils literal"><span class="pre">root</span></tt>. If the output is a graph, it will not contain
vertices that are not reachable from <tt class="docutils literal"><span class="pre">root</span></tt>.</p>
<p>EXAMPLES:</p>
<p>An undirected grid is biconnected, and its dominator tree is a star
(everyone&#8217;s parent is the root):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dominator_tree</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">to_dictionary</span><span class="p">()</span>
<span class="go">{(0, 0): [(0, 1), (1, 0), (1, 1)], (0, 1): [(0, 0)], (1, 0): [(0, 0)], (1, 1): [(0, 0)]}</span>
</pre></div>
</div>
<p>If the graph is made by two 3-cycles <span class="math">\(C_1,C_2\)</span> connected by an edge <span class="math">\((v,w)\)</span>,
with <span class="math">\(v \in C_1\)</span>, <span class="math">\(w \in C_2\)</span>, the cut vertices are <span class="math">\(v\)</span> and <span class="math">\(w\)</span>, the
biconnected components are <span class="math">\(C_1\)</span>, <span class="math">\(C_2\)</span>, and the edge <span class="math">\((v,w)\)</span>. If the root
is in <span class="math">\(C_1\)</span>, the parent of each vertex in <span class="math">\(C_1\)</span> is the root, the parent of
<span class="math">\(w\)</span> is <span class="math">\(v\)</span>, and the parent of each vertex in <span class="math">\(C_2\)</span> is <span class="math">\(w\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">dominator_tree</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 1, 1: None, 2: 1, 3: 0, 4: 3, 5: 3}</span>
</pre></div>
</div>
<p>An example with a directed graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">dominator_tree</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">to_dictionary</span><span class="p">()</span>
<span class="go">{0: [1], 1: [2], 2: [3], 3: [4], 4: [], 5: [6], 6: [7], 7: [8], 8: [9], 9: [0]}</span>
</pre></div>
</div>
<p>If the output is a dictionary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dominator_tree</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">{(0, 0): None, (0, 1): (0, 0), (1, 0): (0, 0), (1, 1): (0, 0)}</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>If <tt class="docutils literal"><span class="pre">g</span></tt> is not a graph, an error is raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.boost_graph</span> <span class="kn">import</span> <span class="n">dominator_tree</span>
<span class="gp">sage: </span><span class="n">dominator_tree</span><span class="p">(</span><span class="s">&#39;I am not a graph&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The input g must be a Sage graph.</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">root</span></tt> is not a vertex, an error is raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">TransitiveTournament</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">dominator_tree</span><span class="p">(</span><span class="s">&#39;Not a vertex!&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The input root must be a vertex of g.</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dominator_tree</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The input root must be a vertex of g.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.eccentricity">
<tt class="descname">eccentricity</tt><big>(</big><em>v=None</em>, <em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em>, <em>dist_dict=None</em>, <em>with_labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.eccentricity" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the eccentricity of vertex (or vertices) v.</p>
<p>The eccentricity of a vertex is the maximum distance to any other
vertex.</p>
<p>For more information and examples on how to use input variables, see
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">v</span></tt> - either a single vertex or a list of vertices. If it is not
specified, then it is taken to be all vertices.</li>
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, edge weights are taken into account; if
False, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - a Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>
and <tt class="docutils literal"><span class="pre">v</span> <span class="pre">is</span> <span class="pre">None</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - a Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed). However,
<tt class="docutils literal"><span class="pre">v</span></tt> must be <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">'From_Dictionary'</span></tt>: uses the (already computed) distances, that
are provided by input variable <tt class="docutils literal"><span class="pre">dist_dict</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm:
<tt class="docutils literal"><span class="pre">'From_Dictionary'</span></tt> if <tt class="docutils literal"><span class="pre">dist_dict</span></tt> is not None, <tt class="docutils literal"><span class="pre">'BFS'</span></tt> for
unweighted graphs, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt> otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
<li><tt class="docutils literal"><span class="pre">dist_dict</span></tt> - used only if <tt class="docutils literal"><span class="pre">algorithm=='From_Dictionary'</span></tt> - a dict
of dicts of distances.</li>
<li><tt class="docutils literal"><span class="pre">with_labels</span></tt> - Whether to return a list or a dict.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">KrackhardtKiteGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">()</span>
<span class="go">[4, 4, 4, 4, 4, 3, 3, 2, 3, 4]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="go">[3, 4, 2]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">8</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">()</span>
<span class="go">[+Infinity, +Infinity, +Infinity]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 0}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: +Infinity, 1: +Infinity}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;BFS&#39;</span><span class="p">)</span>
<span class="go">[1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Floyd-Warshall-Cython&#39;</span><span class="p">)</span>
<span class="go">[1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">)</span>
<span class="go">[2, 1, 2]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Dijkstra_Boost&#39;</span><span class="p">)</span>
<span class="go">[2, 1, 2]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Johnson_Boost&#39;</span><span class="p">)</span>
<span class="go">[2, 1, 2]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Floyd-Warshall-Python&#39;</span><span class="p">)</span>
<span class="go">[2, 1, 2]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">dist_dict</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[2, 1, 2]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>A non-implemented algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;boh&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm boh not yet implemented. Please, contribute!</span>
</pre></div>
</div>
<p>An algorithm that does not work with edge weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;BFS&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;BFS&#39; does not work with weights.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Floyd-Warshall-Cython&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;Floyd-Warshall-Cython&#39; does not work with weights.</span>
</pre></div>
</div>
<p>An algorithm that computes the all-pair-shortest-paths when not all
vertices are needed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Floyd-Warshall-Cython&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;Floyd-Warshall-Cython&#39; works only if all eccentricities are needed.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Floyd-Warshall-Python&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;Floyd-Warshall-Python&#39; works only if all eccentricities are needed.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;Johnson_Boost&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;Johnson_Boost&#39; works only if all eccentricities are needed.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_boundary">
<tt class="descname">edge_boundary</tt><big>(</big><em>vertices1</em>, <em>vertices2=None</em>, <em>labels=True</em>, <em>sort=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_boundary" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of edges <span class="math">\((u,v,l)\)</span> with <span class="math">\(u\)</span> in <tt class="docutils literal"><span class="pre">vertices1</span></tt>
and <span class="math">\(v\)</span> in <tt class="docutils literal"><span class="pre">vertices2</span></tt>. If <tt class="docutils literal"><span class="pre">vertices2</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>, then
it is set to the complement of <tt class="docutils literal"><span class="pre">vertices1</span></tt>.</p>
<p>In a digraph, the external boundary of a vertex <span class="math">\(v\)</span> are those
vertices <span class="math">\(u\)</span> with an arc <span class="math">\((v, u)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">labels</span></tt> - if <tt class="docutils literal"><span class="pre">False</span></tt>, each edge is a tuple <span class="math">\((u,v)\)</span> of
vertices.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">edge_boundary</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span> <span class="p">))</span>
<span class="go">27</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">27</span>
</pre></div>
</div>
<p>Note that the edge boundary preserves direction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">edge_boundary</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span> <span class="p">))</span>
<span class="go">27</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">54</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edge_boundary</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(0, 1, None), (0, 2, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edge_boundary</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DiamondGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_boundary</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[(0, 2, None), (1, 2, None), (1, 3, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_boundary</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_boundary</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(0, 2, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_connectivity">
<tt class="descname">edge_connectivity</tt><big>(</big><em>value_only=True</em>, <em>implementation=None</em>, <em>use_edge_labels=False</em>, <em>vertices=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_connectivity" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the edge connectivity of the graph.</p>
<p>For more information, see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Connectivity_(graph_theory)">Wikipedia article on connectivity</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When the graph is a directed graph, this method actually computes
the <em>strong</em> connectivity, (i.e. a directed graph is strongly
<span class="math">\(k\)</span>-connected if there are <span class="math">\(k\)</span> disjoint paths between any two
vertices <span class="math">\(u, v\)</span>). If you do not want to consider strong
connectivity, the best is probably to convert your <tt class="docutils literal"><span class="pre">DiGraph</span></tt>
object to a <tt class="docutils literal"><span class="pre">Graph</span></tt> object, and compute the connectivity of this
other graph.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt> (default), only the value is returned.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, both the value and a minimum edge cut
are returned.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">implementation</span></tt> &#8211; selects an implementation:<ul>
<li>When set to <tt class="docutils literal"><span class="pre">None</span></tt> (default): selects the best implementation
available.</li>
<li>When set to <tt class="docutils literal"><span class="pre">&quot;boost&quot;</span></tt>, we use the Boost graph library (which is
much more efficient). It is not available when <tt class="docutils literal"><span class="pre">edge_labels=True</span></tt>,
and it is unreliable for directed graphs (see <a class="reference external" href="http://trac.sagemath.org/18753">trac ticket #18753</a>).</li>
<li>When set to <tt class="docutils literal"><span class="pre">&quot;Sage&quot;</span></tt>, we use Sage&#8217;s implementation.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, computes a weighted minimum cut
where each edge has a weight defined by its label. (If
an edge has no label, <span class="math">\(1\)</span> is assumed.). Implies
<tt class="docutils literal"><span class="pre">boost</span></tt> = <tt class="docutils literal"><span class="pre">False</span></tt>.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, each edge has weight <span class="math">\(1\)</span>.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, also returns the two sets of
vertices that are disconnected by the cut. Implies
<tt class="docutils literal"><span class="pre">value_only=False</span></tt>.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used (ignored if <tt class="docutils literal"><span class="pre">implementation='boost'</span></tt>). If set to
<tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For more information on LP solvers
and which default solver is used, see the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>EXAMPLES:</p>
<p>A basic application on the PappusGraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PappusGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The edge connectivity of a complete graph ( and of a random graph )
is its minimum degree, and one of the two parts of the bipartition
is reduced to only one vertex. The cutedges isomorphic to a
Star graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">value</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="p">[</span> <span class="n">setA</span><span class="p">,</span> <span class="n">setB</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">value</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">setA</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">setB</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cut</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cut</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cut</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">StarGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Even if obviously in any graph we know that the edge connectivity
is less than the minimum degree of the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">min</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If we build a tree then assign to its edges a random value, the
minimum cut will be the edge with minimum value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tree</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">tree</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">())</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>       <span class="n">tree</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">random</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">minimum</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="p">[(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span><span class="p">)]]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">==</span> <span class="n">minimum</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When <tt class="docutils literal"><span class="pre">value_only</span> <span class="pre">=</span> <span class="pre">True</span></tt> and <tt class="docutils literal"><span class="pre">implementation=&quot;sage&quot;</span></tt>, this function is
optimized for small connectivity values and does not need to build a
linear program.</p>
<p>It is the case for graphs which are not connected</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&quot;sage&quot;</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>For directed graphs, the strong connectivity is tested
through the dedicated function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&quot;sage&quot;</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>We check that the result with Boost is the same as the result without
Boost</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">()</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&quot;sage&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Boost interface also works with directed graphs</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">implementation</span> <span class="o">=</span> <span class="s">&quot;boost&quot;</span><span class="p">,</span> <span class="n">vertices</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">[1, [(0, 1)], [{0}, {1, 2, 3, 4, 5, 6, 7, 8, 9}]]</span>
</pre></div>
</div>
<p>However, the Boost algorithm is not reliable if the input is directed
(see <a class="reference external" href="http://trac.sagemath.org/18753">trac ticket #18753</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">()</span>
<span class="go">0.0</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&quot;boost&quot;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">()</span>
<span class="go">0.0</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s">&quot;boost&quot;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Checking that the two implementations agree:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="go">....:     g = graphs.RandomGNP(30,0.3)</span>
<span class="go">....:     e1 = g.edge_connectivity(implementation=&quot;boost&quot;)</span>
<span class="go">....:     e2 = g.edge_connectivity(implementation=&quot;sage&quot;)</span>
<span class="go">....:     assert (e1 == e2)</span>
</pre></div>
</div>
<p>Disconnected graphs and <tt class="docutils literal"><span class="pre">vertices=True</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, [], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_cut">
<tt class="descname">edge_cut</tt><big>(</big><em>s</em>, <em>t</em>, <em>value_only=True</em>, <em>use_edge_labels=False</em>, <em>vertices=False</em>, <em>algorithm='FF'</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_cut" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a minimum edge cut between vertices <span class="math">\(s\)</span> and <span class="math">\(t\)</span>.</p>
<p>A minimum edge cut between two vertices <span class="math">\(s\)</span> and <span class="math">\(t\)</span> of self
is a set <span class="math">\(A\)</span> of edges of minimum weight such that the graph
obtained by removing <span class="math">\(A\)</span> from the graph is disconnected. For more
information, see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Cut_%28graph_theory%29">Wikipedia article on cuts</a>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">s</span></tt> &#8211; source vertex</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">t</span></tt> &#8211; sink vertex</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>). When set to
<tt class="docutils literal"><span class="pre">True</span></tt>, only the weight of a minimum cut is returned.
Otherwise, a list of edges of a minimum cut is also returned.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). When set to
<tt class="docutils literal"><span class="pre">True</span></tt>, computes a weighted minimum cut where each edge has
a weight defined by its label (if an edge has no label, <span class="math">\(1\)</span>
is assumed). Otherwise, each edge has weight <span class="math">\(1\)</span>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). When set to
<tt class="docutils literal"><span class="pre">True</span></tt>, returns a list of edges in the edge cut and the
two sets of vertices that are disconnected by the cut.</p>
<p>Note: <tt class="docutils literal"><span class="pre">vertices=True</span></tt> implies <tt class="docutils literal"><span class="pre">value_only=False</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; algorithm to use:</p>
<ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;FF&quot;</span></tt>, a Python implementation of the
Ford-Fulkerson algorithm is used</li>
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;LP&quot;</span></tt>, the flow problem is solved using
Linear Programming.</li>
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;igraph&quot;</span></tt>, the igraph implementation of the
Goldberg-Tarjan algorithm is used (only available when
igraph is installed)</li>
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">None</span></tt> (default), we use <tt class="docutils literal"><span class="pre">LP</span></tt> if
<tt class="docutils literal"><span class="pre">vertex_bound</span> <span class="pre">=</span> <span class="pre">True</span></tt>, otherwise, we use <tt class="docutils literal"><span class="pre">igraph</span></tt> if
it is available, <tt class="docutils literal"><span class="pre">FF</span></tt> if it is not available.</li>
</ul>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The use of Linear Programming for non-integer problems may
possibly mean the presence of a (slight) numerical noise.</p>
</div>
<p>OUTPUT:</p>
<p>Real number or tuple, depending on the given arguments
(examples are given below).</p>
<p>EXAMPLES:</p>
<p>A basic application in the Pappus graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PappusGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Or on Petersen&#8217;s graph, with the corresponding bipartition of
the vertex set:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[3, [(0, 1, None), (0, 4, None), (0, 5, None)], [[0], [1, 2, 3, 4, 5, 6, 7, 8, 9]]]</span>
</pre></div>
</div>
<p>If the graph is a path with randomly weighted edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>     <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">random</span><span class="p">())</span>
</pre></div>
</div>
<p>The edge cut between the two ends is the edge of minimum weight:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">minimum</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">minimum</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">value</span><span class="p">,[</span><span class="n">e</span><span class="p">]]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_label</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">minimum</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The two sides of the edge cut are obviously shorter paths:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">value</span><span class="p">,</span><span class="n">edges</span><span class="p">,[</span><span class="n">set1</span><span class="p">,</span><span class="n">set2</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">set1</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set1</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set2</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">set1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>If algorithm is set to an exotic value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Divination&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The algorithm argument has to be equal to &quot;FF&quot;, &quot;LP&quot;, &quot;igraph&quot;, or None</span>
</pre></div>
</div>
<p>Same result for all three methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>     <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;FF&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;LP&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;FF&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;igraph&quot;</span><span class="p">)</span> <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Rounded return value when using the LP method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PappusGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;LP&quot;</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/12797">trac ticket #12797</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1, [(1, 2, 1)]]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1, [(2, 1, 1)]]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;LP&#39;</span><span class="p">)</span>
<span class="go">(1.0, [(2, 1)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_disjoint_paths">
<tt class="descname">edge_disjoint_paths</tt><big>(</big><em>s</em>, <em>t</em>, <em>algorithm='FF'</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_disjoint_paths" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of edge-disjoint paths between two
vertices as given by Menger&#8217;s theorem.</p>
<p>The edge version of Menger&#8217;s theorem asserts that the size
of the minimum edge cut between two vertices <span class="math">\(s\)</span> and`t`
(the minimum number of edges whose removal disconnects <span class="math">\(s\)</span>
and <span class="math">\(t\)</span>) is equal to the maximum number of pairwise
edge-independent paths from <span class="math">\(s\)</span> to <span class="math">\(t\)</span>.</p>
<p>This function returns a list of such paths.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; There are currently two different
implementations of this method :</p>
<blockquote>
<div><ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;FF&quot;</span></tt> (default), a Python implementation of the
Ford-Fulkerson algorithm is used.</li>
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;LP&quot;</span></tt>, the flow problem is solved using
Linear Programming.</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is topological: it does not take the eventual
weights of the edges into account.</p>
</div>
<p>EXAMPLE:</p>
<p>In a complete bipartite graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_disjoint_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[0, 2, 1], [0, 3, 1], [0, 4, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_disjoint_spanning_trees">
<tt class="descname">edge_disjoint_spanning_trees</tt><big>(</big><em>k</em>, <em>root=None</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_disjoint_spanning_trees" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the desired number of edge-disjoint spanning
trees/arborescences.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">k</span></tt> (integer) &#8211; the required number of edge-disjoint
spanning trees/arborescences</li>
<li><tt class="docutils literal"><span class="pre">root</span></tt> (vertex) &#8211; root of the disjoint arborescences
when the graph is directed.
If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the first vertex in the graph is picked.</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>ALGORITHM:</p>
<p>Mixed Integer Linear Program. The formulation can be found
in <a class="reference internal" href="#lpform" id="id9">[LPForm]</a>.</p>
<p>There are at least two possible rewritings of this method
which do not use Linear Programming:</p>
<blockquote>
<div><ul class="simple">
<li>The algorithm presented in the paper entitled &#8220;A short
proof of the tree-packing theorem&#8221;, by Thomas Kaiser
<a class="reference internal" href="#kaispacking" id="id10">[KaisPacking]</a>.</li>
<li>The implementation of a Matroid class and of the Matroid
Union Theorem (see section 42.3 of <a class="reference internal" href="#schrijvercombopt" id="id11">[SchrijverCombOpt]</a>),
applied to the cycle Matroid (see chapter 51 of
<a class="reference internal" href="#schrijvercombopt" id="id12">[SchrijverCombOpt]</a>).</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>The Petersen Graph does have a spanning tree (it is connected):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Though, it does not have 2 edge-disjoint trees (as it has less
than <span class="math">\(2(|V|-1)\)</span> edges):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">This graph does not contain the required number of trees/arborescences !</span>
</pre></div>
</div>
<p>By Edmond&#8217;s theorem, a graph which is <span class="math">\(k\)</span>-connected always has <span class="math">\(k\)</span> edge-disjoint
arborescences, regardless of the root we pick:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span> <span class="c"># reduced from 30 to 28, cf. #9584</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">arborescences</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>  <span class="c"># long time (up to 15s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arborescences</span><span class="p">])</span>  <span class="c"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arborescences</span><span class="p">])</span>  <span class="c"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In the undirected case, we can only ensure half of it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edge_connectivity</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">trees</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">trees</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="lpform" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[LPForm]</a></td><td>Nathann Cohen,
Several Graph problems and their Linear Program formulations,
<a class="reference external" href="http://hal.archives-ouvertes.fr/inria-00504914/en">http://hal.archives-ouvertes.fr/inria-00504914/en</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="kaispacking" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[KaisPacking]</a></td><td>Thomas Kaiser
A short proof of the tree-packing theorem
<a class="reference external" href="http://arxiv.org/abs/0911.2809">Arxiv 0911.2809</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="schrijvercombopt" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[SchrijverCombOpt]</td><td><em>(<a class="fn-backref" href="#id11">1</a>, <a class="fn-backref" href="#id12">2</a>)</em> Alexander Schrijver
Combinatorial optimization: polyhedra and efficiency
2003</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_iterator">
<tt class="descname">edge_iterator</tt><big>(</big><em>vertices=None</em>, <em>labels=True</em>, <em>ignore_direction=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns an iterator over edges.</p>
<p>The iterator returned is over the edges incident with any vertex given
in the parameter <tt class="docutils literal"><span class="pre">vertices</span></tt>. If the graph is directed, iterates over
edges going out only. If vertices is None, then returns an iterator over
all edges. If self is directed, returns outgoing edges only.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - (default: None) a vertex, a list of vertices or None</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> - if False, each edge is a tuple (u,v) of
vertices.</li>
<li><tt class="docutils literal"><span class="pre">ignore_direction</span></tt> - bool (default: False) - only applies
to directed graphs. If True, searches across edges in either
direction.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">([</span><span class="mi">0</span><span class="p">]):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">(0, 1, None)</span>
<span class="go">(0, 4, None)</span>
<span class="go">(0, 5, None)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">([</span><span class="mi">0</span><span class="p">]):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">(0, 1, None)</span>
<span class="go">(0, 2, None)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">[(0, 1), (0, 2), (0, 3), (1, 2), (1, 3), (2, 3)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[(1, 0, None), (2, 0, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_label">
<tt class="descname">edge_label</tt><big>(</big><em>u</em>, <em>v=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_label" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the label of an edge. Note that if the graph allows
multiple edges, then a list of labels on the edge is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span> <span class="p">:</span> <span class="p">{</span><span class="mi">1</span> <span class="p">:</span> <span class="s">&#39;edgelabel&#39;</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_label</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
<span class="go">&#39;edgelabel&#39;</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span> <span class="p">:</span> <span class="p">{</span><span class="mi">1</span> <span class="p">:</span> <span class="s">&#39;edgelabel&#39;</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edge_label</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
<span class="go">&#39;edgelabel&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[None, None, None, None, None]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[1, 2, 3, 4, 5]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, [8]), (0, 2, [7])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edge_labels">
<tt class="descname">edge_labels</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edge_labels" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of edge labels.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s">&#39;z&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="s">&#39;out&#39;</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">()</span>
<span class="go">[&#39;x&#39;, &#39;z&#39;, &#39;a&#39;, &#39;out&#39;]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s">&#39;z&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="s">&#39;out&#39;</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">()</span>
<span class="go">[&#39;x&#39;, &#39;z&#39;, &#39;a&#39;, &#39;out&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edges">
<tt class="descname">edges</tt><big>(</big><em>labels=True</em>, <em>sort=True</em>, <em>key=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of edges.</p>
<p>Each edge is a triple (u,v,l) where u and v are vertices and l is a
label. If the parameter <tt class="docutils literal"><span class="pre">labels</span></tt> is False then a list of couple (u,v)
is returned where u and v are vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">labels</span></tt> - default: <tt class="docutils literal"><span class="pre">True</span></tt> - if <tt class="docutils literal"><span class="pre">False</span></tt>, each
edge is simply a pair (u,v) of vertices.</li>
<li><tt class="docutils literal"><span class="pre">sort</span></tt> - default: <tt class="docutils literal"><span class="pre">True</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, edges are
sorted according to the default ordering.</li>
<li><tt class="docutils literal"><span class="pre">key</span></tt> - default: <tt class="docutils literal"><span class="pre">None</span></tt> - a function  takes an edge
(a pair or a triple, according to the <tt class="docutils literal"><span class="pre">labels</span></tt> keyword)
as its one argument and returns a value that can be used
for comparisons in the sorting algorithm.</li>
</ul>
<p>OUTPUT: A list of tuples. It is safe to change the returned list.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Since any object may be a vertex, there is no guarantee
that any two vertices will be comparable, and thus no
guarantee how two edges may compare.  With default
objects for vertices (all integers), or when all the
vertices are of the same simple type, then there should
not be a problem with how the vertices will be sorted.
However, if you need to guarantee a total order for
the sorting of the edges, use the <tt class="docutils literal"><span class="pre">key</span></tt> argument,
as illustrated in the examples below.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 10, None), (0, 19, None), (1, 2, None), (1, 8, None), (2, 3, None), (2, 6, None), (3, 4, None), (3, 19, None), (4, 5, None), (4, 17, None), (5, 6, None), (5, 15, None), (6, 7, None), (7, 8, None), (7, 14, None), (8, 9, None), (9, 10, None), (9, 13, None), (10, 11, None), (11, 12, None), (11, 18, None), (12, 13, None), (12, 16, None), (13, 14, None), (14, 15, None), (15, 16, None), (16, 17, None), (17, 18, None), (18, 19, None)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 10), (0, 19), (1, 2), (1, 8), (2, 3), (2, 6), (3, 4), (3, 19), (4, 5), (4, 17), (5, 6), (5, 15), (6, 7), (7, 8), (7, 14), (8, 9), (9, 10), (9, 13), (10, 11), (11, 12), (11, 18), (12, 13), (12, 16), (13, 14), (14, 15), (15, 16), (16, 17), (17, 18), (18, 19)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 10, None), (0, 19, None), (1, 0, None), (1, 2, None), (1, 8, None), (2, 1, None), (2, 3, None), (2, 6, None), (3, 2, None), (3, 4, None), (3, 19, None), (4, 3, None), (4, 5, None), (4, 17, None), (5, 4, None), (5, 6, None), (5, 15, None), (6, 2, None), (6, 5, None), (6, 7, None), (7, 6, None), (7, 8, None), (7, 14, None), (8, 1, None), (8, 7, None), (8, 9, None), (9, 8, None), (9, 10, None), (9, 13, None), (10, 0, None), (10, 9, None), (10, 11, None), (11, 10, None), (11, 12, None), (11, 18, None), (12, 11, None), (12, 13, None), (12, 16, None), (13, 9, None), (13, 12, None), (13, 14, None), (14, 7, None), (14, 13, None), (14, 15, None), (15, 5, None), (15, 14, None), (15, 16, None), (16, 12, None), (16, 15, None), (16, 17, None), (17, 4, None), (17, 16, None), (17, 18, None), (18, 11, None), (18, 17, None), (18, 19, None), (19, 0, None), (19, 3, None), (19, 18, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 10), (0, 19), (1, 0), (1, 2), (1, 8), (2, 1), (2, 3), (2, 6), (3, 2), (3, 4), (3, 19), (4, 3), (4, 5), (4, 17), (5, 4), (5, 6), (5, 15), (6, 2), (6, 5), (6, 7), (7, 6), (7, 8), (7, 14), (8, 1), (8, 7), (8, 9), (9, 8), (9, 10), (9, 13), (10, 0), (10, 9), (10, 11), (11, 10), (11, 12), (11, 18), (12, 11), (12, 13), (12, 16), (13, 9), (13, 12), (13, 14), (14, 7), (14, 13), (14, 15), (15, 5), (15, 14), (15, 16), (16, 12), (16, 15), (16, 17), (17, 4), (17, 16), (17, 18), (18, 11), (18, 17), (18, 19), (19, 0), (19, 3), (19, 18)]</span>
</pre></div>
</div>
<p>The default is to sort the returned list in the default fashion, as in the above examples.
this can be overridden by specifying a key function. This first example just ignores
the labels in the third component of the triple.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">[(0, 1, None), (1, 2, None), (2, 3, None), (3, 4, None), (0, 4, None)]</span>
</pre></div>
</div>
<p>We set the labels to characters and then perform a default sort
followed by a sort according to the labels.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(0, 1, &#39;F&#39;), (0, 4, &#39;U&#39;), (1, 2, &#39;L&#39;), (2, 3, &#39;R&#39;), (3, 4, &#39;X&#39;)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[(0, 1, &#39;F&#39;), (1, 2, &#39;L&#39;), (2, 3, &#39;R&#39;), (0, 4, &#39;U&#39;), (3, 4, &#39;X&#39;)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>It is an error to turn off sorting while providing a key function for sorting.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">sort keyword is False, yet a key function is given</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.edges_incident">
<tt class="descname">edges_incident</tt><big>(</big><em>vertices=None</em>, <em>labels=True</em>, <em>sort=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.edges_incident" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns incident edges to some vertices.</p>
<p>If <tt class="docutils literal"><span class="pre">vertices`</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">vertex,</span> <span class="pre">then</span> <span class="pre">it</span> <span class="pre">returns</span> <span class="pre">the</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">edges</span> <span class="pre">incident</span> <span class="pre">to</span>
<span class="pre">that</span> <span class="pre">vertex.</span> <span class="pre">If</span> <span class="pre">``vertices</span></tt> is a list of vertices then it returns the
list of all edges adjacent to those vertices. If <tt class="docutils literal"><span class="pre">vertices</span></tt>
is None, returns a list of all edges in graph. For digraphs, only
lists outward edges.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - object (default: None) - a vertex, a list of vertices
or None.</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> - bool (default: True) - if False, each edge is a tuple
(u,v) of vertices.</li>
<li><tt class="docutils literal"><span class="pre">sort</span></tt> - bool (default: True) - if True the returned list is sorted.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 4), (0, 5), (4, 9), (6, 9), (7, 9)]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># ticket 9581</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[(0, 0, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.eigenspaces">
<tt class="descname">eigenspaces</tt><big>(</big><em>laplacian=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.eigenspaces" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the <em>right</em> eigenspaces of the adjacency matrix of the graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">laplacian</span></tt> - if True, use the Laplacian matrix
(see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix" title="sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">kirchhoff_matrix()</span></tt></a>)</li>
</ul>
<p>OUTPUT:</p>
<p>A list of pairs.  Each pair is an eigenvalue of the
adjacency matrix of the graph, followed by
the vector space that is the eigenspace for that eigenvalue,
when the eigenvectors are placed on the right of the matrix.</p>
<p>For some graphs, some of the the eigenspaces are described
exactly by vector spaces over a
<a class="reference external" href="../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Sage Reference Manual: Algebraic Numbers and Number Fields v6.10)"><tt class="xref py py-func docutils literal"><span class="pre">NumberField()</span></tt></a>.
For numerical eigenvectors use <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eigenvectors" title="sage.graphs.generic_graph.GenericGraph.eigenvectors"><tt class="xref py py-meth docutils literal"><span class="pre">eigenvectors()</span></tt></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">eigenspaces</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(3, Vector space of degree 10 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[1 1 1 1 1 1 1 1 1 1]),</span>
<span class="go">(-2, Vector space of degree 10 and dimension 4 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1  0  0  0 -1 -1 -1  0  1  1]</span>
<span class="go">[ 0  1  0  0 -1  0 -2 -1  1  2]</span>
<span class="go">[ 0  0  1  0 -1  1 -1 -2  0  2]</span>
<span class="go">[ 0  0  0  1 -1  1  0 -1 -1  1]),</span>
<span class="go">(1, Vector space of degree 10 and dimension 5 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1  0  0  0  0  1 -1  0  0 -1]</span>
<span class="go">[ 0  1  0  0  0 -1  1 -1  0  0]</span>
<span class="go">[ 0  0  1  0  0  0 -1  1 -1  0]</span>
<span class="go">[ 0  0  0  1  0  0  0 -1  1 -1]</span>
<span class="go">[ 0  0  0  0  1 -1  0  0 -1  1])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Eigenspaces for the Laplacian should be identical since the
Petersen graph is regular.  However, since the output also
contains the eigenvalues, the two outputs are slightly
different.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">eigenspaces</span><span class="p">(</span><span class="n">laplacian</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 10 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[1 1 1 1 1 1 1 1 1 1]),</span>
<span class="go">(5, Vector space of degree 10 and dimension 4 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1  0  0  0 -1 -1 -1  0  1  1]</span>
<span class="go">[ 0  1  0  0 -1  0 -2 -1  1  2]</span>
<span class="go">[ 0  0  1  0 -1  1 -1 -2  0  2]</span>
<span class="go">[ 0  0  0  1 -1  1  0 -1 -1  1]),</span>
<span class="go">(2, Vector space of degree 10 and dimension 5 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1  0  0  0  0  1 -1  0  0 -1]</span>
<span class="go">[ 0  1  0  0  0 -1  1 -1  0  0]</span>
<span class="go">[ 0  0  1  0  0  0 -1  1 -1  0]</span>
<span class="go">[ 0  0  0  1  0  0  0 -1  1 -1]</span>
<span class="go">[ 0  0  0  0  1 -1  0  0 -1  1])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Notice how one eigenspace below is described with a square root of
2.  For the two possible values (positive and negative) there is a
corresponding eigenspace.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">eigenspaces</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(2, Vector space of degree 8 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[1 1 1 1 1 1 1 1]),</span>
<span class="go">(-2, Vector space of degree 8 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -1  1 -1  1 -1  1 -1]),</span>
<span class="go">(0, Vector space of degree 8 and dimension 2 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1  0 -1  0  1  0 -1  0]</span>
<span class="go">[ 0  1  0 -1  0  1  0 -1]),</span>
<span class="go">(a3, Vector space of degree 8 and dimension 2 over Number Field in a3 with defining polynomial x^2 - 2</span>
<span class="go">User basis matrix:</span>
<span class="go">[  1   0  -1 -a3  -1   0   1  a3]</span>
<span class="go">[  0   1  a3   1   0  -1 -a3  -1])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>A digraph may have complex eigenvalues and eigenvectors.
For a 3-cycle, we have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">eigenspaces</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(1, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[1 1 1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 + x + 1</span>
<span class="go">User basis matrix:</span>
<span class="go">[      1      a1 -a1 - 1])</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.eigenvectors">
<tt class="descname">eigenvectors</tt><big>(</big><em>laplacian=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.eigenvectors" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the <em>right</em> eigenvectors of the adjacency matrix of the graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">laplacian</span></tt> - if True, use the Laplacian matrix
(see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix" title="sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">kirchhoff_matrix()</span></tt></a>)</li>
</ul>
<p>OUTPUT:</p>
<p>A list of triples.  Each triple begins with an eigenvalue of
the adjacency matrix of the graph.  This is followed by
a list of eigenvectors for the eigenvalue, when the
eigenvectors are placed on the right side of the matrix.
Together, the eigenvectors form a basis for the eigenspace.
The triple concludes with the algebraic multiplicity of
the eigenvalue.</p>
<p>For some graphs, the exact eigenspaces provided by
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eigenspaces" title="sage.graphs.generic_graph.GenericGraph.eigenspaces"><tt class="xref py py-meth docutils literal"><span class="pre">eigenspaces()</span></tt></a> provide additional insight into
the structure of the eigenspaces.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">()</span>
<span class="go">[(3, [</span>
<span class="go">(1, 1, 1, 1, 1, 1, 1, 1, 1, 1)</span>
<span class="go">], 1), (-2, [</span>
<span class="go">(1, 0, 0, 0, -1, -1, -1, 0, 1, 1),</span>
<span class="go">(0, 1, 0, 0, -1, 0, -2, -1, 1, 2),</span>
<span class="go">(0, 0, 1, 0, -1, 1, -1, -2, 0, 2),</span>
<span class="go">(0, 0, 0, 1, -1, 1, 0, -1, -1, 1)</span>
<span class="go">], 4), (1, [</span>
<span class="go">(1, 0, 0, 0, 0, 1, -1, 0, 0, -1),</span>
<span class="go">(0, 1, 0, 0, 0, -1, 1, -1, 0, 0),</span>
<span class="go">(0, 0, 1, 0, 0, 0, -1, 1, -1, 0),</span>
<span class="go">(0, 0, 0, 1, 0, 0, 0, -1, 1, -1),</span>
<span class="go">(0, 0, 0, 0, 1, -1, 0, 0, -1, 1)</span>
<span class="go">], 5)]</span>
</pre></div>
</div>
<p>Eigenspaces for the Laplacian should be identical since the
Petersen graph is regular.  However, since the output also
contains the eigenvalues, the two outputs are slightly
different.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">(</span><span class="n">laplacian</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(0, [</span>
<span class="go">(1, 1, 1, 1, 1, 1, 1, 1, 1, 1)</span>
<span class="go">], 1), (5, [</span>
<span class="go">(1, 0, 0, 0, -1, -1, -1, 0, 1, 1),</span>
<span class="go">(0, 1, 0, 0, -1, 0, -2, -1, 1, 2),</span>
<span class="go">(0, 0, 1, 0, -1, 1, -1, -2, 0, 2),</span>
<span class="go">(0, 0, 0, 1, -1, 1, 0, -1, -1, 1)</span>
<span class="go">], 4), (2, [</span>
<span class="go">(1, 0, 0, 0, 0, 1, -1, 0, 0, -1),</span>
<span class="go">(0, 1, 0, 0, 0, -1, 1, -1, 0, 0),</span>
<span class="go">(0, 0, 1, 0, 0, 0, -1, 1, -1, 0),</span>
<span class="go">(0, 0, 0, 1, 0, 0, 0, -1, 1, -1),</span>
<span class="go">(0, 0, 0, 0, 1, -1, 0, 0, -1, 1)</span>
<span class="go">], 5)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">()</span>
<span class="go">[(2, [</span>
<span class="go">(1, 1, 1, 1, 1, 1, 1, 1)</span>
<span class="go">], 1), (-2, [</span>
<span class="go">(1, -1, 1, -1, 1, -1, 1, -1)</span>
<span class="go">], 1), (0, [</span>
<span class="go">(1, 0, -1, 0, 1, 0, -1, 0),</span>
<span class="go">(0, 1, 0, -1, 0, 1, 0, -1)</span>
<span class="go">], 2), (-1.4142135623..., [(1, 0, -1, 1.4142135623..., -1, 0, 1, -1.4142135623...), (0, 1, -1.4142135623..., 1, 0, -1, 1.4142135623..., -1)], 2), (1.4142135623..., [(1, 0, -1, -1.4142135623..., -1, 0, 1, 1.4142135623...), (0, 1, 1.4142135623..., 1, 0, -1, -1.4142135623..., -1)], 2)]</span>
</pre></div>
</div>
<p>A digraph may have complex eigenvalues.  Previously, the complex parts
of graph eigenvalues were being dropped.  For a 3-cycle, we have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">()</span>
<span class="go">[(1, [</span>
<span class="go">(1, 1, 1)</span>
<span class="go">], 1), (-0.5000000000... - 0.8660254037...*I, [(1, -0.5000000000... - 0.8660254037...*I, -0.5000000000... + 0.8660254037...*I)], 1), (-0.5000000000... + 0.8660254037...*I, [(1, -0.5000000000... + 0.8660254037...*I, -0.5000000000... - 0.8660254037...*I)], 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.eulerian_circuit">
<tt class="descname">eulerian_circuit</tt><big>(</big><em>return_vertices=False</em>, <em>labels=True</em>, <em>path=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.eulerian_circuit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of edges forming an eulerian circuit if one exists.
Otherwise return False.</p>
<p>This is implemented using Hierholzer&#8217;s algorithm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">return_vertices</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) optionally provide a list of
vertices for the path</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">True</span></tt>) whether to return edges with labels
(3-tuples)</li>
<li><tt class="docutils literal"><span class="pre">path</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) find an eulerian path instead</li>
</ul>
<p>OUTPUT:</p>
<p>either ([edges], [vertices]) or [edges] of an Eulerian circuit (or path)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">()</span>
<span class="go">[(0, 4, None), (4, 3, None), (3, 2, None), (2, 1, None), (1, 0, None)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 4), (4, 3), (3, 2), (2, 1), (1, 0)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">edges</span><span class="p">,</span> <span class="n">vertices</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">(</span><span class="n">return_vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">vertices</span>
<span class="go">[0, 6, 5, 4, 6, 3, 5, 2, 4, 3, 2, 6, 1, 5, 0, 4, 1, 3, 0, 2, 1, 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A disconnected graph can be eulerian:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(1, 3), (3, 2), (2, 1)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(0, 1), (1, 2), (2, 3), (3, 1), (1, 4)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(1, 3), (3, 4), (4, 2), (2, 3), (3, 0), (0, 2), (2, 1), (1, 0)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">({</span><span class="s">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;G&#39;</span><span class="p">,</span><span class="s">&#39;L&#39;</span><span class="p">,</span><span class="s">&#39;L&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">],</span> <span class="s">&#39;L&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;G&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">]})</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(&#39;H&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;L&#39;), (&#39;L&#39;, &#39;G&#39;), (&#39;G&#39;, &#39;H&#39;), (&#39;H&#39;, &#39;L&#39;), (&#39;L&#39;, &#39;H&#39;)]</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span><span class="o">.</span><span class="n">eulerian_circuit</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (1, 0), (0, 1), (1, 0), (0, 0)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.eulerian_orientation">
<tt class="descname">eulerian_orientation</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.eulerian_orientation" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a DiGraph which is an Eulerian orientation of the current graph.</p>
<p>An Eulerian graph being a graph such that any vertex has an even degree,
an Eulerian orientation of a graph is an orientation of its edges such
that each vertex <span class="math">\(v\)</span> verifies <span class="math">\(d^+(v)=d^-(v)=d(v)/2\)</span>, where <span class="math">\(d^+\)</span> and
<span class="math">\(d^-\)</span> respectively represent the out-degree and the in-degree of a vertex.</p>
<p>If the graph is not Eulerian, the orientation verifies for any vertex <span class="math">\(v\)</span>
that <span class="math">\(| d^+(v)-d^-(v) | \leq 1\)</span>.</p>
<p>ALGORITHM:</p>
<p>This algorithm is a random walk through the edges of the graph, which
orients the edges according to the walk. When a vertex is reached which
has no non-oriented edge ( this vertex must have odd degree ), the
walk resumes at another vertex of odd degree, if any.</p>
<p>This algorithm has complexity <span class="math">\(O(m)\)</span>, where <span class="math">\(m\)</span> is the number of edges
in the graph.</p>
<p>EXAMPLES:</p>
<p>The CubeGraph with parameter 4, which is regular of even degree, has an
Eulerian orientation such that <span class="math">\(d^+=d^-\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">[4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">eulerian_orientation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span>
<span class="go">[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]</span>
</pre></div>
</div>
<p>Secondly, the Petersen Graph, which is 3 regular has an orientation
such that the difference between <span class="math">\(d^+\)</span> and <span class="math">\(d^-\)</span> is at most 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">eulerian_orientation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span>
<span class="go">[2, 2, 2, 2, 2, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">[1, 1, 1, 1, 1, 2, 2, 2, 2, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.export_to_file">
<tt class="descname">export_to_file</tt><big>(</big><em>filename</em>, <em>format=None</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.export_to_file" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Export the graph to a file.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">filename</span></tt> (string) &#8211; a file name.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">format</span></tt> (string) &#8211; select the output format explicitly. If set to
<tt class="docutils literal"><span class="pre">None</span></tt> (default), the format is set to be the file extension of
<tt class="docutils literal"><span class="pre">filename</span></tt>. Admissible formats are: <tt class="docutils literal"><span class="pre">adjlist</span></tt>, <tt class="docutils literal"><span class="pre">dot</span></tt>,
<tt class="docutils literal"><span class="pre">edgelist</span></tt>, <tt class="docutils literal"><span class="pre">gexf</span></tt>, <tt class="docutils literal"><span class="pre">gml</span></tt>, <tt class="docutils literal"><span class="pre">graphml</span></tt>, <tt class="docutils literal"><span class="pre">multiline_adjlist</span></tt>,
<tt class="docutils literal"><span class="pre">pajek</span></tt>, <tt class="docutils literal"><span class="pre">yaml</span></tt>.</p>
</li>
<li><p class="first">All other arguments are forwarded to the subfunction. For more
information, see their respective documentation:</p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">adjlist</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.adjlist.write_adjlist.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.adjlist.write_adjlist.html</a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">dot</span></tt></td>
<td><a class="reference external" href="https://networkx.github.io/documentation/latest/reference/generated/networkx.drawing.nx_pydot.write_dot.html">https://networkx.github.io/documentation/latest/reference/generated/networkx.drawing.nx_pydot.write_dot.html</a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">edgelist</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.edgelist.write_edgelist.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.edgelist.write_edgelist.html</a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">gexf</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.gexf.write_gexf.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.gexf.write_gexf.html</a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">gml</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.gml.write_gml.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.gml.write_gml.html</a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">graphml</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.graphml.write_graphml.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.graphml.write_graphml.html</a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">multiline_adjlist</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.multiline_adjlist.write_multiline_adjlist.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.multiline_adjlist.write_multiline_adjlist.html</a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">pajek</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.pajek.write_pajek.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.pajek.write_pajek.html</a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">yaml</span></tt></td>
<td><a class="reference external" href="http://networkx.lanl.gov/reference/generated/networkx.readwrite.nx_yaml.write_yaml.html">http://networkx.lanl.gov/reference/generated/networkx.readwrite.nx_yaml.write_yaml.html</a></td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject.save" title="(in Sage Reference Manual: Basic Structures v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">save()</span></tt></a> &#8211; save a Sage
object to a &#8216;sobj&#8217; file (preserves all its attributes).</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This functions uses the <tt class="docutils literal"><span class="pre">write_*</span></tt> functions defined in NetworkX
(see <a class="reference external" href="http://networkx.lanl.gov/reference/readwrite.html">http://networkx.lanl.gov/reference/readwrite.html</a>).</p>
</div>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">filename</span> <span class="o">=</span> <span class="n">tmp_filename</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s">&quot;.pajek&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="n">G_networkx</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">read_pajek</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="n">G_networkx</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">filename</span> <span class="o">=</span> <span class="n">tmp_filename</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s">&quot;.edgelist&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">networkx</span><span class="o">.</span><span class="n">read_edgelist</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span><span class="s">&quot;hey&quot;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&quot;When I feel heavy metaaaaaallll...&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Format &#39;When I feel heavy metaaaaaallll...&#39; unknown.</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span><span class="s">&quot;my_file.Yeeeeppeeeeee&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The file format could not be guessed from &#39;my_file.Yeeeeppeeeeee&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.faces">
<tt class="descname">faces</tt><big>(</big><em>embedding=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.faces" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the faces of an embedded graph.</p>
<p>A combinatorial embedding of a graph is a clockwise ordering of the
neighbors of each vertex. From this information one can define the faces
of the embedding, which is what this method returns.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">embedding</span></tt> - a combinatorial embedding dictionary. Format:
<tt class="docutils literal"><span class="pre">{v1:[v2,v3],</span> <span class="pre">v2:[v1],</span> <span class="pre">v3:[v1]}</span></tt> (clockwise ordering of neighbors at
each vertex). If set to <tt class="docutils literal"><span class="pre">None</span></tt> (default) the method will use the
embedding stored as <tt class="docutils literal"><span class="pre">self._embedding</span></tt>. If none is stored, the method
will compute the set of faces from the embedding returned by
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_planar" title="sage.graphs.generic_graph.GenericGraph.is_planar"><tt class="xref py py-meth docutils literal"><span class="pre">is_planar()</span></tt></a> (if the graph is, of course, planar).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">embedding</span></tt> is an ordered list based on the hash order of the
vertices of graph. To avoid confusion, it might be best to set the
rot_sys based on a &#8216;nice_copy&#8217; of the graph.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.set_embedding" title="sage.graphs.generic_graph.GenericGraph.set_embedding"><tt class="xref py py-meth docutils literal"><span class="pre">set_embedding()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.get_embedding" title="sage.graphs.generic_graph.GenericGraph.get_embedding"><tt class="xref py py-meth docutils literal"><span class="pre">get_embedding()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.is_planar" title="sage.graphs.generic_graph.GenericGraph.is_planar"><tt class="xref py py-meth docutils literal"><span class="pre">is_planar()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">faces</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="go">[[(0, 1), (1, 2), (2, 0)],</span>
<span class="go"> [(3, 2), (2, 1), (1, 3)],</span>
<span class="go"> [(2, 3), (3, 0), (0, 2)],</span>
<span class="go"> [(0, 3), (3, 1), (1, 0)]]</span>
</pre></div>
</div>
<p>With no embedding provided:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span><span class="o">.</span><span class="n">faces</span><span class="p">()</span>
<span class="go">[[(0, 1), (1, 2), (2, 0)],</span>
<span class="go"> [(3, 2), (2, 1), (1, 3)],</span>
<span class="go"> [(2, 3), (3, 0), (0, 2)],</span>
<span class="go"> [(0, 3), (3, 1), (1, 0)]]</span>
</pre></div>
</div>
<p>With no embedding provided (non-planar graph):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">faces</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">No embedding is provided and the graph is not planar.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.feedback_vertex_set">
<tt class="descname">feedback_vertex_set</tt><big>(</big><em>value_only=False</em>, <em>solver=None</em>, <em>verbose=0</em>, <em>constraint_generation=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.feedback_vertex_set" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes the minimum feedback vertex set of a (di)graph.</p>
<p>The minimum feedback vertex set of a (di)graph is a set of vertices that
intersect all of its cycles.  Equivalently, a minimum feedback vertex
set of a (di)graph is a set <span class="math">\(S\)</span> of vertices such that the digraph <span class="math">\(G-S\)</span>
is acyclic. For more information, see <a class="reference external" href="https://en.wikipedia.org/wiki/Feedback_vertex_set">Wikipedia article Feedback_vertex_set</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, only the minimum cardinal of a minimum vertex
set is returned.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, the <tt class="docutils literal"><span class="pre">Set</span></tt> of vertices of a minimal feedback
vertex set is returned.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used,
see the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
<li><tt class="docutils literal"><span class="pre">constraint_generation</span></tt> (boolean) &#8211; whether to use constraint
generation when solving the Mixed Integer Linear Program (default:
<tt class="docutils literal"><span class="pre">True</span></tt>).</li>
</ul>
<p>ALGORITHMS:</p>
<p>(Constraints generation)</p>
<p>When the parameter <tt class="docutils literal"><span class="pre">constraint_generation</span></tt> is enabled (default) the
following MILP formulation is used to solve the problem:</p>
<div class="math">
\[\begin{split}\mbox{Minimize : }&amp;\sum_{v\in G} b_{v}\\
\mbox{Such that : }&amp;\\
&amp;\forall C\text{ circuits }\subseteq G, \sum_{v\in C}b_{v}\geq 1\\\end{split}\]</div>
<p>As the number of circuits contained in a graph is exponential, this LP
is solved through constraint generation. This means that the solver is
sequentially asked to solve the problem, knowing only a portion of the
circuits contained in <span class="math">\(G\)</span>, each time adding to the list of its
constraints the circuit which its last answer had left intact.</p>
<p>(Another formulation based on an ordering of the vertices)</p>
<p>When the graph is directed, a second (and very slow) formulation is
available, which should only be used to check the result of the first
implementation in case of doubt.</p>
<div class="math">
\[\begin{split}\mbox{Minimize : }&amp;\sum_{v\in G} b_v\\
\mbox{Such that : }&amp;\\
&amp;\forall (u,v)\in G, d_u-d_v+nb_u+nb_v\geq 0\\
&amp;\forall u\in G, 0\leq d_u\leq |G|\\\end{split}\]</div>
<p>A brief explanation:</p>
<p>An acyclic digraph can be seen as a poset, and every poset has a linear
extension. This means that in any acyclic digraph the vertices can be
ordered with a total order <span class="math">\(&lt;\)</span> in such a way that if <span class="math">\((u,v)\in G\)</span>, then
<span class="math">\(u&lt;v\)</span>.  Thus, this linear program is built in order to assign to each
vertex <span class="math">\(v\)</span> a number <span class="math">\(d_v\in [0,\dots,n-1]\)</span> such that if there exists an
edge <span class="math">\((u,v)\in G\)</span> then either <span class="math">\(d_v&lt;d_u\)</span> or one of <span class="math">\(u\)</span> or <span class="math">\(v\)</span> is removed.
The number of vertices removed is then minimized, which is the
objective.</p>
<p>EXAMPLES:</p>
<p>The necessary example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fvs</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">feedback_vertex_set</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">fvs</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">fvs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_forest</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In a digraph built from a graph, any edge is replaced by arcs going in
the two opposite directions, thus creating a cycle of length two.
Hence, to remove all the cycles from the graph, each edge must see one
of its neighbors removed: a feedback vertex set is in this situation a
vertex cover:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cycle</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dcycle</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cycle</span><span class="o">.</span><span class="n">vertex_cover</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">feedback</span> <span class="o">=</span> <span class="n">dcycle</span><span class="o">.</span><span class="n">feedback_vertex_set</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">feedback</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">cycle</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="ow">in</span> <span class="n">feedback</span> <span class="ow">or</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">feedback</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a circuit, the minimum feedback arc set is clearly <span class="math">\(1\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">circuit</span><span class="o">.</span><span class="n">feedback_vertex_set</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Comparing with/without constraint generation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">feedback_vertex_set</span><span class="p">(</span><span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">feedback_vertex_set</span><span class="p">(</span><span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
<span class="go">....:          constraint_generation = False)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Bad algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">feedback_vertex_set</span><span class="p">(</span><span class="n">constraint_generation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The only implementation available for undirected graphs is with constraint_generation set to True.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.flow">
<tt class="descname">flow</tt><big>(</big><em>x</em>, <em>y</em>, <em>value_only=True</em>, <em>integer=False</em>, <em>use_edge_labels=True</em>, <em>vertex_bound=False</em>, <em>algorithm=None</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.flow" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a maximum flow in the graph from <tt class="docutils literal"><span class="pre">x</span></tt> to <tt class="docutils literal"><span class="pre">y</span></tt>
represented by an optimal valuation of the edges. For more
information, see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Max_flow">Wikipedia article on maximum flow</a>.</p>
<p>As an optimization problem, is can be expressed this way :</p>
<div class="math">
\[\begin{split}\mbox{Maximize : }&amp;\sum_{e\in G.edges()} w_e b_e\\
\mbox{Such that : }&amp;\forall v \in G, \sum_{(u,v)\in G.edges()} b_{(u,v)}\leq 1\\
&amp;\forall x\in G, b_x\mbox{ is a binary variable}\end{split}\]</div>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">x</span></tt> &#8211; Source vertex</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">y</span></tt> &#8211; Sink vertex</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>)</p>
<ul class="simple">
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, only the value of a maximal
flow is returned.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, is returned a pair whose first element
is the value of the maximum flow, and whose second value is
a flow graph (a copy of the current graph, such that each edge
has the flow using it as a label, the edges without flow being
omitted).</li>
</ul>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">integer</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>)</p>
<ul class="simple">
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, computes an optimal solution under the
constraint that the flow going through an edge has to be an
integer.</li>
</ul>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>)</p>
<ul class="simple">
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, computes a maximum flow
where each edge has a capacity defined by its label. (If
an edge has no label, <span class="math">\(1\)</span> is assumed.)</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, each edge has capacity <span class="math">\(1\)</span>.</li>
</ul>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertex_bound</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)</p>
<ul class="simple">
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, sets the maximum flow leaving
a vertex different from <span class="math">\(x\)</span> to <span class="math">\(1\)</span> (useful for vertex
connectivity parameters).</li>
</ul>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; There are currently three different
implementations of this method:</p>
<blockquote>
<div><ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;FF&quot;</span></tt>, a Python implementation of the
Ford-Fulkerson algorithm is used (only available when
<tt class="docutils literal"><span class="pre">vertex_bound</span> <span class="pre">=</span> <span class="pre">False</span></tt>)</li>
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;LP&quot;</span></tt>, the flow problem is solved using
Linear Programming.</li>
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;igraph&quot;</span></tt>, the igraph implementation of the
Goldberg-Tarjan algorithm is used (only available when
igraph is installed and <tt class="docutils literal"><span class="pre">vertex_bound</span> <span class="pre">=</span> <span class="pre">False</span></tt>)</li>
<li>If <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">None</span></tt> (default), we use <tt class="docutils literal"><span class="pre">LP</span></tt> if
<tt class="docutils literal"><span class="pre">vertex_bound</span> <span class="pre">=</span> <span class="pre">True</span></tt>, otherwise, we use <tt class="docutils literal"><span class="pre">igraph</span></tt> if
it is available, <tt class="docutils literal"><span class="pre">FF</span></tt> if it is not available.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; Specify a Linear Program solver to be used.
If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used.  function of
<tt class="docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt>. See the documentation of
<tt class="docutils literal"><span class="pre">MixedIntegerLinearProgram.solve</span></tt> for more information.</p>
<p>Only useful when LP is used to solve the flow problem.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">verbose</span></tt> (integer) &#8211; sets the level of verbosity. Set to 0
by default (quiet).</p>
<p>Only useful when LP is used to solve the flow problem.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Even though the three different implementations are meant to
return the same Flow values, they can not be expected to
return the same Flow graphs.</p>
<p class="last">Besides, the use of Linear Programming may possibly mean a
(slight) numerical noise.</p>
</div>
<p>EXAMPLES:</p>
<p>Two basic applications of the flow method for the <tt class="docutils literal"><span class="pre">PappusGraph</span></tt> and the
<tt class="docutils literal"><span class="pre">ButterflyGraph</span></tt> with parameter <span class="math">\(2\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PappusGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">int</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">b</span><span class="o">=</span><span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">flow</span><span class="p">((</span><span class="s">&#39;00&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s">&#39;00&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The flow method can be used to compute a matching in a bipartite graph
by linking a source <span class="math">\(s\)</span> to all the vertices of the first set and linking
a sink <span class="math">\(t\)</span> to all the vertices of the second set, then computing
a maximum <span class="math">\(s-t\)</span> flow</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">cardinal</span><span class="p">,</span> <span class="n">flow_graph</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">,</span><span class="n">integer</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">flow_graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">([</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">flow_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The undirected case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">cardinal</span><span class="p">,</span> <span class="n">flow_graph</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">,</span><span class="n">integer</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">flow_graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">([</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">flow_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">4</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>An exception if raised when forcing &#8220;FF&#8221; or &#8220;igraph&#8221; with <tt class="docutils literal"><span class="pre">vertex_bound</span> <span class="pre">=</span> <span class="pre">True</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vertex_bound</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&quot;FF&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This method does not support both vertex_bound=True and algorithm=&#39;FF&#39;.</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vertex_bound</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&quot;igraph&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This method does not support both vertex_bound=True and algorithm=&#39;igraph&#39;.</span>
</pre></div>
</div>
<p>Or if the method is different from the expected values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Divination&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The algorithm argument has to be equal to either &quot;FF&quot;, &quot;LP&quot;, &quot;igraph&quot;, or None</span>
</pre></div>
</div>
<p>The two algorithms are indeed returning the same results (possibly with
some numerical noise, cf. <a class="reference external" href="http://trac.sagemath.org/12362">trac ticket #12362</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>     <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">flow_ff</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;FF&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">flow_lp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;LP&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">flow_ff</span><span class="o">-</span><span class="n">flow_lp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">flow_igraph</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;igraph&quot;</span><span class="p">)</span> <span class="c"># optional python_igraph</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">flow_ff</span><span class="o">-</span><span class="n">flow_igraph</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.00001</span>         <span class="c"># optional python_igraph</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.genus">
<tt class="descname">genus</tt><big>(</big><em>set_embedding=True</em>, <em>on_embedding=None</em>, <em>minimal=True</em>, <em>maximal=False</em>, <em>circular=None</em>, <em>ordered=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.genus" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the minimal genus of the graph.</p>
<p>The genus of a compact surface is the number of handles it
has. The genus of a graph is the minimal genus of the surface
it can be embedded into.</p>
<p>Note - This function uses Euler&#8217;s formula and thus it is necessary
to consider only connected graphs.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">set_embedding</span> <span class="pre">(boolean)</span></tt> - whether or not to
store an embedding attribute of the computed (minimal) genus of the
graph. (Default is True).</li>
<li><tt class="docutils literal"><span class="pre">on_embedding</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) - two kinds of input are allowed:<ul>
<li>a dictionnary representing a combinatorial embedding on which the
genus should be computed. Note that this must be a valid embedding
for the graph. The dictionary structure is given by: <tt class="docutils literal"><span class="pre">vertex1:</span>
<span class="pre">[neighbor1,</span> <span class="pre">neighbor2,</span> <span class="pre">neighbor3],</span> <span class="pre">vertex2:</span> <span class="pre">[neighbor]</span></tt> where
there is a key for each vertex in the graph and a (clockwise)
ordered list of each vertex&#8217;s neighbors as values. The value of
<tt class="docutils literal"><span class="pre">on_embedding</span></tt> takes precedence over a stored <tt class="docutils literal"><span class="pre">_embedding</span></tt>
attribute if minimal is set to <tt class="docutils literal"><span class="pre">False</span></tt>.</li>
<li>The value <tt class="docutils literal"><span class="pre">True</span></tt>, in order to indicate that the embedding stored
as <tt class="docutils literal"><span class="pre">_embedding</span></tt> should be used (see examples).</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">minimal</span> <span class="pre">(boolean)</span></tt> - whether or not to compute
the minimal genus of the graph (i.e., testing all embeddings). If
minimal is False, then either maximal must be True or on_embedding
must not be None. If on_embedding is not None, it will take
priority over minimal. Similarly, if maximal is True, it will take
priority over minimal.</li>
<li><tt class="docutils literal"><span class="pre">maximal</span> <span class="pre">(boolean)</span></tt> - whether or not to compute
the maximal genus of the graph (i.e., testing all embeddings). If
maximal is False, then either minimal must be True or on_embedding
must not be None. If on_embedding is not None, it will take
priority over maximal. However, maximal takes priority over the
default minimal.</li>
<li><tt class="docutils literal"><span class="pre">circular</span> <span class="pre">(list)</span></tt> - if <tt class="docutils literal"><span class="pre">circular</span></tt> is a list of vertices, the
method computes the genus preserving a planar embedding of the this
list. If circular is defined, <tt class="docutils literal"><span class="pre">on_embedding</span></tt> is not a valid
option. It is set to <tt class="docutils literal"><span class="pre">None</span></tt> by default.</li>
<li><tt class="docutils literal"><span class="pre">ordered</span> <span class="pre">(boolean)</span></tt> - if circular is True, then
whether or not the boundary order may be permuted. (Default is
True, which means the boundary order is preserved.)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span> <span class="c"># tests for minimal genus by default</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">on_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">maximal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># on_embedding overrides minimal and maximal arguments</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">maximal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># setting maximal to True overrides default minimal=True</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">on_embedding</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">())</span> <span class="c"># can also send a valid combinatorial embedding dict</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K23</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K23</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K33</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K33</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Using the circular argument, we can compute the minimal genus
preserving a planar, ordered boundary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cube</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">circular</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;01&#39;</span><span class="p">,</span><span class="s">&#39;10&#39;</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">is_circular_planar</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">circular</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;01&#39;</span><span class="p">,</span><span class="s">&#39;10&#39;</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">circular</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;01&#39;</span><span class="p">,</span><span class="s">&#39;10&#39;</span><span class="p">],</span> <span class="n">on_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">circular</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;01&#39;</span><span class="p">,</span><span class="s">&#39;10&#39;</span><span class="p">],</span> <span class="n">maximal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Cannot compute the maximal genus of a genus respecting a boundary.</span>
</pre></div>
</div>
<p>Note: not everything works for multigraphs, looped graphs or digraphs.  But the
minimal genus is ultimately computable for every connected graph &#8211; but the
embedding we obtain for the simple graph can&#8217;t be easily converted to an
embedding of a non-simple graph.  Also, the maximal genus of a multigraph does
not trivially correspond to that of its simple graph.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Can&#39;t work with embeddings of non-simple graphs</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">to_simple</span><span class="p">()</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">set_embedding</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">genus</span><span class="p">(</span><span class="n">maximal</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">set_embedding</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Can&#39;t compute the maximal genus of a graph with loops or multiple edges</span>
</pre></div>
</div>
<p>We break graphs with cut vertices into their blocks, which greatly speeds up
computation of minimal genus.  This is not implemented for maximal genus.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">k</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="o">+</span><span class="mi">5</span><span class="p">),</span><span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span>      <span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="gp">... </span>      <span class="n">s</span> <span class="o">+=</span> <span class="mi">4</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.get_embedding">
<tt class="descname">get_embedding</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.get_embedding" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the attribute _embedding if it exists.</p>
<p><tt class="docutils literal"><span class="pre">_embedding</span></tt> is a dictionary organized with vertex labels as keys and a
list of each vertex&#8217;s neighbors in clockwise order.</p>
<p>Error-checked to insure valid embedding is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">()</span>
<span class="go">{0: [1, 4, 5], 1: [0, 2, 6], 2: [1, 3, 7], 3: [2, 4, 8], 4: [0, 3, 9], 5: [0, 7, 8], 6: [1, 9, 8], 7: [2, 5, 9], 8: [3, 6, 5], 9: [4, 6, 7]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.get_pos">
<tt class="descname">get_pos</tt><big>(</big><em>dim=2</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.get_pos" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the position dictionary, a dictionary specifying the
coordinates of each vertex.</p>
<p>EXAMPLES: By default, the position of a graph is None:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">save_pos</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>Some of the named graphs come with a pre-specified positioning:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="go">{0: (...e-17, 1.0),</span>
<span class="go"> ...</span>
<span class="go"> 9: (0.475..., 0.154...)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.get_vertex">
<tt class="descname">get_vertex</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.get_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Retrieve the object associated with a given vertex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertex</span></tt> - the given vertex</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">(),</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">FlowerSnark</span><span class="p">(),</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">MoebiusKantorGraph</span><span class="p">(),</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span> <span class="p">}</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">Moebius-Kantor Graph: Graph on 16 vertices</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Flower Snark: Graph on 20 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.get_vertices">
<tt class="descname">get_vertices</tt><big>(</big><em>verts=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.get_vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a dictionary of the objects associated to each vertex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">verts</span></tt> - iterable container of vertices</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">(),</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">FlowerSnark</span><span class="p">(),</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">MoebiusKantorGraph</span><span class="p">(),</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span> <span class="p">}</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">{1: Flower Snark: Graph on 20 vertices,</span>
<span class="go"> 2: Moebius-Kantor Graph: Graph on 16 vertices}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.girth">
<tt class="descname">girth</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.girth" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes the girth of the graph. For directed graphs, computes the
girth of the undirected graph.</p>
<p>The girth is the length of the shortest cycle in the graph. Graphs
without cycles have infinite girth.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">trees</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.odd_girth" title="sage.graphs.graph.Graph.odd_girth"><tt class="xref py py-meth docutils literal"><span class="pre">odd_girth()</span></tt></a> &#8211; computes
the odd girth of a graph.</li>
</ul>
</div>
<p>TESTS:</p>
<p>Prior to <a class="reference external" href="http://trac.sagemath.org/12243">trac ticket #12243</a>, the girth computation assumed
vertices were integers (and failed).  The example below
tests the computation for graphs with vertices that are
not integers.  In this example the vertices are sets.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">OddGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;class &#39;sage.sets.set.Set_object_enumerated_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Ticket <a class="reference external" href="http://trac.sagemath.org/12355">trac ticket #12355</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Girth &lt; 3 (see <a class="reference external" href="http://trac.sagemath.org/12355">trac ticket #12355</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.graphplot">
<tt class="descname">graphplot</tt><big>(</big><em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.graphplot" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a GraphPlot object.</p>
<p>EXAMPLES:</p>
<p>Creating a graphplot object uses the same options as graph.plot():</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;f&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;f&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;h&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">GP</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">graphplot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">color_by_label</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">edge_style</span><span class="o">=</span><span class="s">&#39;dashed&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">GP</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 22 graphics primitives</span>
</pre></div>
</div>
<p>We can modify the graphplot object.  Notice that the changes are cumulative:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">GP</span><span class="o">.</span><span class="n">set_edges</span><span class="p">(</span><span class="n">edge_style</span><span class="o">=</span><span class="s">&#39;solid&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">GP</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 22 graphics primitives</span>
<span class="gp">sage: </span><span class="n">GP</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">(</span><span class="n">talk</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">GP</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 22 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.graphviz_string">
<tt class="descname">graphviz_string</tt><big>(</big><em>rankdir='down'</em>, <em>edge_color=None</em>, <em>vertex_labels=True</em>, <em>edge_labels=False</em>, <em>labels='string'</em>, <em>color_by_label=False</em>, <em>edge_colors=None</em>, <em>edge_options=()</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.graphviz_string" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a representation in the <span class="math">\(dot\)</span> language.</p>
<p>The <span class="math">\(dot\)</span> language is a text based format for graphs. It is used
by the software suite <span class="math">\(graphviz\)</span>. The specifications of the
language are available on the web (see the reference <a class="reference internal" href="#dotspec" id="id13">[dotspec]</a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">labels</span></tt> &#8211; &#8220;string&#8221; or &#8220;latex&#8221; (default: &#8220;string&#8221;). If
labels is string latex command are not interpreted. This
option stands for both vertex labels and edge labels.</li>
<li><tt class="docutils literal"><span class="pre">vertex_labels</span></tt> &#8211; boolean (default: True) whether to add
the labels on vertices.</li>
<li><tt class="docutils literal"><span class="pre">edge_labels</span></tt> &#8211; boolean (default: False) whether to add
the labels on edges.</li>
<li><tt class="docutils literal"><span class="pre">edge_color</span></tt> &#8211; (default: None) specify a default color
for the edges.</li>
<li><tt class="docutils literal"><span class="pre">edge_colors</span></tt> &#8211; (default: None) a dictionary whose keys
are colors and values are list of edges. The list of edges
need not to be complete in which case the default color is
used.</li>
<li><tt class="docutils literal"><span class="pre">color_by_label</span></tt> &#8211; (default: False) a boolean or
dictionary or function whether to color each edge with a
different color according to its label; the colors are
chosen along a rainbow, unless they are specified by a
function or dictionary mapping labels to colors; this option
is incompatible with <tt class="docutils literal"><span class="pre">edge_color</span></tt> and <tt class="docutils literal"><span class="pre">edge_colors</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">edge_options</span></tt> &#8211; a function (or tuple thereof) mapping
edges to a dictionary of options for this edge.</li>
<li><tt class="docutils literal"><span class="pre">rankdir</span></tt> &#8211; &#8216;left&#8217;, &#8216;right&#8217;, &#8216;up&#8217;, or &#8216;down&#8217;
(default: &#8216;down&#8217;, for consistency with <span class="math">\(graphviz\)</span>):
the preferred ranking direction for acyclic layouts;
see the <span class="math">\(rankdir\)</span> option of <span class="math">\(graphviz\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s">&#39;foo&#39;</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="s">&#39;foo&#39;</span><span class="p">}},</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">graph {</span>
<span class="go">  node_0  [label=&quot;0&quot;];</span>
<span class="go">  node_1  [label=&quot;1&quot;];</span>
<span class="go">  node_2  [label=&quot;2&quot;];</span>
<span class="go">  node_3  [label=&quot;3&quot;];</span>

<span class="go">  node_0 -- node_1;</span>
<span class="go">  node_0 -- node_2;</span>
<span class="go">  node_1 -- node_2;</span>
<span class="go">  node_2 -- node_3 [label=&quot;foo&quot;];</span>
<span class="go">}</span>
</pre></div>
</div>
<p>A variant, with the labels in latex, for post-processing with <tt class="docutils literal"><span class="pre">dot2tex</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="s">&quot;latex&quot;</span><span class="p">)</span>
<span class="go">graph {</span>
<span class="go">  node [shape=&quot;plaintext&quot;];</span>
<span class="go">  node_0  [label=&quot; &quot;, texlbl=&quot;$0$&quot;];</span>
<span class="go">  node_1  [label=&quot; &quot;, texlbl=&quot;$1$&quot;];</span>
<span class="go">  node_2  [label=&quot; &quot;, texlbl=&quot;$2$&quot;];</span>
<span class="go">  node_3  [label=&quot; &quot;, texlbl=&quot;$3$&quot;];</span>

<span class="go">  node_0 -- node_1;</span>
<span class="go">  node_0 -- node_2;</span>
<span class="go">  node_1 -- node_2;</span>
<span class="go">  node_2 -- node_3 [label=&quot; &quot;, texlbl=&quot;$\text{\texttt{foo}}$&quot;];</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Same, with a digraph and a color for edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span><span class="s">&#39;foo&#39;</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{}}</span> <span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">edge_color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="go">digraph {</span>
<span class="go">  node_0  [label=&quot;0&quot;];</span>
<span class="go">  node_1  [label=&quot;1&quot;];</span>
<span class="go">  node_2  [label=&quot;2&quot;];</span>
<span class="go">  node_3  [label=&quot;3&quot;];</span>

<span class="go">edge [color=&quot;red&quot;];</span>
<span class="go">  node_0 -&gt; node_1;</span>
<span class="go">  node_0 -&gt; node_2;</span>
<span class="go">  node_1 -&gt; node_2;</span>
<span class="go">  node_2 -&gt; node_3;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>A digraph using latex labels for vertices and edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s">&quot;latex&quot;</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># random</span>
<span class="go">digraph {</span>
<span class="go">  node [shape=&quot;plaintext&quot;];</span>
<span class="go">  node_10  [label=&quot; &quot;, texlbl=&quot;$1$&quot;];</span>
<span class="go">  node_11  [label=&quot; &quot;, texlbl=&quot;$2$&quot;];</span>
<span class="go">  node_3  [label=&quot; &quot;, texlbl=&quot;$-\frac{1}{2}$&quot;];</span>
<span class="go">  node_6  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{2}$&quot;];</span>
<span class="go">  node_7  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{2}$&quot;];</span>
<span class="go">  node_5  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{3}$&quot;];</span>
<span class="go">  node_8  [label=&quot; &quot;, texlbl=&quot;$\frac{2}{3}$&quot;];</span>
<span class="go">  node_4  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{4}$&quot;];</span>
<span class="go">  node_1  [label=&quot; &quot;, texlbl=&quot;$-2$&quot;];</span>
<span class="go">  node_9  [label=&quot; &quot;, texlbl=&quot;$\frac{4}{5}$&quot;];</span>
<span class="go">  node_0  [label=&quot; &quot;, texlbl=&quot;$-4$&quot;];</span>
<span class="go">  node_2  [label=&quot; &quot;, texlbl=&quot;$-1$&quot;];</span>

<span class="go">  node_10 -&gt; node_2 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ -\frac{1}{x}$&quot;];</span>
<span class="go">  node_10 -&gt; node_6 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ \frac{1}{x + 1}$&quot;];</span>
<span class="go">  node_11 -&gt; node_3 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ -\frac{1}{x}$&quot;];</span>
<span class="go">  node_11 -&gt; node_5 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ \frac{1}{x + 1}$&quot;];</span>
<span class="go">  node_7 -&gt; node_1 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ -\frac{1}{x}$&quot;];</span>
<span class="go">  node_7 -&gt; node_8 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ \frac{1}{x + 1}$&quot;];</span>
<span class="go">  node_4 -&gt; node_0 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ -\frac{1}{x}$&quot;];</span>
<span class="go">  node_4 -&gt; node_9 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ \frac{1}{x + 1}$&quot;];</span>
<span class="go">}</span>

<span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s">&quot;latex&quot;</span><span class="p">,</span><span class="n">color_by_label</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># random</span>
<span class="go">digraph {</span>
<span class="go">  node [shape=&quot;plaintext&quot;];</span>
<span class="go">  node_10  [label=&quot; &quot;, texlbl=&quot;$1$&quot;];</span>
<span class="go">  node_11  [label=&quot; &quot;, texlbl=&quot;$2$&quot;];</span>
<span class="go">  node_3  [label=&quot; &quot;, texlbl=&quot;$-\frac{1}{2}$&quot;];</span>
<span class="go">  node_6  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{2}$&quot;];</span>
<span class="go">  node_7  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{2}$&quot;];</span>
<span class="go">  node_5  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{3}$&quot;];</span>
<span class="go">  node_8  [label=&quot; &quot;, texlbl=&quot;$\frac{2}{3}$&quot;];</span>
<span class="go">  node_4  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{4}$&quot;];</span>
<span class="go">  node_1  [label=&quot; &quot;, texlbl=&quot;$-2$&quot;];</span>
<span class="go">  node_9  [label=&quot; &quot;, texlbl=&quot;$\frac{4}{5}$&quot;];</span>
<span class="go">  node_0  [label=&quot; &quot;, texlbl=&quot;$-4$&quot;];</span>
<span class="go">  node_2  [label=&quot; &quot;, texlbl=&quot;$-1$&quot;];</span>

<span class="go">  node_10 -&gt; node_2 [color = &quot;#ff0000&quot;];</span>
<span class="go">  node_10 -&gt; node_6 [color = &quot;#00ffff&quot;];</span>
<span class="go">  node_11 -&gt; node_3 [color = &quot;#ff0000&quot;];</span>
<span class="go">  node_11 -&gt; node_5 [color = &quot;#00ffff&quot;];</span>
<span class="go">  node_7 -&gt; node_1 [color = &quot;#ff0000&quot;];</span>
<span class="go">  node_7 -&gt; node_8 [color = &quot;#00ffff&quot;];</span>
<span class="go">  node_4 -&gt; node_0 [color = &quot;#ff0000&quot;];</span>
<span class="go">  node_4 -&gt; node_9 [color = &quot;#00ffff&quot;];</span>
<span class="go">}</span>

<span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s">&quot;latex&quot;</span><span class="p">,</span><span class="n">color_by_label</span><span class="o">=</span><span class="p">{</span> <span class="n">f</span><span class="p">:</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="s">&quot;blue&quot;</span> <span class="p">})</span>  <span class="c"># random</span>
<span class="go">digraph {</span>
<span class="go">  node [shape=&quot;plaintext&quot;];</span>
<span class="go">  node_10  [label=&quot; &quot;, texlbl=&quot;$1$&quot;];</span>
<span class="go">  node_11  [label=&quot; &quot;, texlbl=&quot;$2$&quot;];</span>
<span class="go">  node_3  [label=&quot; &quot;, texlbl=&quot;$-\frac{1}{2}$&quot;];</span>
<span class="go">  node_6  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{2}$&quot;];</span>
<span class="go">  node_7  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{2}$&quot;];</span>
<span class="go">  node_5  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{3}$&quot;];</span>
<span class="go">  node_8  [label=&quot; &quot;, texlbl=&quot;$\frac{2}{3}$&quot;];</span>
<span class="go">  node_4  [label=&quot; &quot;, texlbl=&quot;$\frac{1}{4}$&quot;];</span>
<span class="go">  node_1  [label=&quot; &quot;, texlbl=&quot;$-2$&quot;];</span>
<span class="go">  node_9  [label=&quot; &quot;, texlbl=&quot;$\frac{4}{5}$&quot;];</span>
<span class="go">  node_0  [label=&quot; &quot;, texlbl=&quot;$-4$&quot;];</span>
<span class="go">  node_2  [label=&quot; &quot;, texlbl=&quot;$-1$&quot;];</span>

<span class="go">  node_10 -&gt; node_2 [color = &quot;red&quot;];</span>
<span class="go">  node_10 -&gt; node_6 [color = &quot;blue&quot;];</span>
<span class="go">  node_11 -&gt; node_3 [color = &quot;red&quot;];</span>
<span class="go">  node_11 -&gt; node_5 [color = &quot;blue&quot;];</span>
<span class="go">  node_7 -&gt; node_1 [color = &quot;red&quot;];</span>
<span class="go">  node_7 -&gt; node_8 [color = &quot;blue&quot;];</span>
<span class="go">  node_4 -&gt; node_0 [color = &quot;red&quot;];</span>
<span class="go">  node_4 -&gt; node_9 [color = &quot;blue&quot;];</span>
<span class="go">}</span>
</pre></div>
</div>
<p>By default <tt class="docutils literal"><span class="pre">graphviz</span></tt> renders digraphs using a hierarchical
layout, ranking the vertices down from top to bottom. Here we
specify alternative ranking directions for this layout:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">D</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&quot;up&quot;</span><span class="p">)</span>
<span class="go">digraph {</span>
<span class="go">  rankdir=BT</span>
<span class="go">  node_0  [label=&quot;1&quot;];</span>
<span class="go">  node_1  [label=&quot;2&quot;];</span>

<span class="go">  node_0 -&gt; node_1;</span>
<span class="go">}</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">D</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&quot;down&quot;</span><span class="p">)</span>
<span class="go">digraph {</span>
<span class="go">  node_0  [label=&quot;1&quot;];</span>
<span class="go">  node_1  [label=&quot;2&quot;];</span>

<span class="go">  node_0 -&gt; node_1;</span>
<span class="go">}</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">D</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&quot;left&quot;</span><span class="p">)</span>
<span class="go">digraph {</span>
<span class="go">  rankdir=RL</span>
<span class="go">  node_0  [label=&quot;1&quot;];</span>
<span class="go">  node_1  [label=&quot;2&quot;];</span>

<span class="go">  node_0 -&gt; node_1;</span>
<span class="go">}</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">D</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">)</span>
<span class="go">digraph {</span>
<span class="go">  rankdir=LR</span>
<span class="go">  node_0  [label=&quot;1&quot;];</span>
<span class="go">  node_1  [label=&quot;2&quot;];</span>

<span class="go">  node_0 -&gt; node_1;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Edge-specific options can also be specified by providing a
function (or tuple thereof) which maps each edge to a
dictionary of options. Valid options are &#8220;color&#8221;, &#8220;backward&#8221;
(a boolean), &#8220;dot&#8221; (a string containing a sequence of options
in dot format), &#8220;label&#8221; (a string), &#8220;label_style&#8221; (&#8220;string&#8221; or
&#8220;latex&#8221;), &#8220;edge_string&#8221; (&#8220;&#8211;&#8221; or &#8220;-&gt;&#8221;). Here we state that the
graph should be laid out so that edges starting from <tt class="docutils literal"><span class="pre">1</span></tt> are
going backward (e.g. going up instead of down):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">def</span> <span class="nf">edge_options</span><span class="p">((</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">label</span><span class="p">)):</span>
<span class="go">....:     return { &quot;backward&quot;: u == 1 }</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">edge_options</span> <span class="o">=</span> <span class="n">edge_options</span><span class="p">)</span>  <span class="c"># random</span>
<span class="go">digraph {</span>
<span class="go">  node_10  [label=&quot;1&quot;];</span>
<span class="go">  node_11  [label=&quot;2&quot;];</span>
<span class="go">  node_3  [label=&quot;-1/2&quot;];</span>
<span class="go">  node_6  [label=&quot;1/2&quot;];</span>
<span class="go">  node_7  [label=&quot;1/2&quot;];</span>
<span class="go">  node_5  [label=&quot;1/3&quot;];</span>
<span class="go">  node_8  [label=&quot;2/3&quot;];</span>
<span class="go">  node_4  [label=&quot;1/4&quot;];</span>
<span class="go">  node_1  [label=&quot;-2&quot;];</span>
<span class="go">  node_9  [label=&quot;4/5&quot;];</span>
<span class="go">  node_0  [label=&quot;-4&quot;];</span>
<span class="go">  node_2  [label=&quot;-1&quot;];</span>

<span class="go">  node_2 -&gt; node_10 [dir=back];</span>
<span class="go">  node_6 -&gt; node_10 [dir=back];</span>
<span class="go">  node_11 -&gt; node_3;</span>
<span class="go">  node_11 -&gt; node_5;</span>
<span class="go">  node_7 -&gt; node_1;</span>
<span class="go">  node_7 -&gt; node_8;</span>
<span class="go">  node_4 -&gt; node_0;</span>
<span class="go">  node_4 -&gt; node_9;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>We now test all options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">def</span> <span class="nf">edge_options</span><span class="p">((</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">label</span><span class="p">)):</span>
<span class="go">....:     options = { &quot;color&quot;: { f: &quot;red&quot;, g: &quot;blue&quot; }[label] }</span>
<span class="go">....:     if (u,v) == (1/2, -2): options[&quot;label&quot;]       = &quot;coucou&quot;; options[&quot;label_style&quot;] = &quot;string&quot;</span>
<span class="go">....:     if (u,v) == (1/2,2/3): options[&quot;dot&quot;]         = &quot;x=1,y=2&quot;</span>
<span class="go">....:     if (u,v) == (1,   -1): options[&quot;label_style&quot;] = &quot;latex&quot;</span>
<span class="go">....:     if (u,v) == (1,  1/2): options[&quot;edge_string&quot;] = &quot;&lt;-&quot;</span>
<span class="go">....:     if (u,v) == (1/2,  1): options[&quot;backward&quot;]    = True</span>
<span class="go">....:     return options</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">G</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">(</span><span class="n">edge_options</span> <span class="o">=</span> <span class="n">edge_options</span><span class="p">)</span>  <span class="c"># random</span>
<span class="go">digraph {</span>
<span class="go">  node_10  [label=&quot;1&quot;];</span>
<span class="go">  node_11  [label=&quot;2&quot;];</span>
<span class="go">  node_3  [label=&quot;-1/2&quot;];</span>
<span class="go">  node_6  [label=&quot;1/2&quot;];</span>
<span class="go">  node_7  [label=&quot;1/2&quot;];</span>
<span class="go">  node_5  [label=&quot;1/3&quot;];</span>
<span class="go">  node_8  [label=&quot;2/3&quot;];</span>
<span class="go">  node_4  [label=&quot;1/4&quot;];</span>
<span class="go">  node_1  [label=&quot;-2&quot;];</span>
<span class="go">  node_9  [label=&quot;4/5&quot;];</span>
<span class="go">  node_0  [label=&quot;-4&quot;];</span>
<span class="go">  node_2  [label=&quot;-1&quot;];</span>

<span class="go">  node_10 -&gt; node_2 [label=&quot; &quot;, texlbl=&quot;$x \ {\mapsto}\ -\frac{1}{x}$&quot;, color = &quot;red&quot;];</span>
<span class="go">  node_10 &lt;- node_6 [color = &quot;blue&quot;];</span>
<span class="go">  node_11 -&gt; node_3 [color = &quot;red&quot;];</span>
<span class="go">  node_11 -&gt; node_5 [color = &quot;blue&quot;];</span>
<span class="go">  node_7 -&gt; node_1 [label=&quot;coucou&quot;, color = &quot;red&quot;];</span>
<span class="go">  node_7 -&gt; node_8 [x=1,y=2, color = &quot;blue&quot;];</span>
<span class="go">  node_4 -&gt; node_0 [color = &quot;red&quot;];</span>
<span class="go">  node_4 -&gt; node_9 [color = &quot;blue&quot;];</span>
<span class="go">}</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The following digraph has tuples as vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">print</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">()</span>
<span class="go">digraph {</span>
<span class="go">  node_3  [label=&quot;(&#39;1&#39;, 1)&quot;];</span>
<span class="go">  node_0  [label=&quot;(&#39;0&#39;, 0)&quot;];</span>
<span class="go">  node_2  [label=&quot;(&#39;1&#39;, 0)&quot;];</span>
<span class="go">  node_1  [label=&quot;(&#39;0&#39;, 1)&quot;];</span>

<span class="go">  node_0 -&gt; node_3;</span>
<span class="go">  node_0 -&gt; node_1;</span>
<span class="go">  node_2 -&gt; node_3;</span>
<span class="go">  node_2 -&gt; node_1;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>The following digraph has vertices with newlines in their
string representations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m1</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m2</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m1</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m2</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="n">m1</span><span class="p">:</span> <span class="p">[</span><span class="n">m2</span><span class="p">]</span> <span class="p">})</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">g</span><span class="o">.</span><span class="n">graphviz_string</span><span class="p">()</span>
<span class="go">digraph {</span>
<span class="go">  node_0  [label=&quot;[0 0 0]\n\</span>
<span class="go">[0 0 0]\n\</span>
<span class="go">[0 0 0]&quot;];</span>
<span class="go">  node_1  [label=&quot;[1 0 0]\n\</span>
<span class="go">[0 1 0]\n\</span>
<span class="go">[0 0 1]&quot;];</span>

<span class="go">  node_0 -&gt; node_1;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="dotspec" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[dotspec]</a></td><td><a class="reference external" href="http://www.graphviz.org/doc/info/lang.html">http://www.graphviz.org/doc/info/lang.html</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.graphviz_to_file_named">
<tt class="descname">graphviz_to_file_named</tt><big>(</big><em>filename</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.graphviz_to_file_named" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Write a representation in the dot in a file.</p>
<p>The dot language is a plaintext format for graph structures. See the
documentation of <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.graphviz_string" title="sage.graphs.generic_graph.GenericGraph.graphviz_string"><tt class="xref py py-meth docutils literal"><span class="pre">graphviz_string()</span></tt></a> for available options.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">filename</span></tt> - the name of the file to write in</p>
<p><tt class="docutils literal"><span class="pre">options</span></tt> - options for the graphviz string</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s">&#39;foo&#39;</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="s">&#39;foo&#39;</span><span class="p">}},</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tempfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SAGE_TMP</span><span class="p">,</span> <span class="s">&#39;temp_graphviz&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">graphviz_to_file_named</span><span class="p">(</span><span class="n">tempfile</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="nb">open</span><span class="p">(</span><span class="n">tempfile</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">graph {</span>
<span class="go">  node_0  [label=&quot;0&quot;];</span>
<span class="go">  node_1  [label=&quot;1&quot;];</span>
<span class="go">  node_2  [label=&quot;2&quot;];</span>
<span class="go">  node_3  [label=&quot;3&quot;];</span>

<span class="go">  node_0 -- node_1;</span>
<span class="go">  node_0 -- node_2;</span>
<span class="go">  node_1 -- node_2;</span>
<span class="go">  node_2 -- node_3 [label=&quot;foo&quot;];</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.hamiltonian_cycle">
<tt class="descname">hamiltonian_cycle</tt><big>(</big><em>algorithm='tsp'</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.hamiltonian_cycle" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a Hamiltonian cycle/circuit of the current graph/digraph</p>
<p>A graph (resp. digraph) is said to be Hamiltonian
if it contains as a subgraph a cycle (resp. a circuit)
going through all the vertices.</p>
<p>Computing a Hamiltonian cycle/circuit being NP-Complete,
this algorithm could run for some time depending on
the instance.</p>
<p>ALGORITHM:</p>
<p>See <tt class="docutils literal"><span class="pre">Graph.traveling_salesman_problem</span></tt> for &#8216;tsp&#8217; algorithm and
<tt class="docutils literal"><span class="pre">find_hamiltonian</span></tt> from <tt class="docutils literal"><span class="pre">sage.graphs.generic_graph_pyx</span></tt>
for &#8216;backtrack&#8217; algorithm.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - one of &#8216;tsp&#8217; or &#8216;backtrack&#8217;.</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<p>If using the &#8216;tsp&#8217; algorithm, returns a Hamiltonian cycle/circuit if it
exists; otherwise, raises a <tt class="docutils literal"><span class="pre">EmptySetError</span></tt> exception. If using the
&#8216;backtrack&#8217; algorithm, returns a pair (B,P). If B is True then P is a
Hamiltonian cycle and if B is False, P is a longest path found by the
algorithm. Observe that if B is False, the graph may still be Hamiltonian.
The &#8216;backtrack&#8217; algorithm is only implemented for undirected
graphs.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The &#8216;backtrack&#8217; algorithm may loop endlessly on graphs
with vertices of degree 1.</p>
</div>
<p>NOTE:</p>
<p>This function, as <tt class="docutils literal"><span class="pre">is_hamiltonian</span></tt>, computes a Hamiltonian
cycle if it exists: the user should <em>NOT</em> test for
Hamiltonicity using <tt class="docutils literal"><span class="pre">is_hamiltonian</span></tt> before calling this
function, as it would result in computing it twice.</p>
<p>The backtrack algorithm is only implemented for undirected graphs.</p>
<p>EXAMPLES:</p>
<p>The Heawood Graph is known to be Hamiltonian</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">hamiltonian_cycle</span><span class="p">()</span>
<span class="go">TSP from Heawood graph: Graph on 14 vertices</span>
</pre></div>
</div>
<p>The Petersen Graph, though, is not</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">hamiltonian_cycle</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">The given graph is not hamiltonian</span>
</pre></div>
</div>
<p>Now, using the backtrack algorithm in the Heawood graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">hamiltonian_cycle</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;backtrack&#39;</span><span class="p">)</span>
<span class="go">(True, [11, 10, 1, 2, 3, 4, 9, 8, 7, 6, 5, 0, 13, 12])</span>
</pre></div>
</div>
<p>And now in the Petersen graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">hamiltonian_cycle</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;backtrack&#39;</span><span class="p">)</span>
<span class="go">(False, [6, 8, 5, 0, 1, 2, 7, 9, 4, 3])</span>
</pre></div>
</div>
<p>Finally, we test the algorithm in a cube graph, which is Hamiltonian</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">hamiltonian_cycle</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;backtrack&#39;</span><span class="p">)</span>
<span class="go">(True, [&#39;010&#39;, &#39;110&#39;, &#39;100&#39;, &#39;000&#39;, &#39;001&#39;, &#39;101&#39;, &#39;111&#39;, &#39;011&#39;])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.has_edge">
<tt class="descname">has_edge</tt><big>(</big><em>u</em>, <em>v=None</em>, <em>label=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.has_edge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns True if (u, v) is an edge, False otherwise.</p>
<p>INPUT: The following forms are accepted by NetworkX:</p>
<ul class="simple">
<li>G.has_edge( 1, 2 )</li>
<li>G.has_edge( (1, 2) )</li>
<li>G.has_edge( 1, 2, &#8216;label&#8217; )</li>
<li>G.has_edge( (1, 2, &#8216;label&#8217;) )</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">()</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">()</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;label&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;different label&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;label&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.has_loops">
<tt class="descname">has_loops</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.has_loops" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns whether there are loops in the (di)graph.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Looped graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Looped digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.has_multiple_edges">
<tt class="descname">has_multiple_edges</tt><big>(</big><em>to_undirected=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.has_multiple_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns whether there are multiple edges in the (di)graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">to_undirected</span></tt> &#8211; (default: False) If True, runs the test on the undirected version of a DiGraph.
Otherwise, treats DiGraph edges (u,v) and (v,u) as unique individual edges.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Multi-graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None)]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Multi-digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None)]</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span> <span class="s">&#39;h&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;g&#39;</span><span class="p">}},</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">(</span><span class="n">to_undirected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">(</span><span class="n">to_undirected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(1, 2, &#39;h&#39;), (2, 1, &#39;g&#39;)]</span>
</pre></div>
</div>
<p>A loop is not a multiedge:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.has_vertex">
<tt class="descname">has_vertex</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.has_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return True if vertex is one of the vertices of this graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertex</span></tt> - an integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">bool</span></tt> - True or False</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">]});</span> <span class="n">g</span>
<span class="go">Graph on 5 vertices</span>
<span class="gp">sage: </span><span class="mi">2</span> <span class="ow">in</span> <span class="n">g</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">10</span> <span class="ow">in</span> <span class="n">g</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">has_vertex</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.igraph_graph">
<tt class="descname">igraph_graph</tt><big>(</big><em>vertex_attrs={}</em>, <em>edge_attrs={}</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.igraph_graph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Converts the graph into an igraph graph.</p>
<p>Optionally, it is possible to add vertex attributes and edge attributes
to the output graph.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This routine needs the optional package igraph to be installed:
to do so, it is enough to
run <tt class="docutils literal"><span class="pre">sage</span> <span class="pre">-i</span> <span class="pre">python_igraph</span></tt>. For
more information on the Python version of igraph, see
<a class="reference external" href="http://igraph.org/python/">http://igraph.org/python/</a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertex_attrs</span></tt> (dictionary) - a dictionary where the key is a string
(the attribute name), and the value is an iterable containing in
position i the label of the ith vertex returned by <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertices" title="sage.graphs.generic_graph.GenericGraph.vertices"><tt class="xref py py-meth docutils literal"><span class="pre">vertices()</span></tt></a>
(see <a class="reference external" href="http://igraph.org/python/doc/igraph.Graph-class.html#__init__">http://igraph.org/python/doc/igraph.Graph-class.html#__init__</a> for
more information).</li>
<li><tt class="docutils literal"><span class="pre">edge_attrs</span></tt> (dictionary) - a dictionary where the key is a string
(the attribute name), and the value is an iterable containing in
position i the label of the ith edge in the list outputted by
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_iterator" title="sage.graphs.generic_graph.GenericGraph.edge_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">edge_iterator()</span></tt></a> (see
<a class="reference external" href="http://igraph.org/python/doc/igraph.Graph-class.html#__init__">http://igraph.org/python/doc/igraph.Graph-class.html#__init__</a> for more
information).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In igraph, a graph is weighted if the edge labels have attribute
<tt class="docutils literal"><span class="pre">weight</span></tt>. Hence, to create a weighted graph, it is enough to add
this attribute.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Often, Sage uses its own defined types for integer/floats. These
types may not be igraph-compatible (see example below).</p>
</div>
<p>EXAMPLES:</p>
<p>Standard conversion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">()</span>          <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>                   <span class="c"># optional - python_igraph</span>
<span class="go">&#39;IGRAPH U--- 4 6 -- &#39;</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">()</span>          <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>                   <span class="c"># optional - python_igraph</span>
<span class="go">&#39;IGRAPH D--- 3 2 -- &#39;</span>
</pre></div>
</div>
<p>Adding edge attributes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>                                     <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">edge_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;label&#39;</span><span class="p">:[</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]})</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s">&#39;label&#39;</span><span class="p">]</span>                                                        <span class="c"># optional - python_igraph</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
<p>If edges have an attribute <tt class="docutils literal"><span class="pre">weight</span></tt>, the igraph graph is considered
weighted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})])</span>                              <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">edge_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;weight&#39;</span><span class="p">:[</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;weight&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]})</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_weighted</span><span class="p">()</span>                                                                 <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s">&#39;weight&#39;</span><span class="p">]</span>                                                                  <span class="c"># optional - python_igraph</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
<p>Adding vertex attributes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>                            <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">vertex_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()})</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">vs</span><span class="p">()[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>                                         <span class="c"># optional - python_igraph</span>
<span class="go">[(0, 0), (0, 1), (1, 0), (1, 1)]</span>
</pre></div>
</div>
<p>Sometimes, Sage integer/floats are not compatible with igraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>                                                    <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">edge_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;capacity&#39;</span><span class="p">:[</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]})</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">maxflow_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;capacity&#39;</span><span class="p">)</span>                                       <span class="c"># optional - python_igraph</span>
<span class="go">1.0</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">edge_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;capacity&#39;</span><span class="p">:[</span><span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]})</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">maxflow_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;capacity&#39;</span><span class="p">)</span>                                              <span class="c"># optional - python_igraph</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Converting a DiGraph back and forth:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,{</span><span class="s">&#39;w&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}),(</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,{</span><span class="s">&#39;w&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})])</span>    <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">vertex_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()}</span>                    <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">edge_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;w&#39;</span><span class="p">:[</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;w&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]}</span>       <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">vertex_attrs</span><span class="p">,</span> <span class="n">edge_attrs</span><span class="p">))</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>                                                <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>                                <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">edge_attrs</span><span class="o">=</span><span class="n">edge_attrs</span><span class="p">))</span>    <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>                                                <span class="c"># optional - python_igraph</span>
<span class="go">False</span>
</pre></div>
</div>
<p>When checking for equality, edge labels are not taken into account:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">vertex_attrs</span><span class="p">))</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>                                    <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>                    <span class="c"># optional - python_igraph</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Converting a Graph back and forth:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,{</span><span class="s">&#39;w&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}),(</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,{</span><span class="s">&#39;w&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})])</span>    <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">vertex_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()}</span>                  <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">edge_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;w&#39;</span><span class="p">:[</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;w&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]}</span>     <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">vertex_attrs</span><span class="p">,</span> <span class="n">edge_attrs</span><span class="p">))</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>                                              <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>                              <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">edge_attrs</span><span class="o">=</span><span class="n">edge_attrs</span><span class="p">))</span>    <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>                                              <span class="c"># optional - python_igraph</span>
<span class="go">False</span>
</pre></div>
</div>
<p>When checking for equality, edge labels are not taken into account:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">igraph_graph</span><span class="p">(</span><span class="n">vertex_attrs</span><span class="p">))</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>                                  <span class="c"># optional - python_igraph</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>                  <span class="c"># optional - python_igraph</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.incidence_matrix">
<tt class="descname">incidence_matrix</tt><big>(</big><em>oriented=None</em>, <em>sparse=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.incidence_matrix" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the incidence matrix of the (di)graph.</p>
<p>Each row is a vertex, and each column is an edge. The vertices as
ordered as obtained by the method <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.vertices" title="sage.graphs.generic_graph.GenericGraph.vertices"><tt class="xref py py-meth docutils literal"><span class="pre">vertices()</span></tt></a> and the edges as
obtained by the method <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_iterator" title="sage.graphs.generic_graph.GenericGraph.edge_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">edge_iterator()</span></tt></a>.</p>
<p>If the graph is not directed, then return a matrix with entries in
<span class="math">\(\{0,1,2\}\)</span>. Each column will either contain two <span class="math">\(1\)</span> (at the position of
the endpoint of the edge), or one <span class="math">\(2\)</span> (if the corresponding edge is a
loop).</p>
<p>If the graph is directed return a matrix in <span class="math">\(\{-1,0,1\}\)</span> where <span class="math">\(-1\)</span> and
<span class="math">\(+1\)</span> correspond respectively to the source and the target of the edge. A
loop will correspond to a zero column. In particular, it is not possible
to recover the loops of an oriented graph from its incidence matrix.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Incidence_Matrix">Wikipedia article Incidence_Matrix</a> for more informations.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">oriented</span></tt> &#8211; an optional boolean. If set to <tt class="docutils literal"><span class="pre">True</span></tt>, the matrix
will be oriented (i.e. with entries in <span class="math">\(-1\)</span>, <span class="math">\(0\)</span>, <span class="math">\(1\)</span>) and if set to
<tt class="docutils literal"><span class="pre">False</span></tt> the matrix will be not oriented (i.e. with entries in <span class="math">\(0\)</span>,
<span class="math">\(1\)</span>, <span class="math">\(2\)</span>). By default, this argument is inferred from the graph type.
Note that in the case the graph is not directed and with the option
<tt class="docutils literal"><span class="pre">directed=True</span></tt>, a somewhat random direction is chosen for each
edge.</li>
<li><tt class="docutils literal"><span class="pre">sparse</span></tt> &#8211; default to <tt class="docutils literal"><span class="pre">True</span></tt>, whether to use a sparse or a dense
matrix.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">()</span>
<span class="go">[0 1 0 0 0 1 0 1 0 0 0 0]</span>
<span class="go">[0 0 0 1 0 1 1 0 0 0 0 0]</span>
<span class="go">[1 1 1 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 1 1 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 1 1]</span>
<span class="go">[0 0 0 0 0 0 1 0 0 1 0 1]</span>
<span class="go">[0 0 1 0 0 0 0 0 1 0 1 0]</span>
<span class="go">[0 0 0 0 1 0 0 0 1 1 0 0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">oriented</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[ 0 -1  0  0  0 -1  0 -1  0  0  0  0]</span>
<span class="go">[ 0  0  0 -1  0  1 -1  0  0  0  0  0]</span>
<span class="go">[-1  1 -1  0  0  0  0  0  0  0  0  0]</span>
<span class="go">[ 1  0  0  1 -1  0  0  0  0  0  0  0]</span>
<span class="go">[ 0  0  0  0  0  0  0  1  0  0 -1 -1]</span>
<span class="go">[ 0  0  0  0  0  0  1  0  0 -1  0  1]</span>
<span class="go">[ 0  0  1  0  0  0  0  0 -1  0  1  0]</span>
<span class="go">[ 0  0  0  0  1  0  0  0  1  1  0  0]</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">()</span>
<span class="go">[-1 -1  1  0  0  0  1  0]</span>
<span class="go">[ 1  0 -1 -1  1  0  0  0]</span>
<span class="go">[ 0  0  0  1 -1 -1  0  1]</span>
<span class="go">[ 0  1  0  0  0  1 -1 -1]</span>

<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">()</span>
<span class="go">[1 1 0]</span>
<span class="go">[1 0 1]</span>
<span class="go">[0 1 1]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">oriented</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[2 1 1]</span>
<span class="go">[0 1 1]</span>
</pre></div>
</div>
<p>A well known result states that the product of the (oriented) incidence
matrix with its transpose of a (non-oriented graph) is in fact the
Kirchhoff matrix:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">oriented</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">G</span><span class="o">.</span><span class="n">kirchhoff_matrix</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">oriented</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">kirchhoff_matrix</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">oriented</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">kirchhoff_matrix</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_chordal">
<tt class="descname">is_chordal</tt><big>(</big><em>certificate=False</em>, <em>algorithm='B'</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_chordal" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether the given graph is chordal.</p>
<p>A Graph <span class="math">\(G\)</span> is said to be chordal if it contains no induced hole (a
cycle of length at least 4).</p>
<p>Alternatively, chordality can be defined using a Perfect Elimination
Order :</p>
<p>A Perfect Elimination Order of a graph <span class="math">\(G\)</span> is an ordering <span class="math">\(v_1,...,v_n\)</span>
of its vertex set such that for all <span class="math">\(i\)</span>, the neighbors of <span class="math">\(v_i\)</span> whose
index is greater that <span class="math">\(i\)</span> induce a complete subgraph in <span class="math">\(G\)</span>. Hence, the
graph <span class="math">\(G\)</span> can be totally erased by successively removing vertices whose
neighborhood is a clique (also called <em>simplicial</em> vertices)
<a class="reference internal" href="#fulkerson65" id="id14">[Fulkerson65]</a>.</p>
<p>(It can be seen that if <span class="math">\(G\)</span> contains an induced hole, then it can not
have a perfect elimination order. Indeed, if we write <span class="math">\(h_1,...,h_k\)</span> the
<span class="math">\(k\)</span> vertices of such a hole, then the first of those vertices to be
removed would have two non-adjacent neighbors in the graph.)</p>
<p>A Graph is then chordal if and only if it has a Perfect Elimination
Order.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">certificate</span></tt> (boolean) &#8211; Whether to return a certificate.</p>
<blockquote>
<div><ul>
<li><p class="first">If <tt class="docutils literal"><span class="pre">certificate</span> <span class="pre">=</span> <span class="pre">False</span></tt> (default), returns <tt class="docutils literal"><span class="pre">True</span></tt> or
<tt class="docutils literal"><span class="pre">False</span></tt> accordingly.</p>
</li>
<li><p class="first">If <tt class="docutils literal"><span class="pre">certificate</span> <span class="pre">=</span> <span class="pre">True</span></tt>, returns :</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">(True,</span> <span class="pre">peo)</span></tt> when the graph is chordal, where <tt class="docutils literal"><span class="pre">peo</span></tt> is a
perfect elimination order of its vertices.</li>
<li><tt class="docutils literal"><span class="pre">(False,</span> <span class="pre">Hole)</span></tt> when the graph is not chordal, where
<tt class="docutils literal"><span class="pre">Hole</span></tt> (a <tt class="docutils literal"><span class="pre">Graph</span></tt> object) is an induced subgraph of
<tt class="docutils literal"><span class="pre">self</span></tt> isomorphic to a hole.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; Two algorithms are available for this method (see
next section), which can be selected by setting <tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;A&quot;</span></tt> or
<tt class="docutils literal"><span class="pre">algorithm</span> <span class="pre">=</span> <span class="pre">&quot;B&quot;</span></tt> (default). While they will agree on whether the
given graph is chordal, they can not be expected to return the same
certificates.</p>
</li>
</ul>
<p>ALGORITHM:</p>
<p>This algorithm works through computing a Lex BFS on the graph, then
checking whether the order is a Perfect Elimination Order by computing
for each vertex <span class="math">\(v\)</span> the subgraph induces by its non-deleted neighbors,
then testing whether this graph is complete.</p>
<p>This problem can be solved in <span class="math">\(O(m)\)</span> <a class="reference internal" href="#rose75" id="id15">[Rose75]</a> ( where <span class="math">\(m\)</span> is the number
of edges in the graph ) but this implementation is not linear because of
the complexity of Lex BFS.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Because of a past bug (#11735, #11961), the first implementation
(algorithm A) of this method sometimes returned as certificates
subgraphs which were <strong>not</strong> holes. Since then, this bug has been
fixed and the values are now double-checked before being returned,
so that the algorithm only returns correct values or raises an
exception. In the case where an exception is raised, the user is
advised to switch to the other algorithm. And to <strong>please</strong> report
the bug :-)</p>
</div>
<p>EXAMPLES:</p>
<p>The lexicographic product of a Path and a Complete Graph
is chordal</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same goes with the product of a random lobster
( which is a tree ) and a Complete Graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomLobster</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The disjoint union of chordal graphs is still chordal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Let us check the certificate given by Sage is indeed a perfect elimintion order:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">peo</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">peo</span><span class="p">:</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">.</span><span class="n">is_clique</span><span class="p">():</span>
<span class="gp">... </span>           <span class="k">print</span> <span class="s">&quot;This should never happen !&quot;</span>
<span class="gp">... </span>      <span class="n">g</span><span class="o">.</span><span class="n">delete_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="s">&quot;Everything is fine !&quot;</span>
<span class="go">Everything is fine !</span>
</pre></div>
</div>
<p>Of course, the Petersen Graph is not chordal as it has girth 5</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">girth</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>We can even obtain such a cycle as a certificate</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">hole</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hole</span>
<span class="go">Subgraph of (Petersen graph): Graph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">hole</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>This shouldn&#8217;t raise exceptions (<a class="reference external" href="http://trac.sagemath.org/10899">trac ticket #10899</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">graphs</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="go">....:     _ = g.is_chordal()</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/11735">trac ticket #11735</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">3</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">g1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">g1</span><span class="o">.</span><span class="n">is_chordal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">g1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">order</span><span class="p">()))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="rose75" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id15">[Rose75]</a></td><td>Rose, D.J. and Tarjan, R.E.,
Algorithmic aspects of vertex elimination,
Proceedings of seventh annual ACM symposium on Theory of computing
Page 254, ACM 1975</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="fulkerson65" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[Fulkerson65]</a></td><td>Fulkerson, D.R. and Gross, OA
Incidence matrices and interval graphs
Pacific J. Math 1965
Vol. 15, number 3, pages 835&#8211;855</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_circulant">
<tt class="descname">is_circulant</tt><big>(</big><em>certificate=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_circulant" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether the graph is circulant.</p>
<p>For more information on circulant graphs, see the
<a class="reference external" href="https://en.wikipedia.org/wiki/Circulant_graph">Wikipedia page on circulant graphs</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">certificate</span></tt> (boolean) &#8211; whether to return a certificate for
yes-answers. See OUTPUT section. Set to <tt class="docutils literal"><span class="pre">False</span></tt> by default.</li>
</ul>
<p>OUTPUT:</p>
<p>When <tt class="docutils literal"><span class="pre">certificate</span></tt> is set to <tt class="docutils literal"><span class="pre">False</span></tt> (default) this method only
returns <tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt> answers. When <tt class="docutils literal"><span class="pre">certificate</span></tt> is set to
<tt class="docutils literal"><span class="pre">True</span></tt>, the method either returns <tt class="docutils literal"><span class="pre">(False,</span> <span class="pre">None)</span></tt> or <tt class="docutils literal"><span class="pre">(True,</span>
<span class="pre">lists_of_parameters)</span></tt> each element of <tt class="docutils literal"><span class="pre">lists_of_parameters</span></tt> can be
used to define the graph as a circulant graph.</p>
<p>See the documentation of
<a class="reference internal" href="graph_generators.html#sage.graphs.graph_generators.GraphGenerators.CirculantGraph" title="sage.graphs.graph_generators.GraphGenerators.CirculantGraph"><tt class="xref py py-func docutils literal"><span class="pre">CirculantGraph()</span></tt></a> and
<a class="reference internal" href="digraph_generators.html#sage.graphs.digraph_generators.DiGraphGenerators.Circulant" title="sage.graphs.digraph_generators.DiGraphGenerators.Circulant"><tt class="xref py py-meth docutils literal"><span class="pre">Circulant()</span></tt></a> for
more information, and the examples below.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="graph_generators.html#sage.graphs.graph_generators.GraphGenerators.CirculantGraph" title="sage.graphs.graph_generators.GraphGenerators.CirculantGraph"><tt class="xref py py-meth docutils literal"><span class="pre">CirculantGraph()</span></tt></a>
&#8211; a constructor for circulant graphs.</p>
</div>
<p>EXAMPLES:</p>
<p>The Petersen graph is not a circulant graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A cycle is obviously a circulant graph, but several sets of parameters
can be used to define it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, [(5, [1, 4]), (5, [2, 3])])</span>
</pre></div>
</div>
<p>The same goes for directed graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, [(5, [1]), (5, [3]), (5, [2]), (5, [4])])</span>
</pre></div>
</div>
<p>With this information, it is very easy to create (and plot) all possible
drawings of a circulant graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CirculantGraph</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>     <span class="n">graphs</span><span class="o">.</span><span class="n">CirculantGraph</span><span class="p">(</span><span class="o">*</span><span class="n">param</span><span class="p">)</span>
<span class="go">Circulant graph ([2, 3, 10, 11]): Graph on 13 vertices</span>
<span class="go">Circulant graph ([1, 5, 8, 12]): Graph on 13 vertices</span>
<span class="go">Circulant graph ([4, 6, 7, 9]): Graph on 13 vertices</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, [(3, [0, 1, 2])])</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (1, []))</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (0, []))</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span><span class="o">.</span><span class="n">is_circulant</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (1, [0]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_circular_planar">
<tt class="descname">is_circular_planar</tt><big>(</big><em>on_embedding=None</em>, <em>kuratowski=False</em>, <em>set_embedding=True</em>, <em>boundary=None</em>, <em>ordered=False</em>, <em>set_pos=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_circular_planar" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether the graph is circular planar (outerplanar)</p>
<p>A graph is circular planar if it has a planar embedding in which all
vertices can be drawn in order on a circle. This method can also be used
to check the existence of a planar embedding in which the vertices of a
specific set (the <em>boundary</em>) can be drawn on a circle, all other
vertices being drawn inside of the circle. An order can be defined on
the vertices of the boundary in order to define how they are to appear
on the circle.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">kuratowski</span></tt> (boolean) - if set to True, returns a tuple with
boolean first entry and the Kuratowski subgraph (i.e. an edge
subdivision of <span class="math">\(K_5\)</span> or <span class="math">\(K_{3,3}\)</span>) as the second entry (see OUTPUT below).
It is set to <tt class="docutils literal"><span class="pre">False</span></tt> by default.</li>
<li><tt class="docutils literal"><span class="pre">on_embedding</span></tt> (boolean) - the embedding dictionary to test
planarity on. (i.e.: will return <tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt> only for the
given embedding). It is set to <tt class="docutils literal"><span class="pre">False</span></tt> by default.</li>
<li><tt class="docutils literal"><span class="pre">set_embedding</span></tt> (boolean) - whether or not to set the instance field
variable that contains a combinatorial embedding (clockwise ordering
of neighbors at each vertex). This value will only be set if a
circular planar embedding is found. It is stored as a Python dict:
<tt class="docutils literal"><span class="pre">v1:</span> <span class="pre">[n1,n2,n3]</span></tt> where <tt class="docutils literal"><span class="pre">v1</span></tt> is a vertex and <tt class="docutils literal"><span class="pre">n1,n2,n3</span></tt> are its
neighbors. It is set to <tt class="docutils literal"><span class="pre">True</span></tt> by default.</li>
<li><tt class="docutils literal"><span class="pre">boundary</span></tt> - a set of vertices that are required to be drawn on the
circle, all others being drawn inside of it. It is set to <tt class="docutils literal"><span class="pre">None</span></tt> by
default, meaning that <em>all</em> vertices should be drawn on the boundary.</li>
<li><tt class="docutils literal"><span class="pre">ordered</span></tt> (boolean) - whether or not to consider the order of the
boundary. It is set to <tt class="docutils literal"><span class="pre">False</span></tt> by default, and required
<tt class="docutils literal"><span class="pre">boundary</span></tt> to be defined.</li>
<li><tt class="docutils literal"><span class="pre">set_pos</span></tt> - whether or not to set the position dictionary (for
plotting) to reflect the combinatorial embedding.  Note that this
value will default to False if set_emb is set to False. Also, the
position dictionary will only be updated if a circular planar
embedding is found.</li>
</ul>
<p>OUTPUT:</p>
<p>The method returns <tt class="docutils literal"><span class="pre">True</span></tt> if the graph is circular planar, and
<tt class="docutils literal"><span class="pre">False</span></tt> if it is not.</p>
<p>If <tt class="docutils literal"><span class="pre">kuratowski</span></tt> is set to <tt class="docutils literal"><span class="pre">True</span></tt>, then this function will return a
tuple, whose first entry is a boolean and whose second entry is the
Kuratowski subgraph (i.e. an edge subdivison of <span class="math">\(K_5\)</span> or <span class="math">\(K_{3,3}\)</span>)
isolated by the Boyer-Myrvold algorithm. Note that this graph
might contain a vertex or edges that were not in the initial graph.
These would be elements referred to below
as parts of the wheel and the star, which were added to the graph to
require that the boundary can be drawn on the boundary of a disc, with
all other vertices drawn inside (and no edge crossings).</p>
<p>ALGORITHM:</p>
<p>This is a linear time algorithm to test for circular planarity. It
relies on the edge-addition planarity algorithm due to
Boyer-Myrvold. We accomplish linear time for circular planarity by
modifying the graph before running the general planarity
algorithm.</p>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="bm04" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[BM04]</td><td>John M. Boyer and Wendy J. Myrvold, On the Cutting Edge:
Simplified O(n) Planarity by Edge Addition. Journal of Graph
Algorithms and Applications, Vol. 8, No. 3, pp. 241-273,
2004.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g439</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g439</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g439</span><span class="o">.</span><span class="n">is_circular_planar</span><span class="p">(</span><span class="n">boundary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">g439</span><span class="o">.</span><span class="n">is_circular_planar</span><span class="p">(</span><span class="n">kuratowski</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">boundary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">(False, Graph on 8 vertices)</span>
<span class="gp">sage: </span><span class="n">g439</span><span class="o">.</span><span class="n">is_circular_planar</span><span class="p">(</span><span class="n">kuratowski</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">boundary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">(True, None)</span>
<span class="gp">sage: </span><span class="n">g439</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">()</span>
<span class="go">{1: [7, 5],</span>
<span class="go">2: [5, 6],</span>
<span class="go">3: [6, 7],</span>
<span class="go">4: [7, 6, 5],</span>
<span class="go">5: [1, 4, 2],</span>
<span class="go">6: [2, 4, 3],</span>
<span class="go">7: [3, 4, 1]}</span>
</pre></div>
</div>
<p>Order matters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K23</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K23</span><span class="o">.</span><span class="n">is_circular_planar</span><span class="p">(</span><span class="n">boundary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K23</span><span class="o">.</span><span class="n">is_circular_planar</span><span class="p">(</span><span class="n">ordered</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">boundary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
<p>With a different order:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K23</span><span class="o">.</span><span class="n">is_circular_planar</span><span class="p">(</span><span class="n">set_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">boundary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_clique">
<tt class="descname">is_clique</tt><big>(</big><em>vertices=None</em>, <em>directed_clique=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_clique" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether a set of vertices is a clique</p>
<p>A clique is a set of vertices such that there is an edge between any two
vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - Vertices can be a single vertex or an
iterable container of vertices, e.g. a list, set, graph, file or
numeric array. If not passed, defaults to the entire graph.</li>
<li><tt class="docutils literal"><span class="pre">directed_clique</span></tt> - (default False) If set to
False, only consider the underlying undirected graph. If set to
True and the graph is directed, only return True if all possible
edges in _both_ directions exist.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_clique</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_clique</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">is_clique</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">is_clique</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">is_clique</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">is_clique</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">is_clique</span><span class="p">(</span><span class="n">directed_clique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_connected">
<tt class="descname">is_connected</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_connected" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Indicates whether the (di)graph is connected. Note that in a graph,
path connected is equivalent to connected.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_cut_edge">
<tt class="descname">is_cut_edge</tt><big>(</big><em>u</em>, <em>v=None</em>, <em>label=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_cut_edge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns True if the input edge is a cut-edge or a bridge.</p>
<p>A cut edge (or bridge) is an edge that when removed increases
the number of connected components.  This function works with
simple graphs as well as graphs with loops and multiedges.  In
a digraph, a cut edge is an edge that when removed increases
the number of (weakly) connected components.</p>
<p>INPUT: The following forms are accepted</p>
<ul class="simple">
<li>G.is_cut_edge( 1, 2 )</li>
<li>G.is_cut_edge( (1, 2) )</li>
<li>G.is_cut_edge( 1, 2, &#8216;label&#8217; )</li>
<li>G.is_cut_edge( (1, 2, &#8216;label&#8217;) )</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>Returns True if (u,v) is a cut edge, False otherwise</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s">&#39;silly&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s">&#39;silly&#39;</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">loops</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">edge not in graph</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_cut_vertex">
<tt class="descname">is_cut_vertex</tt><big>(</big><em>u</em>, <em>weak=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_cut_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns True if the input vertex is a cut-vertex.</p>
<p>A vertex is a cut-vertex if its removal from the (di)graph increases the
number of (strongly) connected components. Isolated vertices or leafs
are not cut-vertices. This function works with simple graphs as well as
graphs with loops and multiple edges.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">u</span></tt> &#8211; a vertex</li>
<li><tt class="docutils literal"><span class="pre">weak</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) boolean set to <span class="math">\(True\)</span> if the
connectivity of directed graphs is to be taken in the weak sense, that
is ignoring edges orientations.</li>
</ul>
<p>OUTPUT:</p>
<p>Returns True if <tt class="docutils literal"><span class="pre">u</span></tt> is a cut-vertex, and False otherwise.</p>
<p>EXAMPLES:</p>
<p>Giving a LollipopGraph(4,2), that is a complete graph with 4 vertices with a pending edge:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">LollipopGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Comparing the weak and strong connectivity of a digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_cut_vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_cut_vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">weak</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Giving a vertex that is not in the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_cut_vertex</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The input vertex is not in the vertex set.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_drawn_free_of_edge_crossings">
<tt class="descname">is_drawn_free_of_edge_crossings</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_drawn_free_of_edge_crossings" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns True is the position dictionary for this graph is set and
that position dictionary gives a planar embedding.</p>
<p>This simply checks all pairs of edges that don&#8217;t share a vertex to
make sure that they don&#8217;t intersect.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function require that _pos attribute is set. (Returns
False otherwise.)</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">set_planar_positions</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_drawn_free_of_edge_crossings</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_equitable">
<tt class="descname">is_equitable</tt><big>(</big><em>partition</em>, <em>quotient_matrix=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_equitable" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Checks whether the given partition is equitable with respect to
self.</p>
<p>A partition is equitable with respect to a graph if for every pair
of cells C1, C2 of the partition, the number of edges from a vertex
of C1 to C2 is the same, over all vertices in C1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">partition</span></tt> - a list of lists</li>
<li><tt class="docutils literal"><span class="pre">quotient_matrix</span></tt> - (default False) if True, and
the partition is equitable, returns a matrix over the integers
whose rows and columns represent cells of the partition, and whose
i,j entry is the number of vertices in cell j adjacent to each
vertex in cell i (since the partition is equitable, this is well
defined)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_equitable</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">]])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_equitable</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_equitable</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">]],</span> <span class="n">quotient_matrix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1 2 0]</span>
<span class="go">[1 0 2]</span>
<span class="go">[0 2 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">WheelGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prt</span> <span class="o">=</span> <span class="p">[[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ss</span><span class="o">.</span><span class="n">is_equitable</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Partition ([[(0, 1)], [(0, 2), (0, 3), (0, 4), (1, 2), (1, 4)], [(2, 3), (3, 4)]]) is not valid for this graph: vertices are incorrect.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">WheelGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ss</span><span class="o">.</span><span class="n">is_equitable</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_eulerian">
<tt class="descname">is_eulerian</tt><big>(</big><em>path=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_eulerian" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return true if the graph has a (closed) tour that visits each edge exactly
once.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">path</span></tt> &#8211; by default this function finds if the graph contains a closed
tour visiting each edge once, i.e. an eulerian cycle. If you want to test
the existence of an eulerian path, set this argument to <tt class="docutils literal"><span class="pre">True</span></tt>. Graphs
with this property are sometimes called semi-eulerian.</li>
</ul>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt> for the closed tour case. For an open tour search
(<tt class="docutils literal"><span class="pre">path``=``True</span></tt>) the function returns <tt class="docutils literal"><span class="pre">False</span></tt> if the graph is not
semi-eulerian, or a tuple (u, v) in the other case. This tuple defines the
edge that would make the graph eulerian, i.e. close an existing open tour.
This edge may or may not be already present in the graph.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]});</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">2</span><span class="p">]});</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[]});</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)]);</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]});</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]});</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">]},</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">e</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[],</span> <span class="mi">2</span><span class="p">:[],</span> <span class="mi">3</span><span class="p">:[]});</span> <span class="n">g</span><span class="o">.</span><span class="n">is_eulerian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_gallai_tree">
<tt class="descname">is_gallai_tree</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_gallai_tree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns whether the current graph is a Gallai tree.</p>
<p>A graph is a Gallai tree if and only if it is
connected and its <span class="math">\(2\)</span>-connected components are all
isomorphic to complete graphs or odd cycles.</p>
<p>A connected graph is not degree-choosable if and
only if it is a Gallai tree <a class="reference internal" href="#erdos1978choos" id="id16">[erdos1978choos]</a>.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="erdos1978choos" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[erdos1978choos]</a></td><td>Erdos, P. and Rubin, A.L. and Taylor, H.
Proc. West Coast Conf. on Combinatorics
Graph Theory and Computing, Congressus Numerantium
vol 26, pages 125&#8211;157, 1979</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<p>A complete graph is, or course, a Gallai Tree:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_gallai_tree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The Petersen Graph is not:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_gallai_tree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A Graph built from vertex-disjoint complete graphs
linked by one edge to a special vertex <span class="math">\(-1\)</span> is a
&#8216;&#8217;star-shaped&#8217;&#8217; Gallai tree</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">connected_components</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_gallai_tree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_hamiltonian">
<tt class="descname">is_hamiltonian</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_hamiltonian" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether the current graph is Hamiltonian.</p>
<p>A graph (resp. digraph) is said to be Hamiltonian
if it contains as a subgraph a cycle (resp. a circuit)
going through all the vertices.</p>
<p>Testing for Hamiltonicity being NP-Complete, this
algorithm could run for some time depending on
the instance.</p>
<p>ALGORITHM:</p>
<p>See <tt class="docutils literal"><span class="pre">Graph.traveling_salesman_problem</span></tt>.</p>
<p>OUTPUT:</p>
<p>Returns <tt class="docutils literal"><span class="pre">True</span></tt> if a Hamiltonian cycle/circuit exists, and
<tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</p>
<p>NOTE:</p>
<p>This function, as <tt class="docutils literal"><span class="pre">hamiltonian_cycle</span></tt> and
<tt class="docutils literal"><span class="pre">traveling_salesman_problem</span></tt>, computes a Hamiltonian
cycle if it exists: the user should <em>NOT</em> test for
Hamiltonicity using <tt class="docutils literal"><span class="pre">is_hamiltonian</span></tt> before calling
<tt class="docutils literal"><span class="pre">hamiltonian_cycle</span></tt> or <tt class="docutils literal"><span class="pre">traveling_salesman_problem</span></tt>
as it would result in computing it twice.</p>
<p>EXAMPLES:</p>
<p>The Heawood Graph is known to be Hamiltonian</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The Petergraph, though, is not</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">ChvatalGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/16210">trac ticket #16210</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_immutable">
<tt class="descname">is_immutable</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_immutable" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns whether the graph is immutable.</p>
<p>EXAMPLES:</p>
<blockquote>
<div>sage: G = graphs.PetersenGraph()
sage: G.is_immutable()
False
sage: Graph(G, immutable=True).is_immutable()
True</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_independent_set">
<tt class="descname">is_independent_set</tt><big>(</big><em>vertices=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_independent_set" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns True if the set <tt class="docutils literal"><span class="pre">vertices</span></tt> is an independent
set, False if not. An independent set is a set of vertices such
that there is no edge between any two vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - Vertices can be a single vertex or an
iterable container of vertices, e.g. a list, set, graph, file or
numeric array. If not passed, defaults to the entire graph.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_independent_set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_independent_set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_interval">
<tt class="descname">is_interval</tt><big>(</big><em>certificate=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_interval" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Check whether self is an interval graph</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">certificate</span></tt> (boolean) &#8211; The function returns <tt class="docutils literal"><span class="pre">True</span></tt>
or <tt class="docutils literal"><span class="pre">False</span></tt> according to the graph, when <tt class="docutils literal"><span class="pre">certificate</span> <span class="pre">=</span>
<span class="pre">False</span></tt> (default). When <tt class="docutils literal"><span class="pre">certificate</span> <span class="pre">=</span> <span class="pre">True</span></tt> and the graph
is an interval graph, a dictionary whose keys are the
vertices and values are pairs of integers are returned
instead of <tt class="docutils literal"><span class="pre">True</span></tt>. They correspond to an embedding of the
interval graph, each vertex being represented by an interval
going from the first of the two values to the second.</li>
</ul>
<p>ALGORITHM:</p>
<p>Through the use of PQ-Trees</p>
<p>AUTHOR:</p>
<p>Nathann Cohen (implementation)</p>
<p>EXAMPLES:</p>
<p>A Petersen Graph is not chordal, nor can it be an interval
graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_interval</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Though we can build intervals from the corresponding random
generator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomIntervalGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_interval</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This method can also return, given an interval graph, a
possible embedding (we can actually compute all of them
through the PQ-Tree structures):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="s">&#39;:S__@_@A_@AB_@AC_@ACD_@ACDE_ACDEF_ACDEFG_ACDEGH_ACDEGHI_ACDEGHIJ_ACDEGIJK_ACDEGIJKL_ACDEGIJKLMaCEGIJKNaCEGIJKNaCGIJKNPaCIP&#39;</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">is_interval</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">d</span>                                    <span class="c"># not tested</span>
<span class="go">{0: (0, 20), 1: (1, 9), 2: (2, 36), 3: (3, 5), 4: (4, 38), 5: (6, 21), 6: (7, 27), 7: (8, 12), 8: (10, 29), 9: (11, 16), 10: (13, 39), 11: (14, 31), 12: (15, 32), 13: (17, 23), 14: (18, 22), 15: (19, 33), 16: (24, 25), 17: (26, 35), 18: (28, 30), 19: (34, 37)}</span>
</pre></div>
</div>
<p>From this embedding, we can clearly build an interval graph
isomorphic to the previous one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g2</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">IntervalGraph</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">g2</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Enumerate all small interval graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">sage: </span><span class="n">count</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">graphs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">augment</span><span class="o">=</span><span class="s">&#39;vertices&#39;</span><span class="p">,</span><span class="nb">property</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">is_interval</span><span class="p">()):</span> <span class="c"># not tested -- 50s</span>
<span class="go">....:     count[g.order()] += 1                                                  # not tested -- 50s</span>
<span class="gp">sage: </span><span class="n">count</span>                                                                      <span class="c"># not tested -- 50s</span>
<span class="go">[1, 1, 2, 4, 10, 27, 92, 369, 1807]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="pq_trees.html#module-sage.graphs.pq_trees" title="sage.graphs.pq_trees"><tt class="xref py py-mod docutils literal"><span class="pre">Interval</span> <span class="pre">Graph</span> <span class="pre">Recognition</span></tt></a>.</li>
<li><a class="reference internal" href="pq_trees.html#sage.graphs.pq_trees.PQ" title="sage.graphs.pq_trees.PQ"><tt class="xref py py-meth docutils literal"><span class="pre">PQ</span></tt></a>
&#8211; Implementation of PQ-Trees.</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_isomorphic">
<tt class="descname">is_isomorphic</tt><big>(</big><em>other</em>, <em>certify=False</em>, <em>verbosity=0</em>, <em>edge_labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_isomorphic" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests for isomorphism between self and other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">certify</span></tt> - if True, then output is <span class="math">\((a, b)\)</span>, where <span class="math">\(a\)</span>
is a boolean and <span class="math">\(b\)</span> is either a map or <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">edge_labels</span></tt> - default <tt class="docutils literal"><span class="pre">False</span></tt>, otherwise allows
only permutations respecting edge labels.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>either a boolean or, if <tt class="docutils literal"><span class="pre">certify</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, a tuple consisting
of a boolean and a map or <tt class="docutils literal"><span class="pre">None</span></tt></li>
</ul>
<p>EXAMPLES:</p>
<p>Graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.groups.perm_gps.permgroup_named</span> <span class="kn">import</span> <span class="n">SymmetricGroup</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">SymmetricGroup</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SymmetricGroup</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">certify</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">a</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.plot.graphics</span> <span class="kn">import</span> <span class="n">GraphicsArray</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.generic_graph_pyx</span> <span class="kn">import</span> <span class="n">spring_layout_fast</span>
<span class="gp">sage: </span><span class="n">position_D</span> <span class="o">=</span> <span class="n">spring_layout_fast</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">position_E</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="n">position_D</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">position_E</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">vert</span><span class="p">]]</span> <span class="o">=</span> <span class="n">position_D</span><span class="p">[</span><span class="n">vert</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">GraphicsArray</span><span class="p">([</span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">position_D</span><span class="p">),</span> <span class="n">E</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">position_E</span><span class="p">)])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Multigraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">certify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, {0: 1, 1: 0, 2: 2})</span>
</pre></div>
</div>
<p>Edge labeled graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Edge labeled digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">certify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, {0: 1, 1: 2, 2: 3, 3: 4, 4: 0})</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g1</span> <span class="o">=</span> <span class="s">&#39;~?A[~~{ACbCwV_~__OOcCW_fAA{CF{CCAAAC__bCCCwOOV___~____OOOOcCCCW___fAAAA&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;{CCCF{CCCCAAAAAC____bCCCCCwOOOOV_____~_O@ACG_@ACGOo@ACG?{?`A?GV_GO@AC}@?_OGC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;C?_OI@?K?I@?_OM?_OGD?F_A@OGC@{A@?_OG?O@?gCA?@_GCA@O?B_@OGCA?BoA@?gC?@{A?GO`?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;??_GO@AC??E?O`?CG??[?O`A?G??{?GO`A???|A?_GOC`AC@_OCGACEAGS?HA?_SA`aO@G?cOC_N&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;G_C@AOP?GnO@_GACOE?g?`OGACCOGaGOc?HA?`GORCG_AO@B?K@[`A?OCI@A@By?_K@?SCABA?H?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;SA?a@GC`CH?Q?C_c?cGRC@G_AOCOa@Ax?QC?_GOo_CNg@A?oC@CaCGO@CGA_O`?GSGPAGOC_@OO_&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;aCHaG?cO@CB?_`Ax?GQC?_cAOCG^OGAC@_D?IGO`?D?O_I?HAOO`AGOHA?cC?oAO`AW_Q?HCACAC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;GO`[_OCHA?_cCACG^O_@CAGO`A?GCOGc@?I?OQOC?IGC_o@CAGCCE?A@DBG_OA@C_CP?OG_VA_CO&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;G@D?_OA_DFgA@CO?aH?Ga@?a?_I?S@A@@Oa@?@P@GCO_AACO_a_?`K_GCQ@?cAOG_OGAwQ@?K?cC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;GH?I?ABy@C?G_S@@GCA@C`?OI?_D?OP@G?IGGP@O_AGCP?aG?GCPAX?cA?OGSGCGCAGCJ`?oAGCC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;HAA?A_CG^O@CAG_GCSCAGCCGOCG@OA_`?`?g_OACG_`CAGOAO_H?a_?`AXA?OGcAAOP?a@?CGVAC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;OG@_AGG`OA_?O`|?Ga?COKAAGCA@O`A?a?S@?HCG`?_?gO`AGGaC?PCAOGI?A@GO`K_CQ@?GO_`O&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;GCAACGVAG@_COOCQ?g?I?O`ByC?G_P?O`A?H@G?_P?`OAGC?gD?_C@_GCAGDG_OA@CCPC?AOQ??g&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;_R@_AGCO____OCC_@OAbaOC?g@C_H?AOOC@?a`y?PC?G`@OOH??cOG_OOAG@_COAP?WA?_KAGC@C&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;_CQ@?HAACH??c@P?_AWGaC?P?gA_C_GAD?I?Awa?S@?K?`C_GAOGCS?@|?COGaA@CAAOQ?AGCAGO&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;ACOG@_G_aC@_G@CA@@AHA?OGc?WAAH@G?P?_?cH_`CAGOGACc@@GA?S?CGVCG@OA_CICAOOC?PO?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;OG^OG_@CAC_cC?AOP?_OICG@?oAGCO_GO_GB@?_OG`AH?cA?OH?`P??cC_O?SCGR@O_AGCAI?Q?_&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;GGS?D?O`[OI?_D@@CCA?cCA_?_O`By?_PC?IGAGOQ?@A@?aO`A?Q@?K?__`_E?_GCA@CGO`C_GCQ&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;@A?gAOQ?@C?DCACGR@GCO_AGPA@@GAA?A_CO`Aw_I?S@?SCB@?OC_?_P@ACNgOC@A?aCGOCAGCA@&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;CA?H@GG_C@AOGa?OOG_O?g_OA?oDC_AO@GOCc?@P?_A@D??cC``O?cGAOGD?@OA_CAGCA?_cwKA?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;`?OWGG?_PO?I?S?H@?^OGAC@_Aa@CAGC?a@?_Q?@H?_OCHA?OQA_P?_G_O?WA?_IG_Q?HC@A@ADC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;A?AI?AC_?QAWOHA?cAGG_I?S?G_OG@GA?`[D?O_IA?`GGCS?OA_?c@?Q?^OAC@_G_Ca@CA@?OGCO&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;H@G@A@?GQC?_Q@GP?_OG?IGGB?OCGaG?cO@A__QGC?E?A@CH@G?GRAGOC_@GGOW@O?O_OGa?_c?G&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;V@CGA_OOaC?a_?a?A_CcC@?CNgA?oC@GGE@?_OH?a@?_?QA`A@?QC?_KGGO_OGCAa@?A?_KCGPC@&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;G_AOAGPGC?D@?a_A?@GGO`KH?Q?C_QGAA_?gOG_OA?_GG`AwH?SA?`?cAI?A@D?I?@?QA?`By?K@&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;?O`GGACA@CGCA@CC_?WO`?`A?OCH?`OCA@COG?I?oC@ACGPCG_AO@_aAA?Aa?g?GD@G?CO`AWOc?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;HA?OcG_?g@OGCAAAOC@ACJ_`OGACAGCS?CAGI?A`@?OCACG^&#39;</span>
<span class="gp">sage: </span><span class="n">g2</span> <span class="o">=</span> <span class="s">&#39;~?A[??osR?WARSETCJ_QWASehOXQg`QwChK?qSeFQ_sTIaWIV?XIR?KAC?B?`?COCG?o?O_&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;@_?`??B?`?o@_O_WCOCHC@_?`W?E?AD_O?WCCeO?WCSEGAGAIaA@_?aw?OK?ER?`?@_HQXA?B@Q_&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;pA?a@Qg_`?o?h[?GOK@IR?@A?BEQcoCG?K\IB?GOCWiTC?GOKWIV??CGEKdH_H_?CB?`?DC??_WC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;G?SO?AP?O_?g_?D_?`?C__?D_?`?CCo??@_O_XDC???WCGEGg_??a?`G_aa??E?AD_@cC??K?CJ?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;@@K?O?WCCe?aa?G?KAIB?Gg_A?a?ag_@DC?OK?CV??EOO@?o?XK??GH`A?B?Qco?Gg`A?B@Q_o?C&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;SO`?P?hSO?@DCGOK?IV???K_`A@_HQWC??_cCG?KXIRG?@D?GO?WySEG?@D?GOCWiTCC??a_CGEK&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;DJ_@??K_@A@bHQWAW?@@K??_WCG?g_?CSO?A@_O_@P??Gg_?Ca?`?@P??Gg_?D_?`?C__?EOO?Ao&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;?O_AAW?@@K???WCGEPP??Gg_??B?`?pDC??aa??AGACaAIG?@DC??K?CJ?BGG?@cC??K?CJ?@@K?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;?_e?G?KAAR?PP??Gg_A?B?a_oAIG?@DC?OCOCTC?Gg_?CSO@?o?P[??X@??K__A@_?qW??OR??GH&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;`A?B?Qco?Gg_?CSO`?@_hOW?AIG?@DCGOCOITC??PP??Gg`A@_@Qw??@cC??qACGE?dH_O?AAW?@&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;@GGO?WqSeO?AIG?@D?GO?WySEG?@DC??a_CGAKTIaA??PP??Gg@A@b@Qw?O?BGG?@c?GOKXIR?KA&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;C?H_?CCo?A@_O_?WCG@P??Gg_?CB?`?COCG@P??Gg_?Ca?`?E?AC?g_?CSO?Ao?O_@_?`@GG?@cC&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;??k?CG??WCGOR??GH_??B?`?o@_O`DC??aa???KACB?a?`AIG?@DC??COCHC@_?`AIG?@DC??K?C&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;J??o?O`cC??qA??E?AD_O?WC?OR??GH_A?B?_cq?B?_AIG?@DC?O?WCSEGAGA?Gg_?CSO@?P?PSO&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;OK?C?PP??Gg_A@_?aw?OK?C?X@??K__A@_?qWCG?K??GH_?CCo`?@_HQXA?B??AIG?@DCGO?WISE&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;GOCO??PP??Gg`A?a@Qg_`?o??@DC??aaCGE?DJ_@A@_??BGG?@cCGOK@IR?@A?BO?AAW?@@GGO?W&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;qSe?`?@g?@DC??a_CG?K\IB?GOCQ??PP??Gg@A?bDQg_@A@_O?AIG?@D?GOKWIV??CGE@??K__?E&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;O?`?pchK?_SA_OI@OGD?gCA_SA@OI?c@H?Q?c_H?QOC_HGAOCc?QOC_HGAOCc@GAQ?c@H?QD?gCA&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;_SA@OI@?gD?_SA_OKA_SA@OI@?gD?_SA_OI@OHI?c_H?QOC_HGAOCc@GAQ?eC_H?QOC_HGAOCc@G&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;AQ?c@XD?_SA_OI@OGD?gCA_SA@PKGO`A@ACGSGO`?`ACICGO_?ACGOcGO`?O`AC`ACHACGO???^?&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;????}Bw????Fo^???????Fo?}?????Bw?^?Bw?????GO`AO`AC`ACGACGOcGO`??aCGO_O`ADACG&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;OGO`A@ACGOA???@{?N_@{?????Fo?}????OFo????N_}????@{????Bw?OACGOgO`A@ACGSGO`?`&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;ACG?OaCGO_GO`AO`AC`ACGACGO_@G???Fo^?????}Bw????Fo??AC@{?????Fo?}?Fo?????^??A&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;OGO`AO`AC@ACGQCGO_GO`A?HAACGOgO`A@ACGOGO`A`ACG?GQ??^?Bw?????N_@{?????Fo?QC??&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;Fo^?????}????@{Fo???CHACGO_O`ACACGOgO`A@ACGO@AOcGO`?O`AC`ACGACGOcGO`?@GQFo??&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;??N_????^@{????Bw??`GRw?????N_@{?????Fo?}???HAO_OI@OGD?gCA_SA@OI@?gDK_??C@GA&#39;</span><span class="o">+</span>\
<span class="gp">... </span>  <span class="s">&#39;Q?c@H?Q?c_H?QOC_HEW????????????????????????~~~~~&#39;</span>
<span class="gp">sage: </span><span class="n">G1</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">G2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Ensure that isomorphic looped graphs with non-range vertex labels report
correctly (<a class="reference external" href="http://trac.sagemath.org/10814">trac ticket #10814</a>, fixed by <a class="reference external" href="http://trac.sagemath.org/8395">trac ticket #8395</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G1</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">G2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">loops</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">loops</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">certify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, {0: 0, 1: 1})</span>
<span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">certify</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">certify</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5})</span>
</pre></div>
</div>
<p>Ensure that <a class="reference external" href="http://trac.sagemath.org/11620">trac ticket #11620</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G1</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span>
<span class="gp">... </span>  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span>
<span class="gp">... </span>  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">),</span>
<span class="gp">... </span>  <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span>
<span class="gp">... </span>  <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span>
<span class="gp">... </span>  <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">)],</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">G1</span><span class="o">.</span><span class="n">relabel</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G1</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">G2</span><span class="o">.</span><span class="n">canonical_label</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">G2</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Ensure that <a class="reference external" href="http://trac.sagemath.org/13114">trac ticket #13114</a> is fixed</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gg</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">gg</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Ensure that <a class="reference external" href="http://trac.sagemath.org/14777">trac ticket #14777</a> is fixed</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>as well as <a class="reference external" href="http://trac.sagemath.org/18613">trac ticket #18613</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">certify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_planar">
<tt class="descname">is_planar</tt><big>(</big><em>on_embedding=None</em>, <em>kuratowski=False</em>, <em>set_embedding=False</em>, <em>set_pos=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_planar" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Test whether the graph is planar.</p>
<p>This wraps the reference implementation provided by John Boyer of the
linear time planarity algorithm by edge addition due to Boyer
Myrvold. (See reference code in <a class="reference internal" href="planarity.html#module-sage.graphs.planarity" title="sage.graphs.planarity"><tt class="xref py py-mod docutils literal"><span class="pre">planarity</span></tt></a>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument on_embedding takes precedence over
<tt class="docutils literal"><span class="pre">set_embedding</span></tt>. This means that only the <tt class="docutils literal"><span class="pre">on_embedding</span></tt>
combinatorial embedding will be tested for planarity and no
<tt class="docutils literal"><span class="pre">_embedding</span></tt> attribute will be set as a result of this function
call, unless <tt class="docutils literal"><span class="pre">on_embedding</span></tt> is None.</p>
</div>
<p>REFERENCE:</p>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>John M. Boyer and Wendy J. Myrvold, On the Cutting Edge:
Simplified <span class="math">\(O(n)\)</span> Planarity by Edge Addition. Journal of Graph
Algorithms and Applications, Vol. 8, No. 3, pp. 241-273,
2004.</td></tr>
</tbody>
</table>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">kuratowski</span></tt> - returns a tuple with boolean as first entry. If the
graph is nonplanar, will return the Kuratowski subgraph (i.e. an edge
subdivision of <span class="math">\(K_5\)</span> or <span class="math">\(K_{3,3}\)</span>) as the second tuple entry.  If the
graph is planar, returns <tt class="docutils literal"><span class="pre">None</span></tt> as the second entry.</li>
<li><tt class="docutils literal"><span class="pre">on_embedding</span></tt> - the embedding dictionary to test planarity
on. (i.e.: will return <tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt> only for the given
embedding.)</li>
<li><tt class="docutils literal"><span class="pre">set_embedding</span></tt> - whether or not to set the instance field variable
that contains a combinatorial embedding (clockwise ordering of
neighbors at each vertex). This value will only be set if a planar
embedding is found. It is stored as a Python dict: <tt class="docutils literal"><span class="pre">v1:</span> <span class="pre">[n1,n2,n3]</span></tt>
where <tt class="docutils literal"><span class="pre">v1</span></tt> is a vertex and <tt class="docutils literal"><span class="pre">n1,n2,n3</span></tt> are its neighbors.</li>
<li><tt class="docutils literal"><span class="pre">set_pos</span></tt> - whether or not to set the position
dictionary (for plotting) to reflect the combinatorial embedding.
Note that this value will default to False if set_emb is set to
False. Also, the position dictionary will only be updated if a
planar embedding is found.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_planar</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CircularLadderGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">set_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">()</span>
<span class="go">{0: [1, 4, 3],</span>
<span class="go"> 1: [2, 5, 0],</span>
<span class="go"> 2: [3, 6, 1],</span>
<span class="go"> 3: [0, 7, 2],</span>
<span class="go"> 4: [0, 5, 7],</span>
<span class="go"> 5: [1, 6, 4],</span>
<span class="go"> 6: [2, 7, 5],</span>
<span class="go"> 7: [4, 6, 3]}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">kuratowski</span><span class="o">=</span><span class="bp">True</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 0 0 0 1 0 0 0]</span>
<span class="go">[1 0 1 0 0 0 1 0 0]</span>
<span class="go">[0 1 0 1 0 0 0 1 0]</span>
<span class="go">[0 0 1 0 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 1 1 0]</span>
<span class="go">[1 0 0 0 0 0 0 1 1]</span>
<span class="go">[0 1 0 0 1 0 0 0 1]</span>
<span class="go">[0 0 1 0 1 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 1 1 0 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k43</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">result</span> <span class="o">=</span> <span class="n">k43</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">kuratowski</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">result</span>
<span class="go">(False, Graph on 6 vertices)</span>
<span class="gp">sage: </span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Multi-edged and looped graphs are partially supported:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]},</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_planar</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">on_embedding</span><span class="o">=</span><span class="p">{})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Cannot compute with embeddings of multiple-edged or looped graphs.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">set_pos</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Cannot compute with embeddings of multiple-edged or looped graphs.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">set_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Cannot compute with embeddings of multiple-edged or looped graphs.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">kuratowski</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, None)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_planar</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">b</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">kuratowski</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4]</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/18045">trac ticket #18045</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">set_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">on_embedding</span><span class="o">=</span><span class="n">emb</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/19193">trac ticket #19193</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Posets</span><span class="o">.</span><span class="n">BooleanLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">cover_relations_graph</span><span class="p">()</span><span class="o">.</span><span class="n">is_planar</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_regular">
<tt class="descname">is_regular</tt><big>(</big><em>k=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_regular" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if this graph is (<span class="math">\(k\)</span>-)regular.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">k</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) - the degree of regularity to
check for</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HoffmanSingletonGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_regular</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_regular</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>So the Hoffman-Singleton graph is regular, but not
9-regular.  In fact, we can now find the degree easily as
follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree_iterator</span><span class="p">())</span>
<span class="go">7</span>
</pre></div>
</div>
<p>The house graph is not regular:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">HouseGraph</span><span class="p">()</span><span class="o">.</span><span class="n">is_regular</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A graph without vertices is <span class="math">\(k\)</span>-regular for every <span class="math">\(k\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">()</span><span class="o">.</span><span class="n">is_regular</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_subgraph">
<tt class="descname">is_subgraph</tt><big>(</big><em>other</em>, <em>induced=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_subgraph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if the graph is a subgraph of <tt class="docutils literal"><span class="pre">other</span></tt>, and <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Please note that this method does not check whether <tt class="docutils literal"><span class="pre">self</span></tt>
contains a subgraph <em>isomorphic</em> to <tt class="docutils literal"><span class="pre">other</span></tt>, but only if it
directly contains it as a subgraph !</p>
<p class="last">By default <tt class="docutils literal"><span class="pre">induced</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt> for backwards compatibility.</p>
</div>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">induced</span></tt> - boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>) If set to <tt class="docutils literal"><span class="pre">True</span></tt> tests
whether the graph is an <em>induced</em> subgraph of <tt class="docutils literal"><span class="pre">other</span></tt> that is if
the vertices of the graph are also vertices of <tt class="docutils literal"><span class="pre">other</span></tt>, and the
edges of the graph are equal to the edges of <tt class="docutils literal"><span class="pre">other</span></tt> between the
vertices contained in the graph.</p>
<p>If set to <tt class="docutils literal"><span class="pre">False</span></tt> tests whether the graph is a subgraph of
<tt class="docutils literal"><span class="pre">other</span></tt> that is if all vertices of the graph are also in
<tt class="docutils literal"><span class="pre">other</span></tt> and all edges of the graph are also in <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>boolean &#8211; <tt class="docutils literal"><span class="pre">True</span></tt> iff the graph is a (possibly induced)
subgraph of <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>If you are interested in the (possibly induced) subgraphs
isomorphic to the graph in <tt class="docutils literal"><span class="pre">other</span></tt>, you are looking for
the following methods:</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search" title="sage.graphs.generic_graph.GenericGraph.subgraph_search"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search()</span></tt></a> &#8211; Find a subgraph
isomorphic to <tt class="docutils literal"><span class="pre">other</span></tt> inside of the graph.</li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_count" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_count"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_count()</span></tt></a> &#8211; Count the number
of such copies.</li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_iterator()</span></tt></a> &#8211;
Iterate over all the copies of <tt class="docutils literal"><span class="pre">other</span></tt> contained in the graph.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_subgraph</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_subgraph</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_subgraph</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">induced</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_subgraph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">induced</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Raise an error when self and other are of different types:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_subgraph</span><span class="p">(</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span> <span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The input parameter must be a Graph.</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_subgraph</span><span class="p">(</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span> <span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The input parameter must be a DiGraph.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_transitively_reduced">
<tt class="descname">is_transitively_reduced</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_transitively_reduced" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether the digraph is transitively reduced.</p>
<p>A digraph is transitively reduced if it is equal to its transitive
reduction.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">is_transitively_reduced</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">is_transitively_reduced</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[]})</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">is_transitively_reduced</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.is_vertex_transitive">
<tt class="descname">is_vertex_transitive</tt><big>(</big><em>partition=None</em>, <em>verbosity=0</em>, <em>edge_labels=False</em>, <em>order=False</em>, <em>return_group=True</em>, <em>orbits=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.is_vertex_transitive" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns whether the automorphism group of self is transitive within
the partition provided, by default the unit partition of the
vertices of self (thus by default tests for vertex transitivity in
the usual sense).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_vertex_transitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">is_vertex_transitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_vertex_transitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="o">.</span><span class="mo">01</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">is_vertex_transitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix">
<tt class="descname">kirchhoff_matrix</tt><big>(</big><em>weighted=None</em>, <em>indegree=True</em>, <em>normalized=False</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the Kirchhoff matrix (a.k.a. the Laplacian) of the graph.</p>
<p>The Kirchhoff matrix is defined to be <span class="math">\(D - M\)</span>, where <span class="math">\(D\)</span> is
the diagonal degree matrix (each diagonal entry is the degree
of the corresponding vertex), and <span class="math">\(M\)</span> is the adjacency matrix.
If <tt class="docutils literal"><span class="pre">normalized</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, then the returned matrix is
<span class="math">\(D^{-1/2}(D-M)D^{-1/2}\)</span>.</p>
<p>( In the special case of DiGraphs, <span class="math">\(D\)</span> is defined as the diagonal
in-degree matrix or diagonal out-degree matrix according to the
value of <tt class="docutils literal"><span class="pre">indegree</span></tt>)</p>
<p>INPUT:</p>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">weighted</span></tt> &#8211; Binary variable :</dt>
<dd><ul class="first simple">
<li>If <tt class="docutils literal"><span class="pre">True</span></tt>, the weighted adjacency matrix is used for <span class="math">\(M\)</span>,
and the diagonal matrix <span class="math">\(D\)</span> takes into account the weight of edges
(replace in the definition &#8220;degree&#8221; by &#8220;sum of the incident edges&#8221; ).</li>
<li>Else, each edge is assumed to have weight 1.</li>
</ul>
<p class="last">Default is to take weights into consideration if and only if the graph is
weighted.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">indegree</span></tt> &#8211; Binary variable  :</dt>
<dd><ul class="first">
<li><p class="first">If <tt class="docutils literal"><span class="pre">True</span></tt>, each diagonal entry of <span class="math">\(D\)</span> is equal to the
in-degree of the corresponding vertex.</p>
</li>
<li><p class="first">Else, each diagonal entry of <span class="math">\(D\)</span> is equal to the
out-degree of the corresponding vertex.</p>
<p>By default, <tt class="docutils literal"><span class="pre">indegree</span></tt> is set to <tt class="docutils literal"><span class="pre">True</span></tt></p>
</li>
</ul>
<p class="last">( This variable only matters when the graph is a digraph )</p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">normalized</span></tt> &#8211; Binary variable :</p>
<blockquote>
<div><ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">True</span></tt>, the returned matrix is
<span class="math">\(D^{-1/2}(D-M)D^{-1/2}\)</span>, a normalized version of the
Laplacian matrix.
(More accurately, the normalizing matrix used is equal to <span class="math">\(D^{-1/2}\)</span>
only for non-isolated vertices.  If vertex <span class="math">\(i\)</span> is isolated, then
diagonal entry <span class="math">\(i\)</span> in the matrix is 1, rather than a division by
zero.)</li>
<li>Else, the matrix <span class="math">\(D-M\)</span> is returned</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>Note that any additional keywords will be passed on to either
the <tt class="docutils literal"><span class="pre">adjacency_matrix</span></tt> or <tt class="docutils literal"><span class="pre">weighted_adjacency_matrix</span></tt> method.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Tom Boothby</li>
<li>Jason Grout</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">kirchhoff_matrix</span><span class="p">(</span><span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[ 8 -1 -3 -4]</span>
<span class="go">[-1  3 -2  0]</span>
<span class="go">[-3 -2  5  0]</span>
<span class="go">[-4  0  0  4]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">kirchhoff_matrix</span><span class="p">();</span> <span class="n">M</span>
<span class="go">[ 3 -1 -1 -1]</span>
<span class="go">[-1  2 -1  0]</span>
<span class="go">[-1 -1  2  0]</span>
<span class="go">[-1  0  0  1]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[                   1 -1/6*sqrt(3)*sqrt(2) -1/6*sqrt(3)*sqrt(2)         -1/3*sqrt(3)]</span>
<span class="go">[-1/6*sqrt(3)*sqrt(2)                    1                 -1/2                    0]</span>
<span class="go">[-1/6*sqrt(3)*sqrt(2)                 -1/2                    1                    0]</span>
<span class="go">[        -1/3*sqrt(3)                    0                    0                    1]</span>

<span class="gp">sage: </span><span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 0  1 -1]</span>
<span class="go">[ 0 -1  1]</span>
</pre></div>
</div>
<p>A weighted directed graph with loops, changing the variable <tt class="docutils literal"><span class="pre">indegree</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">}},</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">()</span>
<span class="go">[ 4 -3]</span>
<span class="go">[-4  3]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">}},</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">(</span><span class="n">indegree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[ 3 -3]</span>
<span class="go">[-4  4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.kronecker_product">
<tt class="descname">kronecker_product</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.kronecker_product" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the tensor product of self and other.</p>
<p>The tensor product of <span class="math">\(G\)</span> and <span class="math">\(H\)</span> is the graph <span class="math">\(L\)</span> with vertex set
<span class="math">\(V(L)\)</span> equal to the Cartesian product of the vertices <span class="math">\(V(G)\)</span> and <span class="math">\(V(H)\)</span>,
and <span class="math">\(((u,v), (w,x))\)</span> is an edge iff - <span class="math">\((u, w)\)</span> is an edge of self, and -
<span class="math">\((v, x)\)</span> is an edge of other.</p>
<p>The tensor product is also known as the categorical product and the
kronecker product (refering to the kronecker matrix product). See
<a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_product">Wikipedia article on the Kronecker product</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">T</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 21 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">T</span>
<span class="go">Graph on 200 vertices</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">900</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 1101 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Tensor product of graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (1, &#39;b&#39;)), ((0, &#39;b&#39;), (1, &#39;a&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;)), ((1, &#39;b&#39;), (2, &#39;a&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">H</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Tensor product of digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">J</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The tensor product of two DeBruijn digraphs of same diameter is a DeBruijn digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">B1</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B2</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">B1</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span> <span class="n">B2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.laplacian_matrix">
<tt class="descname">laplacian_matrix</tt><big>(</big><em>weighted=None</em>, <em>indegree=True</em>, <em>normalized=False</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.laplacian_matrix" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the Kirchhoff matrix (a.k.a. the Laplacian) of the graph.</p>
<p>The Kirchhoff matrix is defined to be <span class="math">\(D - M\)</span>, where <span class="math">\(D\)</span> is
the diagonal degree matrix (each diagonal entry is the degree
of the corresponding vertex), and <span class="math">\(M\)</span> is the adjacency matrix.
If <tt class="docutils literal"><span class="pre">normalized</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, then the returned matrix is
<span class="math">\(D^{-1/2}(D-M)D^{-1/2}\)</span>.</p>
<p>( In the special case of DiGraphs, <span class="math">\(D\)</span> is defined as the diagonal
in-degree matrix or diagonal out-degree matrix according to the
value of <tt class="docutils literal"><span class="pre">indegree</span></tt>)</p>
<p>INPUT:</p>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">weighted</span></tt> &#8211; Binary variable :</dt>
<dd><ul class="first simple">
<li>If <tt class="docutils literal"><span class="pre">True</span></tt>, the weighted adjacency matrix is used for <span class="math">\(M\)</span>,
and the diagonal matrix <span class="math">\(D\)</span> takes into account the weight of edges
(replace in the definition &#8220;degree&#8221; by &#8220;sum of the incident edges&#8221; ).</li>
<li>Else, each edge is assumed to have weight 1.</li>
</ul>
<p class="last">Default is to take weights into consideration if and only if the graph is
weighted.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">indegree</span></tt> &#8211; Binary variable  :</dt>
<dd><ul class="first">
<li><p class="first">If <tt class="docutils literal"><span class="pre">True</span></tt>, each diagonal entry of <span class="math">\(D\)</span> is equal to the
in-degree of the corresponding vertex.</p>
</li>
<li><p class="first">Else, each diagonal entry of <span class="math">\(D\)</span> is equal to the
out-degree of the corresponding vertex.</p>
<p>By default, <tt class="docutils literal"><span class="pre">indegree</span></tt> is set to <tt class="docutils literal"><span class="pre">True</span></tt></p>
</li>
</ul>
<p class="last">( This variable only matters when the graph is a digraph )</p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">normalized</span></tt> &#8211; Binary variable :</p>
<blockquote>
<div><ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">True</span></tt>, the returned matrix is
<span class="math">\(D^{-1/2}(D-M)D^{-1/2}\)</span>, a normalized version of the
Laplacian matrix.
(More accurately, the normalizing matrix used is equal to <span class="math">\(D^{-1/2}\)</span>
only for non-isolated vertices.  If vertex <span class="math">\(i\)</span> is isolated, then
diagonal entry <span class="math">\(i\)</span> in the matrix is 1, rather than a division by
zero.)</li>
<li>Else, the matrix <span class="math">\(D-M\)</span> is returned</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>Note that any additional keywords will be passed on to either
the <tt class="docutils literal"><span class="pre">adjacency_matrix</span></tt> or <tt class="docutils literal"><span class="pre">weighted_adjacency_matrix</span></tt> method.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Tom Boothby</li>
<li>Jason Grout</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">kirchhoff_matrix</span><span class="p">(</span><span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[ 8 -1 -3 -4]</span>
<span class="go">[-1  3 -2  0]</span>
<span class="go">[-3 -2  5  0]</span>
<span class="go">[-4  0  0  4]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">kirchhoff_matrix</span><span class="p">();</span> <span class="n">M</span>
<span class="go">[ 3 -1 -1 -1]</span>
<span class="go">[-1  2 -1  0]</span>
<span class="go">[-1 -1  2  0]</span>
<span class="go">[-1  0  0  1]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[                   1 -1/6*sqrt(3)*sqrt(2) -1/6*sqrt(3)*sqrt(2)         -1/3*sqrt(3)]</span>
<span class="go">[-1/6*sqrt(3)*sqrt(2)                    1                 -1/2                    0]</span>
<span class="go">[-1/6*sqrt(3)*sqrt(2)                 -1/2                    1                    0]</span>
<span class="go">[        -1/3*sqrt(3)                    0                    0                    1]</span>

<span class="gp">sage: </span><span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 0  1 -1]</span>
<span class="go">[ 0 -1  1]</span>
</pre></div>
</div>
<p>A weighted directed graph with loops, changing the variable <tt class="docutils literal"><span class="pre">indegree</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">}},</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">()</span>
<span class="go">[ 4 -3]</span>
<span class="go">[-4  3]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">}},</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">(</span><span class="n">indegree</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[ 3 -3]</span>
<span class="go">[-4  4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.latex_options">
<tt class="descname">latex_options</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.latex_options" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns an instance of
<a class="reference internal" href="graph_latex.html#sage.graphs.graph_latex.GraphLatex" title="sage.graphs.graph_latex.GraphLatex"><tt class="xref py py-class docutils literal"><span class="pre">GraphLatex</span></tt></a> for the graph.</p>
<p>Changes to this object will affect the LaTeX version of the graph.  For
a full explanation of how to use LaTeX to render graphs, see the
introduction to the <a class="reference internal" href="graph_latex.html#module-sage.graphs.graph_latex" title="sage.graphs.graph_latex"><tt class="xref py py-mod docutils literal"><span class="pre">graph_latex</span></tt></a> module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">opts</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">latex_options</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">opts</span>
<span class="go">LaTeX options for Petersen graph: {}</span>
<span class="gp">sage: </span><span class="n">opts</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">&#39;tkz_style&#39;</span><span class="p">,</span> <span class="s">&#39;Classic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">opts</span>
<span class="go">LaTeX options for Petersen graph: {&#39;tkz_style&#39;: &#39;Classic&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout">
<tt class="descname">layout</tt><big>(</big><em>layout=None</em>, <em>pos=None</em>, <em>dim=2</em>, <em>save_pos=False</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a layout for the vertices of this graph.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li>layout &#8211; one of &#8220;acyclic&#8221;, &#8220;circular&#8221;, &#8220;ranked&#8221;, &#8220;graphviz&#8221;, &#8220;planar&#8221;, &#8220;spring&#8221;, or &#8220;tree&#8221;</li>
<li>pos &#8211; a dictionary of positions or None (the default)</li>
<li>save_pos &#8211; a boolean</li>
<li>layout options &#8211; (see below)</li>
</ul>
</div></blockquote>
<p>If <tt class="docutils literal"><span class="pre">layout=algorithm</span></tt> is specified, this algorithm is used
to compute the positions.</p>
<p>Otherwise, if <tt class="docutils literal"><span class="pre">pos</span></tt> is specified, use the given positions.</p>
<p>Otherwise, try to fetch previously computed and saved positions.</p>
<p>Otherwise use the default layout (usually the spring layout)</p>
<p>If <tt class="docutils literal"><span class="pre">save_pos</span> <span class="pre">=</span> <span class="pre">True</span></tt>, the layout is saved for later use.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
<span class="go">{(&#39;0&#39;, 0): [2.22..., 0.832...],</span>
<span class="go"> (&#39;0&#39;, 1): [0.833..., 0.543...],</span>
<span class="go"> (&#39;1&#39;, 0): [1.12..., -0.830...],</span>
<span class="go"> (&#39;1&#39;, 1): [2.50..., -0.545...]}</span>

<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&quot;acyclic_dummy&quot;</span><span class="p">,</span> <span class="n">save_pos</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{(&#39;0&#39;, 0): [0.3..., 0],</span>
<span class="go"> (&#39;0&#39;, 1): [0.3..., 1],</span>
<span class="go"> (&#39;1&#39;, 0): [0.6..., 0],</span>
<span class="go"> (&#39;1&#39;, 1): [0.6..., 1]}</span>

<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">{(&#39;0&#39;, 0): [2.02..., 0.528..., 0.343...],</span>
<span class="go"> (&#39;0&#39;, 1): [1.61..., 0.260..., -0.927...],</span>
<span class="go"> (&#39;1&#39;, 0): [0.674..., -0.528..., -0.343...],</span>
<span class="go"> (&#39;1&#39;, 1): [1.07..., -0.260..., 0.927...]}</span>
</pre></div>
</div>
<p>Here is the list of all the available layout options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_plot</span> <span class="kn">import</span> <span class="n">layout_options</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">layout_options</span><span class="o">.</span><span class="n">iteritems</span><span class="p">())):</span>
<span class="gp">... </span>     <span class="k">print</span> <span class="s">&quot;option&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s">&quot;:&quot;</span><span class="p">,</span> <span class="n">value</span>
<span class="go">option by_component : Whether to do the spring layout by connected component -- a boolean.</span>
<span class="go">option dim : The dimension of the layout -- 2 or 3.</span>
<span class="go">option heights : A dictionary mapping heights to the list of vertices at this height.</span>
<span class="go">option iterations : The number of times to execute the spring layout algorithm.</span>
<span class="go">option layout : A layout algorithm -- one of : &quot;acyclic&quot;, &quot;circular&quot; (plots the graph with vertices evenly distributed on a circle), &quot;ranked&quot;, &quot;graphviz&quot;, &quot;planar&quot;, &quot;spring&quot; (traditional spring layout, using the graph&#39;s current positions as initial positions), or &quot;tree&quot; (the tree will be plotted in levels, depending on minimum distance for the root).</span>
<span class="go">option prog : Which graphviz layout program to use -- one of &quot;circo&quot;, &quot;dot&quot;, &quot;fdp&quot;, &quot;neato&quot;, or &quot;twopi&quot;.</span>
<span class="go">option save_pos : Whether or not to save the computed position for the graph.</span>
<span class="go">option spring : Use spring layout to finalize the current layout.</span>
<span class="go">option tree_orientation : The direction of tree branches -- &#39;up&#39;, &#39;down&#39;, &#39;left&#39; or &#39;right&#39;.</span>
<span class="go">option tree_root : A vertex designation for drawing trees. A vertex of the tree to be used as the root for the ``layout=&#39;tree&#39;`` option. If no root is specified, then one is chosen close to the center of the tree. Ignored unless ``layout=&#39;tree&#39;``</span>
</pre></div>
</div>
<p>Some of them only apply to certain layout algorithms. For
details, see <a class="reference internal" href="digraph.html#sage.graphs.digraph.DiGraph.layout_acyclic" title="sage.graphs.digraph.DiGraph.layout_acyclic"><tt class="xref py py-meth docutils literal"><span class="pre">layout_acyclic()</span></tt></a>, <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_planar" title="sage.graphs.generic_graph.GenericGraph.layout_planar"><tt class="xref py py-meth docutils literal"><span class="pre">layout_planar()</span></tt></a>,
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_circular" title="sage.graphs.generic_graph.GenericGraph.layout_circular"><tt class="xref py py-meth docutils literal"><span class="pre">layout_circular()</span></tt></a>, <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_spring" title="sage.graphs.generic_graph.GenericGraph.layout_spring"><tt class="xref py py-meth docutils literal"><span class="pre">layout_spring()</span></tt></a>, ...</p>
<p>..warning: unknown optional arguments are silently ignored</p>
<p>..warning: <tt class="docutils literal"><span class="pre">graphviz</span></tt> and <tt class="docutils literal"><span class="pre">dot2tex</span></tt> are currently required
to obtain a nice &#8216;acyclic&#8217; layout. See
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_graphviz" title="sage.graphs.generic_graph.GenericGraph.layout_graphviz"><tt class="xref py py-meth docutils literal"><span class="pre">layout_graphviz()</span></tt></a> for installation instructions.</p>
<p>A subclass may implement another layout algorithm <span class="math">\(blah\)</span>, by
implementing a method <tt class="docutils literal"><span class="pre">.layout_blah</span></tt>. It may override
the default layout by overriding <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout_default" title="sage.graphs.generic_graph.GenericGraph.layout_default"><tt class="xref py py-meth docutils literal"><span class="pre">layout_default()</span></tt></a>, and
similarly override the predefined layouts.</p>
<p>TODO: use this feature for all the predefined graphs classes
(like for the Petersen graph, ...), rather than systematically
building the layout at construction time.</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_circular">
<tt class="descname">layout_circular</tt><big>(</big><em>dim=2</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_circular" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes a circular layout for this graph</p>
<p>OUTPUT: a dictionary mapping vertices to positions</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CirculantGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">layout_circular</span><span class="p">()</span>
<span class="go">{0: [6.12...e-17, 1.0],</span>
<span class="go"> 1: [-0.78...,  0.62...],</span>
<span class="go"> 2: [-0.97..., -0.22...],</span>
<span class="go"> 3: [-0.43..., -0.90...],</span>
<span class="go"> 4: [0.43...,  -0.90...],</span>
<span class="go"> 5: [0.97...,  -0.22...],</span>
<span class="go"> 6: [0.78...,   0.62...]}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;circular&quot;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 22 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_default">
<tt class="descname">layout_default</tt><big>(</big><em>by_component=True</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_default" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes a spring layout for this graph</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">iterations</span></tt> &#8211; a positive integer</li>
<li><tt class="docutils literal"><span class="pre">dim</span></tt> &#8211; 2 or 3 (default: 2)</li>
</ul>
</div></blockquote>
<p>OUTPUT: a dictionary mapping vertices to positions</p>
<p>Returns a layout computed by randomly arranging the vertices
along the given heights</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">LadderGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">#TODO!!!!</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">layout_spring</span><span class="p">()</span>
<span class="go">{0: [1.28..., -0.94...],</span>
<span class="go"> 1: [1.57..., -0.10...],</span>
<span class="go"> 2: [1.83..., 0.74...],</span>
<span class="go"> 3: [0.53..., -0.75...],</span>
<span class="go"> 4: [0.79..., 0.10...],</span>
<span class="go"> 5: [1.08..., 0.94...]}</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">LadderGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;spring&quot;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 34 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_extend_randomly">
<tt class="descname">layout_extend_randomly</tt><big>(</big><em>pos</em>, <em>dim=2</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_extend_randomly" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Extends randomly a partial layout</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">pos</span></tt>: a dictionary mapping vertices to positions</li>
</ul>
</div></blockquote>
<p>OUTPUT: a dictionary mapping vertices to positions</p>
<p>The vertices not referenced in <tt class="docutils literal"><span class="pre">pos</span></tt> are assigned random
positions within the box delimited by the other vertices.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_extend_randomly</span><span class="p">({(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)})</span>
<span class="go">{(&#39;0&#39;, 0): (0, 0),</span>
<span class="go"> (&#39;0&#39;, 1): [0.0446..., 0.332...],</span>
<span class="go"> (&#39;1&#39;, 0): [0.111..., 0.514...],</span>
<span class="go"> (&#39;1&#39;, 1): (1, 1)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_graphviz">
<tt class="descname">layout_graphviz</tt><big>(</big><em>dim=2</em>, <em>prog='dot'</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_graphviz" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calls <tt class="docutils literal"><span class="pre">graphviz</span></tt> to compute a layout of the vertices of this graph.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">prog</span></tt> &#8211; one of &#8220;dot&#8221;, &#8220;neato&#8221;, &#8220;twopi&#8221;, &#8220;circo&#8221;, or &#8220;fdp&#8221;</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">layout_graphviz</span><span class="p">()</span>  <span class="c"># optional - dot2tex graphviz</span>
<span class="go">{(&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...],</span>
<span class="go"> (&#39;...&#39;, ...): [...,...]}</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;graphviz&quot;</span><span class="p">)</span>  <span class="c"># optional - dot2tex graphviz</span>
<span class="go">Graphics object consisting of 29 graphics primitives</span>
</pre></div>
</div>
<p>Note: the actual coordinates are not deterministic</p>
<p>By default, an acyclic layout is computed using <tt class="docutils literal"><span class="pre">graphviz</span></tt>&#8216;s
<tt class="docutils literal"><span class="pre">dot</span></tt> layout program. One may specify an alternative layout
program:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;graphviz&quot;</span><span class="p">,</span> <span class="n">prog</span> <span class="o">=</span> <span class="s">&quot;dot&quot;</span><span class="p">)</span>   <span class="c"># optional - dot2tex graphviz</span>
<span class="go">Graphics object consisting of 29 graphics primitives</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;graphviz&quot;</span><span class="p">,</span> <span class="n">prog</span> <span class="o">=</span> <span class="s">&quot;neato&quot;</span><span class="p">)</span> <span class="c"># optional - dot2tex graphviz</span>
<span class="go">Graphics object consisting of 29 graphics primitives</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;graphviz&quot;</span><span class="p">,</span> <span class="n">prog</span> <span class="o">=</span> <span class="s">&quot;twopi&quot;</span><span class="p">)</span> <span class="c"># optional - dot2tex graphviz</span>
<span class="go">Graphics object consisting of 29 graphics primitives</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;graphviz&quot;</span><span class="p">,</span> <span class="n">prog</span> <span class="o">=</span> <span class="s">&quot;fdp&quot;</span><span class="p">)</span>   <span class="c"># optional - dot2tex graphviz</span>
<span class="go">Graphics object consisting of 29 graphics primitives</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">BalancedTree</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;graphviz&quot;</span><span class="p">,</span> <span class="n">prog</span> <span class="o">=</span> <span class="s">&quot;circo&quot;</span><span class="p">)</span>  <span class="c"># optional - dot2tex graphviz</span>
<span class="go">Graphics object consisting of 62 graphics primitives</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Put here some cool examples showcasing graphviz features.</p>
</div>
<p>This requires <tt class="docutils literal"><span class="pre">graphviz</span></tt> and the <tt class="docutils literal"><span class="pre">dot2tex</span></tt> spkg. Here are
some installation tips:</p>
<blockquote>
<div><ul class="simple">
<li>Install graphviz &gt;= 2.14 so that the programs dot, neato, ...
are in your path. The graphviz suite can be download from
<a class="reference external" href="http://graphviz.org">http://graphviz.org</a>.</li>
<li>Install dot2tex with <tt class="docutils literal"><span class="pre">sage</span> <span class="pre">-i</span> <span class="pre">dot2tex</span></tt></li>
</ul>
</div></blockquote>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">Use the graphviz functionality of Networkx 1.0 once it
will be merged into Sage.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_planar">
<tt class="descname">layout_planar</tt><big>(</big><em>set_embedding=False</em>, <em>on_embedding=None</em>, <em>external_face=None</em>, <em>test=False</em>, <em>circular=False</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_planar" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Uses Schnyder&#8217;s algorithm to compute a planar layout for self,
raising an error if self is not planar.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">set_embedding</span></tt> - if True, sets the combinatorial
embedding used (see self.get_embedding())</li>
<li><tt class="docutils literal"><span class="pre">on_embedding</span></tt> - dict: provide a combinatorial
embedding</li>
<li><tt class="docutils literal"><span class="pre">external_face</span></tt> - ignored</li>
<li><tt class="docutils literal"><span class="pre">test</span></tt> - if True, perform sanity tests along the way</li>
<li><tt class="docutils literal"><span class="pre">circular</span></tt> - ignored</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_planar_positions</span><span class="p">(</span><span class="n">test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">BalancedTree</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_planar_positions</span><span class="p">(</span><span class="n">test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_planar_positions</span><span class="p">(</span><span class="n">test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_planar_positions</span><span class="p">(</span><span class="n">test</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">set_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Complete graph is not a planar graph</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_ranked">
<tt class="descname">layout_ranked</tt><big>(</big><em>heights=None</em>, <em>dim=2</em>, <em>spring=False</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes a ranked layout for this graph</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li>heights &#8211; a dictionary mapping heights to the list of vertices at this height</li>
</ul>
</div></blockquote>
<p>OUTPUT: a dictionary mapping vertices to positions</p>
<p>Returns a layout computed by randomly arranging the vertices
along the given heights</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">LadderGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">layout_ranked</span><span class="p">(</span><span class="n">heights</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="p">(</span><span class="n">i</span><span class="p">,[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">))</span>
<span class="go">{0: [0.668..., 0],</span>
<span class="go"> 1: [0.667..., 1],</span>
<span class="go"> 2: [0.677..., 2],</span>
<span class="go"> 3: [1.34..., 0],</span>
<span class="go"> 4: [1.33..., 1],</span>
<span class="go"> 5: [1.33..., 2]}</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">LadderGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;ranked&quot;</span><span class="p">,</span> <span class="n">heights</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="p">(</span><span class="n">i</span><span class="p">,[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">))</span>
<span class="go">Graphics object consisting of 34 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_spring">
<tt class="descname">layout_spring</tt><big>(</big><em>by_component=True</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_spring" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes a spring layout for this graph</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">iterations</span></tt> &#8211; a positive integer</li>
<li><tt class="docutils literal"><span class="pre">dim</span></tt> &#8211; 2 or 3 (default: 2)</li>
</ul>
</div></blockquote>
<p>OUTPUT: a dictionary mapping vertices to positions</p>
<p>Returns a layout computed by randomly arranging the vertices
along the given heights</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">LadderGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">#TODO!!!!</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">layout_spring</span><span class="p">()</span>
<span class="go">{0: [1.28..., -0.94...],</span>
<span class="go"> 1: [1.57..., -0.10...],</span>
<span class="go"> 2: [1.83..., 0.74...],</span>
<span class="go"> 3: [0.53..., -0.75...],</span>
<span class="go"> 4: [0.79..., 0.10...],</span>
<span class="go"> 5: [1.08..., 0.94...]}</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">LadderGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s">&quot;spring&quot;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 34 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.layout_tree">
<tt class="descname">layout_tree</tt><big>(</big><em>tree_orientation='down'</em>, <em>tree_root=None</em>, <em>dim=2</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.layout_tree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes an ordered tree layout for this graph, which should
be a tree (no non-oriented cycles).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">tree_root</span></tt> &#8211; the root vertex. By default <tt class="docutils literal"><span class="pre">None</span></tt>. In
this case, a vertex is chosen close to the center of the
tree.</li>
<li><tt class="docutils literal"><span class="pre">tree_orientation</span></tt> &#8211; the direction in which the tree is
growing, can be &#8216;up&#8217;, &#8216;down&#8217;, &#8216;left&#8217; or &#8216;right&#8217; (default is
&#8216;down&#8217;)</li>
</ul>
<p>OUTPUT: a dictionary mapping vertices to positions</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomLobster</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;tree&#39;</span><span class="p">,</span> <span class="n">tree_orientation</span><span class="o">=</span><span class="s">&#39;up&#39;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HoffmanSingletonGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">starting_vertex</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;tree&#39;</span><span class="p">,</span> <span class="n">tree_root</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">BalancedTree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">layout_tree</span><span class="p">(</span><span class="n">tree_root</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">{0: (1.5, 0),</span>
<span class="go"> 1: (2.5, -1),</span>
<span class="go"> 2: (0.5, -1),</span>
<span class="go"> 3: (3.0, -2),</span>
<span class="go"> 4: (2.0, -2),</span>
<span class="go"> 5: (1.0, -2),</span>
<span class="go"> 6: (0.0, -2)}</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">BalancedTree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&quot;tree&quot;</span><span class="p">,</span> <span class="n">tree_root</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tree_orientation</span> <span class="o">=</span> <span class="s">&quot;up&quot;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 62 graphics primitives</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomTree</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&quot;tree&quot;</span><span class="p">,</span> <span class="n">tree_orientation</span> <span class="o">=</span> <span class="s">&quot;right&quot;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 160 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;tree&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Cannot use tree layout on this graph: self.is_tree() returns False.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.lex_BFS">
<tt class="descname">lex_BFS</tt><big>(</big><em>reverse=False</em>, <em>tree=False</em>, <em>initial_vertex=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.lex_BFS" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Performs a Lex BFS on the graph.</p>
<p>A Lex BFS ( or Lexicographic Breadth-First Search ) is a Breadth
First Search used for the recognition of Chordal Graphs. For more
information, see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Lexicographic_breadth-first_search">Wikipedia article on Lex-BFS</a>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">reverse</span></tt> (boolean) &#8211; whether to return the vertices
in discovery order, or the reverse.</p>
<p><tt class="docutils literal"><span class="pre">False</span></tt> by default.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">tree</span></tt> (boolean) &#8211; whether to return the discovery
directed tree (each vertex being linked to the one that
saw it for the first time)</p>
<p><tt class="docutils literal"><span class="pre">False</span></tt> by default.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">initial_vertex</span></tt> &#8211; the first vertex to consider.</p>
<p><tt class="docutils literal"><span class="pre">None</span></tt> by default.</p>
</li>
</ul>
<p>ALGORITHM:</p>
<p>This algorithm maintains for each vertex left in the graph
a code corresponding to the vertices already removed. The
vertex of maximal code ( according to the lexicographic
order ) is then removed, and the codes are updated.</p>
<p>This algorithm runs in time <span class="math">\(O(n^2)\)</span> ( where <span class="math">\(n\)</span> is the
number of vertices in the graph ), which is not optimal.
An optimal algorithm would run in time <span class="math">\(O(m)\)</span> ( where <span class="math">\(m\)</span>
is the number of edges in the graph ), and require the use
of a doubly-linked list which are not available in python
and can not really be written efficiently. This could be
done in Cython, though.</p>
<p>EXAMPLE:</p>
<p>A Lex BFS is obviously an ordering of the vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">lex_BFS</span><span class="p">())</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a Chordal Graph, a reversed Lex BFS is a Perfect
Elimination Order</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">lex_BFS</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(2, 1), (2, 0), (1, 1), (1, 0), (0, 1), (0, 0)]</span>
</pre></div>
</div>
<p>And the vertices at the end of the tree of discovery are, for
chordal graphs, simplicial vertices (their neighborhood is
a complete graph):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">ClawGraph</span><span class="p">()</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">lex_BFS</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">peo</span><span class="p">,</span> <span class="n">tree</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">lex_BFS</span><span class="p">(</span><span class="n">initial_vertex</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span>  <span class="n">tree</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tree</span> <span class="k">if</span> <span class="n">tree</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">.</span><span class="n">is_clique</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>There were some problems with the following call in the past (<a class="reference external" href="http://trac.sagemath.org/10899">trac ticket #10899</a>) &#8211; now
it should be fine:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">lex_BFS</span><span class="p">(</span><span class="n">tree</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">([0], Digraph on 1 vertex)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.lexicographic_product">
<tt class="descname">lexicographic_product</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.lexicographic_product" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the lexicographic product of self and other.</p>
<p>The lexicographic product of <span class="math">\(G\)</span> and <span class="math">\(H\)</span> is the graph <span class="math">\(L\)</span> with vertex
set <span class="math">\(V(L)=V(G)\times V(H)\)</span>, and <span class="math">\(((u,v), (w,x))\)</span> is an edge iff :</p>
<ul class="simple">
<li><span class="math">\((u, w)\)</span> is an edge of <span class="math">\(G\)</span>, or</li>
<li><span class="math">\(u = w\)</span> and <span class="math">\((v, x)\)</span> is an edge of <span class="math">\(H\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 36 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Graph on 200 vertices</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 3501 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Lexicographic product of graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (0, &#39;b&#39;)), ((0, &#39;a&#39;), (1, &#39;a&#39;)), ((0, &#39;a&#39;), (1, &#39;b&#39;)), ((0, &#39;b&#39;), (1, &#39;a&#39;)), ((0, &#39;b&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;a&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;)), ((1, &#39;b&#39;), (2, &#39;a&#39;)), ((1, &#39;b&#39;), (2, &#39;b&#39;)), ((2, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">H</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Lexicographic product of digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (0, &#39;b&#39;)), ((0, &#39;a&#39;), (1, &#39;a&#39;)), ((0, &#39;a&#39;), (1, &#39;b&#39;)), ((0, &#39;b&#39;), (1, &#39;a&#39;)), ((0, &#39;b&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;a&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;)), ((1, &#39;b&#39;), (2, &#39;a&#39;)), ((1, &#39;b&#39;), (2, &#39;b&#39;)), ((2, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">J</span><span class="o">.</span><span class="n">lexicographic_product</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.line_graph">
<tt class="descname">line_graph</tt><big>(</big><em>labels=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.line_graph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the line graph of the (di)graph.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">labels</span></tt> (boolean) &#8211; whether edge labels should be taken in
consideration. If <tt class="docutils literal"><span class="pre">labels=True</span></tt>, the vertices of the line graph will be
triples <tt class="docutils literal"><span class="pre">(u,v,label)</span></tt>, and pairs of vertices otherwise.</p>
<p>This is set to <tt class="docutils literal"><span class="pre">True</span></tt> by default.</p>
</li>
</ul>
<p>The line graph of an undirected graph G is an undirected graph H such that
the vertices of H are the edges of G and two vertices e and f of H are
adjacent if e and f share a common vertex in G. In other words, an edge in H
represents a path of length 2 in G.</p>
<p>The line graph of a directed graph G is a directed graph H such that the
vertices of H are the edges of G and two vertices e and f of H are adjacent
if e and f share a common vertex in G and the terminal vertex of e is the
initial vertex of f. In other words, an edge in H represents a (directed)
path of length 2 in G.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As a <a class="reference internal" href="graph.html#sage.graphs.graph.Graph" title="sage.graphs.graph.Graph"><tt class="xref py py-class docutils literal"><span class="pre">Graph</span></tt></a> object only accepts hashable objects as vertices
(and as the vertices of the line graph are the edges of the graph), this
code will fail if edge labels are not hashable. You can also set the
argument <tt class="docutils literal"><span class="pre">labels=False</span></tt> to ignore labels.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li>The <a class="reference internal" href="line_graph.html#module-sage.graphs.line_graph" title="sage.graphs.line_graph"><tt class="xref py py-mod docutils literal"><span class="pre">line_graph</span></tt></a> module.</li>
<li><a class="reference internal" href="graph_generators.html#sage.graphs.graph_generators.GraphGenerators.line_graph_forbidden_subgraphs" title="sage.graphs.graph_generators.GraphGenerators.line_graph_forbidden_subgraphs"><tt class="xref py py-meth docutils literal"><span class="pre">line_graph_forbidden_subgraphs()</span></tt></a>
&#8211; the forbidden subgraphs of a line graph.</li>
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.is_line_graph" title="sage.graphs.graph.Graph.is_line_graph"><tt class="xref py py-meth docutils literal"><span class="pre">is_line_graph()</span></tt></a> &#8211; tests whether a graph is a line graph.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">line_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(0, 1, None),</span>
<span class="go">(0, 2, None),</span>
<span class="go">(0, 3, None),</span>
<span class="go">(1, 2, None),</span>
<span class="go">(1, 3, None),</span>
<span class="go">(2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 1 1 1 1 0]</span>
<span class="go">[1 0 1 1 0 1]</span>
<span class="go">[1 1 0 0 1 1]</span>
<span class="go">[1 1 0 0 1 1]</span>
<span class="go">[1 0 1 1 0 1]</span>
<span class="go">[0 1 1 1 1 0]</span>
<span class="gp">sage: </span><span class="n">h2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">line_graph</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h2</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(0, 1), (0, 2), (0, 3), (1, 2), (1, 3), (2, 3)]</span>
<span class="gp">sage: </span><span class="n">h2</span><span class="o">.</span><span class="n">am</span><span class="p">()</span> <span class="o">==</span> <span class="n">h</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">4</span><span class="p">],</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">line_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(1, 2, None),</span>
<span class="go">(1, 3, None),</span>
<span class="go">(1, 4, None),</span>
<span class="go">(2, 3, None),</span>
<span class="go">(2, 4, None),</span>
<span class="go">(3, 4, None)]</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[((1, 2, None), (2, 3, None), None),</span>
<span class="go"> ((1, 2, None), (2, 4, None), None),</span>
<span class="go"> ((1, 3, None), (3, 4, None), None),</span>
<span class="go"> ((2, 3, None), (3, 4, None), None)]</span>
</pre></div>
</div>
<p>Tests:</p>
<p><a class="reference external" href="http://trac.sagemath.org/13787">trac ticket #13787</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">KneserGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">line_graph</span><span class="p">()</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">line_graph</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.longest_path">
<tt class="descname">longest_path</tt><big>(</big><em>s=None</em>, <em>t=None</em>, <em>use_edge_labels=False</em>, <em>algorithm='MILP'</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.longest_path" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a longest path of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">s</span></tt> (vertex) &#8211; forces the source of the path (the method then
returns the longest path starting at <tt class="docutils literal"><span class="pre">s</span></tt>). The argument is set to
<tt class="docutils literal"><span class="pre">None</span></tt> by default, which means that no constraint is set upon the
first vertex in the path.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">t</span></tt> (vertex) &#8211; forces the destination of the path (the method then
returns the longest path ending at <tt class="docutils literal"><span class="pre">t</span></tt>). The argument is set to
<tt class="docutils literal"><span class="pre">None</span></tt> by default, which means that no constraint is set upon the
last vertex in the path.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> (boolean) &#8211; whether the labels on the edges are
to be considered as weights (a label set to <tt class="docutils literal"><span class="pre">None</span></tt> or <tt class="docutils literal"><span class="pre">{}</span></tt> being
considered as a weight of <span class="math">\(1\)</span>). Set to <tt class="docutils literal"><span class="pre">False</span></tt> by default.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; one of <tt class="docutils literal"><span class="pre">&quot;MILP&quot;</span></tt> (default) or <tt class="docutils literal"><span class="pre">&quot;backtrack&quot;</span></tt>. Two
remarks on this respect:</p>
<blockquote>
<div><ul class="simple">
<li>While the MILP formulation returns an exact answer, the
backtrack algorithm is a randomized heuristic.</li>
<li>As the backtrack algorithm does not support edge weighting,
setting <tt class="docutils literal"><span class="pre">use_edge_labels=True</span></tt> will force the use of the MILP
algorithm.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify the Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The length of a path is assumed to be the number of its edges, or
the sum of their labels.</p>
</div>
<p>OUTPUT:</p>
<p>A subgraph of <tt class="docutils literal"><span class="pre">self</span></tt> corresponding to a (directed if <tt class="docutils literal"><span class="pre">self</span></tt> is
directed) longest path. If <tt class="docutils literal"><span class="pre">use_edge_labels</span> <span class="pre">==</span> <span class="pre">True</span></tt>, a pair <tt class="docutils literal"><span class="pre">weight,</span>
<span class="pre">path</span></tt> is returned.</p>
<p>ALGORITHM:</p>
<p>Mixed Integer Linear Programming. (This problem is known to be NP-Hard).</p>
<p>EXAMPLES:</p>
<p>Petersen&#8217;s graph being hypohamiltonian, it has a longest path
of length <span class="math">\(n-2\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lp</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The heuristic totally agrees:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;backtrack&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 2, None), (2, 3, None), (3, 4, None), (4, 9, None), (5, 7, None), (5, 8, None), (6, 8, None), (6, 9, None)]</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../_images/generic_graph-1.png" src="../../_images/generic_graph-1.png" />
</div>
<p>Let us compute longest paths on random graphs with random weights. Each
time, we ensure the resulting graph is indeed a path:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>          <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">random</span><span class="p">())</span>
<span class="gp">... </span>      <span class="n">lp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">lp</span><span class="o">.</span><span class="n">is_forest</span><span class="p">()</span> <span class="ow">or</span>
<span class="gp">... </span>          <span class="ow">not</span> <span class="nb">max</span><span class="p">(</span><span class="n">lp</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">or</span>
<span class="gp">... </span>          <span class="ow">not</span> <span class="n">lp</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()):</span>
<span class="gp">... </span>          <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error!&quot;</span><span class="p">)</span>
<span class="gp">... </span>          <span class="k">break</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The argument <tt class="docutils literal"><span class="pre">algorithm</span></tt> must be either <tt class="docutils literal"><span class="pre">'backtrack'</span></tt> or
<tt class="docutils literal"><span class="pre">'MILP'</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">algorithm must be either &#39;backtrack&#39; or &#39;MILP&#39;</span>
</pre></div>
</div>
<p>Disconnected graphs not weighted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g1</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">g1</span>
<span class="gp">sage: </span><span class="n">lp1</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lp2</span> <span class="o">=</span> <span class="n">g2</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">lp1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lp2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Disconnected graphs weighted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g1</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">random</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">g2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">g1</span>
<span class="gp">sage: </span><span class="n">lp1</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lp2</span> <span class="o">=</span> <span class="n">g2</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lp1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">lp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Empty graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">()</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="go">Graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">()</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, Graph on 0 vertices]</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">()</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="go">Graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">()</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, Graph on 0 vertices]</span>
</pre></div>
</div>
<p>Trivial graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="go">Graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, Graph on 0 vertices]</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="go">Graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, Graph on 0 vertices]</span>
</pre></div>
</div>
<p>Random test for digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>          <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">random</span><span class="p">())</span>
<span class="gp">... </span>      <span class="n">lp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">lp</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span> <span class="ow">or</span>
<span class="gp">... </span>          <span class="ow">not</span> <span class="nb">max</span><span class="p">(</span><span class="n">lp</span><span class="o">.</span><span class="n">out_degree</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">or</span>
<span class="gp">... </span>          <span class="ow">not</span> <span class="nb">max</span><span class="p">(</span><span class="n">lp</span><span class="o">.</span><span class="n">in_degree</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">or</span>
<span class="gp">... </span>          <span class="ow">not</span> <span class="n">lp</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()):</span>
<span class="gp">... </span>          <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error!&quot;</span><span class="p">)</span>
<span class="gp">... </span>          <span class="k">print</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="gp">... </span>          <span class="k">break</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/13019">trac ticket #13019</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">longest_path</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Subgraph of (Complete graph): Digraph on 5 vertices</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/14412">trac ticket #14412</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)}</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">==</span><span class="p">{</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">longest_path</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.loop_edges">
<tt class="descname">loop_edges</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.loop_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of all loops in the graph.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loop_edges</span><span class="p">()</span>
<span class="go">[(0, 0, None), (1, 1, None), (2, 2, None), (3, 3, None)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">loop_edges</span><span class="p">()</span>
<span class="go">[(0, 0, None), (1, 1, None), (2, 2, None), (3, 3, None)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loop_edges</span><span class="p">()</span>
<span class="go">[(0, 0, None), (1, 1, None), (2, 2, None), (3, 3, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.loop_vertices">
<tt class="descname">loop_vertices</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.loop_vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of vertices with loops.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loop_vertices</span><span class="p">()</span>
<span class="go">[0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.loops">
<tt class="descname">loops</tt><big>(</big><em>labels=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.loops" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns any loops in the (di)graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">labels</span></tt> &#8211; whether returned edges have labels ((u,v,l)) or not ((u,v)).</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Looped graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Looped digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[(0, 0, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">loops</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.max_cut">
<tt class="descname">max_cut</tt><big>(</big><em>value_only=True</em>, <em>use_edge_labels=False</em>, <em>vertices=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.max_cut" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a maximum edge cut of the graph. For more information, see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Cut_%28graph_theory%29">Wikipedia article on cuts</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt> (default), only the value is returned.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, both the value and a maximum edge cut
are returned.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, computes a maximum weighted cut
where each edge has a weight defined by its label. (If
an edge has no label, <span class="math">\(1\)</span> is assumed.)</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, each edge has weight <span class="math">\(1\)</span>.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, also returns the two sets of
vertices that are disconnected by the cut. This implies
<tt class="docutils literal"><span class="pre">value_only=False</span></tt>.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>EXAMPLE:</p>
<p>Quite obviously, the max cut of a bipartite graph
is the number of edges, and the two sets of vertices
are the the two sides</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">value</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="p">[</span> <span class="n">setA</span><span class="p">,</span> <span class="n">setB</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">max_cut</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">value</span> <span class="o">==</span> <span class="mi">5</span><span class="o">*</span><span class="mi">6</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">bsetA</span><span class="p">,</span> <span class="n">bsetB</span>  <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="n">g</span><span class="o">.</span><span class="n">bipartite_sets</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">bsetA</span> <span class="o">==</span> <span class="n">setA</span> <span class="ow">and</span> <span class="n">bsetB</span> <span class="o">==</span> <span class="n">setB</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">((</span><span class="n">bsetA</span> <span class="o">==</span> <span class="n">setB</span> <span class="ow">and</span> <span class="n">bsetB</span> <span class="o">==</span> <span class="n">setA</span> <span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The max cut of a Petersen graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">max_cut</span><span class="p">()</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.merge_vertices">
<tt class="descname">merge_vertices</tt><big>(</big><em>vertices</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.merge_vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Merge vertices.</p>
<p>This function replaces a set <span class="math">\(S\)</span> of vertices by a single vertex
<span class="math">\(v_{new}\)</span>, such that the edge <span class="math">\(uv_{new}\)</span> exists if and only if
<span class="math">\(\exists v'\in S: (u,v')\in G\)</span>.</p>
<p>The new vertex is named after the first vertex in the list
given in argument. If this first name is None, a new vertex
is created.</p>
<p>In the case of multigraphs, the multiplicity is preserved.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; the set of vertices to be merged</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">merge_vertices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 2, None)]</span>

<span class="gp">sage: </span><span class="c"># With a Multigraph :</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">merge_vertices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 2), (0, 2)]</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">merge_vertices</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 8, 9]</span>

<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">merge_vertices</span><span class="p">([</span><span class="bp">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 4), (0, 5), (2, 5), (4, 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.min_spanning_tree">
<tt class="descname">min_spanning_tree</tt><big>(</big><em>weight_function=None</em>, <em>algorithm='Prim_Boost'</em>, <em>starting_vertex=None</em>, <em>check=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the edges of a minimum spanning tree.</p>
<p>At the moment, no algorithm for directed graph is implemented: if the
graph is directed, a minimum spanning tree of the corresponding
undirected graph is returned.</p>
<p>We expect all weights of the graph to be convertible to float.
Otherwise, an exception is raised.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge <tt class="docutils literal"><span class="pre">e</span></tt>
and outputs its weight. An edge has the form <tt class="docutils literal"><span class="pre">(u,v,l)</span></tt>, where <tt class="docutils literal"><span class="pre">u</span></tt>
and <tt class="docutils literal"><span class="pre">v</span></tt> are vertices, <tt class="docutils literal"><span class="pre">l</span></tt> is a label (that can be of any kind).
The <tt class="docutils literal"><span class="pre">weight_function</span></tt> can be used to transform the label into a
weight (note that, if the weight returned is not convertible to a
float, an error is raised). In particular:<ul>
<li>if <tt class="docutils literal"><span class="pre">weight_function</span></tt> is not <tt class="docutils literal"><span class="pre">None</span></tt>, the weight of an edge <tt class="docutils literal"><span class="pre">e</span></tt>
is <tt class="docutils literal"><span class="pre">weight_function(e)</span></tt>;</li>
<li>if <tt class="docutils literal"><span class="pre">weight_function</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> (default) and <tt class="docutils literal"><span class="pre">g</span></tt> is weighted
(that is, <tt class="docutils literal"><span class="pre">g.weighted()==True</span></tt>), for each edge <tt class="docutils literal"><span class="pre">e=(u,v,l)</span></tt>, we
set weight <tt class="docutils literal"><span class="pre">l</span></tt>;</li>
<li>if <tt class="docutils literal"><span class="pre">weight_function</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">g</span></tt> is not weighted, we set
all weights to 1 (hence, the output can be any spanning tree).</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; The algorithm to use in computing a minimum spanning
tree of <tt class="docutils literal"><span class="pre">G</span></tt>. The following algorithms are supported:<ul>
<li><tt class="docutils literal"><span class="pre">&quot;Prim_Boost&quot;</span></tt> (default) &#8211; Prim&#8217;s algorithm
(Boost implementation).</li>
<li><tt class="docutils literal"><span class="pre">&quot;Prim_fringe&quot;</span></tt> &#8211; a variant of Prim&#8217;s algorithm.
<tt class="docutils literal"><span class="pre">&quot;Prim_fringe&quot;</span></tt> ignores the labels on the edges.</li>
<li><tt class="docutils literal"><span class="pre">&quot;Prim_edge&quot;</span></tt> &#8211; a variant of Prim&#8217;s algorithm.</li>
<li><tt class="docutils literal"><span class="pre">&quot;Kruskal&quot;</span></tt> &#8211; Kruskal&#8217;s algorithm.</li>
<li><tt class="docutils literal"><span class="pre">&quot;Kruskal_Boost&quot;</span></tt> &#8211; Kruskal&#8217;s algorithm (Boost implementation).</li>
<li><tt class="docutils literal"><span class="pre">NetworkX</span></tt> &#8211; Uses NetworkX&#8217;s minimum spanning tree
implementation.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">starting_vertex</span></tt> &#8211; The vertex from which to begin the search
for a minimum spanning tree (available only for <tt class="docutils literal"><span class="pre">Prim_fringe</span></tt> and
<tt class="docutils literal"><span class="pre">Prim_edge</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> &#8211; Boolean; default: <tt class="docutils literal"><span class="pre">False</span></tt>. Whether to first perform
sanity checks on the input graph <tt class="docutils literal"><span class="pre">G</span></tt>. If appropriate, <tt class="docutils literal"><span class="pre">check</span></tt>
is passed on to any minimum spanning tree functions that are
invoked from the current method. See the documentation of the
corresponding functions for details on what sort of sanity checks
will be performed.</li>
</ul>
<p>OUTPUT:</p>
<p>The edges of a minimum spanning tree of <tt class="docutils literal"><span class="pre">G</span></tt>, if one exists, otherwise
returns the empty list.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="spanning_tree.html#sage.graphs.spanning_tree.kruskal" title="sage.graphs.spanning_tree.kruskal"><tt class="xref py py-func docutils literal"><span class="pre">sage.graphs.spanning_tree.kruskal()</span></tt></a></li>
<li><a class="reference internal" href="base/boost_graph.html#sage.graphs.base.boost_graph.min_spanning_tree" title="sage.graphs.base.boost_graph.min_spanning_tree"><tt class="xref py py-func docutils literal"><span class="pre">sage.graphs.base.boost_graph.min_spanning_tree()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>Kruskal&#8217;s algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">())</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">weight</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">((</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 4, None), (1, 4, None), (2, 4, None), (3, 4, None)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Kruskal_Boost&#39;</span><span class="p">)</span>
<span class="go">[(0, 4, None), (1, 4, None), (2, 4, None), (3, 4, None)]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 4, None), (0, 5, None), (1, 2, None), (1, 6, None), (3, 8, None), (5, 7, None), (5, 8, None), (6, 9, None)]</span>
</pre></div>
</div>
<p>Prim&#8217;s algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_edge&#39;</span><span class="p">,</span> <span class="n">starting_vertex</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 4, None), (1, 4, None), (2, 4, None), (3, 4, None)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_fringe&#39;</span><span class="p">,</span> <span class="n">starting_vertex</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 4, None), (1, 4, None), (2, 4, None), (3, 4, None)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_Boost&#39;</span><span class="p">)</span>
<span class="go">[(0, 4, None), (1, 4, None), (2, 4, None), (3, 4, None)]</span>
</pre></div>
</div>
<p>NetworkX algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NetworkX&#39;</span><span class="p">)</span>
<span class="go">[(0, 1, None), (0, 2, None), (0, 3, None), (0, 4, None)]</span>
</pre></div>
</div>
<p>More complicated weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;weight&#39;</span><span class="p">])</span>
<span class="go">[(0, 1, {&#39;name&#39;: &#39;a&#39;, &#39;weight&#39;: 1}), (1, 2, {&#39;name&#39;: &#39;b&#39;, &#39;weight&#39;: 1})]</span>
</pre></div>
</div>
<p>If the graph is not weighted, edge labels are not considered, even if
they are numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">()</span>
<span class="go">[(1, 2, 1), (1, 3, 2)]</span>
</pre></div>
</div>
<p>In order to use weights, we need to set variable <tt class="docutils literal"><span class="pre">weighted</span></tt> to
<tt class="docutils literal"><span class="pre">True</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">()</span>
<span class="go">[(1, 2, 1), (2, 3, 1)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that, if <tt class="docutils literal"><span class="pre">weight_function</span></tt> is not provided, then edge weights
are used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">()</span>
<span class="go">[(0, 1, 1), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Kruskal_Boost&#39;</span><span class="p">)</span>
<span class="go">[(0, 1, 1), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_fringe&#39;</span><span class="p">)</span>
<span class="go">[(0, 1, 1), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_edge&#39;</span><span class="p">)</span>
<span class="go">[(0, 1, 1), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_Boost&#39;</span><span class="p">)</span>
<span class="go">[(0, 1, 1), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NetworkX&#39;</span><span class="p">)</span>
<span class="go">[(0, 1, 1), (1, 2, 1)]</span>
</pre></div>
</div>
<p>Check that, if <tt class="docutils literal"><span class="pre">weight_function</span></tt> is provided, it overrides edge
weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">weight</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="mi">3</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Kruskal_Boost&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_fringe&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_edge&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Prim_Boost&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;NetworkX&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
</pre></div>
</div>
<p>If the graph is directed, it is transformed into an undirected graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, None), (1, 2, None)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<span class="go">[(0, 2, None), (1, 2, None)]</span>
</pre></div>
</div>
<p>If at least an edge weight is not convertible to a float, an error is
raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Prim_Boost&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The weight function cannot find the weight of (1, 2, &#39;a&#39;).</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Prim_fringe&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">could not convert string to float: a</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Prim_edge&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">could not convert string to float: a</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Kruskal&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">could not convert string to float: a</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Kruskal_Boost&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The weight function cannot find the weight of (1, 2, &#39;a&#39;).</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;NetworkX&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">could not convert string to float: a</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Prim_Boost&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The weight function cannot find the weight of (1, 2, [1, 2, 3]).</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Prim_fringe&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">float() argument must be a string or a number</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Prim_edge&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">float() argument must be a string or a number</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Kruskal&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">float() argument must be a string or a number</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Kruskal_Boost&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The weight function cannot find the weight of (1, 2, [1, 2, 3]).</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;NetworkX&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">float() argument must be a string or a number</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.multicommodity_flow">
<tt class="descname">multicommodity_flow</tt><big>(</big><em>terminals</em>, <em>integer=True</em>, <em>use_edge_labels=False</em>, <em>vertex_bound=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.multicommodity_flow" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Solves a multicommodity flow problem.</p>
<p>In the multicommodity flow problem, we are given a set of pairs
<span class="math">\((s_i, t_i)\)</span>, called terminals meaning that <span class="math">\(s_i\)</span> is willing
some flow to <span class="math">\(t_i\)</span>.</p>
<p>Even though it is a natural generalisation of the flow problem
this version of it is NP-Complete to solve when the flows
are required to be integer.</p>
<p>For more information, see the
<a class="reference external" href="https://en.wikipedia.org/wiki/Multi-commodity_flow_problem">Wikipedia page on multicommodity flows</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">terminals</span></tt> &#8211; a list of pairs <span class="math">\((s_i, t_i)\)</span> or triples
<span class="math">\((s_i, t_i, w_i)\)</span> representing a flow from <span class="math">\(s_i\)</span> to <span class="math">\(t_i\)</span>
of intensity <span class="math">\(w_i\)</span>. When the pairs are of size <span class="math">\(2\)</span>, a intensity
of <span class="math">\(1\)</span> is assumed.</li>
<li><tt class="docutils literal"><span class="pre">integer</span></tt> (boolean) &#8211; whether to require an integer multicommodity
flow</li>
<li><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> (boolean) &#8211; whether to consider the label of edges
as numerical values representing a capacity. If set to <tt class="docutils literal"><span class="pre">False</span></tt>, a capacity
of <span class="math">\(1\)</span> is assumed</li>
<li><tt class="docutils literal"><span class="pre">vertex_bound</span></tt> (boolean) &#8211; whether to require that a vertex can stand at most
<span class="math">\(1\)</span> commodity of flow through it of intensity <span class="math">\(1\)</span>. Terminals can obviously
still send or receive several units of flow even though vertex_bound is set
to <tt class="docutils literal"><span class="pre">True</span></tt>, as this parameter is meant to represent topological properties.</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; Specify a Linear Program solver to be used.
If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used.
function of <tt class="docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt>. See the documentation  of <tt class="docutils literal"><span class="pre">MixedIntegerLinearProgram.solve</span></tt>
for more informations.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> (integer) &#8211; sets the level of verbosity. Set to 0
by default (quiet).</li>
</ul>
<p>ALGORITHM:</p>
<p>(Mixed Integer) Linear Program, depending on the value of <tt class="docutils literal"><span class="pre">integer</span></tt>.</p>
<p>EXAMPLE:</p>
<p>An easy way to obtain a satisfiable multiflow is to compute
a matching in a graph, and to consider the paired vertices
as terminals</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">matching</span> <span class="o">=</span> <span class="p">[(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">matching</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">multicommodity_flow</span><span class="p">(</span><span class="n">matching</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>We could also have considered <tt class="docutils literal"><span class="pre">g</span></tt> as symmetric and computed
the multiflow in this version instead. In this case, however
edges can be used in both directions at the same time:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">multicommodity_flow</span><span class="p">(</span><span class="n">matching</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>An exception is raised when the problem has no solution</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">multicommodity_flow</span><span class="p">([(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">matching</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">The multiflow problem has no solution</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.multiple_edges">
<tt class="descname">multiple_edges</tt><big>(</big><em>to_undirected=False</em>, <em>labels=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.multiple_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns any multiple edges in the (di)graph.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Multi-graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None)]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Multi-digraph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 1, None), (0, 1, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None)]</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span> <span class="s">&#39;h&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;g&#39;</span><span class="p">}},</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_multiple_edges</span><span class="p">(</span><span class="n">to_undirected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">multiple_edges</span><span class="p">(</span><span class="n">to_undirected</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(1, 2, &#39;h&#39;), (2, 1, &#39;g&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.multiway_cut">
<tt class="descname">multiway_cut</tt><big>(</big><em>vertices</em>, <em>value_only=False</em>, <em>use_edge_labels=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.multiway_cut" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a minimum edge multiway cut corresponding to the
given set of vertices
( cf. <a class="reference external" href="http://www.d.kth.se/~viggo/wwwcompendium/node92.html">http://www.d.kth.se/~viggo/wwwcompendium/node92.html</a> )
represented by a list of edges.</p>
<p>A multiway cut for a vertex set <span class="math">\(S\)</span> in a graph or a digraph
<span class="math">\(G\)</span> is a set <span class="math">\(C\)</span> of edges such that any two vertices <span class="math">\(u,v\)</span>
in <span class="math">\(S\)</span> are disconnected when removing the edges from <span class="math">\(C\)</span> from <span class="math">\(G\)</span>.</p>
<p>Such a cut is said to be minimum when its cardinality
(or weight) is minimum.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertices</span></tt> (iterable)&#8211; the set of vertices</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">value_only</span></tt> (boolean)</p>
<blockquote>
<div><ul class="simple">
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, only the value of a minimum
multiway cut is returned.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt> (default), the list of edges
is returned</li>
</ul>
</div></blockquote>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> (boolean)</dt>
<dd><ul class="first last simple">
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, computes a weighted minimum cut
where each edge has a weight defined by its label. ( if
an edge has no label, <span class="math">\(1\)</span> is assumed )</li>
<li>when set to <tt class="docutils literal"><span class="pre">False</span></tt> (default), each edge has weight <span class="math">\(1\)</span>.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<p>Of course, a multiway cut between two vertices correspond
to a minimum edge cut</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">multiway_cut</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As Petersen&#8217;s graph is <span class="math">\(3\)</span>-regular, a minimum multiway cut
between three vertices contains at most <span class="math">\(2\times 3\)</span> edges
(which could correspond to the neighborhood of 2
vertices):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">multiway_cut</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In this case, though, the vertices are an independent set.
If we pick instead vertices <span class="math">\(0,9,\)</span> and <span class="math">\(7\)</span>, we can save <span class="math">\(4\)</span>
edges in the multiway cut</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">multiway_cut</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This example, though, does not work in the directed case anymore,
as it is not possible in Petersen&#8217;s graph to mutualise edges</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">multiway_cut</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="o">*</span><span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Of course, a multiway cut between the whole vertex set
contains all the edges of the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">multiway_cut</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">())</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.name">
<tt class="descname">name</tt><big>(</big><em>new=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.name" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns or sets the graph&#8217;s name.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">new</span></tt> - if not None, then this becomes the new name of the (di)graph.
(if new == &#8216;&#8217;, removes any name)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">d</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;Petersen Graph&quot;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Petersen Graph: Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<p>Name of an immutable graph <a class="reference external" href="http://trac.sagemath.org/15681">trac ticket #15681</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">gi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gi</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="go">&#39;Petersen graph&#39;</span>
<span class="gp">sage: </span><span class="n">gi</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;Hey&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">An immutable graph does not change name</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.neighbor_iterator">
<tt class="descname">neighbor_iterator</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.neighbor_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over neighbors of vertex.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">neighbor_iterator</span><span class="p">(</span><span class="s">&#39;010&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">011</span>
<span class="go">000</span>
<span class="go">110</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">neighbor_iterator</span><span class="p">(</span><span class="s">&#39;010&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">011</span>
<span class="go">000</span>
<span class="go">110</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">neighbor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.neighbors">
<tt class="descname">neighbors</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.neighbors" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of neighbors (in and out if directed) of vertex.</p>
<p>G[vertex] also works.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[2, 4, 8]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="go">[0, 3, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.networkx_graph">
<tt class="descname">networkx_graph</tt><big>(</big><em>copy=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.networkx_graph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Creates a new NetworkX graph from the Sage graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">copy</span></tt> - if False, and the underlying
implementation is a NetworkX graph, then the actual object itself
is returned.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">networkx_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">&lt;class &#39;networkx.classes.graph.Graph&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.num_edges">
<tt class="descname">num_edges</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.num_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of edges.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.num_verts">
<tt class="descname">num_verts</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.num_verts" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of vertices. Note that len(G) returns the number
of vertices in G also.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.number_of_loops">
<tt class="descname">number_of_loops</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.number_of_loops" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of edges that are loops.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 0), (1, 1), (2, 2), (2, 3), (3, 3)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">number_of_loops</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 0), (1, 1), (2, 2), (2, 3), (3, 3)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">number_of_loops</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.order">
<tt class="descname">order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.order" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of vertices. Note that len(G) returns the number
of vertices in G also.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.periphery">
<tt class="descname">periphery</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.periphery" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the set of vertices in the periphery, i.e. whose
eccentricity is equal to the diameter of the (di)graph.</p>
<p>In other words, the periphery is the set of vertices achieving the
maximum eccentricity.</p>
<p>For more information and examples on how to use input variables,
see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a> and
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eccentricity" title="sage.graphs.generic_graph.GenericGraph.eccentricity"><tt class="xref py py-meth docutils literal"><span class="pre">eccentricity()</span></tt></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, edge weights are taken into account; if
False, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - a Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - a Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> for
unweighted graphs, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>, otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DiamondGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">periphery</span><span class="p">()</span>
<span class="go">[0, 3]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">periphery</span><span class="p">())</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">StarGraph</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">periphery</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">periphery</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">periphery</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.plot">
<tt class="descname">plot</tt><big>(</big><em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.plot" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a graphics object representing the (di)graph.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">pos</span></tt> - an optional positioning dictionary</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">layout</span></tt> - what kind of layout to use, takes precedence
over pos</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;circular&#8217; &#8211; plots the graph with vertices evenly
distributed on a circle</li>
<li>&#8216;spring&#8217; - uses the traditional spring layout, using the
graph&#8217;s current positions as initial positions</li>
<li>&#8216;tree&#8217; - the (di)graph must be a tree. One can specify
the root of the tree using the keyword tree_root,
otherwise a root will be selected at random. Then the
tree will be plotted in levels, depending on minimum
distance for the root.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertex_labels</span></tt> - whether to print vertex labels</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">edge_labels</span></tt> - whether to print edge labels. By default,
False, but if True, the result of str(l) is printed on the
edge for each label l. Labels equal to None are not printed
(to set edge labels, see set_edge_label).</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertex_size</span></tt> - size of vertices displayed</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertex_shape</span></tt> - the shape to draw the vertices, for
example <tt class="docutils literal"><span class="pre">&quot;o&quot;</span></tt> for circle or <tt class="docutils literal"><span class="pre">&quot;s&quot;</span></tt> for square. Whole list
is available at <a class="reference external" href="http://matplotlib.org/api/markers_api.html">http://matplotlib.org/api/markers_api.html</a>.
(Not available for multiedge digraphs.)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">graph_border</span></tt> - whether to include a box around the graph</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertex_colors</span></tt> - optional dictionary to specify vertex
colors: each key is a color recognizable by matplotlib, and
each corresponding entry is a list of vertices. If a vertex
is not listed, it looks invisible on the resulting plot (it
doesn&#8217;t get drawn).</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">edge_colors</span></tt> - a dictionary specifying edge colors: each
key is a color recognized by matplotlib, and each entry is a
list of edges.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">partition</span></tt> - a partition of the vertex set. if specified,
plot will show each cell in a different color. vertex_colors
takes precedence.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">talk</span></tt> - if true, prints large vertices with white
backgrounds so that labels are legible on slides</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">iterations</span></tt> - how many iterations of the spring layout
algorithm to go through, if applicable</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">color_by_label</span></tt> - a boolean or dictionary or function (default:
False) whether to color each edge with a different color according
to its label; the colors are chosen along a rainbow, unless
they are specified by a function or dictionary mapping
labels to colors; this option is incompatible with
<tt class="docutils literal"><span class="pre">edge_color</span></tt> and <tt class="docutils literal"><span class="pre">edge_colors</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">heights</span></tt> - if specified, this is a dictionary from a set
of floating point heights to a set of vertices</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">edge_style</span></tt> - keyword arguments passed into the
edge-drawing routine.  This currently only works for
directed graphs, since we pass off the undirected graph to
networkx</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">tree_root</span></tt> - a vertex of the tree to be used as the root
for the layout=&#8221;tree&#8221; option. If no root is specified, then one
is chosen at random. Ignored unless layout=&#8217;tree&#8217;.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">tree_orientation</span></tt> - &#8220;up&#8221; or &#8220;down&#8221; (default is &#8220;down&#8221;).
If &#8220;up&#8221; (resp., &#8220;down&#8221;), then the root of the tree will
appear on the bottom (resp., top) and the tree will grow
upwards (resp. downwards). Ignored unless layout=&#8217;tree&#8217;.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">save_pos</span></tt> - save position computed during plotting</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>This method supports any parameter accepted by
<a class="reference external" href="../../../plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.show" title="(in Sage Reference Manual: 2D Graphics v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">sage.plot.graphics.Graphics.show()</span></tt></a>.</li>
<li>See the documentation of the <a class="reference internal" href="graph_plot.html#module-sage.graphs.graph_plot" title="sage.graphs.graph_plot"><tt class="xref py py-mod docutils literal"><span class="pre">sage.graphs.graph_plot</span></tt></a> module
for information and examples of how to define parameters that will
be applied to <strong>all</strong> graph plots.</li>
<li>Default parameters for this method <em>and a specific graph</em> can also
be set through the <a class="reference external" href="../../../misc/sage/misc/decorators.html#sage.misc.decorators.options" title="(in Sage Reference Manual: Utilities v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">options</span></tt></a>
mechanism. For more information on this different way to set
default parameters, see the help of the <a class="reference external" href="../../../misc/sage/misc/decorators.html#sage.misc.decorators.options" title="(in Sage Reference Manual: Utilities v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">options</span> <span class="pre">decorator</span></tt></a>.</li>
<li>See also the <a class="reference internal" href="graph_latex.html#module-sage.graphs.graph_latex" title="sage.graphs.graph_latex"><tt class="xref py py-mod docutils literal"><span class="pre">sage.graphs.graph_latex</span></tt></a> module for ways to use
LaTeX to produce an image of a graph.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_plot</span> <span class="kn">import</span> <span class="n">graphplot_options</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">graphplot_options</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()))</span>
<span class="go">[...]</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;#FF0000&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="s">&#39;#FF9900&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="s">&#39;#FFFF00&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="s">&#39;#00FF00&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="s">&#39;#0000FF&#39;</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">pos_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="gp">... </span>   <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="gp">... </span>   <span class="n">pos_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">5</span><span class="p">:]:</span>
<span class="gp">... </span>   <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="gp">... </span>   <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="gp">... </span>   <span class="n">pos_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">pl</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos_dict</span><span class="p">,</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vertex_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">vertex_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">graph_border</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="s">&#39;(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="mi">8</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">9</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="mi">10</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="mi">11</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span> <span class="mi">12</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="mi">13</span><span class="p">:</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="mi">14</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="mi">15</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="mi">16</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="mi">17</span><span class="p">:</span> <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="mi">18</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="mi">19</span><span class="p">:</span> <span class="p">[]}</span> <span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">D</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="s">&#39;(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s">&#39;circular&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.plot.colors</span> <span class="kn">import</span> <span class="n">rainbow</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">rainbow</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">edge_colors</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">edge_colors</span><span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="n">C</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<span class="gp">... </span>           <span class="n">edge_colors</span><span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vertex_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">vertex_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">edge_colors</span><span class="o">=</span><span class="n">edge_colors</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Pi</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">16</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">12</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">partition</span><span class="o">=</span><span class="n">Pi</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">)],(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">):[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="bp">None</span><span class="p">)]})</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s">&#39;spring&#39;</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="go">{0: (6.12..., 1.0...),</span>
<span class="go"> 1: (-0.95..., 0.30...),</span>
<span class="go"> 2: (-0.58..., -0.80...),</span>
<span class="go"> 3: (0.58..., -0.80...),</span>
<span class="go"> 4: (0.95..., 0.30...),</span>
<span class="go"> 5: (1.53..., 0.5...),</span>
<span class="go"> 6: (-0.47..., 0.15...),</span>
<span class="go"> 7: (-0.29..., -0.40...),</span>
<span class="go"> 8: (0.29..., -0.40...),</span>
<span class="go"> 9: (0.47..., 0.15...)}</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">save_pos</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s">&#39;spring&#39;</span><span class="p">)</span>

<span class="go">The following illustrates the format of a position dictionary.</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span> <span class="c"># currently random across platforms, see #9593</span>
<span class="go">{0: [1.17..., -0.855...],</span>
<span class="go"> 1: [1.81..., -0.0990...],</span>
<span class="go"> 2: [1.35..., 0.184...],</span>
<span class="go"> 3: [1.51..., 0.644...],</span>
<span class="go"> 4: [2.00..., -0.507...],</span>
<span class="go"> 5: [0.597..., -0.236...],</span>
<span class="go"> 6: [2.04..., 0.687...],</span>
<span class="go"> 7: [1.46..., -0.473...],</span>
<span class="go"> 8: [0.902..., 0.773...],</span>
<span class="go"> 9: [2.48..., -0.119...]}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">trees</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]})</span>
<span class="go">Graphics object consisting of 14 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">trees</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]})</span>
<span class="go">Graphics object consisting of 14 graphics primitives</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;spam&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">heights</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]},</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Graphics object consisting of 20 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">trees</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;tree&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 14 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="s">&#39;JCC???@A??GO??CO??GO??&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;tree&#39;</span><span class="p">,</span> <span class="n">tree_root</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tree_orientation</span><span class="o">=</span><span class="s">&quot;up&quot;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 22 graphics primitives</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 16 graphics primitives</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">edge_colors</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">_color_by_label</span><span class="p">())</span>
<span class="go">Graphics object consisting of 34 graphics primitives</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">color_by_label</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="s">&#39;red&#39;</span><span class="p">},</span> <span class="n">edge_style</span><span class="o">=</span><span class="s">&#39;dashed&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 34 graphics primitives</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;f&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;f&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;h&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">color_by_label</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">edge_style</span><span class="o">=</span><span class="s">&#39;dashed&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 22 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SupersingularModule</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">Graph</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">],</span><span class="s">&#39;b&#39;</span><span class="p">:[</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">],</span><span class="s">&#39;c&#39;</span><span class="p">:[</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">],</span><span class="s">&#39;d&#39;</span><span class="p">:[</span><span class="s">&#39;e&#39;</span><span class="p">]},</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;b&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;c&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;d&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;e&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]})</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;c&#39;</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">color_by_label</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="s">&#39;yellow&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="s">&#39;purple&#39;</span><span class="p">});</span> <span class="n">p</span>
<span class="go">Graphics object consisting of 14 graphics primitives</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">options</span><span class="p">()[</span><span class="s">&#39;rgbcolor&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">p</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sage</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">arrow</span><span class="o">.</span><span class="n">CurveArrow</span><span class="p">)])</span>
<span class="go">[&#39;black&#39;, &#39;purple&#39;, &#39;yellow&#39;, &#39;yellow&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.plot3d">
<tt class="descname">plot3d</tt><big>(</big><em>bgcolor=(1</em>, <em>1</em>, <em>1)</em>, <em>vertex_colors=None</em>, <em>vertex_size=0.06</em>, <em>vertex_labels=False</em>, <em>edge_colors=None</em>, <em>edge_size=0.02</em>, <em>edge_size2=0.0325</em>, <em>pos3d=None</em>, <em>color_by_label=False</em>, <em>engine='jmol'</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.plot3d" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Plot a graph in three dimensions.</p>
<p>See also the <a class="reference internal" href="graph_latex.html#module-sage.graphs.graph_latex" title="sage.graphs.graph_latex"><tt class="xref py py-mod docutils literal"><span class="pre">sage.graphs.graph_latex</span></tt></a> module for ways to use LaTeX
to produce an image of a graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">bgcolor</span></tt> - rgb tuple (default: (1,1,1))</li>
<li><tt class="docutils literal"><span class="pre">vertex_size</span></tt> - float (default: 0.06)</li>
<li><tt class="docutils literal"><span class="pre">vertex_labels</span></tt> &#8211; a boolean (default: False)
whether to display vertices using text labels instead of spheres</li>
<li><tt class="docutils literal"><span class="pre">vertex_colors</span></tt> - optional dictionary to specify
vertex colors: each key is a color recognizable by tachyon (rgb
tuple (default: (1,0,0))), and each corresponding entry is a list
of vertices. If a vertex is not listed, it looks invisible on the
resulting plot (it doesn&#8217;t get drawn).</li>
<li><tt class="docutils literal"><span class="pre">edge_colors</span></tt> - a dictionary specifying edge
colors: each key is a color recognized by tachyon ( default:
(0,0,0) ), and each entry is a list of edges.</li>
<li><tt class="docutils literal"><span class="pre">color_by_label</span></tt> - a boolean or dictionary or function (default:
False) whether to color each edge with a different color according
to its label; the colors are chosen along a rainbow, unless
they are specified by a function or dictionary mapping
labels to colors; this option is incompatible with
<tt class="docutils literal"><span class="pre">edge_color</span></tt> and <tt class="docutils literal"><span class="pre">edge_colors</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">edge_size</span></tt> - float (default: 0.02)</li>
<li><tt class="docutils literal"><span class="pre">edge_size2</span></tt> - float (default: 0.0325), used for
Tachyon sleeves</li>
<li><tt class="docutils literal"><span class="pre">pos3d</span></tt> - a position dictionary for the vertices</li>
<li><tt class="docutils literal"><span class="pre">layout</span></tt>, <tt class="docutils literal"><span class="pre">iterations</span></tt>, ... - layout options; see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.layout" title="sage.graphs.generic_graph.GenericGraph.layout"><tt class="xref py py-meth docutils literal"><span class="pre">layout()</span></tt></a></li>
<li><tt class="docutils literal"><span class="pre">engine</span></tt> - which renderer to use. Options:<ul>
<li><tt class="docutils literal"><span class="pre">'jmol'</span></tt> - default</li>
<li><tt class="docutils literal"><span class="pre">'tachyon'</span></tt></li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">xres</span></tt> - resolution</li>
<li><tt class="docutils literal"><span class="pre">yres</span></tt> - resolution</li>
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - passed on to the rendering engine</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">edge_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span> <span class="c"># long time</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<p>We plot a fairly complicated Cayley graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A5</span> <span class="o">=</span> <span class="n">AlternatingGroup</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">A5</span>
<span class="go">Alternating group of order 5!/2 as a permutation group</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A5</span><span class="o">.</span><span class="n">cayley_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">edge_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()},</span> <span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">color_by_label</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span> <span class="c"># long time</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<p>Some Tachyon examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P3D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3D</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">,</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()})</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">,</span> <span class="n">edge_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="n">C</span><span class="o">.</span><span class="n">edges</span><span class="p">()},</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="n">C</span><span class="o">.</span><span class="n">vertices</span><span class="p">()},</span> <span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">,</span> <span class="n">edge_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">):[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">)]})</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<p>A directed version of the dodecahedron</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="mi">8</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">9</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="mi">10</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="mi">11</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span> <span class="mi">12</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="mi">13</span><span class="p">:</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="mi">14</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="mi">15</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="mi">16</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="mi">17</span><span class="p">:</span> <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="mi">18</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="mi">19</span><span class="p">:</span> <span class="p">[]}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot3d</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.plot.colors</span> <span class="kn">import</span> <span class="n">rainbow</span>
<span class="gp">sage: </span><span class="n">edges</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">rainbow</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">),</span> <span class="s">&#39;rgbtuple&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">edge_colors</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)):</span>
<span class="gp">... </span>      <span class="n">edge_colors</span><span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">,</span> <span class="n">edge_colors</span><span class="o">=</span><span class="n">edge_colors</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">Graph</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">],</span><span class="s">&#39;b&#39;</span><span class="p">:[</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">],</span><span class="s">&#39;c&#39;</span><span class="p">:[</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">],</span><span class="s">&#39;d&#39;</span><span class="p">:[</span><span class="s">&#39;e&#39;</span><span class="p">]},</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">3D plotting of multiple edges or loops not implemented.</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;c&#39;</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">color_by_label</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="s">&#39;yellow&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="s">&#39;cyan&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x3d_str</span><span class="p">()</span>
</pre></div>
</div>
<p>This 3D plot contains four yellow objects (two cylinders and
two cones), two black objects and 2 cyan objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;Material diffuseColor=&#39;1.0 1.0 0.0&#39;&quot;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;Material diffuseColor=&#39;0.0 0.0 0.0&#39;&quot;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;Material diffuseColor=&#39;0.0 1.0 1.0&#39;&quot;</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.plot" title="sage.graphs.generic_graph.GenericGraph.plot"><tt class="xref py py-meth docutils literal"><span class="pre">plot()</span></tt></a></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.graphviz_string" title="sage.graphs.generic_graph.GenericGraph.graphviz_string"><tt class="xref py py-meth docutils literal"><span class="pre">graphviz_string()</span></tt></a></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.radius">
<tt class="descname">radius</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.radius" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the radius of the (di)graph.</p>
<p>The radius is defined to be the minimum eccentricity of any vertex,
where the eccentricity is the maximum distance to any other
vertex. For more information and examples on how to use input variables,
see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a> and
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.eccentricity" title="sage.graphs.generic_graph.GenericGraph.eccentricity"><tt class="xref py py-meth docutils literal"><span class="pre">eccentricity()</span></tt></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, edge weights are taken into account; if
False, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - a Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - a Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> for
unweighted graphs, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>, otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>EXAMPLES: The more symmetric a graph is, the smaller (diameter -
radius) is.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">BarbellGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">radius</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">diameter</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">OctahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">radius</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">diameter</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>TEST:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">radius</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This method has no meaning on empty graphs.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.random_edge">
<tt class="descname">random_edge</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.random_edge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a random edge of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - arguments to be passed down to the
<tt class="docutils literal"><span class="pre">edge_iterator</span></tt> method.</li>
</ul>
<p>EXAMPLE:</p>
<p>The returned value is an edge of self:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">random_edge</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As the <tt class="docutils literal"><span class="pre">edges()</span></tt> method would, this function returns
by default a triple <tt class="docutils literal"><span class="pre">(u,v,l)</span></tt> of values, in which
<tt class="docutils literal"><span class="pre">l</span></tt> is the label of edge <span class="math">\((u,v)\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">random_edge</span><span class="p">()</span>
<span class="go">(3, 4, None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.random_subgraph">
<tt class="descname">random_subgraph</tt><big>(</big><em>p</em>, <em>inplace=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.random_subgraph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a random subgraph that contains each vertex with prob. p.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">random_subgraph</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">)</span>
<span class="go">Subgraph of (Petersen graph): Graph on 4 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.random_vertex">
<tt class="descname">random_vertex</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.random_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a random vertex of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - arguments to be passed down to the
<tt class="docutils literal"><span class="pre">vertex_iterator</span></tt> method.</li>
</ul>
<p>EXAMPLE:</p>
<p>The returned value is a vertex of self:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">random_vertex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="ow">in</span> <span class="n">g</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.relabel">
<tt class="descname">relabel</tt><big>(</big><em>perm=None</em>, <em>inplace=True</em>, <em>return_map=False</em>, <em>check_input=True</em>, <em>complete_partial_function=True</em>, <em>immutable=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.relabel" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Relabels the vertices of <tt class="docutils literal"><span class="pre">self</span></tt></p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">perm</span></tt> &#8211; a function, dictionary, list, permutation, or
<tt class="docutils literal"><span class="pre">None</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">inplace</span></tt> &#8211; a boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">return_map</span></tt> &#8211; a boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">check_input</span></tt> (boolean) &#8211; whether to test input for
correctness. <em>This can potentially be very time-consuming !</em>.</li>
<li><tt class="docutils literal"><span class="pre">complete_partial_function</span></tt> (boolean) &#8211; whether to automatically
complete the permutation if some elements of the graph are not
associated with any new name. In this case, those elements are not
relabeled <em>This can potentially be very time-consuming !</em>.</li>
<li><tt class="docutils literal"><span class="pre">immutable</span></tt> (boolean) &#8211; with <tt class="docutils literal"><span class="pre">inplace=False</span></tt>, whether to create
a mutable/immutable relabelled copy. <tt class="docutils literal"><span class="pre">immutable=None</span></tt> (default)
means that the graph and its copy will behave the same way.</li>
</ul>
</div></blockquote>
<p>If <tt class="docutils literal"><span class="pre">perm</span></tt> is a function <tt class="docutils literal"><span class="pre">f</span></tt>, then each vertex <tt class="docutils literal"><span class="pre">v</span></tt> is
relabeled to <tt class="docutils literal"><span class="pre">f(v)</span></tt>.</p>
<p>If <tt class="docutils literal"><span class="pre">perm</span></tt> is a dictionary <tt class="docutils literal"><span class="pre">d</span></tt>, then each vertex <tt class="docutils literal"><span class="pre">v</span></tt> (which should
be a key of <tt class="docutils literal"><span class="pre">d</span></tt>) is relabeled to <tt class="docutils literal"><span class="pre">d[v]</span></tt>.  Similarly, if <tt class="docutils literal"><span class="pre">perm</span></tt> is
a list or tuple <tt class="docutils literal"><span class="pre">l</span></tt> of length <tt class="docutils literal"><span class="pre">n</span></tt>, then the first vertex returned by
<tt class="docutils literal"><span class="pre">G.vertices()</span></tt> is relabeled to <tt class="docutils literal"><span class="pre">l[0]</span></tt>, the second to <tt class="docutils literal"><span class="pre">l[1]</span></tt>, ...</p>
<p>If <tt class="docutils literal"><span class="pre">perm</span></tt> is a permutation, then each vertex <tt class="docutils literal"><span class="pre">v</span></tt> is
relabeled to <tt class="docutils literal"><span class="pre">perm(v)</span></tt>. Caveat: this assumes that the
vertices are labelled <span class="math">\(\{0,1,...,n-1\}\)</span>; since permutations
act by default on the set <span class="math">\(\{1,2,...,n\}\)</span>, this is achieved by
identifying <span class="math">\(n\)</span> and <span class="math">\(0\)</span>.</p>
<p>If <tt class="docutils literal"><span class="pre">perm</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>, the graph is relabeled to be on the
vertices <span class="math">\(\{0,1,...,n-1\}\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">at this point, only injective relabeling are supported.</p>
</div>
<p>If <tt class="docutils literal"><span class="pre">inplace</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, the graph is modified in place and
<tt class="docutils literal"><span class="pre">None</span></tt> is returned. Otherwise a relabeled copy of the graph
is returned.</p>
<p>If <tt class="docutils literal"><span class="pre">return_map</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt> a dictionary representing the
relabelling map is returned (incompatible with <tt class="docutils literal"><span class="pre">inplace==False</span></tt>).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 1 0]</span>
<span class="go">[1 0 1]</span>
<span class="go">[0 1 0]</span>
</pre></div>
</div>
<p>Relabeling using a dictionary. Note that the dictionary does not define
the new label of vertex <span class="math">\(0\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 0 1]</span>
<span class="go">[0 0 1]</span>
<span class="go">[1 1 0]</span>
</pre></div>
</div>
<p>This is because the method automatically &#8220;extends&#8221; the relabeling to the
missing vertices (whose label will not change). Checking that all
vertices have an image can require some time, and this feature can be
disabled (at your own risk):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">complete_partial_function</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">0</span>
</pre></div>
</div>
<p>Relabeling using a list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 0 1]</span>
<span class="go">[0 0 1]</span>
<span class="go">[1 1 0]</span>
</pre></div>
</div>
<p>Relabeling using a tuple:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 0 1]</span>
<span class="go">[0 0 1]</span>
<span class="go">[1 1 0]</span>
</pre></div>
</div>
<p>Relabeling using a Sage permutation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.groups.perm_gps.permgroup_named</span> <span class="kn">import</span> <span class="n">SymmetricGroup</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SymmetricGroup</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s">&#39;(1,2)&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
<span class="go">[0 0 1]</span>
<span class="go">[0 0 1]</span>
<span class="go">[1 1 0]</span>
</pre></div>
</div>
<p>Relabeling using an injective function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 2, None)]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[10, 11, 12]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(10, 11, None), (11, 12, None)]</span>
</pre></div>
</div>
<p>Relabeling using a non injective function has no meaning:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 2, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Non injective relabeling</span>
</pre></div>
</div>
<p>But this test can be disabled, which can lead to ... problems:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 2, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">check_input</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Relabeling to simpler labels:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[&#39;000&#39;, &#39;001&#39;, &#39;010&#39;, &#39;011&#39;, &#39;100&#39;, &#39;101&#39;, &#39;110&#39;, &#39;111&#39;]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7]</span>
</pre></div>
</div>
<p>Recovering the relabeling with <tt class="docutils literal"><span class="pre">return_map</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">expecting</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;000&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;001&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;010&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;011&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;100&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;101&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;110&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&#39;111&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="n">return_map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">expecting</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 10, 1: 11, 2: 12}</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">relabel</span><span class="p">()</span>
</pre></div>
</div>
<p>The attributes are properly updated too</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s">&#39;before&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s">&#39;delete&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s">&#39;after&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">delete_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">()</span>
<span class="go">{0: &#39;before&#39;, 1: &#39;after&#39;, 2: None, 3: None}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="go">{0: (0, 0), 1: (2, 0), 2: (3, 0), 3: (4, 0)}</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/12477">trac ticket #12477</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">rel</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">}</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="n">rel</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[3, &#39;a&#39;, &#39;b&#39;]</span>
<span class="gp">sage: </span><span class="n">rel</span>
<span class="go">{1: &#39;a&#39;, 2: &#39;b&#39;}</span>
</pre></div>
</div>
<p>Immutable graphs cannot be relabeled:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">(),</span> <span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">relabel</span><span class="p">({})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">To relabel an immutable graph use inplace=False</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/16257">trac ticket #16257</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span> <span class="p">[</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">())</span> <span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span> <span class="p">[</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">())</span> <span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.remove_loops">
<tt class="descname">remove_loops</tt><big>(</big><em>vertices=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.remove_loops" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Removes loops on vertices in vertices. If vertices is None, removes
all loops.</p>
<p>EXAMPLE</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 0), (1, 1), (2, 2), (2, 3), (3, 3)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">remove_loops</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(2, 3)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 0), (1, 1), (2, 2), (2, 3), (3, 3)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">remove_loops</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(2, 3)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_loops</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.remove_multiple_edges">
<tt class="descname">remove_multiple_edges</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.remove_multiple_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Removes all multiple edges, retaining one edge for each.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 1), (0, 1), (0, 1), (1, 2)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">remove_multiple_edges</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (1, 2)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 1), (0, 1), (0, 1), (1, 2)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">remove_multiple_edges</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (1, 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.set_edge_label">
<tt class="descname">set_edge_label</tt><big>(</big><em>u</em>, <em>v</em>, <em>l</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.set_edge_label" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Set the edge label of a given edge.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There can be only one edge from u to v for this to make
sense. Otherwise, an error is raised.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">u,</span> <span class="pre">v</span></tt> - the vertices (and direction if digraph)
of the edge</li>
<li><tt class="docutils literal"><span class="pre">l</span></tt> - the new label</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">SD</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="mi">8</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="mi">9</span><span class="p">:[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">10</span><span class="p">:[</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="mi">11</span><span class="p">:[</span><span class="mi">12</span><span class="p">],</span> <span class="mi">12</span><span class="p">:[</span><span class="mi">13</span><span class="p">],</span> <span class="mi">13</span><span class="p">:[</span><span class="mi">17</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span> <span class="mi">14</span><span class="p">:[</span><span class="mi">16</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span> <span class="mi">15</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">:[</span><span class="mi">13</span><span class="p">],</span> <span class="mi">17</span><span class="p">:[</span><span class="mi">15</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="mi">18</span><span class="p">:[</span><span class="mi">13</span><span class="p">]</span> <span class="p">},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="s">&#39;discrete&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s">&#39;discrete&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;h = 0&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="s">&#39;h = 0&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;aut&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;aut&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&#39;no label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="s">&#39;k &gt; h&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s">&#39;k = h&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&#39;v_k finite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&#39;v_k m.c.r.&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">posn</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span> <span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>  <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>  <span class="mi">4</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>  <span class="mi">5</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>  <span class="mi">6</span><span class="p">:[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="mi">8</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>  <span class="mi">9</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span> <span class="mi">10</span><span class="p">:[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">11</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">12</span><span class="p">:[</span><span class="mi">13</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">13</span><span class="p">:[</span><span class="mi">16</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">14</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="mi">15</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">],</span> <span class="mi">16</span><span class="p">:[</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="mi">17</span><span class="p">:[</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">],</span> <span class="mi">18</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">SD</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">posn</span><span class="p">,</span> <span class="n">vertex_size</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;#FFFFFF&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">19</span><span class="p">)},</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="s">&#39;(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">    [(0, 1, &#39;(0,1)&#39;),</span>
<span class="go">     (0, 5, &#39;(0,5)&#39;),</span>
<span class="go">     (0, 13, &#39;(0,13)&#39;),</span>
<span class="go">     ...</span>
<span class="go">     (11, 12, &#39;(11,12)&#39;),</span>
<span class="go">     (12, 13, &#39;(12,13)&#39;)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 0, &#39;test&#39;), (0, 1, None), (0, 1, None), (0, 2, None)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;test2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;test3&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Cannot set edge label, since there are multiple edges from 0 to 0.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">dg</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dg</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dg</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dg</span><span class="o">.</span><span class="n">outgoing_edges</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[(1, 0, 9)]</span>
<span class="gp">sage: </span><span class="n">dg</span><span class="o">.</span><span class="n">incoming_edges</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[(0, 1, 5)]</span>
<span class="gp">sage: </span><span class="n">dg</span><span class="o">.</span><span class="n">outgoing_edges</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[(0, 1, 5)]</span>
<span class="gp">sage: </span><span class="n">dg</span><span class="o">.</span><span class="n">incoming_edges</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[(1, 0, 9)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.set_embedding">
<tt class="descname">set_embedding</tt><big>(</big><em>embedding</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.set_embedding" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Sets a combinatorial embedding dictionary to <tt class="docutils literal"><span class="pre">_embedding</span></tt> attribute.</p>
<p>Dictionary is organized with vertex labels as keys and a list of
each vertex&#8217;s neighbors in clockwise order.</p>
<p>Dictionary is error-checked for validity.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">embedding</span></tt> - a dictionary</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">8</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">9</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">({</span><span class="s">&#39;s&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">8</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">9</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The following vertices from the embedding do not belong to the graph: [&#39;s&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.set_latex_options">
<tt class="descname">set_latex_options</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.set_latex_options" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Sets multiple options for rendering a graph with LaTeX.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">kwds</span></tt> - any number of option/value pairs to set many graph
latex options at once (a variable number, in any
order). Existing values are overwritten, new values are
added.  Existing values can be cleared by setting the value
to <tt class="docutils literal"><span class="pre">None</span></tt>.  Possible options are documented at
<a class="reference internal" href="graph_latex.html#sage.graphs.graph_latex.GraphLatex.set_option" title="sage.graphs.graph_latex.GraphLatex.set_option"><tt class="xref py py-meth docutils literal"><span class="pre">sage.graphs.graph_latex.GraphLatex.set_option()</span></tt></a>.</li>
</ul>
<p>This method is a convenience for setting the options of a graph
directly on an instance of the graph.  For a full explanation of
how to use LaTeX to render graphs, see the introduction to the
<a class="reference internal" href="graph_latex.html#module-sage.graphs.graph_latex" title="sage.graphs.graph_latex"><tt class="xref py py-mod docutils literal"><span class="pre">graph_latex</span></tt></a> module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="n">tkz_style</span> <span class="o">=</span> <span class="s">&#39;Welsh&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">opts</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">latex_options</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">opts</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s">&#39;tkz_style&#39;</span><span class="p">)</span>
<span class="go">&#39;Welsh&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.set_planar_positions">
<tt class="descname">set_planar_positions</tt><big>(</big><em>test=False</em>, <em>**layout_options</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.set_planar_positions" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute a planar layout for self using Schnyder&#8217;s algorithm,
and save it as default layout.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_planar_positions</span><span class="p">(</span><span class="n">test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This method is deprecated since Sage-4.4.1.alpha2. Please use instead:</p>
<blockquote>
<div>sage: g.layout(layout = &#8220;planar&#8221;, save_pos = True)
{0: [1, 1], 1: [2, 2], 2: [3, 2], 3: [1, 4], 4: [5, 1], 5: [0, 5], 6: [1, 0]}</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.set_pos">
<tt class="descname">set_pos</tt><big>(</big><em>pos</em>, <em>dim=2</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.set_pos" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Sets the position dictionary, a dictionary specifying the
coordinates of each vertex.</p>
<p>EXAMPLES: Note that set_pos will allow you to do ridiculous things,
which will not blow up until plotting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="go">{0: (..., ...),</span>
<span class="go"> ...</span>
<span class="go"> 9: (..., ...)}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="s">&#39;spam&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">string indices must be integers, not str</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.set_vertex">
<tt class="descname">set_vertex</tt><big>(</big><em>vertex</em>, <em>object</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.set_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Associate an arbitrary object with a vertex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertex</span></tt> - which vertex</li>
<li><tt class="docutils literal"><span class="pre">object</span></tt> - object to associate to vertex</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">set_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">graphs</span><span class="o">.</span><span class="n">FlowerSnark</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Flower Snark: Graph on 20 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.set_vertices">
<tt class="descname">set_vertices</tt><big>(</big><em>vertex_dict</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.set_vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Associate arbitrary objects with each vertex, via an association
dictionary.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertex_dict</span></tt> - the association dictionary</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">(),</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">FlowerSnark</span><span class="p">(),</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">MoebiusKantorGraph</span><span class="p">(),</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span> <span class="p">}</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">Moebius-Kantor Graph: Graph on 16 vertices</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Flower Snark: Graph on 20 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.shortest_path">
<tt class="descname">shortest_path</tt><big>(</big><em>u</em>, <em>v</em>, <em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em>, <em>bidirectional=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.shortest_path" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of vertices representing some shortest path from u
to v: if there is no path from u to v, the list is empty.</p>
<p>For more information and more examples, see
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a> (the inputs are very similar).</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">u</span></tt>, <tt class="docutils literal"><span class="pre">v</span></tt> (vertices) - the start and the end vertices of the paths.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt>: performs a BFS from <tt class="docutils literal"><span class="pre">u</span></tt>. Does not work with edge
weights.</li>
<li><tt class="docutils literal"><span class="pre">'BFS_Bid</span></tt>: performs a BFS from <tt class="docutils literal"><span class="pre">u</span></tt> and from <tt class="docutils literal"><span class="pre">v</span></tt>. Does not
work with edge weights.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. Works only with positive weights.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Bid_NetworkX'</span></tt>: performs a Dijkstra visit from <tt class="docutils literal"><span class="pre">u</span></tt>
and from <tt class="docutils literal"><span class="pre">v</span></tt> (NetworkX implementation). Works only with positive
weights.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Bid'</span></tt>: a Cython implementation that performs
a Dijkstra visit from <tt class="docutils literal"><span class="pre">u</span></tt> and from <tt class="docutils literal"><span class="pre">v</span></tt>. Works only with positive
weights.</li>
<li><tt class="docutils literal"><span class="pre">'Bellman-Ford_Boost'</span></tt>: the Bellman-Ford algorithm, implemented in
Boost. Works also with negative weights, if there is no negative
cycle.</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS_Bid'</span></tt>
if <tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Bid'</span></tt> otherwise.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If there are negative weights and algorithm is <tt class="docutils literal"><span class="pre">None</span></tt>, the
result is not reliable. This occurs because, for performance
reasons, we cannot check whether there are edges with negative
weights before running the algorithm. If there are, the user
should explicitly input <tt class="docutils literal"><span class="pre">algorithm='Bellman-Ford_Boost'</span></tt>.</p>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">bidirectional</span></tt> - Deprecated and replaced by Algorithm: now it has
no effect. Before, if it was True, the algorithm would expand vertices
from <tt class="docutils literal"><span class="pre">u</span></tt> and <tt class="docutils literal"><span class="pre">v</span></tt> at the same time, making two spheres of half the
usual radius.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="go">[4, 17, 16, 12, 13, 9]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS&#39;</span><span class="p">)</span>
<span class="go">[4, 3, 2, 1, 8, 9]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">)</span>
<span class="go">[4, 3, 2, 1, 8]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Bid_NetworkX&#39;</span><span class="p">)</span>
<span class="go">[4, 3, 2, 1, 8]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Bid&#39;</span><span class="p">)</span>
<span class="go">[4, 3, 19, 0, 10, 9]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}},</span> <span class="n">sparse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[0, 4, 3]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Bid_NetworkX&#39;</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>If the algorithm is not implemented:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;tip top&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;tip top&#39; not yet implemented.</span>
</pre></div>
</div>
<p>BFS on weighted graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The &#39;BFS&#39; algorithm does not work on weighted graphs.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS_Bid&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The &#39;BFS_Bid&#39; algorithm does not work on weighted graphs.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs">
<tt class="descname">shortest_path_all_pairs</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em>, <em>default_weight=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes a shortest path between each pair of vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - the Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - the Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> if
<tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
<li><tt class="docutils literal"><span class="pre">default_weight</span></tt> - Deprecated: now it has no effect. Before, it was
used to assign a weight to edges with no label. Now it has been
replaced by <tt class="docutils literal"><span class="pre">weight_function</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple <tt class="docutils literal"><span class="pre">(dist,</span> <span class="pre">pred)</span></tt>. They are both dicts of dicts. The first
indicates the length <tt class="docutils literal"><span class="pre">dist[u][v]</span></tt> of the shortest weighted path
from <span class="math">\(u\)</span> to <span class="math">\(v\)</span>. The second is a compact representation of all the
paths - it indicates the predecessor <tt class="docutils literal"><span class="pre">pred[u][v]</span></tt> of <span class="math">\(v\)</span> in the
shortest path from <span class="math">\(u\)</span> to <span class="math">\(v\)</span>. If the algorithm used is
<tt class="docutils literal"><span class="pre">Johnson_Boost</span></tt>, predecessors are not computed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only reachable vertices are present in the dictionaries.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is a Cython version of this method that is usually
much faster for large graphs, as most of the time is
actually spent building the final double
dictionary. Everything on the subject is to be found in the
<a class="reference internal" href="distances_all_pairs.html#module-sage.graphs.distances_all_pairs" title="sage.graphs.distances_all_pairs"><tt class="xref py py-mod docutils literal"><span class="pre">distances_all_pairs</span></tt></a> module.</p>
</div>
<p>EXAMPLES:</p>
<p>Some standard examples (see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a> for
more examples on how to use the input variables):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="p">},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dist</span>
<span class="go">{0: {0: 0, 1: 1, 2: 2, 3: 3, 4: 2}, 1: {0: 1, 1: 0, 2: 1, 3: 2, 4: 3}, 2: {0: 2, 1: 1, 2: 0, 3: 1, 4: 3}, 3: {0: 3, 1: 2, 2: 1, 3: 0, 4: 2}, 4: {0: 2, 1: 3, 2: 3, 3: 2, 4: 0}}</span>
<span class="gp">sage: </span><span class="n">pred</span>
<span class="go">{0: {0: None, 1: 0, 2: 1, 3: 2, 4: 0}, 1: {0: 1, 1: None, 2: 1, 3: 2, 4: 0}, 2: {0: 1, 1: 2, 2: None, 3: 2, 4: 3}, 3: {0: 1, 1: 2, 2: 3, 3: None, 4: 3}, 4: {0: 4, 1: 0, 2: 3, 3: 4, 4: None}}</span>
<span class="gp">sage: </span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{0: None, 1: 0, 2: 1, 3: 2, 4: 0}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}}</span> <span class="p">},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">weight_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;weight&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">dist</span>
<span class="go">{0: {0: 0, 1: 1, 2: 2, 3: 3, 4: 2}, 1: {0: 1, 1: 0, 2: 1, 3: 2, 4: 3}, 2: {0: 2, 1: 1, 2: 0, 3: 1, 4: 3}, 3: {0: 3, 1: 2, 2: 1, 3: 0, 4: 2}, 4: {0: 2, 1: 3, 2: 3, 3: 2, 4: 0}}</span>
<span class="gp">sage: </span><span class="n">pred</span>
<span class="go">{0: {0: None, 1: 0, 2: 1, 3: 2, 4: 0}, 1: {0: 1, 1: None, 2: 1, 3: 2, 4: 0}, 2: {0: 1, 1: 2, 2: None, 3: 2, 4: 3}, 3: {0: 1, 1: 2, 2: 3, 3: None, 4: 3}, 4: {0: 4, 1: 0, 2: 3, 3: 4, 4: None}}</span>
</pre></div>
</div>
<p>So for example the shortest weighted path from <span class="math">\(0\)</span> to <span class="math">\(3\)</span> is obtained as
follows. The predecessor of <span class="math">\(3\)</span> is <tt class="docutils literal"><span class="pre">pred[0][3]</span> <span class="pre">==</span> <span class="pre">2</span></tt>, the predecessor
of <span class="math">\(2\)</span> is <tt class="docutils literal"><span class="pre">pred[0][2]</span> <span class="pre">==</span> <span class="pre">1</span></tt>, and the predecessor of <span class="math">\(1\)</span> is
<tt class="docutils literal"><span class="pre">pred[0][1]</span> <span class="pre">==</span> <span class="pre">0</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="bp">None</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="p">},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">()</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2, 3: 2, 4: 1},</span>
<span class="go">1: {0: 1, 1: 0, 2: 1, 3: 2, 4: 2},</span>
<span class="go">2: {0: 2, 1: 1, 2: 0, 3: 1, 4: 2},</span>
<span class="go">3: {0: 2, 1: 2, 2: 1, 3: 0, 4: 1},</span>
<span class="go">4: {0: 1, 1: 2, 2: 2, 3: 1, 4: 0}},</span>
<span class="go">{0: {0: None, 1: 0, 2: 1, 3: 4, 4: 0},</span>
<span class="go">1: {0: 1, 1: None, 2: 1, 3: 2, 4: 0},</span>
<span class="go">2: {0: 1, 1: 2, 2: None, 3: 2, 4: 3},</span>
<span class="go">3: {0: 4, 1: 2, 2: 3, 3: None, 4: 3},</span>
<span class="go">4: {0: 4, 1: 0, 2: 3, 3: 4, 4: None}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2, 3: 3, 4: 2},</span>
<span class="go">1: {0: 1, 1: 0, 2: 1, 3: 2, 4: 3},</span>
<span class="go">2: {0: 2, 1: 1, 2: 0, 3: 1, 4: 3},</span>
<span class="go">3: {0: 3, 1: 2, 2: 1, 3: 0, 4: 2},</span>
<span class="go">4: {0: 2, 1: 3, 2: 3, 3: 2, 4: 0}},</span>
<span class="go">{0: {0: None, 1: 0, 2: 1, 3: 2, 4: 0},</span>
<span class="go">1: {0: 1, 1: None, 2: 1, 3: 2, 4: 0},</span>
<span class="go">2: {0: 1, 1: 2, 2: None, 3: 2, 4: 3},</span>
<span class="go">3: {0: 1, 1: 2, 2: 3, 3: None, 4: 3},</span>
<span class="go">4: {0: 4, 1: 0, 2: 3, 3: 4, 4: None}})</span>
</pre></div>
</div>
<p>Now, <tt class="docutils literal"><span class="pre">default_weight</span></tt> does not work anymore:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">by_weight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">default_weight</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The weight function cannot find the weight of (0, 1, None).</span>
</pre></div>
</div>
<p>It can be replaced by choosing an appropriate weight_function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">200</span><span class="p">))</span>
<span class="go">({0: {0: 0, 1: 200, 2: 5, 3: 4, 4: 2},</span>
<span class="go">1: {0: 200, 1: 0, 2: 200, 3: 201, 4: 202},</span>
<span class="go">2: {0: 5, 1: 200, 2: 0, 3: 1, 4: 3},</span>
<span class="go">3: {0: 4, 1: 201, 2: 1, 3: 0, 4: 2},</span>
<span class="go">4: {0: 2, 1: 202, 2: 3, 3: 2, 4: 0}},</span>
<span class="go">{0: {0: None, 1: 0, 2: 3, 3: 4, 4: 0},</span>
<span class="go">1: {0: 1, 1: None, 2: 1, 3: 2, 4: 0},</span>
<span class="go">2: {0: 4, 1: 2, 2: None, 3: 2, 4: 3},</span>
<span class="go">3: {0: 4, 1: 2, 2: 3, 3: None, 4: 3},</span>
<span class="go">4: {0: 4, 1: 0, 2: 3, 3: 4, 4: None}})</span>
</pre></div>
</div>
<p>Checking that distances are equal regardless of the algorithm used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;BFS&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Floyd-Warshall-Cython&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d3</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Floyd-Warshall-Python&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d4</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_NetworkX&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d5</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d6</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Johnson_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="o">==</span> <span class="n">d3</span> <span class="o">==</span> <span class="n">d4</span> <span class="o">==</span> <span class="n">d5</span> <span class="o">==</span> <span class="n">d6</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Checking that distances are equal regardless of the algorithm used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNM</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;BFS&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Floyd-Warshall-Cython&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d3</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Floyd-Warshall-Python&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d4</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_NetworkX&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d5</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d6</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Johnson_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="o">==</span> <span class="n">d3</span> <span class="o">==</span> <span class="n">d4</span> <span class="o">==</span> <span class="n">d5</span> <span class="o">==</span> <span class="n">d6</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Checking that weighted distances are equal regardless of the algorithm used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="go">....:     for w in range(5):</span>
<span class="go">....:         g.add_edge(v,w,random.uniform(1,10))</span>
<span class="gp">sage: </span><span class="n">d1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Floyd-Warshall-Python&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_NetworkX&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d3</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d4</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Johnson_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="o">==</span> <span class="n">d3</span> <span class="o">==</span> <span class="n">d4</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Checking a random path is valid:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">dist</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;BFS&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">random_vertex</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">random_vertex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">path</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Negative weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The graph contains a negative cycle.</span>
</pre></div>
</div>
<p>Unreachable vertices are not present in the dictionaries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS&#39;</span><span class="p">)</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2}, 1: {1: 0, 2: 1}, 2: {2: 0}},</span>
<span class="go"> {0: {0: None, 1: 0, 2: 1}, 1: {1: None, 2: 1}, 2: {2: None}})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">)</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2}, 1: {1: 0, 2: 1}, 2: {2: 0}},</span>
<span class="go"> {0: {0: None, 1: 1, 2: 1}, 1: {1: None, 2: 2}, 2: {2: None}})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Boost&#39;</span><span class="p">)</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2}, 1: {1: 0, 2: 1}, 2: {2: 0}},</span>
<span class="go"> {0: {0: None, 1: 0, 2: 1}, 1: {1: None, 2: 1}, 2: {2: None}})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Floyd-Warshall-Python&#39;</span><span class="p">)</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2}, 1: {1: 0, 2: 1}, 2: {2: 0}},</span>
<span class="go"> {0: {0: None, 1: 0, 2: 1}, 1: {1: None, 2: 1}, 2: {2: None}})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Floyd-Warshall-Cython&#39;</span><span class="p">)</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2}, 1: {1: 0, 2: 1}, 2: {2: 0}},</span>
<span class="go"> {0: {0: None, 1: 0, 2: 1}, 1: {1: None, 2: 1}, 2: {2: None}})</span>
</pre></div>
</div>
<p>In order to change the default behavior if the graph is disconnected,
we can use default values with dictionaries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.infinity</span> <span class="kn">import</span> <span class="n">Infinity</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">(),</span><span class="mi">2</span><span class="p">):</span>
<span class="go">....:     print &quot;dist({}, {}) = {}&quot;.format(u,v, d[u].get(v,+Infinity))</span>
<span class="go">dist(0, 1) = 1</span>
<span class="go">dist(0, 2) = +Infinity</span>
<span class="go">dist(0, 3) = +Infinity</span>
<span class="go">dist(1, 2) = +Infinity</span>
<span class="go">dist(1, 3) = +Infinity</span>
<span class="go">dist(2, 3) = 1</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Wrong name for <tt class="docutils literal"><span class="pre">algorithm</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm Bob is not implemented.</span>
</pre></div>
</div>
<p>Algorithms that do not work with weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;BFS&quot;</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;BFS&#39; does not work with weights.</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Floyd-Warshall-Cython&quot;</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;Floyd-Warshall-Cython&#39; does not work with weights.</span>
</pre></div>
</div>
<p>Dijkstra with negative weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_Boost&quot;</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Dijkstra algorithm does not work with negative weights. Please, use Bellman-Ford.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.shortest_path_length">
<tt class="descname">shortest_path_length</tt><big>(</big><em>u</em>, <em>v</em>, <em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em>, <em>bidirectional=None</em>, <em>weight_sum=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_length" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the minimal length of a path from u to v.</p>
<p>If there is no path from u to v, returns Infinity.</p>
<p>For more information and more examples, we refer to
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path" title="sage.graphs.generic_graph.GenericGraph.shortest_path"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path()</span></tt></a> and
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a>, which have very similar inputs.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">u</span></tt>, <tt class="docutils literal"><span class="pre">v</span></tt> (vertices) - the start and the end vertices of the paths.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt>: performs a BFS from <tt class="docutils literal"><span class="pre">u</span></tt>. Does not work with edge
weights.</li>
<li><tt class="docutils literal"><span class="pre">'BFS_Bid</span></tt>: performs a BFS from <tt class="docutils literal"><span class="pre">u</span></tt> and from <tt class="docutils literal"><span class="pre">v</span></tt>. Does not
work with edge weights.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Bid_NetworkX'</span></tt>: performs a Dijkstra visit from <tt class="docutils literal"><span class="pre">u</span></tt>
and from <tt class="docutils literal"><span class="pre">v</span></tt> (NetworkX implementation).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Bid'</span></tt>: a Cython implementation that performs
a Dijkstra visit from <tt class="docutils literal"><span class="pre">u</span></tt> and from <tt class="docutils literal"><span class="pre">v</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Bellman-Ford_Boost'</span></tt>: the Bellman-Ford algorithm, implemented in
Boost. Works also with negative weights, if there is no negative
cycle.</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS_Bid'</span></tt>
if <tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Bid'</span></tt> otherwise.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If there are negative weights and algorithm is <tt class="docutils literal"><span class="pre">None</span></tt>, the
result is not reliable. This occurs because, for performance
reasons, we cannot check whether there are edges with negative
weights before running the algorithm. If there are, the user
should explicitly input <tt class="docutils literal"><span class="pre">algorithm='Bellman-Ford_Boost'</span></tt>.</p>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">bidirectional</span></tt> - Deprecated and replaced by Algorithm: now it has
no effect. Before, if it was True, the algorithm would expand vertices
from <tt class="docutils literal"><span class="pre">u</span></tt> and <tt class="docutils literal"><span class="pre">v</span></tt> at the same time, making two spheres of half the
usual radius.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">weight_sum</span></tt> - Deprecated: now it has no effect. Before, it was used
to decide if the algorithm should return the number of edges in the
shortest path or the length of the (weighted) path. Now it has the
same value as <tt class="docutils literal"><span class="pre">by_weight</span></tt>.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<p>Standard examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS&#39;</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Bid_NetworkX&#39;</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Bid&#39;</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Bellman-Ford_Boost&#39;</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}},</span> <span class="n">sparse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Bid_NetworkX&#39;</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>If Dijkstra is used with negative weights, usually it raises an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">}},</span> <span class="n">sparse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The graph contains an edge with negative weight!</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Bellman-Ford_Boost&#39;</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>However, sometimes the result may be wrong, and no error is raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1000</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3000</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Bellman-Ford_Boost&#39;</span><span class="p">)</span>
<span class="go">-1000</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.shortest_path_lengths">
<tt class="descname">shortest_path_lengths</tt><big>(</big><em>u</em>, <em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em>, <em>weight_sums=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_lengths" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes the length of a shortest path from u to any other vertex.</p>
<p>Returns a dictionary of shortest path lengths keyed by targets,
escluding all vertices that are not reachable from u.</p>
<p>For more information on the input variables and more examples, we refer
to <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a>
which has the same input variables.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">u</span></tt> (vertex) - the starting vertex.</li>
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt>: performs a BFS from <tt class="docutils literal"><span class="pre">u</span></tt>. Does not work with edge
weights.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX (works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Bellman-Ford_Boost'</span></tt>: the Bellman-Ford algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> if
<tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Bellman-Ford_Boost'</span></tt> otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
<li><tt class="docutils literal"><span class="pre">weight_sums</span></tt> - Deprecated: now this variable has no effect. Before,
it was used to decide whether the number of edges or the sum of their
lengths was outputted. Now we use variable <tt class="docutils literal"><span class="pre">by_weight</span></tt> to decide.</li>
</ul>
<p>EXAMPLES:</p>
<p>Unweighted case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{0: 0, 1: 1, 2: 2, 3: 2, 4: 3, 5: 4, 6: 3, 7: 3, 8: 2, 9: 2, 10: 1, 11: 2, 12: 3, 13: 3, 14: 4, 15: 5, 16: 4, 17: 3, 18: 2, 19: 1}</span>
</pre></div>
</div>
<p>Weighted case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="p">},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 0, 1: 1, 2: 2, 3: 3, 4: 2}</span>
</pre></div>
</div>
<p>Using a weight function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})])</span>
<span class="gp">sage: </span><span class="n">weight_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;weight&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">{1: 0, 2: 1}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight_function</span><span class="p">)</span>
<span class="go">{0: 0, 1: 1, 2: 4}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight_function</span><span class="p">)</span>
<span class="go">{1: 0, 2: 3}</span>
</pre></div>
</div>
<p>Negative weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">}),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight_function</span><span class="p">)</span>
<span class="go">{0: 0, 1: -1, 2: 2}</span>
</pre></div>
</div>
<p>Negative cycles:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">}),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight_function</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The graph contains a negative cycle.</span>
</pre></div>
</div>
<p>Checking that distances are equal regardless of the algorithm used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;BFS&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_NetworkX&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d3</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Dijkstra_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d4</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortest_path_lengths</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;Bellman-Ford_Boost&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="o">==</span> <span class="n">d3</span> <span class="o">==</span> <span class="n">d4</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.shortest_paths">
<tt class="descname">shortest_paths</tt><big>(</big><em>u</em>, <em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em>, <em>cutoff=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a dictionary associating to each vertex v a shortest path from u
to v, if it exists.</p>
<p>If u and v are not connected, vertex v is not present in the dictionary.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">u</span></tt> (vertex) - the starting vertex.</li>
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt>: performs a BFS from <tt class="docutils literal"><span class="pre">u</span></tt>. Does not work with edge
weights.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX (works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Bellman-Ford_Boost'</span></tt>: the Bellman-Ford algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> if
<tt class="docutils literal"><span class="pre">by_weight</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Bellman-Ford_Boost'</span></tt> otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
<li><tt class="docutils literal"><span class="pre">cutoff</span></tt> (integer) - integer depth to stop search (used only if
<tt class="docutils literal"><span class="pre">algorithm=='BFS'</span></tt>).</li>
</ul>
<p>EXAMPLES:</p>
<p>Standard example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{0: [0], 1: [0, 1], 2: [0, 1, 2], 3: [0, 19, 3], 4: [0, 19, 3, 4], 5: [0, 1, 2, 6, 5], 6: [0, 1, 2, 6], 7: [0, 1, 8, 7], 8: [0, 1, 8], 9: [0, 10, 9], 10: [0, 10], 11: [0, 10, 11], 12: [0, 10, 11, 12], 13: [0, 10, 9, 13], 14: [0, 1, 8, 7, 14], 15: [0, 19, 18, 17, 16, 15], 16: [0, 19, 18, 17, 16], 17: [0, 19, 18, 17], 18: [0, 19, 18], 19: [0, 19]}</span>
</pre></div>
</div>
<p>All these paths are obviously induced graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">D</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="p">)</span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">{0: [0], 1: [0, 1], 2: [0, 1, 2], 3: [0, 19, 3], 8: [0, 1, 8], 9: [0, 10, 9], 10: [0, 10], 11: [0, 10, 11], 18: [0, 19, 18], 19: [0, 19]}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="p">},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: [0], 1: [0, 1], 2: [0, 1, 2], 3: [0, 1, 2, 3], 4: [0, 4]}</span>
</pre></div>
</div>
<p>Weighted shortest paths:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{0: [0], 1: [0, 1], 2: [0, 2]}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: [0], 1: [0, 1], 2: [0, 1, 2]}</span>
</pre></div>
</div>
<p>Using a weight function (this way, <tt class="docutils literal"><span class="pre">by_weight</span></tt> is set to <tt class="docutils literal"><span class="pre">True</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})])</span>
<span class="gp">sage: </span><span class="n">weight_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s">&#39;weight&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight_function</span><span class="p">)</span>
<span class="go">{0: [0], 1: [0, 1], 2: [0, 1, 2]}</span>
</pre></div>
</div>
<p>If the weight function does not match the label:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The weight function cannot find the weight of (0, 1, {&#39;weight&#39;: 1}).</span>
</pre></div>
</div>
<p>However, if <tt class="docutils literal"><span class="pre">check_weight</span></tt> is set to False, unexpected behavior may
occur:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">check_weight</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unsupported operand type(s) for +: &#39;int&#39; and &#39;dict&#39;</span>
</pre></div>
</div>
<p>Negative weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: [0], 1: [0, 1], 2: [0, 1, 2]}</span>
</pre></div>
</div>
<p>Negative cycles:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The graph contains a negative cycle.</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>If we ask for an unknown algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;tip top&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm tip top not yet implemented. Please, contribute!</span>
</pre></div>
</div>
<p>If we ask for BFS in a weighted graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS&#39;</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The &#39;BFS&#39; algorithm does not work on weighted graphs.</span>
</pre></div>
</div>
<p>If we run Dijkstra with negative weights:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Boost&#39;</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Dijkstra algorithm does not work with negative weights. Please, use Bellman-Ford.</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(&#39;Contradictory paths found:&#39;, &#39;negative weights?&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.show">
<tt class="descname">show</tt><big>(</big><em>method='matplotlib'</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.show" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Shows the (di)graph.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">method</span></tt> &#8211; set to <tt class="docutils literal"><span class="pre">&quot;matplotlib&quot;</span></tt> (default) to display the graph
using matplotlib, or to <tt class="docutils literal"><span class="pre">&quot;js&quot;</span></tt> to visualize it in a browser using
<a class="reference external" href="http://d3js.org/">d3.js</a>.</p>
</li>
<li><p class="first">Any other argument supported by the drawing functions:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">&quot;matplotlib&quot;</span></tt> &#8211; see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.plot" title="sage.graphs.generic_graph.GenericGraph.plot"><tt class="xref py py-meth docutils literal"><span class="pre">GenericGraph.plot</span></tt></a> and
<a class="reference external" href="../../../plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.show" title="(in Sage Reference Manual: 2D Graphics v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">sage.plot.graphics.Graphics.show()</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">&quot;js&quot;</span></tt> &#8211; see <a class="reference internal" href="graph_plot_js.html#sage.graphs.graph_plot_js.gen_html_code" title="sage.graphs.graph_plot_js.gen_html_code"><tt class="xref py py-meth docutils literal"><span class="pre">gen_html_code()</span></tt></a>.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vertex_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">vertex_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">graph_border</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c"># long time (3s on sage.math, 2011)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.show3d">
<tt class="descname">show3d</tt><big>(</big><em>bgcolor=(1</em>, <em>1</em>, <em>1)</em>, <em>vertex_colors=None</em>, <em>vertex_size=0.06</em>, <em>edge_colors=None</em>, <em>edge_size=0.02</em>, <em>edge_size2=0.0325</em>, <em>pos3d=None</em>, <em>color_by_label=False</em>, <em>engine='jmol'</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.show3d" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Plots the graph using Tachyon, and shows the resulting plot.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">bgcolor</span></tt> - rgb tuple (default: (1,1,1))</li>
<li><tt class="docutils literal"><span class="pre">vertex_size</span></tt> - float (default: 0.06)</li>
<li><tt class="docutils literal"><span class="pre">vertex_colors</span></tt> - optional dictionary to specify
vertex colors: each key is a color recognizable by tachyon (rgb
tuple (default: (1,0,0))), and each corresponding entry is a list
of vertices. If a vertex is not listed, it looks invisible on the
resulting plot (it doesn&#8217;t get drawn).</li>
<li><tt class="docutils literal"><span class="pre">edge_colors</span></tt> - a dictionary specifying edge
colors: each key is a color recognized by tachyon ( default:
(0,0,0) ), and each entry is a list of edges.</li>
<li><tt class="docutils literal"><span class="pre">edge_size</span></tt> - float (default: 0.02)</li>
<li><tt class="docutils literal"><span class="pre">edge_size2</span></tt> - float (default: 0.0325), used for
Tachyon sleeves</li>
<li><tt class="docutils literal"><span class="pre">pos3d</span></tt> - a position dictionary for the vertices</li>
<li><tt class="docutils literal"><span class="pre">iterations</span></tt> - how many iterations of the spring
layout algorithm to go through, if applicable</li>
<li><tt class="docutils literal"><span class="pre">engine</span></tt> - which renderer to use. Options:</li>
<li><tt class="docutils literal"><span class="pre">'jmol'</span></tt> - default &#8216;tachyon&#8217;</li>
<li><tt class="docutils literal"><span class="pre">xres</span></tt> - resolution</li>
<li><tt class="docutils literal"><span class="pre">yres</span></tt> - resolution</li>
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> - passed on to the Tachyon command</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">edge_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span> <span class="c"># long time</span>
</pre></div>
</div>
<p>We plot a fairly complicated Cayley graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A5</span> <span class="o">=</span> <span class="n">AlternatingGroup</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">A5</span>
<span class="go">Alternating group of order 5!/2 as a permutation group</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A5</span><span class="o">.</span><span class="n">cayley_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">edge_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">edge_size2</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()},</span> <span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">color_by_label</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span> <span class="c"># long time</span>
</pre></div>
</div>
<p>Some Tachyon examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">)</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">,</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()})</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">,</span> <span class="n">edge_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="n">C</span><span class="o">.</span><span class="n">edges</span><span class="p">()},</span> <span class="n">vertex_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="n">C</span><span class="o">.</span><span class="n">vertices</span><span class="p">()},</span> <span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="c"># long time</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s">&#39;tachyon&#39;</span><span class="p">,</span> <span class="n">edge_colors</span><span class="o">=</span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">):[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">)]})</span> <span class="c"># long time</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.size">
<tt class="descname">size</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.size" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of edges.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.spanning_trees_count">
<tt class="descname">spanning_trees_count</tt><big>(</big><em>root_vertex=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.spanning_trees_count" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of spanning trees in a graph.</p>
<p>In the case of a digraph, counts the number of spanning out-trees rooted
in <tt class="docutils literal"><span class="pre">root_vertex</span></tt>.  Default is to set first vertex as root.</p>
<p>This computation uses Kirchhoff&#8217;s Matrix Tree Theorem [1] to calculate
the number of spanning trees. For complete graphs on <span class="math">\(n\)</span> vertices the
result can also be reached using Cayley&#8217;s formula: the number of
spanning trees are <span class="math">\(n^(n-2)\)</span>.</p>
<p>For digraphs, the augmented Kirchhoff Matrix as defined in [2] is
used for calculations. Here the result is the number of out-trees
rooted at a specific vertex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">root_vertex</span></tt> &#8211; integer (default: the first vertex) This is the vertex
that will be used as root for all spanning out-trees if the graph
is a directed graph.  This argument is ignored if the graph is not a digraph.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.spanning_trees" title="sage.graphs.graph.Graph.spanning_trees"><tt class="xref py py-meth docutils literal"><span class="pre">spanning_trees()</span></tt></a> &#8211; enumerates all
spanning trees of a graph.</p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] <a class="reference external" href="http://mathworld.wolfram.com/MatrixTreeTheorem.html">http://mathworld.wolfram.com/MatrixTreeTheorem.html</a></li>
<li>[2] Lih-Hsing Hsu, Cheng-Kuan Lin, &#8220;Graph Theory and
Interconnection Networks&#8221;</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>Anders Jonsson (2009-10-10)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">spanning_trees_count</span><span class="p">()</span>
<span class="go">2000</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ST</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">spanning_trees_count</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ST</span> <span class="o">==</span> <span class="n">n</span><span class="o">^</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">spanning_trees_count</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">spanning_trees_count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">spanning_trees_count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.spectrum">
<tt class="descname">spectrum</tt><big>(</big><em>laplacian=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.spectrum" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of the eigenvalues of the adjacency matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">laplacian</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, use the Laplacian matrix
(see <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix" title="sage.graphs.generic_graph.GenericGraph.kirchhoff_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">kirchhoff_matrix()</span></tt></a>)</li>
</ul>
<p>OUTPUT:</p>
<p>A list of the eigenvalues, including multiplicities, sorted
with the largest eigenvalue first.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
<span class="go">[3, 1, 1, 1, 1, 1, -2, -2, -2, -2]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">laplacian</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[5, 5, 5, 5, 2, 2, 2, 2, 2, 0]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
<span class="go">[2.9032119259..., 1, 1, 1, 1, 0.8060634335..., -1.7092753594..., -2, -2, -2]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
<span class="go">[2, 1.4142135623..., 1.4142135623..., 0, 0, -1.4142135623..., -1.4142135623..., -2]</span>
</pre></div>
</div>
<p>A digraph may have complex eigenvalues.  Previously, the complex parts
of graph eigenvalues were being dropped.  For a 3-cycle, we have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
<span class="go">[1, -0.5000000000... + 0.8660254037...*I, -0.5000000000... - 0.8660254037...*I]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The Laplacian matrix of a graph is the negative of the adjacency matrix with the degree of each vertex on the diagonal.  So for a regular graph, if <span class="math">\(\delta\)</span> is an eigenvalue of a regular graph of degree <span class="math">\(r\)</span>, then <span class="math">\(r-\delta\)</span> will be an eigenvalue of the Laplacian.  The Hoffman-Singleton graph is regular of degree 7, so the following will test both the Laplacian construction and the computation of eigenvalues.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HoffmanSingletonGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">evals</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lap</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evals</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">lap</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lap</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">laplacian</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.steiner_tree">
<tt class="descname">steiner_tree</tt><big>(</big><em>vertices</em>, <em>weighted=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.steiner_tree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a tree of minimum weight connecting the given
set of vertices.</p>
<p>Definition :</p>
<p>Computing a minimum spanning tree in a graph can be done in <span class="math">\(n
\log(n)\)</span> time (and in linear time if all weights are equal) where
<span class="math">\(n = V + E\)</span>. On the other hand, if one is given a large (possibly
weighted) graph and a subset of its vertices, it is NP-Hard to
find a tree of minimum weight connecting the given set of
vertices, which is then called a Steiner Tree.</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Steiner_tree_problem">Wikipedia article on Steiner Trees</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; the vertices to be connected by the Steiner
Tree.</li>
<li><tt class="docutils literal"><span class="pre">weighted</span></tt> (boolean) &#8211; Whether to consider the graph as
weighted, and use each edge&#8217;s label as a weight, considering
<tt class="docutils literal"><span class="pre">None</span></tt> as a weight of <span class="math">\(1\)</span>. If <tt class="docutils literal"><span class="pre">weighted=False</span></tt> (default)
all edges are considered to have a weight of <span class="math">\(1\)</span>.</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>This problem being defined on undirected graphs, the
orientation is not considered if the current graph is
actually a digraph.</li>
<li>The graph is assumed not to have multiple edges.</li>
</ul>
</div>
<p>ALGORITHM:</p>
<p>Solved through Linear Programming.</p>
<p>COMPLEXITY:</p>
<p>NP-Hard.</p>
<p>Note that this algorithm first checks whether the given
set of vertices induces a connected graph, returning one of its
spanning trees if <tt class="docutils literal"><span class="pre">weighted</span></tt> is set to <tt class="docutils literal"><span class="pre">False</span></tt>, and thus
answering very quickly in some cases</p>
<p>EXAMPLES:</p>
<p>The Steiner Tree of the first 5 vertices in a random graph is,
of course, always a tree</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">st</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">steiner_tree</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()[:</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">st</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>And all the 5 vertices are contained in this tree</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">v</span> <span class="ow">in</span> <span class="n">st</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]</span> <span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An exception is raised when the problem is impossible, i.e.
if the given vertices are not all included in the same
connected component</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">st</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">steiner_tree</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">The given vertices do not all belong to the same connected component. This problem has no solution !</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.strong_product">
<tt class="descname">strong_product</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.strong_product" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the strong product of self and other.</p>
<p>The strong product of <span class="math">\(G\)</span> and <span class="math">\(H\)</span> is the graph <span class="math">\(L\)</span> with vertex set
<span class="math">\(V(L)=V(G)\times V(H)\)</span>, and <span class="math">\(((u,v), (w,x))\)</span> is an edge of <span class="math">\(L\)</span> iff
either :</p>
<ul class="simple">
<li><span class="math">\((u, w)\)</span> is an edge of <span class="math">\(G\)</span> and <span class="math">\(v = x\)</span>, or</li>
<li><span class="math">\((v, x)\)</span> is an edge of <span class="math">\(H\)</span> and <span class="math">\(u = w\)</span>, or</li>
<li><span class="math">\((u, w)\)</span> is an edge of <span class="math">\(G\)</span> and <span class="math">\((v, x)\)</span> is an edge of <span class="math">\(H\)</span>.</li>
</ul>
<p>In other words, the edges of the strong product is the union of the
edges of the tensor and Cartesian products.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">strong_product</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 36 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">strong_product</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Graph on 200 vertices</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 1701 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Strong product of graphs is commutative:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">strong_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">H</span><span class="o">.</span><span class="n">strong_product</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Strong product of digraphs is commutative:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">strong_product</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">J</span><span class="o">.</span><span class="n">strong_product</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Counting the edges (see <a class="reference external" href="http://trac.sagemath.org/13699">trac ticket #13699</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gn</span><span class="p">,</span><span class="n">gm</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hn</span><span class="p">,</span><span class="n">hm</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">h</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">product_size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">strong_product</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">expected</span> <span class="o">=</span> <span class="n">gm</span><span class="o">*</span><span class="n">hn</span> <span class="o">+</span> <span class="n">hm</span><span class="o">*</span><span class="n">gn</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">gm</span><span class="o">*</span><span class="n">hm</span>
<span class="gp">sage: </span><span class="k">if</span> <span class="n">product_size</span> <span class="o">!=</span> <span class="n">expected</span><span class="p">:</span>
<span class="gp">... </span>      <span class="k">print</span> <span class="s">&quot;Something is really wrong here...&quot;</span><span class="p">,</span> <span class="n">product_size</span><span class="p">,</span> <span class="s">&quot;!=&quot;</span><span class="p">,</span> <span class="n">expected</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.subdivide_edge">
<tt class="descname">subdivide_edge</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.subdivide_edge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Subdivides an edge <span class="math">\(k\)</span> times.</p>
<p>INPUT:</p>
<p>The following forms are all accepted to subdivide <span class="math">\(8\)</span> times
the edge between vertices <span class="math">\(1\)</span> and <span class="math">\(2\)</span> labeled with
<tt class="docutils literal"><span class="pre">&quot;my_label&quot;</span></tt>.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">G.subdivide_edge(</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">8</span> <span class="pre">)</span></tt></li>
<li><tt class="docutils literal"><span class="pre">G.subdivide_edge(</span> <span class="pre">(1,</span> <span class="pre">2),</span> <span class="pre">8</span> <span class="pre">)</span></tt></li>
<li><tt class="docutils literal"><span class="pre">G.subdivide_edge(</span> <span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">&quot;my_label&quot;),</span> <span class="pre">8</span> <span class="pre">)</span></tt></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>If the given edge is labelled with <span class="math">\(l\)</span>, all the edges
created by the subdivision will have the same label.</li>
<li>If no label is given, the label used will be the one
returned by the method <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.edge_label" title="sage.graphs.generic_graph.GenericGraph.edge_label"><tt class="xref py py-meth docutils literal"><span class="pre">edge_label()</span></tt></a> on the pair
<tt class="docutils literal"><span class="pre">u,v</span></tt></li>
</ul>
</div>
<p>EXAMPLE:</p>
<p>Subdividing <span class="math">\(5\)</span> times an edge in a path of length
<span class="math">\(3\)</span> makes it a path of length <span class="math">\(8\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">edge</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subdivide_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Subdividing a labelled edge in two ways</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;label1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;label2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(0, 1, &#39;label1&#39;), (1, 2, &#39;label2&#39;)]</span>
</pre></div>
</div>
<p>Specifying the label:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subdivide_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;label1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(0, 3, &#39;label1&#39;), (1, 2, &#39;label2&#39;), (1, 5, &#39;label1&#39;), (3, 4, &#39;label1&#39;), (4, 5, &#39;label1&#39;)]</span>
</pre></div>
</div>
<p>The lazy way:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subdivide_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;label2&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(0, 3, &#39;label1&#39;), (1, 5, &#39;label1&#39;), (1, 6, &#39;label2&#39;), (2, 10, &#39;label2&#39;), (3, 4, &#39;label1&#39;), (4, 5, &#39;label1&#39;), (6, 7, &#39;label2&#39;), (7, 8, &#39;label2&#39;), (8, 9, &#39;label2&#39;), (9, 10, &#39;label2&#39;)]</span>
</pre></div>
</div>
<p>If too many arguments are given, an exception is raised</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subdivide_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This method takes at most 4 arguments !</span>
</pre></div>
</div>
<p>The same goes when the given edge does not exist:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subdivide_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;fake_label&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The given edge does not exist.</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subdivide_edges" title="sage.graphs.generic_graph.GenericGraph.subdivide_edges"><tt class="xref py py-meth docutils literal"><span class="pre">subdivide_edges()</span></tt></a> &#8211; subdivides multiples edges at a time</li>
</ul>
</div>
<p>TESTS:</p>
<p><a class="reference external" href="http://trac.sagemath.org/15895">trac ticket #15895</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="s">&#39;S&#39;</span><span class="p">;</span> <span class="n">F</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F2</span><span class="o">.</span><span class="n">subdivide_edges</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">F2</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">0</span> <span class="ow">in</span> <span class="n">F2</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.subdivide_edges">
<tt class="descname">subdivide_edges</tt><big>(</big><em>edges</em>, <em>k</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.subdivide_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Subdivides k times edges from an iterable container.</p>
<p>For more information on the behaviour of this method, please
refer to the documentation of <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subdivide_edge" title="sage.graphs.generic_graph.GenericGraph.subdivide_edge"><tt class="xref py py-meth docutils literal"><span class="pre">subdivide_edge()</span></tt></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">edges</span></tt> &#8211; a list of edges</li>
<li><tt class="docutils literal"><span class="pre">k</span></tt> (integer) &#8211; common length of the subdivisions</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a given edge is labelled with <span class="math">\(l\)</span>, all the edges
created by its subdivision will have the same label.</p>
</div>
<p>EXAMPLE:</p>
<p>If we are given the disjoint union of several paths:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">paths</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">g</span> <span class="o">=</span> <span class="n">g</span> <span class="o">+</span> <span class="n">P</span>
</pre></div>
</div>
<p>... subdividing edges in each of them will only change their
lengths:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">edges</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">connected_components_subgraphs</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subdivide_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us check this by creating the graph we expect to have built
through subdivision:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">paths2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="mi">9</span><span class="o">+</span><span class="n">k</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">paths2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">,</span> <span class="n">paths2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g2</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">paths2</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">g2</span> <span class="o">=</span> <span class="n">g2</span> <span class="o">+</span> <span class="n">P</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subdivide_edge" title="sage.graphs.generic_graph.GenericGraph.subdivide_edge"><tt class="xref py py-meth docutils literal"><span class="pre">subdivide_edge()</span></tt></a> &#8211; subdivides one edge</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.subgraph">
<tt class="descname">subgraph</tt><big>(</big><em>vertices=None</em>, <em>edges=None</em>, <em>inplace=False</em>, <em>vertex_property=None</em>, <em>edge_property=None</em>, <em>algorithm=None</em>, <em>immutable=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.subgraph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the subgraph containing the given vertices and edges.</p>
<p>If either vertices or edges are not specified, they are assumed to be
all vertices or edges. If edges are not specified, returns the subgraph
induced by the vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">inplace</span></tt> - Using inplace is True will simply
delete the extra vertices and edges from the current graph. This
will modify the graph.</li>
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - Vertices can be a single vertex or an
iterable container of vertices, e.g. a list, set, graph, file or
numeric array. If not passed, defaults to the entire graph.</li>
<li><tt class="docutils literal"><span class="pre">edges</span></tt> - As with vertices, edges can be a single
edge or an iterable container of edges (e.g., a list, set, file,
numeric array, etc.). If not edges are not specified, then all
edges are assumed and the returned graph is an induced subgraph. In
the case of multiple edges, specifying an edge as (u,v) means to
keep all edges (u,v), regardless of the label.</li>
<li><tt class="docutils literal"><span class="pre">vertex_property</span></tt> - If specified, this is
expected to be a function on vertices, which is intersected with
the vertices specified, if any are.</li>
<li><tt class="docutils literal"><span class="pre">edge_property</span></tt> - If specified, this is expected
to be a function on edges, which is intersected with the edges
specified, if any are.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - If <tt class="docutils literal"><span class="pre">algorithm=delete</span></tt> or <tt class="docutils literal"><span class="pre">inplace=True</span></tt>,
then the graph is constructed by deleting edges and
vertices.  If <tt class="docutils literal"><span class="pre">add</span></tt>, then the graph is constructed by
building a new graph from the appropriate vertices and
edges.  If not specified, then the algorithm is chosen based
on the number of vertices in the subgraph.</li>
<li><tt class="docutils literal"><span class="pre">immutable</span></tt> (boolean) &#8211; whether to create a mutable/immutable
subgraph. <tt class="docutils literal"><span class="pre">immutable=None</span></tt> (default) means that the graph and its
subgraph will behave the same way.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">H</span>
<span class="go">Subgraph of (Complete graph): Graph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">Complete graph: Graph on 9 vertices</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1)]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span><span class="o">==</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Subgraph of (Complete graph): Graph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">()</span><span class="o">==</span><span class="n">G</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">H</span>
<span class="go">Subgraph of (Complete graph): Digraph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2)]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span><span class="o">==</span><span class="n">D</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">Complete graph: Digraph on 9 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Subgraph of (Complete graph): Digraph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">subgraph</span><span class="p">()</span><span class="o">==</span><span class="n">D</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complicated example involving multiple edges and labels.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;f&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;not in graph&#39;</span><span class="p">)])</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;a&#39;), (0, 1, &#39;b&#39;), (0, 1, &#39;c&#39;), (0, 2, &#39;d&#39;)]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;a&#39;)]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">())</span><span class="o">==</span><span class="n">G</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;f&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;not in graph&#39;</span><span class="p">)])</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;a&#39;), (0, 1, &#39;b&#39;), (0, 2, &#39;d&#39;)]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;a&#39;)]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1]</span>
</pre></div>
</div>
<p>Using the property arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">vertex_property</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span> <span class="p">:</span> <span class="n">v</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 2, 4, 6, 8]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">edge_property</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(&#39;00&#39;, &#39;01&#39;, None), (&#39;00&#39;, &#39;10&#39;, None), (&#39;01&#39;, &#39;11&#39;, None), (&#39;10&#39;, &#39;11&#39;, None)]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(&#39;00&#39;, &#39;01&#39;, None), (&#39;10&#39;, &#39;11&#39;, None)]</span>
</pre></div>
</div>
<p>The algorithm is not specified, then a reasonable choice is made for speed.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c"># uses the &#39;add&#39; algorithm</span>
<span class="go">Subgraph of (Path graph): Graph on 10 vertices</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The appropriate properties are preserved.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_planar</span><span class="p">(</span><span class="n">set_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_vertices</span><span class="p">(</span><span class="nb">dict</span><span class="p">((</span><span class="n">v</span><span class="p">,</span> <span class="s">&#39;v</span><span class="si">%d</span><span class="s">&#39;</span><span class="o">%</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()))</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="mf">3.</span><span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[3, 4, 5]</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">()</span>
<span class="go">{3: &#39;v3&#39;, 4: &#39;v4&#39;, 5: &#39;v5&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.subgraph_search">
<tt class="descname">subgraph_search</tt><big>(</big><em>G</em>, <em>induced=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a copy of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">G</span></tt> &#8211; the (di)graph whose copy we are looking for in <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">induced</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). Whether or not to
search for an induced copy of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">induced=False</span></tt>, return a copy of <tt class="docutils literal"><span class="pre">G</span></tt> in this graph.
Otherwise, return an induced copy of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>. If <tt class="docutils literal"><span class="pre">G</span></tt>
is the empty graph, return the empty graph since it is a subgraph
of every graph. Now suppose <tt class="docutils literal"><span class="pre">G</span></tt> is not the empty graph. If there
is no copy (induced or otherwise) of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>, we return
<tt class="docutils literal"><span class="pre">None</span></tt>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method does not take vertex/edge labels into account.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_count" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_count"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_count()</span></tt></a> &#8211; Counts the number
of copies of <span class="math">\(H\)</span> inside of <span class="math">\(G\)</span></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_iterator()</span></tt></a> &#8211; Iterate on the
copies of <span class="math">\(H\)</span> inside of <span class="math">\(G\)</span></li>
</ul>
</div>
<p>ALGORITHM:</p>
<p>See the documentation of
<a class="reference internal" href="generic_graph_pyx.html#sage.graphs.generic_graph_pyx.SubgraphSearch" title="sage.graphs.generic_graph_pyx.SubgraphSearch"><tt class="xref py py-class docutils literal"><span class="pre">SubgraphSearch</span></tt></a>.</p>
<p>EXAMPLES:</p>
<p>The Petersen graph contains the path graph <span class="math">\(P_5\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="n">h1</span>
<span class="go">Subgraph of (Petersen graph): Graph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">h1</span><span class="o">.</span><span class="n">vertices</span><span class="p">();</span> <span class="n">h1</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4]</span>
<span class="go">[(0, 1), (1, 2), (2, 3), (3, 4)]</span>
<span class="gp">sage: </span><span class="n">I1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">induced</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">I1</span>
<span class="go">Subgraph of (Petersen graph): Graph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">I1</span><span class="o">.</span><span class="n">vertices</span><span class="p">();</span> <span class="n">I1</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 8]</span>
<span class="go">[(0, 1), (1, 2), (2, 3), (3, 8)]</span>
</pre></div>
</div>
<p>It also contains the claw <span class="math">\(K_{1,3}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">h2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">ClawGraph</span><span class="p">());</span> <span class="n">h2</span>
<span class="go">Subgraph of (Petersen graph): Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">h2</span><span class="o">.</span><span class="n">vertices</span><span class="p">();</span> <span class="n">h2</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0, 1, 4, 5]</span>
<span class="go">[(0, 1), (0, 4), (0, 5)]</span>
<span class="gp">sage: </span><span class="n">I2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">ClawGraph</span><span class="p">(),</span> <span class="n">induced</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">I2</span>
<span class="go">Subgraph of (Petersen graph): Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">I2</span><span class="o">.</span><span class="n">vertices</span><span class="p">();</span> <span class="n">I2</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0, 1, 4, 5]</span>
<span class="go">[(0, 1), (0, 4), (0, 5)]</span>
</pre></div>
</div>
<p>Of course the induced copies are isomorphic to the graphs we were
looking for:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I2</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">ClawGraph</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>However, the Petersen graph does not contain a subgraph isomorphic to
<span class="math">\(K_3\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Nor does it contain a nonempty induced subgraph isomorphic to <span class="math">\(P_6\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">induced</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The empty graph is a subgraph of every graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">())</span>
<span class="go">Graph on 0 vertices</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">(),</span> <span class="n">induced</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Graph on 0 vertices</span>
</pre></div>
</div>
<p>The subgraph may just have edges missing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k3</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">p3</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k3</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">=</span><span class="n">k3</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(&#39;a&#39;, &#39;b&#39;), (&#39;b&#39;, &#39;c&#39;)]</span>
</pre></div>
</div>
<p>Of course, <span class="math">\(P_3\)</span> is not an induced subgraph of <span class="math">\(K_3\)</span>, though:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k3</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">p3</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k3</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">k3</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">induced</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Inside of a small graph (<a class="reference external" href="http://trac.sagemath.org/13906">trac ticket #13906</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">subgraph_search</span><span class="p">(</span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Graph on 1 vertex</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.subgraph_search_count">
<tt class="descname">subgraph_search_count</tt><big>(</big><em>G</em>, <em>induced=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_count" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of labelled occurences of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">G</span></tt> &#8211; the (di)graph whose copies we are looking for in
<tt class="docutils literal"><span class="pre">self</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">induced</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). Whether or not
to count induced copies of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method does not take vertex/edge labels into account.</p>
</div>
<p>ALGORITHM:</p>
<p>See the documentation of
<a class="reference internal" href="generic_graph_pyx.html#sage.graphs.generic_graph_pyx.SubgraphSearch" title="sage.graphs.generic_graph_pyx.SubgraphSearch"><tt class="xref py py-class docutils literal"><span class="pre">SubgraphSearch</span></tt></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search" title="sage.graphs.generic_graph.GenericGraph.subgraph_search"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search()</span></tt></a> &#8211; finds an subgraph
isomorphic to <span class="math">\(H\)</span> inside of a graph <span class="math">\(G\)</span></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_iterator()</span></tt></a> &#8211; Iterate on the
copies of a graph <span class="math">\(H\)</span> inside of a graph <span class="math">\(G\)</span></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>Counting the number of paths <span class="math">\(P_5\)</span> in a PetersenGraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph_search_count</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">240</span>
</pre></div>
</div>
<p>Requiring these subgraphs be induced:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph_search_count</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">induced</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">120</span>
</pre></div>
</div>
<p>If we define the graph <span class="math">\(T_k\)</span> (the transitive tournament on <span class="math">\(k\)</span>
vertices) as the graph on <span class="math">\(\{0, ..., k-1\}\)</span> such that <span class="math">\(ij \in
T_k\)</span> iif <span class="math">\(i&lt;j\)</span>, how many directed triangles can be found in
<span class="math">\(T_5\)</span> ? The answer is of course <span class="math">\(0\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T5</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T5</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T5</span><span class="o">.</span><span class="n">subgraph_search_count</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
<p>If we count instead the number of <span class="math">\(T_3\)</span> in <span class="math">\(T_5\)</span>, we expect
the answer to be <span class="math">\({5 \choose 3}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T3</span> <span class="o">=</span> <span class="n">T5</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T5</span><span class="o">.</span><span class="n">subgraph_search_count</span><span class="p">(</span><span class="n">T3</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">10</span>
</pre></div>
</div>
<p>The empty graph is a subgraph of every graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subgraph_search_count</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">())</span>
<span class="go">1</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Inside of a small graph (<a class="reference external" href="http://trac.sagemath.org/13906">trac ticket #13906</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">subgraph_search_count</span><span class="p">(</span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator">
<tt class="descname">subgraph_search_iterator</tt><big>(</big><em>G</em>, <em>induced=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns an iterator over the labelled copies of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">G</span></tt> &#8211; the graph whose copies we are looking for in
<tt class="docutils literal"><span class="pre">self</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">induced</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). Whether or not
to iterate over the induced copies of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method does not take vertex/edge labels into account.</p>
</div>
<p>ALGORITHM:</p>
<p>See the documentation of
<a class="reference internal" href="generic_graph_pyx.html#sage.graphs.generic_graph_pyx.SubgraphSearch" title="sage.graphs.generic_graph_pyx.SubgraphSearch"><tt class="xref py py-class docutils literal"><span class="pre">SubgraphSearch</span></tt></a>.</p>
<p>OUTPUT:</p>
<blockquote>
<div>Iterator over the labelled copies of <tt class="docutils literal"><span class="pre">G</span></tt> in <tt class="docutils literal"><span class="pre">self</span></tt>, as
<em>lists</em>. For each value <span class="math">\((v_1, v_2, ..., v_k)\)</span> returned,
the first vertex of <span class="math">\(G\)</span> is associated with <span class="math">\(v_1\)</span>, the
second with <span class="math">\(v_2\)</span>, etc ...</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method also works on digraphs.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search" title="sage.graphs.generic_graph.GenericGraph.subgraph_search"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search()</span></tt></a> &#8211; finds an subgraph
isomorphic to <span class="math">\(H\)</span> inside of <span class="math">\(G\)</span></li>
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.subgraph_search_count" title="sage.graphs.generic_graph.GenericGraph.subgraph_search_count"><tt class="xref py py-meth docutils literal"><span class="pre">subgraph_search_count()</span></tt></a> &#8211; Counts the number
of copies of <span class="math">\(H\)</span> inside of <span class="math">\(G\)</span></li>
</ul>
</div>
<p>EXAMPLE:</p>
<p>Iterating through all the labelled <span class="math">\(P_3\)</span> of <span class="math">\(P_5\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph_search_iterator</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="gp">... </span>     <span class="k">print</span> <span class="n">p</span>
<span class="go">[0, 1, 2]</span>
<span class="go">[1, 2, 3]</span>
<span class="go">[2, 1, 0]</span>
<span class="go">[2, 3, 4]</span>
<span class="go">[3, 2, 1]</span>
<span class="go">[4, 3, 2]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Inside of a small graph (<a class="reference external" href="http://trac.sagemath.org/13906">trac ticket #13906</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">Graph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">subgraph_search_iterator</span><span class="p">(</span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">[Graph on 1 vertex, Graph on 1 vertex, Graph on 1 vertex, Graph on 1 vertex, Graph on 1 vertex]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.szeged_index">
<tt class="descname">szeged_index</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.szeged_index" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the Szeged index of the graph.</p>
<p>For any <span class="math">\(uv\in E(G)\)</span>, let
<span class="math">\(N_u(uv) = \{w\in G:d(u,w)&lt;d(v,w)\}, n_u(uv)=|N_u(uv)|\)</span></p>
<p>The Szeged index of a graph is then defined as [1]:
<span class="math">\(\sum_{uv \in E(G)}n_u(uv)\times n_v(uv)\)</span></p>
<p>EXAMPLE:</p>
<p>True for any connected graph [1]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span><span class="o">&lt;=</span> <span class="n">g</span><span class="o">.</span><span class="n">szeged_index</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>True for all trees [1]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">szeged_index</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<p>[1] Klavzar S., Rajapakse A., Gutman I. (1996). The Szeged and the
Wiener index of graphs. Applied Mathematics Letters, 9 (5), pp. 45-49.</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.tensor_product">
<tt class="descname">tensor_product</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.tensor_product" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the tensor product of self and other.</p>
<p>The tensor product of <span class="math">\(G\)</span> and <span class="math">\(H\)</span> is the graph <span class="math">\(L\)</span> with vertex set
<span class="math">\(V(L)\)</span> equal to the Cartesian product of the vertices <span class="math">\(V(G)\)</span> and <span class="math">\(V(H)\)</span>,
and <span class="math">\(((u,v), (w,x))\)</span> is an edge iff - <span class="math">\((u, w)\)</span> is an edge of self, and -
<span class="math">\((v, x)\)</span> is an edge of other.</p>
<p>The tensor product is also known as the categorical product and the
kronecker product (refering to the kronecker matrix product). See
<a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_product">Wikipedia article on the Kronecker product</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">Z</span><span class="p">);</span> <span class="n">T</span>
<span class="go">Graph on 10 vertices</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 21 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DodecahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">T</span>
<span class="go">Graph on 200 vertices</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">900</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">Graphics object consisting of 1101 graphics primitives</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Tensor product of graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (1, &#39;b&#39;)), ((0, &#39;b&#39;), (1, &#39;a&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;)), ((1, &#39;b&#39;), (2, &#39;a&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">H</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Tensor product of digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">[((0, &#39;a&#39;), (1, &#39;b&#39;)), ((1, &#39;a&#39;), (2, &#39;b&#39;))]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">J</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The tensor product of two DeBruijn digraphs of same diameter is a DeBruijn digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">B1</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B2</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">B1</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span> <span class="n">B2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.to_dictionary">
<tt class="descname">to_dictionary</tt><big>(</big><em>edge_labels=False</em>, <em>multiple_edges=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.to_dictionary" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the graph as a dictionary.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">edge_labels</span></tt> (boolean) &#8211; whether to include edge labels in the
output.</li>
<li><tt class="docutils literal"><span class="pre">multiple_edges</span></tt> (boolean) &#8211; whether to include multiple edges in
the output.</li>
</ul>
<p>OUTPUT:</p>
<p>The output depends on the input:</p>
<ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">edge_labels</span> <span class="pre">==</span> <span class="pre">False</span></tt> and <tt class="docutils literal"><span class="pre">multiple_edges</span> <span class="pre">==</span> <span class="pre">False</span></tt>, the
output is a dictionary associating to each vertex the list of its
neighbors.</li>
<li>If <tt class="docutils literal"><span class="pre">edge_labels</span> <span class="pre">==</span> <span class="pre">False</span></tt> and <tt class="docutils literal"><span class="pre">multiple_edges</span> <span class="pre">==</span> <span class="pre">True</span></tt>, the output
is a dictionary the same as previously with one difference: the
neighbors are listed with multiplicity.</li>
<li>If <tt class="docutils literal"><span class="pre">edge_labels</span> <span class="pre">==</span> <span class="pre">True</span></tt> and <tt class="docutils literal"><span class="pre">multiple_edges</span> <span class="pre">==</span> <span class="pre">False</span></tt>, the output
is a dictionary associating to each vertex <span class="math">\(u\)</span> [a dictionary
associating to each vertex <span class="math">\(v\)</span> incident to <span class="math">\(u\)</span> the label of edge
<span class="math">\((u,v)\)</span>].</li>
<li>If <tt class="docutils literal"><span class="pre">edge_labels</span> <span class="pre">==</span> <span class="pre">True</span></tt> and <tt class="docutils literal"><span class="pre">multiple_edges</span> <span class="pre">==</span> <span class="pre">True</span></tt>, the output
is a dictionary associating to each vertex <span class="math">\(u\)</span> [a dictionary
associating to each vertex <span class="math">\(v\)</span> incident to <span class="math">\(u\)</span> [the list of labels of
all edges between <span class="math">\(u\)</span> and <span class="math">\(v\)</span>]].</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When used on directed graphs, the explanations above can be understood
by replacing the word &#8220;neigbours&#8221; by &#8220;out-neighbors&#8221;</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_dictionary</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">g</span><span class="p">]</span>
<span class="go">[(0, [1, 4, 5]),</span>
<span class="go"> (1, [0, 2, 6]),</span>
<span class="go"> (2, [1, 3, 7]),</span>
<span class="go"> (3, [2, 4, 8]),</span>
<span class="go"> (4, [0, 3, 9]),</span>
<span class="go"> (5, [0, 7, 8]),</span>
<span class="go"> (6, [1, 8, 9]),</span>
<span class="go"> (7, [2, 5, 9]),</span>
<span class="go"> (8, [3, 5, 6]),</span>
<span class="go"> (9, [4, 6, 7])]</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_dictionary</span><span class="p">(</span><span class="n">multiple_edges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: [1, 4, 5], 1: [0, 2, 6],</span>
<span class="go"> 2: [1, 3, 7], 3: [2, 4, 8],</span>
<span class="go"> 4: [0, 3, 9], 5: [0, 7, 8],</span>
<span class="go"> 6: [1, 8, 9], 7: [2, 5, 9],</span>
<span class="go"> 8: [3, 5, 6], 9: [4, 6, 7]}</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_dictionary</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: {1: None, 4: None, 5: None},</span>
<span class="go"> 1: {0: None, 2: None, 6: None},</span>
<span class="go"> 2: {1: None, 3: None, 7: None},</span>
<span class="go"> 3: {2: None, 4: None, 8: None},</span>
<span class="go"> 4: {0: None, 3: None, 9: None},</span>
<span class="go"> 5: {0: None, 7: None, 8: None},</span>
<span class="go"> 6: {1: None, 8: None, 9: None},</span>
<span class="go"> 7: {2: None, 5: None, 9: None},</span>
<span class="go"> 8: {3: None, 5: None, 6: None},</span>
<span class="go"> 9: {4: None, 6: None, 7: None}}</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_dictionary</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">multiple_edges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: {1: [None], 4: [None], 5: [None]},</span>
<span class="go"> 1: {0: [None], 2: [None], 6: [None]},</span>
<span class="go"> 2: {1: [None], 3: [None], 7: [None]},</span>
<span class="go"> 3: {2: [None], 4: [None], 8: [None]},</span>
<span class="go"> 4: {0: [None], 3: [None], 9: [None]},</span>
<span class="go"> 5: {0: [None], 7: [None], 8: [None]},</span>
<span class="go"> 6: {1: [None], 8: [None], 9: [None]},</span>
<span class="go"> 7: {2: [None], 5: [None], 9: [None]},</span>
<span class="go"> 8: {3: [None], 5: [None], 6: [None]},</span>
<span class="go"> 9: {4: [None], 6: [None], 7: [None]}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.to_simple">
<tt class="descname">to_simple</tt><big>(</big><em>to_undirected=True</em>, <em>keep_label='any'</em>, <em>immutable=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.to_simple" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a simple version of itself.</p>
<p>In particular, loops and multiple edges are removed, and the graph might
optionally be converted to an undirected graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">to_undirected</span></tt> - boolean - if <tt class="docutils literal"><span class="pre">True</span></tt>, the graph is also converted
to an undirected graph.</li>
<li><tt class="docutils literal"><span class="pre">keep_label</span></tt> (<tt class="docutils literal"><span class="pre">'any','min','max'</span></tt>): if there are multiple edges
with different labels, this variable defines which label should be
kept: any label (<tt class="docutils literal"><span class="pre">'any'</span></tt>), the smallest label (<tt class="docutils literal"><span class="pre">'min'</span></tt>), or the
largest (<tt class="docutils literal"><span class="pre">'max'</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">immutable</span></tt> (boolean) &#8211; whether to create a mutable/immutable
copy. <tt class="docutils literal"><span class="pre">immutable=None</span></tt> (default) means that the graph and its copy
will behave the same way.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 0), (1, 1), (2, 2), (2, 3), (2, 3), (3, 2)]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">to_simple</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(2, 3)]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">allows_loops</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">to_simple</span><span class="p">(</span><span class="n">to_undirected</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">keep_label</span><span class="o">=</span><span class="s">&#39;min&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 3, 1), (3, 2, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">to_simple</span><span class="p">(</span><span class="n">to_undirected</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">keep_label</span><span class="o">=</span><span class="s">&#39;max&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 3, 2), (3, 2, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.transitive_closure">
<tt class="descname">transitive_closure</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.transitive_closure" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes the transitive closure of a graph and returns it. The
original graph is not modified.</p>
<p>The transitive closure of a graph G has an edge (x,y) if and only
if there is a path between x and y in G.</p>
<p>The transitive closure of any strongly connected component of a
graph is a complete graph. In particular, the transitive closure of
a connected undirected graph is a complete graph. The transitive
closure of a directed acyclic graph is a directed acyclic graph
representing the full partial order.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">transitive_closure</span><span class="p">()</span>
<span class="go">Transitive closure of Path graph: Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">transitive_closure</span><span class="p">()</span><span class="o">==</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">transitive_closure</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 3), (2, 4), (2, 5)]</span>
</pre></div>
</div>
<p>On an immutable digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">transitive_closure</span><span class="p">()</span>
<span class="go">Transitive closure of Path: Digraph on 5 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.transitive_reduction">
<tt class="descname">transitive_reduction</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.transitive_reduction" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a transitive reduction of a graph. The original graph is
not modified.</p>
<p>A transitive reduction H of G has a path from x to y if and only if
there was a path from x to y in G. Deleting any edge of H destroys
this property. A transitive reduction is not unique in general. A
transitive reduction has the same transitive closure as the
original graph.</p>
<p>A transitive reduction of a complete graph is a tree. A transitive
reduction of a tree is itself.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">transitive_reduction</span><span class="p">()</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">edges</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">transitive_reduction</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">transitive_reduction</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.traveling_salesman_problem">
<tt class="descname">traveling_salesman_problem</tt><big>(</big><em>use_edge_labels=False</em>, <em>solver=None</em>, <em>constraint_generation=None</em>, <em>verbose=0</em>, <em>verbose_constraints=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.traveling_salesman_problem" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Solves the traveling salesman problem (TSP)</p>
<p>Given a graph (resp. a digraph) <span class="math">\(G\)</span> with weighted edges, the traveling
salesman problem consists in finding a Hamiltonian cycle (resp. circuit)
of the graph of minimum cost.</p>
<p>This TSP is one of the most famous NP-Complete problems, this function
can thus be expected to take some time before returning its result.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">use_edge_labels</span></tt> (boolean) &#8211; whether to consider the weights of
the edges.</p>
<blockquote>
<div><ul class="simple">
<li>If set to <tt class="docutils literal"><span class="pre">False</span></tt> (default), all edges are assumed to weight
<span class="math">\(1\)</span></li>
<li>If set to <tt class="docutils literal"><span class="pre">True</span></tt>, the weights are taken into account, and the
circuit returned is the one minimizing the sum of the weights
(an edge with no label is assumed to have weight <span class="math">\(1\)</span>).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">constraint_generation</span></tt> (boolean) &#8211; whether to use constraint
generation when solving the Mixed Integer Linear Program.</p>
<p>When <tt class="docutils literal"><span class="pre">constraint_generation</span> <span class="pre">=</span> <span class="pre">None</span></tt>, constraint generation is used
whenever the graph has a density larger than 70%.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">verbose_constraints</span></tt> &#8211; whether to display which constraints are
being generated.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>A solution to the TSP, as a <tt class="docutils literal"><span class="pre">Graph</span></tt> object whose vertex set is <span class="math">\(V(G)\)</span>,
and whose edges are only those of the solution.</p>
<p>ALGORITHM:</p>
<p>This optimization problem is solved through the use of Linear
Programming.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is correctly defined for both graph and digraphs. In
the second case, the returned cycle is a circuit of optimal cost.</p>
</div>
<p>EXAMPLES:</p>
<p>The Heawood graph is known to be Hamiltonian:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">HeawoodGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">tsp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">tsp</span>
<span class="go">TSP from Heawood graph: Graph on 14 vertices</span>
</pre></div>
</div>
<p>The solution to the TSP has to be connected</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">tsp</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It must also be a <span class="math">\(2\)</span>-regular graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">tsp</span><span class="o">.</span><span class="n">is_regular</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>And obviously it is a subgraph of the Heawood graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">tsp</span><span class="o">.</span><span class="n">is_subgraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">induced</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>On the other hand, the Petersen Graph is known not to
be Hamiltonian:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">tsp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">The given graph is not hamiltonian</span>
</pre></div>
</div>
<p>One easy way to change it is obviously to add to this graph the edges
corresponding to a Hamiltonian cycle. If we do this by setting the cost
of these new edges to <span class="math">\(2\)</span>, while the others are set to <span class="math">\(1\)</span>, we notice
that not all the edges we added are used in the optimal solution</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>     <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">cycle</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">cycle</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
<span class="gp">... </span>         <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="gp">... </span>     <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">tsp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">use_edge_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span> <span class="n">tsp</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">()</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">*</span><span class="mi">10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If we pick <span class="math">\(1/2\)</span> instead of <span class="math">\(2\)</span> as a cost for these new edges, they
clearly become the optimal solution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">cycle</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>     <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">tsp</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">use_edge_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span> <span class="n">tsp</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">()</span> <span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Comparing the results returned according to the value of
<tt class="docutils literal"><span class="pre">constraint_generation</span></tt>. First, for graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">... </span>      <span class="n">g</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>           <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>           <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
<span class="gp">... </span>               <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">... </span>      <span class="n">v1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">constraint_generation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">use_edge_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span>      <span class="n">v2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">use_edge_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span>      <span class="n">c1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">v1</span><span class="o">.</span><span class="n">edges</span><span class="p">()))</span>
<span class="gp">... </span>      <span class="n">c2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">v2</span><span class="o">.</span><span class="n">edges</span><span class="p">()))</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="n">c1</span> <span class="o">!=</span> <span class="n">c2</span><span class="p">:</span>
<span class="gp">... </span>          <span class="k">print</span> <span class="s">&quot;Error !&quot;</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span>
<span class="gp">... </span>          <span class="k">break</span>
</pre></div>
</div>
<p>Then for digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
<span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">... </span>      <span class="n">g</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>           <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>           <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
<span class="gp">... </span>               <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">... </span>      <span class="n">v2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">use_edge_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span>      <span class="n">v1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">constraint_generation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">use_edge_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span>      <span class="n">c1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">v1</span><span class="o">.</span><span class="n">edges</span><span class="p">()))</span>
<span class="gp">... </span>      <span class="n">c2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">v2</span><span class="o">.</span><span class="n">edges</span><span class="p">()))</span>
<span class="gp">... </span>      <span class="k">if</span> <span class="n">c1</span> <span class="o">!=</span> <span class="n">c2</span><span class="p">:</span>
<span class="gp">... </span>          <span class="k">print</span> <span class="s">&quot;Error !&quot;</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span>
<span class="gp">... </span>          <span class="k">print</span> <span class="s">&quot;With constraint generation :&quot;</span><span class="p">,</span><span class="n">c2</span>
<span class="gp">... </span>          <span class="k">print</span> <span class="s">&quot;Without constraint generation :&quot;</span><span class="p">,</span><span class="n">c1</span>
<span class="gp">... </span>          <span class="k">break</span>
</pre></div>
</div>
<p>Simple tests for multiple edges and loops:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The traveling salesman problem (or finding Hamiltonian cycle) is not well defined for graphs with less than 2 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The traveling salesman problem (or finding Hamiltonian cycle) is not well defined for graphs with less than 2 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tsp</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The traveling salesman problem (or finding Hamiltonian cycle) is not well defined for graphs with less than 2 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">tsp</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">tsp</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">())</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Graphs on 2 vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>  <span class="c"># i.e. complete digraph with loops</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">remove_loops</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_hamiltonian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Check that weight 0 edges are handled correctly (see <a class="reference external" href="http://trac.sagemath.org/16214">trac ticket #16214</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">tsp</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">use_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">tsp</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.triangles_count">
<tt class="descname">triangles_count</tt><big>(</big><em>algorithm=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.triangles_count" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the number of triangles in the (di)graph.</p>
<p>For digraphs, we count the number of directed circuit of length 3.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) specifies the algorithm to use
(note that only <tt class="docutils literal"><span class="pre">'iter'</span></tt> is available for directed graphs):</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">'sparse_copy'</span></tt> &#8211; counts the triangles in a sparse copy of the
graph (see <a class="reference internal" href="base/static_sparse_graph.html#module-sage.graphs.base.static_sparse_graph" title="sage.graphs.base.static_sparse_graph"><tt class="xref py py-mod docutils literal"><span class="pre">sage.graphs.base.static_sparse_graph</span></tt></a>). Calls
<a class="reference internal" href="base/static_sparse_graph.html#sage.graphs.base.static_sparse_graph.triangles_count" title="sage.graphs.base.static_sparse_graph.triangles_count"><tt class="xref py py-func docutils literal"><span class="pre">static_sparse_graph.triangles_count</span></tt></a></li>
<li><tt class="docutils literal"><span class="pre">'dense_copy'</span></tt> &#8211; counts the triangles in a dense copy of the
graph (see <a class="reference internal" href="base/static_dense_graph.html#module-sage.graphs.base.static_dense_graph" title="sage.graphs.base.static_dense_graph"><tt class="xref py py-mod docutils literal"><span class="pre">sage.graphs.base.static_dense_graph</span></tt></a>). Calls
<a class="reference internal" href="base/static_dense_graph.html#sage.graphs.base.static_dense_graph.triangles_count" title="sage.graphs.base.static_dense_graph.triangles_count"><tt class="xref py py-func docutils literal"><span class="pre">static_dense_graph.triangles_count</span></tt></a></li>
<li><tt class="docutils literal"><span class="pre">'matrix'</span></tt> uses the trace of the cube of the adjacency matrix.</li>
<li><tt class="docutils literal"><span class="pre">'iter'</span></tt> iterates over the pairs of neighbors of each vertex. No
copy of the graph is performed</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> &#8211; for undirected graphs, uses <tt class="docutils literal"><span class="pre">&quot;sparse_copy&quot;</span></tt> or
<tt class="docutils literal"><span class="pre">&quot;dense_copy&quot;</span></tt> depending on whether the graph is stored as dense
or sparse. For directed graphs, uses <tt class="docutils literal"><span class="pre">'iter'</span></tt>.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>EXAMPLES:</p>
<p>The Petersen graph is triangle free and thus:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">triangles_count</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Any triple of vertices in the complete graph induces a triangle so we have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">triangles_count</span><span class="p">()</span> <span class="o">==</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The 2-dimensional DeBruijn graph of 2 symbols has 2 directed C3:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">triangles_count</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The directed n-cycle is trivially triangle free for n &gt; 3:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">triangles_count</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Comparison on algorithms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="c"># long test</span>
<span class="go">....:     G = graphs.RandomBarabasiAlbert(50,2)</span>
<span class="go">....:     results = []</span>
<span class="go">....:     results.append(G.triangles_count(algorithm=&#39;matrix&#39;))</span>
<span class="go">....:     results.append(G.triangles_count(algorithm=&#39;iter&#39;))</span>
<span class="go">....:     results.append(G.triangles_count(algorithm=&#39;sparse_copy&#39;))</span>
<span class="go">....:     results.append(G.triangles_count(algorithm=&#39;dense_copy&#39;))</span>
<span class="go">....:     if any(x != results[0] for x in results):</span>
<span class="go">....:        print results</span>
<span class="go">....:        print &quot;That&#39;s not good!&quot;</span>
</pre></div>
</div>
<p>Asking for an unknown algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">triangles_count</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;tip top&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Algorithm &#39;tip top&#39; not yet implemented. Please contribute.</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">triangles_count</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;sparse_copy&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The value of algorithm(=sparse_copy) must be &#39;iter&#39; or None for direcetd graphs</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.union">
<tt class="descname">union</tt><big>(</big><em>other</em>, <em>immutable=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.union" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the union of self and other.</p>
<p>If the graphs have common vertices, the common vertices will be
identified.</p>
<p>If one of the two graphs allows loops (or multiple edges), the resulting
graph will allow loops (or multiple edges).</p>
<p>If both graphs are immutable, the resulting graph is immutable, unless
requested otherwise.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">immutable</span></tt> (boolean) &#8211; whether to create a mutable/immutable
union. <tt class="docutils literal"><span class="pre">immutable=None</span></tt> (default) means that the graphs and their
union will behave the same way.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.disjoint_union" title="sage.graphs.generic_graph.GenericGraph.disjoint_union"><tt class="xref py py-meth docutils literal"><span class="pre">disjoint_union()</span></tt></a></li>
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.join" title="sage.graphs.graph.Graph.join"><tt class="xref py py-meth docutils literal"><span class="pre">join()</span></tt></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">H</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2), (0, 3), (1, 2), (2, 3)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Multiple edges and loops (<a class="reference external" href="http://trac.sagemath.org/15627">trac ticket #15627</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Hey&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">())</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Immutable input ? Immutable output (<a class="reference external" href="http://trac.sagemath.org/15627">trac ticket #15627</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.static_sparse_backend.StaticSparseBackend&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.vertex_boundary">
<tt class="descname">vertex_boundary</tt><big>(</big><em>vertices1</em>, <em>vertices2=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.vertex_boundary" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of all vertices in the external boundary of
vertices1, intersected with vertices2. If vertices2 is None, then
vertices2 is the complement of vertices1. This is much faster if
vertices1 is smaller than vertices2.</p>
<p>The external boundary of a set of vertices is the union of the
neighborhoods of each vertex in the set. Note that in this
implementation, since vertices2 defaults to the complement of
vertices1, if a vertex <span class="math">\(v\)</span> has a loop, then
vertex_boundary(v) will not contain <span class="math">\(v\)</span>.</p>
<p>In a digraph, the external boundary of a vertex v are those
vertices u with an arc (v, u).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;0111&#39;</span><span class="p">,</span> <span class="s">&#39;0000&#39;</span><span class="p">,</span> <span class="s">&#39;0001&#39;</span><span class="p">,</span> <span class="s">&#39;0011&#39;</span><span class="p">,</span> <span class="s">&#39;0010&#39;</span><span class="p">,</span> <span class="s">&#39;0101&#39;</span><span class="p">,</span> <span class="s">&#39;0100&#39;</span><span class="p">,</span> <span class="s">&#39;1111&#39;</span><span class="p">,</span> <span class="s">&#39;1101&#39;</span><span class="p">,</span> <span class="s">&#39;1011&#39;</span><span class="p">,</span> <span class="s">&#39;1001&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertex_boundary</span><span class="p">([</span><span class="s">&#39;0000&#39;</span><span class="p">,</span> <span class="s">&#39;1111&#39;</span><span class="p">],</span> <span class="n">l</span><span class="p">)</span>
<span class="go">[&#39;0111&#39;, &#39;0001&#39;, &#39;0010&#39;, &#39;0100&#39;, &#39;1101&#39;, &#39;1011&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">vertex_boundary</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.vertex_connectivity">
<tt class="descname">vertex_connectivity</tt><big>(</big><em>value_only=True</em>, <em>sets=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.vertex_connectivity" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the vertex connectivity of the graph. For more information,
see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Connectivity_(graph_theory)">Wikipedia article on connectivity</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>When the graph is a directed graph, this method actually computes
the <em>strong</em> connectivity, (i.e. a directed graph is strongly
<span class="math">\(k\)</span>-connected if there are <span class="math">\(k\)</span> disjoint paths between any two
vertices <span class="math">\(u, v\)</span>). If you do not want to consider strong
connectivity, the best is probably to convert your <tt class="docutils literal"><span class="pre">DiGraph</span></tt>
object to a <tt class="docutils literal"><span class="pre">Graph</span></tt> object, and compute the connectivity of this
other graph.</li>
<li>By convention, a complete graph on <span class="math">\(n\)</span> vertices is <span class="math">\(n-1\)</span>
connected. In this case, no certificate can be given as there is
no pair of vertices split by a cut of size <span class="math">\(k-1\)</span>. For this reason,
the certificates returned in this situation are empty.</li>
</ul>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt> (default), only the value is returned.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt> , both the value and a minimum vertex cut are
returned.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">sets</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, also returns the two sets of
vertices that are disconnected by the cut.
Implies <tt class="docutils literal"><span class="pre">value_only=False</span></tt></li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>EXAMPLES:</p>
<p>A basic application on a <tt class="docutils literal"><span class="pre">PappusGraph</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PappusGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>In a grid, the vertex connectivity is equal to the
minimum degree, in which case one of the two sets is
of cardinality <span class="math">\(1\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="p">[</span> <span class="n">setA</span><span class="p">,</span> <span class="n">setB</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">(</span><span class="n">sets</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">setA</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">setB</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A vertex cut in a tree is any internal vertex:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tree</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">tree</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">val</span><span class="p">,</span> <span class="p">[</span><span class="n">cut_vertex</span><span class="p">]]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tree</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">cut_vertex</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When <tt class="docutils literal"><span class="pre">value_only</span> <span class="pre">=</span> <span class="pre">True</span></tt>, this function is optimized for small
connectivity values and does not need to build a linear program.</p>
<p>It is the case for connected graphs which are not connected:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Or if they are just 1-connected:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>For directed graphs, the strong connectivity is tested
through the dedicated function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>A complete graph on <span class="math">\(10\)</span> vertices is <span class="math">\(9\)</span>-connected:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
<p>A complete digraph on <span class="math">\(10\)</span> vertices is <span class="math">\(9\)</span>-connected:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_connectivity</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.vertex_cut">
<tt class="descname">vertex_cut</tt><big>(</big><em>s</em>, <em>t</em>, <em>value_only=True</em>, <em>vertices=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.vertex_cut" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a minimum vertex cut between non-adjacent vertices <span class="math">\(s\)</span> and <span class="math">\(t\)</span>
represented by a list of vertices.</p>
<p>A vertex cut between two non-adjacent vertices is a set <span class="math">\(U\)</span>
of vertices of self such that the graph obtained by removing
<span class="math">\(U\)</span> from self is disconnected. For more information, see the
<a class="reference external" href="http://en.wikipedia.org/wiki/Cut_%28graph_theory%29">Wikipedia article on cuts</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>). When set to
<tt class="docutils literal"><span class="pre">True</span></tt>, only the size of the minimum cut is returned.</li>
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>). When set to
<tt class="docutils literal"><span class="pre">True</span></tt>, also returns the two sets of vertices that
are disconnected by the cut. Implies <tt class="docutils literal"><span class="pre">value_only</span></tt>
set to False.</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>OUTPUT:</p>
<p>Real number or tuple, depending on the given arguments
(examples are given below).</p>
<p>EXAMPLE:</p>
<p>A basic application in the Pappus graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PappusGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_cut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>In the bipartite complete graph <span class="math">\(K_{2,8}\)</span>, a cut between the two
vertices in the size <span class="math">\(2\)</span> part consists of the other <span class="math">\(8\)</span> vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">vertices</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">value</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">vertices</span> <span class="o">==</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Clearly, in this case the two sides of the cut are singletons</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="p">[</span><span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex_cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">set1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.vertex_disjoint_paths">
<tt class="descname">vertex_disjoint_paths</tt><big>(</big><em>s</em>, <em>t</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.vertex_disjoint_paths" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of vertex-disjoint paths between two
vertices as given by Menger&#8217;s theorem.</p>
<p>The vertex version of Menger&#8217;s theorem asserts that the size
of the minimum vertex cut between two vertices <span class="math">\(s\)</span> and`t`
(the minimum number of vertices whose removal disconnects <span class="math">\(s\)</span>
and <span class="math">\(t\)</span>) is equal to the maximum number of pairwise
vertex-independent paths from <span class="math">\(s\)</span> to <span class="math">\(t\)</span>.</p>
<p>This function returns a list of such paths.</p>
<p>EXAMPLE:</p>
<p>In a complete bipartite graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertex_disjoint_paths</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[0, 2, 1], [0, 3, 1], [0, 4, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.vertex_iterator">
<tt class="descname">vertex_iterator</tt><big>(</big><em>vertices=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.vertex_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns an iterator over the given vertices.</p>
<p>Returns False if not given a vertex, sequence, iterator or None. None is
equivalent to a list of every vertex. Note that <tt class="docutils literal"><span class="pre">for</span> <span class="pre">v</span> <span class="pre">in</span> <span class="pre">G</span></tt> syntax is
allowed.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> - iterated vertices are these
intersected with the vertices of the (di)graph</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">vertex_iterator</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">v</span>
<span class="gp">...</span>
<span class="go">0</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="gp">...</span>
<span class="go">8</span>
<span class="go">9</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">0</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Note that since the intersection option is available, the
vertex_iterator() function is sub-optimal, speed-wise, but note the
following optimization:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">timeit</span> <span class="n">V</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>                   <span class="c"># not tested</span>
<span class="go">100000 loops, best of 3: 8.85 [micro]s per loop</span>
<span class="gp">sage: </span><span class="n">timeit</span> <span class="n">V</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">vertex_iterator</span><span class="p">())</span>      <span class="c"># not tested</span>
<span class="go">100000 loops, best of 3: 5.74 [micro]s per loop</span>
<span class="gp">sage: </span><span class="n">timeit</span> <span class="n">V</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">_nxg</span><span class="o">.</span><span class="n">adj</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">())</span>    <span class="c"># not tested</span>
<span class="go">100000 loops, best of 3: 3.45 [micro]s per loop</span>
</pre></div>
</div>
<p>In other words, if you want a fast vertex iterator, call the
dictionary directly.</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.vertices">
<tt class="descname">vertices</tt><big>(</big><em>key=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.vertices" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of the vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">key</span></tt> - default: <tt class="docutils literal"><span class="pre">None</span></tt> - a function that takes
a vertex as its one argument and returns a value that
can be used for comparisons in the sorting algorithm.</li>
</ul>
<p>OUTPUT:</p>
<p>The vertices of the list.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">There is always an attempt to sort the list before
returning the result. However, since any object may
be a vertex, there is no guarantee that any two
vertices will be comparable.  With default objects
for vertices (all integers), or when all the vertices
are of the same simple type, then there should not be
a problem with how the vertices will be sorted. However,
if you need to guarantee a total order for the sort,
use the <tt class="docutils literal"><span class="pre">key</span></tt> argument, as illustrated in the
examples below.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
<p>If you do not care about sorted output and you are
concerned about the time taken to sort, consider the
following alternatives.  The moral is: if you want a
fast vertex iterator, call the dictionary directly.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">timeit</span> <span class="n">V</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>                     <span class="c"># not tested</span>
<span class="go">100000 loops, best of 3: 8.85 [micro]s per loop</span>
<span class="gp">sage: </span><span class="n">timeit</span> <span class="n">V</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">vertex_iterator</span><span class="p">())</span>        <span class="c"># not tested</span>
<span class="go">100000 loops, best of 3: 5.74 [micro]s per loop</span>
<span class="gp">sage: </span><span class="n">timeit</span> <span class="n">V</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">_nxg</span><span class="o">.</span><span class="n">adj</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">())</span>      <span class="c"># not tested</span>
<span class="go">100000 loops, best of 3: 3.45 [micro]s per loop</span>
</pre></div>
</div>
<p>We illustrate various ways to use a <tt class="docutils literal"><span class="pre">key</span></tt> to sort the list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">HanoiTowerGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, ... 22, 23, 24, 25, 26]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="go">[26, 25, 24, 23, 22, ... 4, 3, 2, 1, 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">HanoiTowerGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[(0, 0, 0), (0, 0, 1), (0, 0, 2), (0, 1, 0), ... (2, 2, 1), (2, 2, 2)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">[(0, 0, 0), (1, 0, 0), (2, 0, 0), (0, 0, 1), ... (1, 2, 2), (2, 2, 2)]</span>
</pre></div>
</div>
<p>The discriminant of a polynomial is a function that returns an integer.
We build a graph whose vertices are polynomials, and use the discriminant
function to provide an ordering.  Note that since functions are first-class
objects in Python, we can specify precisely the function from the Sage library
that we wish to use as the key.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">:[</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">:[</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">6</span><span class="p">:[</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">dsc</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">polynomial_rational_flint</span><span class="o">.</span><span class="n">Polynomial_rational_flint</span><span class="o">.</span><span class="n">discriminant</span>
<span class="gp">sage: </span><span class="n">verts</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">dsc</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">verts</span>
<span class="go">[t^2 + 2, t^2, 5*t, 4*t^2 - 6]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verts</span><span class="p">]</span>
<span class="go">[-8, 0, 1, 96]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.weighted">
<tt class="descname">weighted</tt><big>(</big><em>new=None</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.weighted" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Whether the (di)graph is to be considered as a weighted (di)graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">new</span></tt> (optional bool): If it is provided, then the weightedness
flag is set accordingly. This is not allowed for immutable graphs.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Changing the weightedness flag changes the <tt class="docutils literal"><span class="pre">==</span></tt>-class of
a graph and is thus not allowed for immutable graphs.</p>
<p class="last">Edge weightings can still exist for (di)graphs <tt class="docutils literal"><span class="pre">G</span></tt> where
<tt class="docutils literal"><span class="pre">G.weighted()</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>.</p>
</div>
<p>EXAMPLES:</p>
<p>Here we have two graphs with different labels, but <tt class="docutils literal"><span class="pre">weighted()</span></tt> is
<tt class="docutils literal"><span class="pre">False</span></tt> for both, so we just check for the presence of edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;b&#39;</span><span class="p">}},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now one is weighted and the other is not, and thus the graphs are
not equal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">False</span>
</pre></div>
</div>
<p>However, if both are weighted, then we finally compare &#8216;a&#8217; to &#8216;b&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Ensure that <a class="reference external" href="http://trac.sagemath.org/10490">trac ticket #10490</a> is fixed: allows a weighted graph to be
set as unweighted.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Ensure that graphs using the static sparse backend can not be mutated
using this method, as fixed in <a class="reference external" href="http://trac.sagemath.org/15278">trac ticket #15278</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G_imm</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;static_sparse&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G_imm</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G_imm</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G_imm</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">This graph is immutable and can thus not be changed.</span>
<span class="go">Create a mutable copy, e.g., by `copy(g)`</span>
<span class="gp">sage: </span><span class="n">G_mut</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G_mut</span> <span class="o">==</span> <span class="n">G_imm</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G_mut</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G_mut</span> <span class="o">==</span> <span class="n">G_imm</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G_mut</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.weighted_adjacency_matrix">
<tt class="descname">weighted_adjacency_matrix</tt><big>(</big><em>sparse=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.weighted_adjacency_matrix" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the weighted adjacency matrix of the graph.</p>
<p>Each vertex is represented by its position in the list returned by the
vertices() function.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">weighted_adjacency_matrix</span><span class="p">();</span> <span class="n">M</span>
<span class="go">[0 1 3 4]</span>
<span class="go">[1 0 2 0]</span>
<span class="go">[3 2 0 0]</span>
<span class="go">[4 0 0 0]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;weighted_adjacency_matrix&#39;</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following doctest verifies that #4888 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">}},</span> <span class="n">weighted</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted_adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 0 0]</span>
<span class="go">[1 0 0]</span>
<span class="go">[1 0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.generic_graph.GenericGraph.wiener_index">
<tt class="descname">wiener_index</tt><big>(</big><em>by_weight=False</em>, <em>algorithm=None</em>, <em>weight_function=None</em>, <em>check_weight=True</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.GenericGraph.wiener_index" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the Wiener index of the graph.</p>
<p>The Wiener index of a graph <span class="math">\(G\)</span> is
<span class="math">\(W(G) = \frac 1 2 \sum_{u,v\in G} d(u,v)\)</span>
where <span class="math">\(d(u,v)\)</span> denotes the distance between vertices <span class="math">\(u\)</span> and <span class="math">\(v\)</span> (see
<a class="reference internal" href="distances_all_pairs.html#krg96b" id="id21">[KRG96b]</a>).</p>
<p>For more information on the input variables and more examples, we refer
to <a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_paths" title="sage.graphs.generic_graph.GenericGraph.shortest_paths"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_paths()</span></tt></a> and
<a class="reference internal" href="#sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs" title="sage.graphs.generic_graph.GenericGraph.shortest_path_all_pairs"><tt class="xref py py-meth docutils literal"><span class="pre">shortest_path_all_pairs()</span></tt></a>,
which have very similar input variables.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">by_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, the edges in the graph are
weighted; if <tt class="docutils literal"><span class="pre">False</span></tt>, all edges have weight 1.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string) - one of the following algorithms:<ul>
<li><tt class="docutils literal"><span class="pre">'BFS'</span></tt> - the computation is done through a BFS centered on each
vertex successively. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Cython'</span></tt> - the Cython implementation of
the Floyd-Warshall algorithm. Works only if <tt class="docutils literal"><span class="pre">by_weight==False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'Floyd-Warshall-Python'</span></tt> - the Python implementation of
the Floyd-Warshall algorithm. Works also with weighted graphs, even
with negative weights (but no negative cycle is allowed).</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_NetworkX'</span></tt>: the Dijkstra algorithm, implemented in
NetworkX. It works with weighted graphs, but no negative weight is
allowed.</li>
<li><tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt>: the Dijkstra algorithm, implemented in Boost
(works only with positive weights).</li>
<li><tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>: the Johnson algorithm, implemented in
Boost (works also with negative weights, if there is no negative
cycle).</li>
<li><tt class="docutils literal"><span class="pre">None</span></tt> (default): Sage chooses the best algorithm: <tt class="docutils literal"><span class="pre">'BFS'</span></tt> for
unweighted graphs, <tt class="docutils literal"><span class="pre">'Dijkstra_Boost'</span></tt> if all weights are
positive, <tt class="docutils literal"><span class="pre">'Johnson_Boost'</span></tt>, otherwise.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">weight_function</span></tt> (function) - a function that inputs an edge
<tt class="docutils literal"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></tt> and outputs its weight. If not <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">by_weight</span></tt>
is automatically set to <tt class="docutils literal"><span class="pre">True</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">by_weight</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt>, we use the edge label <tt class="docutils literal"><span class="pre">l</span></tt> as a weight.</li>
<li><tt class="docutils literal"><span class="pre">check_weight</span></tt> (boolean) - if <tt class="docutils literal"><span class="pre">True</span></tt>, we check that the
weight_function outputs a number for each edge.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="p">},</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">200</span><span class="p">))</span>
<span class="go">820</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS&#39;</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Floyd-Warshall-Cython&#39;</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Floyd-Warshall-Python&#39;</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_Boost&#39;</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Johnson_Boost&#39;</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;Dijkstra_NetworkX&#39;</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;BFS&#39;</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">200</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">BFS algorithm does not work on weighted graphs.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.graphs.generic_graph.graph_isom_equivalent_non_edge_labeled_graph">
<tt class="descclassname">sage.graphs.generic_graph.</tt><tt class="descname">graph_isom_equivalent_non_edge_labeled_graph</tt><big>(</big><em>g</em>, <em>partition=None</em>, <em>standard_label=None</em>, <em>return_relabeling=False</em>, <em>return_edge_labels=False</em>, <em>inplace=False</em>, <em>ignore_edge_labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.graph_isom_equivalent_non_edge_labeled_graph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Helper function for canonical labeling of edge labeled (di)graphs.</p>
<p>Translates to a bipartite incidence-structure type graph
appropriate for computing canonical labels of edge labeled and/or multi-edge graphs.
Note that this is actually computationally equivalent to
implementing a change on an inner loop of the main algorithm-
namely making the refinement procedure sort for each label.</p>
<p>If the graph is a multigraph, it is translated to a non-multigraph,
where each edge is labeled with a dictionary describing how many
edges of each label were originally there. Then in either case we
are working on a graph without multiple edges. At this point, we
create another (bipartite) graph, whose left vertices are the
original vertices of the graph, and whose right vertices represent
the edges. We partition the left vertices as they were originally,
and the right vertices by common labels: only automorphisms taking
edges to like-labeled edges are allowed, and this additional
partition information enforces this on the bipartite graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">g</span></tt> &#8211; Graph or DiGraph</li>
<li><tt class="docutils literal"><span class="pre">partition</span></tt> &#8211; (default:None) if given, the partition of the vertices is as well relabeled</li>
<li><tt class="docutils literal"><span class="pre">standard_label</span></tt> &#8211; (default:None) the standard label is not considered to be changed</li>
<li><tt class="docutils literal"><span class="pre">return_relabeling</span></tt> &#8211; (defaut:False) if True, a dictionary containing the relabeling is returned</li>
<li><tt class="docutils literal"><span class="pre">return_edge_labels</span></tt> &#8211; (defaut:False) if True, the different edge_labels are returned (useful if inplace is True)</li>
<li><tt class="docutils literal"><span class="pre">inplace</span></tt> &#8211; (default:False) if True, g is modified, otherwise the result is returned. Note that attributes of g are <em>not</em> copied for speed issues, only edges and vertices.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>if not inplace: the unlabeled graph without multiple edges</li>
<li>the partition of the vertices</li>
<li>if return_relabeling: a dictionary containing the relabeling</li>
<li>if return_edge_labels: the list of (former) edge labels is returned</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.generic_graph</span> <span class="kn">import</span> <span class="n">graph_isom_equivalent_non_edge_labeled_graph</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;string&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">123</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graph_isom_equivalent_non_edge_labeled_graph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">123</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">g</span>
<span class="go">[Graph on 6 vertices, [[0, 3], [1, 2], [4], [5]]]</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graph_isom_equivalent_non_edge_labeled_graph</span><span class="p">(</span><span class="n">G</span><span class="p">);</span> <span class="n">g</span>
<span class="go">[Graph on 6 vertices, [[0, 1, 2, 3], [4], [5]]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 4, None), (1, 4, None), (1, 5, None), (2, 3, None), (2, 5, None)]</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graph_isom_equivalent_non_edge_labeled_graph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">standard_label</span><span class="o">=</span><span class="s">&#39;string&#39;</span><span class="p">,</span><span class="n">return_edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">g</span>
<span class="go">[Graph on 6 vertices, [[0, 1, 2, 3], [5], [4]], [[[None, 1]], [[0, 1], [1, 1], [2, 1], [3, 1], [4, 1], [5, 1], [6, 1], [7, 1], [8, 1], [9, 1]], [[&#39;string&#39;, 1]]]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 4, None), (1, 2, None), (1, 4, None), (2, 5, None), (3, 5, None)]</span>

<span class="gp">sage: </span><span class="n">graph_isom_equivalent_non_edge_labeled_graph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[[0, 1, 2, 3], [4], [5]]]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 4, None), (1, 4, None), (1, 5, None), (2, 3, None), (2, 5, None)]</span>
</pre></div>
</div>
<p>Ensure that #14108 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">HH</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">HH</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.generic_graph.tachyon_vertex_plot">
<tt class="descclassname">sage.graphs.generic_graph.</tt><tt class="descname">tachyon_vertex_plot</tt><big>(</big><em>g</em>, <em>bgcolor=(1</em>, <em>1</em>, <em>1)</em>, <em>vertex_colors=None</em>, <em>vertex_size=0.06</em>, <em>pos3d=None</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.graphs.generic_graph.tachyon_vertex_plot" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Helper function for plotting graphs in 3d with Tachyon. Returns a
plot containing only the vertices, as well as the 3d position
dictionary used for the plot.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li><span class="math">\(pos3d\)</span> - a 3D layout of the vertices</li>
<li>various rendering options</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.generic_graph</span> <span class="kn">import</span> <span class="n">tachyon_vertex_plot</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">tachyon_vertex_plot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos3d</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.plot.plot3d.tachyon.Tachyon&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">&lt;type &#39;dict&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Generic graphs (common to directed/undirected)</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../../index.html"
                                  title="previous chapter">Graph Theory</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="graph.html"
                                  title="next chapter">Undirected graphs</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/graphs/generic_graph.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Undirected graphs"
             >next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Graph Theory"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Graph Theory</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>