<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Abelian Sandpile Model &mdash; Thematic Tutorials v6.7</title>
    
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Thematic Tutorials v6.7" href="index.html" />
    <link rel="up" title="Thematic tutorial document tree" href="toctree.html" />
    <link rel="next" title="Group Theory and Sage" href="group_theory.html" />
    <link rel="prev" title="Tutorial: Using the Sage notebook, navigating the help system, first exercises" href="tutorial-notebook-and-help-long.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="group_theory.html" title="Group Theory and Sage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial-notebook-and-help-long.html" title="Tutorial: Using the Sage notebook, navigating the help system, first exercises"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="index.html">Thematic Tutorials v6.7</a> &raquo;</li>

          <li><a href="toctree.html" accesskey="U">Thematic tutorial document tree</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="abelian-sandpile-model">
<span id="id1"></span><h1>Abelian Sandpile Model<a class="headerlink" href="#abelian-sandpile-model" title="Permalink to this headline">¶</a></h1>
<p><em>Author: David Perkinson, Reed College</em></p>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>These notes provide an introduction to Dhar&#8217;s abelian sandpile model (ASM) and
to Sage Sandpiles, a collection of tools in Sage for doing sandpile
calculations.  For a more thorough introduction to the theory of the ASM, the
papers <em>Chip-Firing and Rotor-Routing on Directed Graphs</em> <a class="reference internal" href="#h" id="id2">[H]</a>, by Holroyd et
al. and <em>Riemann-Roch and Abel-Jacobi Theory on a Finite Graph</em> by Baker and
Norine <a class="reference internal" href="#bn" id="id3">[BN]</a> are recommended.</p>
<p>To describe the ASM, we start with a <em>sandpile graph</em>: a directed multigraph
<span class="math">\(\Gamma\)</span> with a vertex <span class="math">\(s\)</span> that is accessible from every vertex (except
possibly <span class="math">\(s\)</span>, itself).  By <em>multigraph</em>, we mean that each edge of <span class="math">\(\Gamma\)</span> is
assigned a nonnegative integer weight.  To say <span class="math">\(s\)</span> is <em>accessible</em> from some
vertex <span class="math">\(v\)</span> means that there is a sequence of directed edges starting at <span class="math">\(v\)</span> and
ending at <span class="math">\(s\)</span>.  We call <span class="math">\(s\)</span> the <em>sink</em> of the sandpile graph, even though it might have outgoing edges, for reasons that will be made clear in a moment.</p>
<p>We denoted the vertices of <span class="math">\(\Gamma\)</span> by <span class="math">\(V\)</span> and define <span class="math">\(\tilde{V} = V\setminus\{s\}\)</span>.</p>
<div class="section" id="configurations-and-divisors">
<h3>Configurations and divisors<a class="headerlink" href="#configurations-and-divisors" title="Permalink to this headline">¶</a></h3>
<p>A <em>configuration</em> on <span class="math">\(\Gamma\)</span> is an element of <span class="math">\(\mathbb{N}\tilde{V}\)</span>, i.e., the
assignment of a nonnegative integer to each nonsink vertex.  We think of each
integer as a number of grains of sand being placed at the corresponding
vertex.  A <em>divisor</em> on <span class="math">\(\Gamma\)</span> is an element of <span class="math">\(\mathbb{Z}V\)</span>, i.e., an
element in the free abelian group on <em>all</em> of the vertices.  In the context of
divisors, it is sometimes useful to think of assigning dollars to each vertex,
with negative integers signifying a debt.</p>
</div>
<div class="section" id="stabilization">
<h3>Stabilization<a class="headerlink" href="#stabilization" title="Permalink to this headline">¶</a></h3>
<p>A configuration <span class="math">\(c\)</span> is <em>stable</em> at a vertex <span class="math">\(v\in\tilde{V}\)</span> if
<span class="math">\(c(v)&lt;\mbox{out-degree}(v)\)</span>, and <span class="math">\(c\)</span> itself is stable if it is stable at each
nonsink vertex.  Otherwise, <span class="math">\(c\)</span> is <em>unstable</em>.  If <span class="math">\(c\)</span> is unstable at <span class="math">\(v\)</span>, the vertex <span class="math">\(v\)</span> can be <em>fired</em>
(<em>toppled</em>) by removing <span class="math">\(\mbox{out-degree}(v)\)</span> grains of sand from <span class="math">\(v\)</span> and
adding grains of sand to the neighbors of sand, determined by the weights of
the edges leaving <span class="math">\(v\)</span>.</p>
<p>Despite our best intentions, we sometimes consider firing a stable vertex,
resulting in a configuration with a &#8220;negative amount&#8221; of sand at that vertex.
We may also <em>reverse-firing</em> a vertex, absorbing sand from the vertex&#8217;s
neighbors.</p>
<p><strong>Example.</strong> Consider the graph:</p>
<div class="figure align-center">
<img alt="_images/example1.png" src="_images/example1.png" />
<p class="caption"><span class="math">\(\Gamma\)</span></p>
</div>
<p>All edges have weight <span class="math">\(1\)</span> except for the edge from vertex 1 to vertex 3,
which has weight <span class="math">\(2\)</span>.  If we let <span class="math">\(c=(5,0,1)\)</span> with the indicated number of
grains of sand on vertices 1, 2, and 3, respectively, then only vertex 1,
whose out-degree is 4, is unstable.  Firing vertex 1 gives a new
configuration <span class="math">\(c'=(1,1,3)\)</span>.  Here, <span class="math">\(4\)</span> grains have left vertex 1.  One of
these has gone to the sink vertex (and forgotten), one has gone to vertex 1,
and two have gone to vertex 2, since the edge from 1 to 2 has weight 2.
Vertex 3 in the new configuration is now unstable.  The Sage code for this
example follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sink&#39;</span><span class="p">:{},</span>
<span class="go">....:      1:{&#39;sink&#39;:1, 2:1, 3:2},</span>
<span class="go">....:      2:{1:1, 3:1},</span>
<span class="go">....:      3:{1:1, 2:1}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">&#39;sink&#39;</span><span class="p">)</span>   <span class="c"># create the sandpile</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>  <span class="c"># display the graph</span>

<span class="go">Create the configuration:</span>

<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">{1: 4, 2: 2, 3: 2, &#39;sink&#39;: 0}</span>

<span class="go">Fire vertex one:</span>

<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{1: 1, 2: 1, 3: 3}</span>

<span class="go">The configuration is unchanged:</span>

<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 5, 2: 0, 3: 1}</span>

<span class="go">Repeatedly fire vertices until the configuration becomes stable:</span>

<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">{1: 2, 2: 1, 3: 1}</span>

<span class="go">Alternatives:</span>

<span class="gp">sage: </span><span class="o">~</span><span class="n">c</span>             <span class="c"># shorthand for c.stabilize()</span>
<span class="go">{1: 2, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="n">with_firing_vector</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="go">[{1: 2, 2: 1, 3: 1}, {1: 2, 2: 2, 3: 3}]</span>
</pre></div>
</div>
<p>Since vertex 3 has become unstable after firing vertex 1, it can be fired,
which causes vertex 2 to become unstable, etc.  Repeated firings eventually
lead to a stable configuration.  The last line of the Sage code, above, is a
list, the first element of which is the resulting stable configuration,
<span class="math">\((2,1,1)\)</span>.  The second component records how many times each vertex fired in
the stabilization.</p>
<hr class="docutils" />
<p>Since the sink is accessible from each nonsink vertex and never fires, every
configuration will stabilize after a finite number of vertex-firings.  It is
not obvious, but the resulting stabilization is independent of the order in
which unstable vertices are fired.  Thus, each configuration stabilizes to a
unique stable configuration.</p>
</div>
<div class="section" id="laplacian">
<h3>Laplacian<a class="headerlink" href="#laplacian" title="Permalink to this headline">¶</a></h3>
<p>Fix an order on the vertices of <span class="math">\(\Gamma\)</span>. The <em>Laplacian</em> of <span class="math">\(\Gamma\)</span> is</p>
<div class="math">
\[L := D-A\]</div>
<p>where <span class="math">\(D\)</span> is the diagonal matrix of out-degrees of the vertices and <span class="math">\(A\)</span> is the
adjacency matrix whose <span class="math">\((i,j)\)</span>-th entry is the weight of the edge from vertex
<span class="math">\(i\)</span> to vertex <span class="math">\(j\)</span>, which we take to be <span class="math">\(0\)</span> if there is no edge.  The <em>reduced
Laplacian</em>, <span class="math">\(\tilde{L}\)</span>, is the submatrix of the Laplacian formed by removing
the row and column corresponding to the sink vertex.  Firing a vertex of a
configuration is the same as subtracting the corresponding row of the reduced
Laplacian.</p>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>  <span class="c"># the ordering of the vertices</span>
<span class="go">[1, 2, 3, &#39;sink&#39;]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span>
<span class="go">[ 4 -1 -2 -1]</span>
<span class="go">[-1  2 -1  0]</span>
<span class="go">[-1 -1  2  0]</span>
<span class="go">[ 0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[ 4 -1 -2]</span>
<span class="go">[-1  2 -1]</span>
<span class="go">[-1 -1  2]</span>

<span class="go">The configuration we considered previously:</span>

<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 5, 2: 0, 3: 1}</span>

<span class="go">Firing vertex 1 is the same as subtracting the</span>
<span class="go">corresponding row from the reduced Laplacian:</span>

<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1, 1, 3]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(4, -1, -2)</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">vector</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(1, 1, 3)</span>
</pre></div>
</div>
</div>
<div class="section" id="recurrent-elements">
<h3>Recurrent elements<a class="headerlink" href="#recurrent-elements" title="Permalink to this headline">¶</a></h3>
<p>Imagine an experiment in which grains of sand are dropped one-at-a-time onto a
graph, pausing to allow the configuration to stabilize between drops.  Some
configurations will only be seen once in this process.  For example, for most
graphs, once sand is dropped on the graph, no addition of sand+stabilization
will result in a graph empty of sand.  Other configurations&#8212;the so-called
<em>recurrent configurations</em>&#8212;will be seen infinitely often as the process is
repeated indefinitely.</p>
<p>To be precise, a configuration <span class="math">\(c\)</span> is <em>recurrent</em> if (i) it is stable, and (ii)
given any configuration <span class="math">\(a\)</span>, there is a configuration <span class="math">\(b\)</span> such that
<span class="math">\(c=\mbox{stab}(a+b)\)</span>, the stabilization of <span class="math">\(a+b\)</span>.</p>
<p>The <em>maximal-stable</em> configuration, denoted <span class="math">\(c_{\mathrm{max}}\)</span> is defined by
<span class="math">\(c_{\mathrm{max}}(v)=\mbox{out-degree}(v)-1\)</span> for all nonsink vertices <span class="math">\(v\)</span>.  It is clear that <span class="math">\(c_{\mathrm{max}}\)</span> is recurrent.  Further, it is not hard to see that a configuration is recurrent if and only if it has the form <span class="math">\(\mbox{stab}(a+c_{\mathrm{max}})\)</span> for some configuration <span class="math">\(a\)</span>.</p>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">false</span><span class="p">)</span>
<span class="go">[[3, 1, 1], [2, 1, 1], [3, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 2, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 3, 2: 1, 3: 1}</span>

<span class="go">Adding any configuration to the max-stable configuration and stabilizing</span>
<span class="go">yields a recurrent configuration.</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 4, 2: 1, 3: 1}</span>

<span class="go">Use &amp; to add and stabilize:</span>

<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 3, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>

<span class="go">Note the various ways of performing addition + stabilization:</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span> <span class="o">==</span> <span class="o">~</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">m</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="burning-configuration">
<h3>Burning Configuration<a class="headerlink" href="#burning-configuration" title="Permalink to this headline">¶</a></h3>
<p>A <em>burning configuration</em> is a nonnegative integer-linear combination of the
rows of the reduced Laplacian matrix having nonnegative entries and such that
every vertex has a path from some vertex in its support.  The corresponding
<em>burning script</em> gives the integer-linear combination needed to obtain the
burning configuration.  So if <span class="math">\(b\)</span> is the burning configuration, <span class="math">\(\sigma\)</span> is its
script, and <span class="math">\(\tilde{L}\)</span> is the reduced Laplacian, then <span class="math">\(\sigma\,\tilde{L} = b\)</span>.
The <em>minimal burning configuration</em> is the one with the minimal script (its
components are no larger than the components of any other script for a burning
configuration).</p>
<p>The following are equivalent for a configuration <span class="math">\(c\)</span> with burning
configuration <span class="math">\(b\)</span> having script <span class="math">\(\sigma\)</span>:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(c\)</span> is recurrent;</li>
<li><span class="math">\(c+b\)</span> stabilizes to <span class="math">\(c\)</span>;</li>
<li>the firing vector for the stabilization of <span class="math">\(c+b\)</span> is <span class="math">\(\sigma\)</span>.</li>
</ul>
</div></blockquote>
<p>The burning configuration and script are computed using a modified
version of Speer&#8217;s script algorithm.  This is a generalization to
directed multigraphs of Dhar&#8217;s burning algorithm.</p>
<p><strong>Example.</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="go">....:      3:{2:1,5:1},4:{1:1,3:1},5:{2:1,3:1}}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span>
<span class="go">{1: 2, 2: 0, 3: 1, 4: 1, 5: 0}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 0, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 5, 4: 1, 5: 4}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1, 3, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[2 0 1 1 0]</span>
</pre></div>
</div>
</div>
<div class="section" id="sandpile-group">
<h3>Sandpile group<a class="headerlink" href="#sandpile-group" title="Permalink to this headline">¶</a></h3>
<p>The collection of stable configurations forms a commutative monoid with
addition defined as ordinary addition followed by stabilization.  The identity
element is the all-zero configuration.  This monoid is a group
exactly when the underlying graph is a DAG (directed acyclic graph).</p>
<p>The recurrent elements form a submonoid which turns out to be a group.  This
group is called the <em>sandpile group</em> for <span class="math">\(\Gamma\)</span>, denoted
<span class="math">\(\mathcal{S}(\Gamma)\)</span>.  Its identity element is usually not the all-zero
configuration (again, only in the case that <span class="math">\(\Gamma\)</span> is a DAG).  So finding the
identity element is an interesting problem.</p>
<p>Let <span class="math">\(n=|V|-1\)</span> and fix an ordering of the nonsink vertices. Let
<span class="math">\(\mathcal{\tilde{L}}\subset\mathbb{Z}^n\)</span> denote the column-span of
<span class="math">\(\tilde{L}^t\)</span>, the transpose of the reduced Laplacian.  It is a theorem that</p>
<div class="math">
\[\mathcal{S}(\Gamma)\approx \mathbb{Z}^n/\mathcal{\tilde{L}}.\]</div>
<p>Thus, the number of elements of the sandpile group is <span class="math">\(\det{\tilde{L}}\)</span>, which
by the matrix-tree theorem is the number of weighted trees directed into the
sink.</p>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">invariant_factors</span><span class="p">()</span>
<span class="go">[1, 1, 3]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span><span class="o">.</span><span class="n">dense_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[1 0 0]  [ 0  0  1]  [3 1 4]</span>
<span class="go">[0 1 0]  [ 1  0  0]  [4 1 6]</span>
<span class="go">[0 0 3], [ 0  1 -1], [4 1 5]</span>
<span class="go">)</span>

<span class="go">Adding the identity to any recurrent configuration and stabilizing yields</span>
<span class="go">the same recurrent configuration:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">{1: 3, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">&amp;</span> <span class="n">m</span> <span class="o">==</span> <span class="n">m</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="self-organized-criticality">
<h3>Self-organized criticality<a class="headerlink" href="#self-organized-criticality" title="Permalink to this headline">¶</a></h3>
<p>The sandpile model was introduced by Bak, Tang, and Wiesenfeld in the paper,
<em>Self-organized criticality: an explanation of 1/ƒ noise</em> <a class="reference internal" href="#btw" id="id4">[BTW]</a>.  The term
<em>self-organized criticality</em> has no precise definition, but can be
loosely taken to describe a system that naturally evolves to a state that is
barely stable and such that the instabilities are described by a power law.
In practice, <em>self-organized criticality</em> is often taken to mean <em>like the
sandpile model on a grid-graph</em>.  The grid graph is just a grid with an extra
sink vertex.  The vertices on the interior of each side have one edge to the
sink, and the corner vertices have an edge of weight <span class="math">\(2\)</span>.  Thus, every nonsink
vertex has out-degree <span class="math">\(4\)</span>.</p>
<p>Imagine repeatedly dropping grains of sand on and empty grid graph, allowing
the sandpile to stabilize in between.  At first there is little activity, but
as time goes on, the size and extent of the avalanche caused by a single grain
of sand becomes hard to predict.  Computer experiments&#8212;I do not think there
is a proof, yet&#8212;indicate that the distribution of avalanche sizes obeys a
power law with exponent -1.  In the example below, the size of an avalanche is
taken to be the sum of the number of times each vertex fires.</p>
<p><strong>Example (distribution of avalanche sizes).</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">grid_sandpile</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>  <span class="c"># long time (15s on sage.math, 2012)</span>
<span class="go">....:     m = m.add_random()</span>
<span class="go">....:     m, f = m.stabilize(true)</span>
<span class="go">....:     a.append(sum(f.values()))</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">list_plot</span><span class="p">([[</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>  <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">axes_labels</span><span class="p">([</span><span class="s">&#39;log(N)&#39;</span><span class="p">,</span><span class="s">&#39;log(D(N))&#39;</span><span class="p">])</span>  <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">p</span>  <span class="c"># long time</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/btw.png" src="_images/btw.png" />
<p class="caption">Distribution of avalanche sizes</p>
</div>
<p>Note: In the above code, <tt class="docutils literal"><span class="pre">m.stabilize(true)</span></tt> returns a list consisting of the
stabilized configuration and the firing vector.  (Omitting <tt class="docutils literal"><span class="pre">true</span></tt> would give
just the stabilized configuration.)</p>
</div>
<div class="section" id="divisors-and-discrete-riemann-surfaces">
<span id="discrete-riemann-surfaces"></span><h3>Divisors and Discrete Riemann surfaces<a class="headerlink" href="#divisors-and-discrete-riemann-surfaces" title="Permalink to this headline">¶</a></h3>
<p>A reference for this section is <em>Riemann-Roch and Abel-Jacobi theory on a finite
graph</em> <a class="reference internal" href="#bn" id="id5">[BN]</a>.</p>
<p>A <em>divisor</em> on <span class="math">\(\Gamma\)</span> is an element of the free abelian group on its
vertices, including the sink.  Suppose, as above, that the <span class="math">\(n+1\)</span> vertices of
<span class="math">\(\Gamma\)</span> have been ordered, and that <span class="math">\(\mathcal{L}\)</span> is the column span of the
transpose of the Laplacian.  A divisor is then identified with an element
<span class="math">\(D\in\mathbb{Z}^{n+1}\)</span> and two divisors are <em>linearly equivalent</em> if they
differ by an element of <span class="math">\(\mathcal{L}\)</span>.  A divisor <span class="math">\(E\)</span> is <em>effective</em>, written
<span class="math">\(E\geq0\)</span>, if <span class="math">\(E(v)\geq0\)</span> for each <span class="math">\(v\in V\)</span>, i.e., if <span class="math">\(E\in\mathbb{N}^{n+1}\)</span>.
The <em>degree</em> of a divisor, <span class="math">\(D\)</span>, is <span class="math">\(deg(D) := \sum_{v\in V}D(v)\)</span>.   The
divisors of degree zero modulo linear equivalence form the <em>Picard group</em>, or
<em>Jacobian</em> of the graph. For an undirected graph, the Picard group is
isomorphic to the sandpile group.</p>
<p>The <em>complete linear system</em> for a divisor <span class="math">\(D\)</span>, denoted <span class="math">\(|D|\)</span>, is the
collection of effective divisors linearly equivalent to <span class="math">\(D.\)</span></p>
<div class="section" id="riemann-roch">
<h4>Riemann-Roch<a class="headerlink" href="#riemann-roch" title="Permalink to this headline">¶</a></h4>
<p>To describe the Riemann-Roch theorem in this context, suppose that <span class="math">\(\Gamma\)</span> is
an undirected, unweighted graph. The <em>dimension</em>, <span class="math">\(r(D)\)</span> of the linear system
<span class="math">\(|D|\)</span> is <span class="math">\(-1\)</span> if <span class="math">\(|D|=\emptyset\)</span> and otherwise is the greatest integer <span class="math">\(s\)</span> such
that <span class="math">\(|D-E|\neq0\)</span> for all effective divisors <span class="math">\(E\)</span> of degree <span class="math">\(s\)</span>.  Define the
<em>canonical divisor</em> by <span class="math">\(K=\sum_{v\in V}(\deg(v)-2)v\)</span> and the <em>genus</em> by <span class="math">\(g =
\#(E) - \#(V) + 1\)</span>.  The Riemann-Roch theorem says that for any divisor <span class="math">\(D\)</span>,</p>
<div class="math">
\[r(D)-r(K-D)=\deg(D)+1-g.\]</div>
<p><strong>Example.</strong> (Some of the following calculations require the installation of <a class="reference internal" href="#installation"><em>4ti2</em></a>.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c"># the sandpile on the complete graph with 5 vertices</span>

<span class="go">The genus (num_edges method counts each undirected edge twice):</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">num_edges</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">G</span><span class="o">.</span><span class="n">num_verts</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>

<span class="go">A divisor on the graph:</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

<span class="go">Verify the Riemann-Roch theorem:</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">r_of_D</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">r_of_D</span><span class="p">()</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">g</span> <span class="c"># optional - 4ti2</span>
<span class="go">True</span>

<span class="go">The effective divisors linearly equivalent to D:</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()]</span>  <span class="c"># optional - 4ti2</span>
<span class="go">[[0, 1, 1, 4, 1], [4, 0, 0, 3, 0], [1, 2, 2, 0, 2]]</span>

<span class="go">The nonspecial divisors up to linear equivalence (divisors of degree</span>
<span class="go">g-1 with empty linear systems)</span>

<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">nonspecial_divisors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">N</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>   <span class="c"># the first few</span>
<span class="go">[[-1, 2, 1, 3, 0],</span>
<span class="go"> [-1, 0, 3, 1, 2],</span>
<span class="go"> [-1, 2, 0, 3, 1],</span>
<span class="go"> [-1, 3, 1, 2, 0],</span>
<span class="go"> [-1, 2, 0, 1, 3]]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="n">G</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="picturing-linear-systems">
<h4>Picturing linear systems<a class="headerlink" href="#picturing-linear-systems" title="Permalink to this headline">¶</a></h4>
<p>Fix a divisor <span class="math">\(D\)</span>.  There are at least two natural graphs associated with
linear system associated with <span class="math">\(D\)</span>.  First, consider the directed graph with
vertex set <span class="math">\(|D|\)</span> and with an edge from vertex <span class="math">\(E\)</span> to vertex <span class="math">\(F\)</span> if <span class="math">\(F\)</span> is
attained from <span class="math">\(E\)</span> by firing a single unstable vertex.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=.</span><span class="mo">005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">iterations</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/C_6.png" src="_images/C_6.png" />
<p class="caption">Complete linear system for (1,1,1,1,2,0) on <span class="math">\(C_6\)</span>: single firings</p>
</div>
<p>The second graph has the same set of vertices but with an edge from <span class="math">\(E\)</span> to <span class="math">\(F\)</span>
if <span class="math">\(F\)</span> is obtained from <span class="math">\(E\)</span> by firing all unstable vertices of <span class="math">\(E\)</span>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span>  <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">parallel_firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=.</span><span class="mo">005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">iterations</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/C_6-parallel.png" src="_images/C_6-parallel.png" />
<p class="caption">Complete linear system for (1,1,1,1,2,0) on <span class="math">\(C_6\)</span>: parallel firings</p>
</div>
<p>Note that in each of the examples, above, starting at any divisor in the linear
system and following edges, one is eventually led into a cycle of length 6
(cycling the divisor (1,1,1,1,2,0)).  Thus, <tt class="docutils literal"><span class="pre">D.alive()</span></tt> returns <tt class="docutils literal"><span class="pre">True</span></tt>.  In
Sage, one would be able to rotate the above figures to get a better idea of the
structure.</p>
</div>
</div>
<div class="section" id="algebraic-geometry-of-sandpiles">
<h3>Algebraic geometry of sandpiles<a class="headerlink" href="#algebraic-geometry-of-sandpiles" title="Permalink to this headline">¶</a></h3>
<div class="section" id="affine">
<h4>Affine<a class="headerlink" href="#affine" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math">\(n=|V|-1\)</span>, and fix an ordering on the nonsink vertices of <span class="math">\(\Gamma\)</span>.  let
<span class="math">\(\tilde{\mathcal{L}}\subset\mathbb{Z}^n\)</span> denote the column-span of
<span class="math">\(\tilde{L}^t\)</span>, the transpose of the reduced Laplacian.  Label vertex <span class="math">\(i\)</span> with the
indeterminate <span class="math">\(x_i\)</span>, and let <span class="math">\(\mathbb{C}[\Gamma_s] = \mathbb{C}[x_1,\dots,x_n]\)</span>.
(Here, <span class="math">\(s\)</span> denotes the sink vertex of <span class="math">\(\Gamma\)</span>.) The <em>sandpile ideal</em> or
<em>toppling ideal</em>, first studied by Cori, Rossin, and Salvy <a class="reference internal" href="#crs" id="id6">[CRS]</a> for undirected graphs, is the lattice ideal for <span class="math">\(\tilde{\mathcal{L}}\)</span>:</p>
<div class="math">
\[I = I(\Gamma_s) := \{x^u-x^v: u-v\in
\tilde{\mathcal{L}}\}\subset\mathbb{C}[\Gamma_s],\]</div>
<p>where <span class="math">\(x^u := \prod_{i=1}^nx^{u_i}\)</span> for <span class="math">\(u\in\mathbb{Z}^n\)</span>.</p>
<p>For each <span class="math">\(c\in\mathbb{Z}^n\)</span> define <span class="math">\(t(c) = x^{c^+} - x^{c^-}\)</span> where
<span class="math">\(c^+_i=\max\{c_i,0\}\)</span> and <span class="math">\(c^-=\max\{-c_i,0\}\)</span> so that <span class="math">\(c=c^+-c^-\)</span>.
Then, for each <span class="math">\(\sigma\in\mathbb{Z}^n\)</span>, define <span class="math">\(T(\sigma) =
t(\tilde{L}^t\sigma)\)</span>.  It then turns out that</p>
<div class="math">
\[I = (T(e_1),\dots,T(e_n),x^b-1)\]</div>
<p>where <span class="math">\(e_i\)</span> is the <span class="math">\(i\)</span>-th standard basis vector and <span class="math">\(b\)</span> is any burning
configuration.</p>
<p>The affine coordinate ring, <span class="math">\(\mathbb{C}[\Gamma_s]/I,\)</span> is isomorphic to the group
algebra of the sandpile group, <span class="math">\(\mathbb{C}[\mathcal{S}(\Gamma)].\)</span></p>
<p>The standard term-ordering on <span class="math">\(\mathbb{C}[\Gamma_s]\)</span> is graded reverse
lexigraphical order with <span class="math">\(x_i&gt;x_j\)</span> if vertex <span class="math">\(v_i\)</span> is further from the sink than
vertex <span class="math">\(v_j\)</span>. (There are choices to be made for vertices equidistant from the
sink). If <span class="math">\(\sigma_b\)</span> is the script for a burning configuration (not
necessarily minimal), then</p>
<div class="math">
\[\{T(\sigma): \sigma\leq\sigma_b\}\]</div>
<p>is a Groebner basis for <span class="math">\(I\)</span>.</p>
</div>
<div class="section" id="projective">
<h4>Projective<a class="headerlink" href="#projective" title="Permalink to this headline">¶</a></h4>
<p>Now let <span class="math">\(\mathbb{C}[\Gamma]=\mathbb{C}[x_0,x_1,\dots,x_n]\)</span>, where <span class="math">\(x_0\)</span>
corresponds to the sink vertex.  The <em>homogeneous sandpile ideal</em>, denoted
<span class="math">\(I^h\)</span>, is obtaining by homogenizing <span class="math">\(I\)</span> with respect to <span class="math">\(x_0\)</span>.  Let <span class="math">\(L\)</span> be the
(full) Laplacian, and <span class="math">\(\mathcal{L}\subset\mathbb{Z}^{n+1}\)</span> be the column span of
its transpose, <span class="math">\(L^t.\)</span>  Then <span class="math">\(I^h\)</span> is the lattice ideal for <span class="math">\(\mathcal{L}\)</span>:</p>
<div class="math">
\[I^h = I^h(\Gamma) := \{x^u-x^v: u-v \in\mathcal{L}\}\subset\mathbb{C}[\Gamma].\]</div>
<p>This ideal can be calculated by saturating the ideal</p>
<div class="math">
\[(T(e_i): i=0,\dots n)\]</div>
<p>with respect to the product of the indeterminates: <span class="math">\(\prod_{i=0}^nx_i\)</span> (extending
the <span class="math">\(T\)</span> operator in the obvious way).  A Groebner basis with respect to the
degree lexicographic order describe above (with <span class="math">\(x_0\)</span> the smallest vertex), is
obtained by homogenizing each element of the Groebner basis for the
non-homogeneous sandpile ideal with respect to <span class="math">\(x_0.\)</span></p>
<p><strong>Example.</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="go">....:      3:{2:1,5:1},4:{1:1,3:1},5:{2:1,3:1}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in x5, x4, x3, x2, x1, x0 over Rational Field</span>

<span class="go">The homogeneous sandpile ideal:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="go">Ideal (x2 - x0, x3^2 - x5*x0, x5*x3 - x0^2, x4^2 - x3*x1, x5^2 - x3*x0,</span>
<span class="go">x1^3 - x4*x3*x0, x4*x1^2 - x5*x0^2) of Multivariate Polynomial Ring</span>
<span class="go">in x5, x4, x3, x2, x1, x0 over Rational Field</span>

<span class="go">The generators of the ideal:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
<span class="go">[x2 - x0,</span>
<span class="go"> x3^2 - x5*x0,</span>
<span class="go"> x5*x3 - x0^2,</span>
<span class="go"> x4^2 - x3*x1,</span>
<span class="go"> x5^2 - x3*x0,</span>
<span class="go"> x1^3 - x4*x3*x0,</span>
<span class="go"> x4*x1^2 - x5*x0^2]</span>

<span class="go">Its resolution:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">&#39;R^1 &lt;-- R^7 &lt;-- R^19 &lt;-- R^25 &lt;-- R^16 &lt;-- R^4&#39;</span>

<span class="go">and Betti table:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">           0     1     2     3     4     5</span>
<span class="go">------------------------------------------</span>
<span class="go">    0:     1     1     -     -     -     -</span>
<span class="go">    1:     -     4     6     2     -     -</span>
<span class="go">    2:     -     2     7     7     2     -</span>
<span class="go">    3:     -     -     6    16    14     4</span>
<span class="go">------------------------------------------</span>
<span class="go">total:     1     7    19    25    16     4</span>

<span class="go">The Hilbert function:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hilbert_function</span><span class="p">()</span>
<span class="go">[1, 5, 11, 15]</span>

<span class="go">and its first differences (which counts the number of superstable</span>
<span class="go">configurations in each degree):</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 4, 6, 4]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">superstables</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3]</span>

<span class="go">The degree in which the Hilbert function equals the Hilbert polynomial, the</span>
<span class="go">latter always being a constant in the case of a sandpile ideal:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">postulation</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</div>
<div class="section" id="zeros">
<h4>Zeros<a class="headerlink" href="#zeros" title="Permalink to this headline">¶</a></h4>
<p>The <em>zero set</em> for the sandpile ideal <span class="math">\(I\)</span> is</p>
<div class="math">
\[Z(I) = \{p\in\mathbb{C}^n: f(p)=0\mbox{ for all $f\in I$}\},\]</div>
<p>the set of simultaneous zeros of the polynomials in <span class="math">\(I.\)</span>  Letting <span class="math">\(S^1\)</span> denote
the unit circle in the complex plane, <span class="math">\(Z(I)\)</span> is a finite
subgroup of <span class="math">\(S^1\times\dots\times S^1\subset\mathbb{C}^n\)</span>, isomorphic to the
sandpile group.  The zero set is actually linearly isomorphic to a faithful representation of the sandpile group on <span class="math">\(\mathbb{C}^n.\)</span></p>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[x1^2 - x2^2, x1*x2^3 - x0^4, x2^5 - x1*x0^4]</span>

<span class="go">Approximation to the zero set (setting ``x_0 = 1``):</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">[[-0.707107 + 0.707107*I, 0.707107 - 0.707107*I],</span>
<span class="go">[-0.707107 - 0.707107*I, 0.707107 + 0.707107*I],</span>
<span class="go">[-I, -I],</span>
<span class="go">[I, I],</span>
<span class="go">[0.707107 + 0.707107*I, -0.707107 - 0.707107*I],</span>
<span class="go">[0.707107 - 0.707107*I, -0.707107 + 0.707107*I],</span>
<span class="go">[1, 1],</span>
<span class="go">[-1, -1]]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">True</span>

<span class="go">The zeros are generated as a group by a single vector:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">[[e^(1/4*I*pi), e^(-3/4*I*pi)]]</span>
</pre></div>
</div>
</div>
<div class="section" id="resolutions">
<h4>Resolutions<a class="headerlink" href="#resolutions" title="Permalink to this headline">¶</a></h4>
<p>The homogeneous sandpile ideal, <span class="math">\(I^h\)</span>, has a free resolution graded by the
divisors on <span class="math">\(\Gamma\)</span> modulo linear equivalence.  (See the section on
<a class="reference internal" href="#discrete-riemann-surfaces"><em>Discrete Riemann Surfaces</em></a> for the language of
divisors and linear equivalence.)  Let
<span class="math">\(S=\mathbb{C}[\Gamma]=\mathbb{C}[x_0,\dots,x_n]\)</span>, as above, and let
<span class="math">\(\mathfrak{S}\)</span> denote the group of divisors modulo rational equivalence.  Then
<span class="math">\(S\)</span> is graded by <span class="math">\(\mathfrak{S}\)</span> by letting <span class="math">\(\deg(x^c)= c\in\mathfrak{S}\)</span> for
each monomial <span class="math">\(x^c\)</span>.  The minimal free resolution of <span class="math">\(I^h\)</span> has the form</p>
<div class="math">
\[ 0\leftarrow I^h
\leftarrow\oplus_{D\in\mathfrak{S}}S(-D)^{\beta_{0,D}}\leftarrow\oplus_{D\in\mathfrak{S}}S(-D)^{\beta_{1,D}}
\leftarrow\dots\leftarrow\oplus_{D\in\mathfrak{S}}S(-D)^{\beta_{r,D}}\leftarrow0.\]</div>
<p>where the <span class="math">\(\beta_{i,D}\)</span> are the <em>Betti numbers</em> for <span class="math">\(I^h\)</span>.</p>
<p>For each divisor class <span class="math">\(D\in\mathfrak{S}\)</span>, define a simplicial complex,</p>
<div class="math">
\[\Delta_D := \{I\subseteq\{0,\dots,n\}: I\subseteq\mbox{supp}(E)\mbox{ for some}\
E\in |D|\}.\]</div>
<p>The Betti number <span class="math">\(\beta_{i,D}\)</span> equals the dimension over <span class="math">\(\mathbb{C}\)</span> of the
<span class="math">\(i\)</span>-th reduced homology group of <span class="math">\(\Delta_D\)</span>:</p>
<div class="math">
\[\beta_{i,D} = \dim_{\mathbb{C}}\tilde{H}_i(\Delta_D;\mathbb{C}).\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span><span class="mi">3</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span><span class="mi">0</span><span class="p">)</span>

<span class="go">Representatives of all divisor classes with nontrivial homology:</span>

<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">betti_complexes</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># optional - 4ti2</span>
<span class="go">[{0: -8, 1: 5, 2: 4, 3: 1},</span>
<span class="go"> Simplicial complex with vertex set (0, 1, 2, 3) and facets {(1, 2), (3,)}]</span>

<span class="go">The homology associated with the first divisor in the list:</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">[{0: 0, 1: 1, 2: 1, 3: 0}, {0: 0, 1: 0, 2: 0, 3: 2}]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">support</span><span class="p">()</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()]</span> <span class="c"># optional - 4ti2</span>
<span class="go">[[1, 2], [3]]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Dcomplex</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">Simplicial complex with vertex set (0, 1, 2, 3) and facets {(1, 2), (3,)}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Dcomplex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">{0: Z, 1: 0}</span>


<span class="go">The minimal free resolution:</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">&#39;R^1 &lt;-- R^5 &lt;-- R^5 &lt;-- R^1&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">           0     1     2     3</span>
<span class="go">------------------------------</span>
<span class="go">    0:     1     -     -     -</span>
<span class="go">    1:     -     5     5     -</span>
<span class="go">    2:     -     -     -     1</span>
<span class="go">------------------------------</span>
<span class="go">total:     1     5     5     1</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
<span class="go">11</span>

<span class="go">The degrees and ranks of the homology groups for each element of the list p</span>
<span class="go">(compare with the Betti table, above):</span>

<span class="gp">sage: </span><span class="p">[[</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">betti</span><span class="p">()]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span> <span class="c"># optional - 4ti2</span>
<span class="go">[[2, {0: 2, 1: 0}],</span>
<span class="go">[3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go">[2, {0: 2, 1: 0}],</span>
<span class="go">[3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go">[2, {0: 2, 1: 0}],</span>
<span class="go">[3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go">[2, {0: 2, 1: 0}],</span>
<span class="go">[3, {0: 1, 1: 1}],</span>
<span class="go">[2, {0: 2, 1: 0}],</span>
<span class="go">[3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go">[5, {0: 1, 1: 0, 2: 1}]]</span>
</pre></div>
</div>
</div>
<div class="section" id="complete-intersections-and-arithmetically-gorenstein-toppling-ideals">
<h4>Complete Intersections and Arithmetically Gorenstein toppling ideals<a class="headerlink" href="#complete-intersections-and-arithmetically-gorenstein-toppling-ideals" title="Permalink to this headline">¶</a></h4>
<p>NOTE: in the previous section note that the resolution always has length <span class="math">\(n\)</span> since
the ideal is Cohen-Macaulay.</p>
<p>To do.</p>
</div>
<div class="section" id="betti-numbers-for-undirected-graphs">
<h4>Betti numbers for undirected graphs<a class="headerlink" href="#betti-numbers-for-undirected-graphs" title="Permalink to this headline">¶</a></h4>
<p>To do.</p>
</div>
</div>
</div>
<div class="section" id="ti2-installation">
<span id="installation"></span><h2>4ti2 installation<a class="headerlink" href="#ti2-installation" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The methods for computing linear systems of divisors and their corresponding
simplicial complexes require the installation of 4ti2.</p>
</div>
<p>To install 4ti2:</p>
<dl class="docutils">
<dt>Go to the <a class="reference external" href="http://sagemath.org/download-packages.html">Sage website</a> and</dt>
<dd>look for the <em>precise name</em> of the 4ti2 package and install it according to
the instructions given there.  For instance, suppose the package is named
4ti2.p0.spkg.  Install the package with the following command from a UNIX shell
prompt:</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span> <span class="o">-</span><span class="n">i</span> <span class="mi">4</span><span class="n">ti2</span><span class="o">.</span><span class="n">p0</span>
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<p>There are three main classes for sandpile structures in Sage: <tt class="docutils literal"><span class="pre">Sandpile</span></tt>,
<tt class="docutils literal"><span class="pre">SandpileConfig</span></tt>, and <tt class="docutils literal"><span class="pre">SandpileDivisor</span></tt>.  Initialization for <tt class="docutils literal"><span class="pre">Sandpile</span></tt>
has the form</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">sink</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">graph</span></tt> represents a graph and <tt class="docutils literal"><span class="pre">sink</span></tt> is the key for the sink
vertex.  There are four possible forms for <tt class="docutils literal"><span class="pre">graph</span></tt>:</p>
<ol class="arabic">
<li><p class="first">a Python dictionary of dictionaries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="go">....:      3: {2: 1, 5: 1}, 4: {1: 1, 3: 1}, 5: {2: 1, 3: 1}}</span>
</pre></div>
</div>
</li>
</ol>
<div class="figure align-center">
<img alt="_images/initial.png" src="_images/initial.png" />
<p class="caption">Graph from dictionary of dictionaries.</p>
</div>
<p>Each key is the name of a vertex.  Next to each vertex name <span class="math">\(v\)</span> is a dictionary
consisting of pairs: <tt class="docutils literal"><span class="pre">vertex:</span> <span class="pre">weight</span></tt>.  Each pair represents a directed edge
emanating from <span class="math">\(v\)</span> and ending at <tt class="docutils literal"><span class="pre">vertex</span></tt> having (non-negative integer) weight
equal to <tt class="docutils literal"><span class="pre">weight</span></tt>.  Loops are allowed. In the example above, all of the weights are 1.</p>
<ol class="arabic" start="2">
<li><p class="first">a Python dictionary of lists:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="go">....:      3: [2, 5], 4: [1, 3], 5: [2, 3]}</span>
</pre></div>
</div>
</li>
</ol>
<p>This is a short-hand when all of the edge-weights are equal to 1.  The above
example is for the same displayed graph.</p>
<ol class="arabic" start="3">
<li><p class="first">a Sage graph (of type <tt class="docutils literal"><span class="pre">sage.graphs.graph.Graph</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.graphs.graph.Graph&#39;&gt;</span>
</pre></div>
</div>
</li>
</ol>
<p>To see the types of built-in graphs, type <tt class="docutils literal"><span class="pre">graphs.</span></tt>, including the period,
and hit TAB.</p>
<ol class="arabic" start="4">
<li><p class="first">a Sage digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNC</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
<div class="figure align-center">
<img alt="_images/random.png" src="_images/random.png" />
<p class="caption">A random graph.</p>
</div>
<p>See
<a class="reference external" href="../reference/sage/graphs/graph_generators.html">sage.graphs.graph_generators</a> for
more information on the Sage graph library and graph constructors.</p>
<p>Each of these four formats is preprocessed by the Sandpile class so that,
internally, the graph is represented by the dictionary of dictionaries format
first presented.  This internal format is returned by  <tt class="docutils literal"><span class="pre">dict()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {},</span>
<span class="go"> 1: {0: 1, 3: 1, 4: 1},</span>
<span class="go"> 2: {0: 1, 3: 1, 5: 1},</span>
<span class="go"> 3: {2: 1, 5: 1},</span>
<span class="go"> 4: {1: 1, 3: 1},</span>
<span class="go"> 5: {2: 1, 3: 1}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The user is responsible for assuring that each vertex has a directed path
into the designated sink.  If the sink has out-edges, these will be ignored
for the purposes of sandpile calculations (but not calculations on divisors).</p>
</div>
<p>Code for checking whether a given vertex is a sink:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">()]</span> <span class="c"># 0 is a sink</span>
<span class="go">[0, 1, 1, 2, 2, 2]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">()]</span> <span class="c"># 1 is not a sink</span>
<span class="go">[+Infinity, 0, +Infinity, +Infinity, 1, +Infinity]</span>
</pre></div>
</div>
</div>
<div class="section" id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<p>Here are summaries of <tt class="docutils literal"><span class="pre">Sandpile</span></tt>, <tt class="docutils literal"><span class="pre">SandpileConfig</span></tt>, and <tt class="docutils literal"><span class="pre">SandpileDivisor</span></tt> methods
(functions).  Each summary is followed by a list of complete descriptions of
the methods.  There are many more methods available for a Sandpile, e.g.,
those inherited from the class DiGraph.  To see them all, enter
<tt class="docutils literal"><span class="pre">dir(Sandpile)</span></tt> or type <tt class="docutils literal"><span class="pre">Sandpile.</span></tt>, including the period, and hit TAB.</p>
<div class="section" id="sandpile">
<h4>Sandpile<a class="headerlink" href="#sandpile" title="Permalink to this headline">¶</a></h4>
<p><strong>Summary of methods.</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#all-k-config-k"><em>all_k_config(k)</em></a> &#8212; The configuration with all values set to k.</li>
<li><a class="reference internal" href="#all-k-div-k"><em>all_k_div(k)</em></a> &#8212; The divisor with all values set to k.</li>
<li><a class="reference internal" href="#betti-verbose-true"><em>betti(verbose=True)</em></a> &#8212; The Betti table for the homogeneous sandpile ideal.</li>
<li><a class="reference internal" href="#betti-complexes"><em>betti_complexes()</em></a> &#8212; The divisors with nonempty linear systems along with their simplicial complexes.</li>
<li><a class="reference internal" href="#burning-config"><em>burning_config()</em></a> &#8212; A minimal burning configuration.</li>
<li><a class="reference internal" href="#burning-script"><em>burning_script()</em></a> &#8212; A script for the minimal burning configuration.</li>
<li><a class="reference internal" href="#canonical-divisor"><em>canonical_divisor()</em></a> &#8212; The canonical divisor (for undirected graphs).</li>
<li><a class="reference internal" href="#dict"><em>dict()</em></a> &#8212; A dictionary of dictionaries representing a directed graph.</li>
<li><a class="reference internal" href="#groebner"><em>groebner()</em></a> &#8212; Groebner basis for the homogeneous sandpile ideal with respect to the standard sandpile ordering.</li>
<li><a class="reference internal" href="#group-order"><em>group_order()</em></a> &#8212; The size of the sandpile group.</li>
<li><a class="reference internal" href="#h-vector"><em>h_vector()</em></a> &#8212; The first differences of the Hilbert function of the homogeneous sandpile ideal.</li>
<li><a class="reference internal" href="#hilbert-function"><em>hilbert_function()</em></a> &#8212; The Hilbert function of the homogeneous sandpile ideal.</li>
<li><a class="reference internal" href="#ideal-gens-false"><em>ideal(gens=False)</em></a> &#8212; The saturated, homogeneous sandpile ideal.</li>
<li><a class="reference internal" href="#identity"><em>identity()</em></a> &#8212; The identity configuration.</li>
<li><a class="reference internal" href="#in-degree-v-none"><em>in_degree(v=None)</em></a> &#8212; The in-degree of a vertex or a list of all in-degrees.</li>
<li><a class="reference internal" href="#invariant-factors"><em>invariant_factors()</em></a> &#8212; The invariant factors of the sandpile group (a finite abelian group).</li>
<li><a class="reference internal" href="#is-undirected"><em>is_undirected()</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">(u,v)</span></tt> is and edge if and only if <tt class="docutils literal"><span class="pre">(v,u)</span></tt> is an edges, each edge with the same weight.</li>
<li><a class="reference internal" href="#id7"><em>laplacian()</em></a> &#8212; The Laplacian matrix of the graph.</li>
<li><a class="reference internal" href="#max-stable"><em>max_stable()</em></a> &#8212; The maximal stable configuration.</li>
<li><a class="reference internal" href="#max-stable-div"><em>max_stable_div()</em></a> &#8212; The maximal stable divisor.</li>
<li><a class="reference internal" href="#max-superstables-verbose-true"><em>max_superstables(verbose=True)</em></a> &#8212; The maximal superstable configurations.</li>
<li><a class="reference internal" href="#min-recurrents-verbose-true"><em>min_recurrents(verbose=True)</em></a> &#8212; The minimal recurrent elements.</li>
<li><a class="reference internal" href="#nonsink-vertices"><em>nonsink_vertices()</em></a> &#8212; The names of the nonsink vertices.</li>
<li><a class="reference internal" href="#nonspecial-divisors-verbose-true"><em>nonspecial_divisors(verbose=True)</em></a> &#8212; The nonspecial divisors (only for undirected graphs).</li>
<li><a class="reference internal" href="#num-edges"><em>num_edges()</em></a> &#8212; The number of edges.</li>
<li><a class="reference internal" href="#num-verts"><em>num_verts()</em></a> &#8212; The number of vertices.</li>
<li><a class="reference internal" href="#out-degree-v-none"><em>out_degree(v=None)</em></a> &#8212; The out-degree of a vertex or a list of all out-degrees.</li>
<li><a class="reference internal" href="#points"><em>points()</em></a> &#8212; Generators for the multiplicative group of zeros of the sandpile ideal.</li>
<li><a class="reference internal" href="#postulation"><em>postulation()</em></a> &#8212; The postulation number of the sandpile ideal.</li>
<li><a class="reference internal" href="#recurrents-verbose-true"><em>recurrents(verbose=True)</em></a> &#8212; The list of recurrent configurations.</li>
<li><a class="reference internal" href="#reduced-laplacian"><em>reduced_laplacian()</em></a> &#8212; The reduced Laplacian matrix of the graph.</li>
<li><a class="reference internal" href="#reorder-vertices"><em>reorder_vertices()</em></a> &#8212; Create a copy of the sandpile but with the vertices reordered.</li>
<li><a class="reference internal" href="#resolution-verbose-false"><em>resolution(verbose=False)</em></a> &#8212; The minimal free resolution of the homogeneous sandpile ideal.</li>
<li><a class="reference internal" href="#ring"><em>ring()</em></a> &#8212; The ring containing the homogeneous sandpile ideal.</li>
<li><a class="reference internal" href="#show-kwds"><em>show(kwds)</em></a> &#8212; Draws the graph.</li>
<li><a class="reference internal" href="#show3d-kwds"><em>show3d(kwds)</em></a> &#8212; Draws the graph.</li>
<li><a class="reference internal" href="#sink"><em>sink()</em></a> &#8212; The identifier for the sink vertex.</li>
<li><a class="reference internal" href="#solve"><em>solve()</em></a> &#8212; Approximations of the complex affine zeros of the sandpile ideal.</li>
<li><a class="reference internal" href="#superstables-verbose-true"><em>superstables(verbose=True)</em></a> &#8212; The list of superstable configurations.</li>
<li><a class="reference internal" href="#symmetric-recurrents-orbits"><em>symmetric_recurrents(orbits)</em></a> &#8212; The list of symmetric recurrent configurations.</li>
<li><a class="reference internal" href="#unsaturated-ideal"><em>unsaturated_ideal()</em></a> &#8212; The unsaturated, homogeneous sandpile ideal.</li>
<li><a class="reference internal" href="#version"><em>version()</em></a> &#8212; The version number of Sage Sandpiles.</li>
<li><a class="reference internal" href="#vertices-key-none-boundary-first-false"><em>vertices(key=None, boundary_first=False)</em></a> &#8212; List of the vertices.</li>
<li><a class="reference internal" href="#zero-config"><em>zero_config()</em></a> &#8212; The all-zero configuration.</li>
<li><a class="reference internal" href="#zero-div"><em>zero_div()</em></a> &#8212; The all-zero divisor.</li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of Sandpile methods.</strong></p>
<p>&#8212;</p>
<p id="all-k-config-k"><strong>all_k_config(k)</strong></p>
<blockquote>
<div><p>The configuration with all values set to k.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">k</span></tt> - integer</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">all_k_config</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">{1: 7, 2: 7, 3: 7, 4: 7, 5: 7}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="all-k-div-k"><strong>all_k_div(k)</strong></p>
<blockquote>
<div><p>The divisor with all values set to k.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">k</span></tt> - integer</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">all_k_div</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">{0: 7, 1: 7, 2: 7, 3: 7, 4: 7, 5: 7}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="betti-verbose-true"><strong>betti(verbose=True)</strong></p>
<blockquote>
<div><p>Computes the Betti table for the homogeneous sandpile ideal.  If
<tt class="docutils literal"><span class="pre">verbose</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, it prints the standard Betti table,
otherwise, it returns a less formated table.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>Betti numbers for the sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">           0     1     2     3     4     5</span>
<span class="go">------------------------------------------</span>
<span class="go">    0:     1     1     -     -     -     -</span>
<span class="go">    1:     -     4     6     2     -     -</span>
<span class="go">    2:     -     2     7     7     2     -</span>
<span class="go">    3:     -     -     6    16    14     4</span>
<span class="go">------------------------------------------</span>
<span class="go">total:     1     7    19    25    16     4</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="c"># long time</span>
<span class="go">[1, 7, 19, 25, 16, 4]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="betti-complexes"><strong>betti_complexes()</strong></p>
<blockquote>
<div><p>A list of all the divisors with nonempty linear systems whose
corresponding simplicial complexes have nonzero homology in some
dimension.  Each such divisor is returned with its corresponding
simplicial complex.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list (of pairs [divisors, corresponding simplicial complex])</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span><span class="mi">3</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">betti_complexes</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># optional - 4ti2</span>
<span class="go">[{0: -8, 1: 5, 2: 4, 3: 1},</span>
<span class="go"> Simplicial complex with vertex set (0, 1, 2, 3) and facets {(1, 2), (3,)}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">&#39;R^1 &lt;-- R^5 &lt;-- R^5 &lt;-- R^1&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">           0     1     2     3</span>
<span class="go">------------------------------</span>
<span class="go">    0:     1     -     -     -</span>
<span class="go">    1:     -     5     5     -</span>
<span class="go">    2:     -     -     -     1</span>
<span class="go">------------------------------</span>
<span class="go">total:     1     5     5     1</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">{0: Z, 1: 0}</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">{0: 0, 1: 0, 2: Z}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="burning-config"><strong>burning_config()</strong></p>
<blockquote>
<div><p>A minimal burning configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>dict (configuration)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>\
<span class="go">           3:{2:1,5:1},4:{1:1,3:1},5:{2:1,3:1}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span>
<span class="go">{1: 2, 2: 0, 3: 1, 4: 1, 5: 0}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 0, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 5, 4: 1, 5: 4}</span>
<span class="gp">sage: </span><span class="n">script</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">script</span>
<span class="go">[1, 3, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">script</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[2 0 1 1 0]</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The burning configuration and script are computed using a modified
version of Speer&#8217;s script algorithm.  This is a generalization to
directed multigraphs of Dhar&#8217;s burning algorithm.</p>
<p>A <em>burning configuration</em> is a nonnegative integer-linear
combination of the rows of the reduced Laplacian matrix having
nonnegative entries and such that every vertex has a path from some
vertex in its support.  The corresponding <em>burning script</em> gives
the integer-linear combination needed to obtain the burning
configuration.  So if b is the burning configuration, sigma is its
script, and tilde{L} is the reduced Laplacian, then sigma *
tilde{L} = b.  The <em>minimal burning configuration</em> is the one with
the minimal script (its components are no larger than the
components of any other script for a burning configuration).</p>
<p>The following are equivalent for a configuration c with burning
configuration b having script sigma:</p>
<blockquote>
<div><ul class="simple">
<li>c is recurrent;</li>
<li>c+b stabilizes to c;</li>
<li>the firing vector for the stabilization of c+b is sigma.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>&#8212;</p>
<p id="burning-script"><strong>burning_script()</strong></p>
<blockquote>
<div><p>A script for the minimal burning configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>dict</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>\
<span class="go">3:{2:1,5:1},4:{1:1,3:1},5:{2:1,3:1}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span>
<span class="go">{1: 2, 2: 0, 3: 1, 4: 1, 5: 0}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 0, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 5, 4: 1, 5: 4}</span>
<span class="gp">sage: </span><span class="n">script</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">script</span>
<span class="go">[1, 3, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">script</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[2 0 1 1 0]</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The burning configuration and script are computed using a modified
version of Speer&#8217;s script algorithm.  This is a generalization to
directed multigraphs of Dhar&#8217;s burning algorithm.</p>
<p>A <em>burning configuration</em> is a nonnegative integer-linear
combination of the rows of the reduced Laplacian matrix having
nonnegative entries and such that every vertex has a path from some
vertex in its support.  The corresponding <em>burning script</em> gives
the integer-linear combination needed to obtain the burning
configuration. So if b is the burning configuration, s is its
script, and L_{mathrm{red}} is the reduced Laplacian, then s *
L_{mathrm{red}}= b.  The <em>minimal burning configuration</em> is the
one with the minimal script (its components are no larger than the
components of any other script for a burning configuration).</p>
<p>The following are equivalent for a configuration c with burning
configuration b having script s:</p>
<blockquote>
<div><ul class="simple">
<li>c is recurrent;</li>
<li>c+b stabilizes to c;</li>
<li>the firing vector for the stabilization of c+b is s.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>&#8212;</p>
<p id="canonical-divisor"><strong>canonical_divisor()</strong></p>
<blockquote>
<div><p>The canonical divisor: the divisor <tt class="docutils literal"><span class="pre">deg(v)-2</span></tt> grains of sand on
each vertex.  Only for undirected graphs.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="go">{0: 1, 1: 1, 2: 1, 3: 1}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="dict"><strong>dict()</strong></p>
<blockquote>
<div><p>A dictionary of dictionaries representing a directed graph.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>dict</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {},</span>
<span class="go"> 1: {0: 1, 3: 1, 4: 1},</span>
<span class="go"> 2: {0: 1, 3: 1, 5: 1},</span>
<span class="go"> 3: {2: 1, 5: 1},</span>
<span class="go"> 4: {1: 1, 3: 1},</span>
<span class="go"> 5: {2: 1, 3: 1}}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">sink</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="groebner"><strong>groebner()</strong></p>
<blockquote>
<div><p>A Groebner basis for the homogeneous sandpile ideal with respect to
the standard sandpile ordering (see <tt class="docutils literal"><span class="pre">ring</span></tt>).</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>Groebner basis</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">groebner</span><span class="p">()</span>
<span class="go">[x4*x1^2 - x5*x0^2, x1^3 - x4*x3*x0, x5^2 - x3*x0, x4^2 - x3*x1, x5*x3 - x0^2,</span>
<span class="go">x3^2 - x5*x0, x2 - x0]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="group-order"><strong>group_order()</strong></p>
<blockquote>
<div><p>The size of the sandpile group.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>int</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">15</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="h-vector"><strong>h_vector()</strong></p>
<blockquote>
<div><p>The first differences of the Hilbert function of the homogeneous
sandpile ideal.  It lists the number of superstable configurations
in each degree.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of nonnegative integers</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hilbert_function</span><span class="p">()</span>
<span class="go">[1, 5, 11, 15]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 4, 6, 4]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="hilbert-function"><strong>hilbert_function()</strong></p>
<blockquote>
<div><p>The Hilbert function of the homogeneous sandpile ideal.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of nonnegative integers</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hilbert_function</span><span class="p">()</span>
<span class="go">[1, 5, 11, 15]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="ideal-gens-false"><strong>ideal(gens=False)</strong></p>
<blockquote>
<div><p>The saturated, homogeneous sandpile ideal (or its generators if
<tt class="docutils literal"><span class="pre">gens=True</span></tt>).</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>ideal or, optionally, the generators of an ideal</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="go">Ideal (x2 - x0, x3^2 - x5*x0, x5*x3 - x0^2, x4^2 - x3*x1, x5^2 - x3*x0,</span>
<span class="go">x1^3 - x4*x3*x0, x4*x1^2 - x5*x0^2) of Multivariate Polynomial Ring</span>
<span class="go">in x5, x4, x3, x2, x1, x0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[x2 - x0, x3^2 - x5*x0, x5*x3 - x0^2, x4^2 - x3*x1, x5^2 - x3*x0,</span>
<span class="go">x1^3 - x4*x3*x0, x4*x1^2 - x5*x0^2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c"># another way to get the generators</span>
<span class="go">[x2 - x0, x3^2 - x5*x0, x5*x3 - x0^2, x4^2 - x3*x1, x5^2 - x3*x0,</span>
<span class="go">x1^3 - x4*x3*x0, x4*x1^2 - x5*x0^2]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="identity"><strong>identity()</strong></p>
<blockquote>
<div><p>The identity configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>dict (the identity configuration)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">e</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>  <span class="c"># stable addition</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">{1: 2, 2: 2, 3: 1, 4: 1, 5: 1}</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="in-degree-v-none"><strong>in_degree(v=None)</strong></p>
<blockquote>
<div><p>The in-degree of a vertex or a list of all in-degrees.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">v</span></tt> - vertex name or None</p>
<p>OUTPUT:</p>
<p>integer or dict</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span>
<span class="go">{0: 2, 1: 1, 2: 2, 3: 4, 4: 1, 5: 2}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="invariant-factors"><strong>invariant_factors()</strong></p>
<blockquote>
<div><p>The invariant factors of the sandpile group (a finite abelian
group).</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">invariant_factors</span><span class="p">()</span>
<span class="go">[1, 1, 1, 1, 15]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="is-undirected"><strong>is_undirected()</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">(u,v)</span></tt> is and edge if and only if <tt class="docutils literal"><span class="pre">(v,u)</span></tt> is an
edges, each edge with the same weight.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_undirected</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;gor&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_undirected</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="id7"><strong>laplacian()</strong></p>
<blockquote>
<div><p>The Laplacian matrix of the graph.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span>
<span class="go">[ 0  0  0  0  0  0]</span>
<span class="go">[-1  3  0 -1 -1  0]</span>
<span class="go">[-1  0  3 -1  0 -1]</span>
<span class="go">[ 0  0 -1  2  0 -1]</span>
<span class="go">[ 0 -1  0 -1  2  0]</span>
<span class="go">[ 0  0 -1 -1  0  2]</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The function <tt class="docutils literal"><span class="pre">laplacian_matrix</span></tt> should be avoided.  It returns
the indegree version of the laplacian.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="max-stable"><strong>max_stable()</strong></p>
<blockquote>
<div><p>The maximal stable configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileConfig (the maximal stable configuration)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 2, 2: 2, 3: 1, 4: 1, 5: 1}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="max-stable-div"><strong>max_stable_div()</strong></p>
<blockquote>
<div><p>The maximal stable divisor.</p>
<p>INPUT:</p>
<p>SandpileDivisor</p>
<p>OUTPUT:</p>
<p>SandpileDivisor (the maximal stable divisor)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable_div</span><span class="p">()</span>
<span class="go">{0: -1, 1: 2, 2: 2, 3: 1, 4: 1, 5: 1}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">{0: 0, 1: 3, 2: 3, 3: 2, 4: 2, 5: 2}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="max-superstables-verbose-true"><strong>max_superstables(verbose=True)</strong></p>
<blockquote>
<div><p>The maximal superstable configurations.  If the underlying graph is
undirected, these are the superstables of highest degree.  If
<tt class="docutils literal"><span class="pre">verbose</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, the configurations are converted to lists
of integers.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>list (of maximal superstables)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">=</span><span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;riemann-roch2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_superstables</span><span class="p">()</span>
<span class="go">[{1: 1, 2: 1, 3: 1}, {1: 0, 2: 0, 3: 2}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">superstables</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[0, 0, 0],</span>
<span class="go"> [1, 0, 1],</span>
<span class="go"> [1, 0, 0],</span>
<span class="go"> [0, 1, 1],</span>
<span class="go"> [0, 1, 0],</span>
<span class="go"> [1, 1, 0],</span>
<span class="go"> [0, 0, 1],</span>
<span class="go"> [1, 1, 1],</span>
<span class="go"> [0, 0, 2]]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 3, 4, 1]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="min-recurrents-verbose-true"><strong>min_recurrents(verbose=True)</strong></p>
<blockquote>
<div><p>The minimal recurrent elements.  If the underlying graph is
undirected, these are the recurrent elements of least degree.  If
<tt class="docutils literal"><span class="pre">verbose</span> <span class="pre">is</span> <span class="pre">``False</span></tt>, the configurations are converted to lists
of integers.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>list of SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">=</span><span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;riemann-roch2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">min_recurrents</span><span class="p">()</span>
<span class="go">[{1: 0, 2: 0, 3: 1}, {1: 1, 2: 1, 3: 0}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">min_recurrents</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[0, 0, 1], [1, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[1, 1, 2],</span>
<span class="go"> [0, 1, 1],</span>
<span class="go"> [0, 1, 2],</span>
<span class="go"> [1, 0, 1],</span>
<span class="go"> [1, 0, 2],</span>
<span class="go"> [0, 0, 2],</span>
<span class="go"> [1, 1, 1],</span>
<span class="go"> [0, 0, 1],</span>
<span class="go"> [1, 1, 0]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()]</span>
<span class="go">[4, 2, 3, 2, 3, 2, 3, 1, 2]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="nonsink-vertices"><strong>nonsink_vertices()</strong></p>
<blockquote>
<div><p>The names of the nonsink vertices.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>None</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="nonspecial-divisors-verbose-true"><strong>nonspecial_divisors(verbose=True)</strong></p>
<blockquote>
<div><p>The nonspecial divisors: those divisors of degree <tt class="docutils literal"><span class="pre">g-1</span></tt> with
empty linear system.  The term is only defined for undirected
graphs. Here, <tt class="docutils literal"><span class="pre">g</span> <span class="pre">=</span> <span class="pre">|E|</span> <span class="pre">-</span> <span class="pre">|V|</span> <span class="pre">+</span> <span class="pre">1</span></tt> is the genus of the graph.  If
<tt class="docutils literal"><span class="pre">verbose</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, the divisors are converted to lists of
integers.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>list (of divisors)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ns</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">nonspecial_divisors</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">[-1, 1, 0, 2]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">]</span> <span class="c"># optional - 4ti2</span>
<span class="go">[[], [], [], [], [], []]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="num-edges"><strong>num_edges()</strong></p>
<blockquote>
<div><p>The number of edges.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">15</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="num-verts"><strong>num_verts()</strong></p>
<blockquote>
<div><p>The number of vertices. Note that len(G) returns the number
of vertices in G also.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">10</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TetrahedralGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="out-degree-v-none"><strong>out_degree(v=None)</strong></p>
<blockquote>
<div><p>The out-degree of a vertex or a list of all out-degrees.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">v</span></tt> (optional) - vertex name</p>
<p>OUTPUT:</p>
<p>integer or dict</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">{0: 0, 1: 3, 2: 3, 3: 2, 4: 2, 5: 2}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="points"><strong>points()</strong></p>
<blockquote>
<div><p>Generators for the multiplicative group of zeros of the sandpile
ideal.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of complex numbers</p>
<p>EXAMPLES:</p>
<p>The sandpile group in this example is cyclic, and hence there is a
single generator for the group of solutions.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">[[e^(4/5*I*pi), 1, e^(2/3*I*pi), e^(-34/15*I*pi), e^(-2/3*I*pi)]]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="postulation"><strong>postulation()</strong></p>
<blockquote>
<div><p>The postulation number of the sandpile ideal.  This is the largest
weight of a superstable configuration of the graph.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>nonnegative integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">postulation</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="recurrents-verbose-true"><strong>recurrents(verbose=True)</strong></p>
<blockquote>
<div><p>The list of recurrent configurations. If <tt class="docutils literal"><span class="pre">verbose</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>,
the configurations are converted to lists of integers.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>list (of recurrent configurations)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()</span>
<span class="go">[{1: 2, 2: 2, 3: 1, 4: 1, 5: 1}, {1: 2, 2: 2, 3: 0, 4: 1, 5: 1},</span>
<span class="go">{1: 0, 2: 2, 3: 1, 4: 1, 5: 0}, {1: 0, 2: 2, 3: 1, 4: 1, 5: 1},</span>
<span class="go">{1: 1, 2: 2, 3: 1, 4: 1, 5: 1}, {1: 1, 2: 2, 3: 0, 4: 1, 5: 1},</span>
<span class="go">{1: 2, 2: 2, 3: 1, 4: 0, 5: 1}, {1: 2, 2: 2, 3: 0, 4: 0, 5: 1},</span>
<span class="go">{1: 2, 2: 2, 3: 1, 4: 0, 5: 0}, {1: 1, 2: 2, 3: 1, 4: 1, 5: 0},</span>
<span class="go">{1: 1, 2: 2, 3: 1, 4: 0, 5: 0}, {1: 1, 2: 2, 3: 1, 4: 0, 5: 1},</span>
<span class="go">{1: 0, 2: 2, 3: 0, 4: 1, 5: 1}, {1: 2, 2: 2, 3: 1, 4: 1, 5: 0},</span>
<span class="go">{1: 1, 2: 2, 3: 0, 4: 0, 5: 1}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[2, 2, 1, 1, 1], [2, 2, 0, 1, 1], [0, 2, 1, 1, 0], [0, 2, 1, 1, 1],</span>
<span class="go">[1, 2, 1, 1, 1], [1, 2, 0, 1, 1], [2, 2, 1, 0, 1], [2, 2, 0, 0, 1],</span>
<span class="go">[2, 2, 1, 0, 0], [1, 2, 1, 1, 0], [1, 2, 1, 0, 0], [1, 2, 1, 0, 1],</span>
<span class="go">[0, 2, 0, 1, 1], [2, 2, 1, 1, 0], [1, 2, 0, 0, 1]]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="reduced-laplacian"><strong>reduced_laplacian()</strong></p>
<blockquote>
<div><p>The reduced Laplacian matrix of the graph.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span>
<span class="go">[ 0  0  0  0  0  0]</span>
<span class="go">[-1  3  0 -1 -1  0]</span>
<span class="go">[-1  0  3 -1  0 -1]</span>
<span class="go">[ 0  0 -1  2  0 -1]</span>
<span class="go">[ 0 -1  0 -1  2  0]</span>
<span class="go">[ 0  0 -1 -1  0  2]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[ 3  0 -1 -1  0]</span>
<span class="go">[ 0  3 -1  0 -1]</span>
<span class="go">[ 0 -1  2  0 -1]</span>
<span class="go">[-1  0 -1  2  0]</span>
<span class="go">[ 0 -1 -1  0  2]</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>This is the Laplacian matrix with the row and column indexed by the
sink vertex removed.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="reorder-vertices"><strong>reorder_vertices()</strong></p>
<blockquote>
<div><p>Create a copy of the sandpile but with the vertices ordered
according to their distance from the sink, from greatest to least.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;kite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {}, 1: {0: 1, 2: 1,</span>
<span class="go">3: 1}, 2: {1: 1, 3: 1, 4: 1}, 3: {1: 1, 2: 1, 4: 1}, 4: {2: 1,</span>
<span class="go">3: 1}}</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">reorder_vertices</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {1: 1, 2: 1}, 1: {0: 1, 2: 1, 3: 1}, 2: {0: 1, 1: 1, 3: 1},</span>
<span class="go">3: {1: 1, 2: 1, 4: 1}, 4: {}}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="resolution-verbose-false"><strong>resolution(verbose=False)</strong></p>
<blockquote>
<div><p>This function computes a minimal free resolution of the homogeneous
sandpile ideal.  If <tt class="docutils literal"><span class="pre">verbose</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, then all of the
mappings are returned.  Otherwise, the resolution is summarized.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>free resolution of the sandpile ideal</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;gor&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">&#39;R^1 &lt;-- R^5 &lt;-- R^5 &lt;-- R^1&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[ x1^2 - x3*x0 x3*x1 - x2*x0  x3^2 - x2*x1  x2*x3 - x0^2  x2^2 - x1*x0],</span>
<span class="go">[ x3  x2   0  x0   0]  [ x2^2 - x1*x0]</span>
<span class="go">[-x1 -x3  x2   0 -x0]  [-x2*x3 + x0^2]</span>
<span class="go">[ x0  x1   0  x2   0]  [-x3^2 + x2*x1]</span>
<span class="go">[  0   0 -x1 -x3  x2]  [x3*x1 - x2*x0]</span>
<span class="go">[  0   0  x0  x1 -x3], [ x1^2 - x3*x0]</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="gp">sage: </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="ring"><strong>ring()</strong></p>
<blockquote>
<div><p>The ring containing the homogeneous sandpile ideal.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>ring</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in x5, x4, x3, x2, x1, x0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(x5, x4, x3, x2, x1, x0)</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The indeterminate xi corresponds to the i-th vertex as listed my
the method <tt class="docutils literal"><span class="pre">vertices</span></tt>. The term-ordering is degrevlex with
indeterminates ordered according to their distance from the sink
(larger indeterminates are further from the sink).</p>
</div></blockquote>
<p>&#8212;</p>
<p id="show-kwds"><strong>show(kwds)</strong></p>
<blockquote>
<div><p>Draws the graph.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">kwds</span></tt> - arguments passed to the show method for Graph or DiGraph</p>
<p>OUTPUT:</p>
<p>None</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">graph_border</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="show3d-kwds"><strong>show3d(kwds)</strong></p>
<blockquote>
<div><p>Draws the graph.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">kwds</span></tt> - arguments passed to the show method for Graph or DiGraph</p>
<p>OUTPUT:</p>
<p>None</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show3d</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="sink"><strong>sink()</strong></p>
<blockquote>
<div><p>The identifier for the sink vertex.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>Object (name for the sink vertex)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">sink</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">grid_sandpile</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">sink</span><span class="p">()</span>
<span class="go">&#39;sink&#39;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">sink</span><span class="p">())</span>
<span class="go">&lt;type &#39;str&#39;&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="solve"><strong>solve()</strong></p>
<blockquote>
<div><p>Approximations of the complex affine zeros of the sandpile ideal.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of complex numbers</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">[[-0.707107 + 0.707107*I, 0.707107 - 0.707107*I],</span>
<span class="go">[-0.707107 - 0.707107*I, 0.707107 + 0.707107*I],</span>
<span class="go">[-I, -I], [I, I], [0.707107 + 0.707107*I, -0.707107 - 0.707107*I],</span>
<span class="go">[0.707107 - 0.707107*I, -0.707107 + 0.707107*I], [1, 1], [-1, -1]]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The solutions form a multiplicative group isomorphic to the
sandpile group.  Generators for this group are given exactly by
<tt class="docutils literal"><span class="pre">points()</span></tt>.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="superstables-verbose-true"><strong>superstables(verbose=True)</strong></p>
<blockquote>
<div><p>The list of superstable configurations as dictionaries if
<tt class="docutils literal"><span class="pre">verbose</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, otherwise as lists of integers.  The
superstables are also known as G-parking functions.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>list (of superstable elements)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">superstables</span><span class="p">()</span>
<span class="go">[{1: 0, 2: 0, 3: 0, 4: 0, 5: 0},</span>
<span class="go"> {1: 0, 2: 0, 3: 1, 4: 0, 5: 0},</span>
<span class="go"> {1: 2, 2: 0, 3: 0, 4: 0, 5: 1},</span>
<span class="go"> {1: 2, 2: 0, 3: 0, 4: 0, 5: 0},</span>
<span class="go"> {1: 1, 2: 0, 3: 0, 4: 0, 5: 0},</span>
<span class="go"> {1: 1, 2: 0, 3: 1, 4: 0, 5: 0},</span>
<span class="go"> {1: 0, 2: 0, 3: 0, 4: 1, 5: 0},</span>
<span class="go"> {1: 0, 2: 0, 3: 1, 4: 1, 5: 0},</span>
<span class="go"> {1: 0, 2: 0, 3: 0, 4: 1, 5: 1},</span>
<span class="go"> {1: 1, 2: 0, 3: 0, 4: 0, 5: 1},</span>
<span class="go"> {1: 1, 2: 0, 3: 0, 4: 1, 5: 1},</span>
<span class="go"> {1: 1, 2: 0, 3: 0, 4: 1, 5: 0},</span>
<span class="go"> {1: 2, 2: 0, 3: 1, 4: 0, 5: 0},</span>
<span class="go"> {1: 0, 2: 0, 3: 0, 4: 0, 5: 1},</span>
<span class="go"> {1: 1, 2: 0, 3: 1, 4: 1, 5: 0}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">superstables</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[0, 0, 0, 0, 0],</span>
<span class="go"> [0, 0, 1, 0, 0],</span>
<span class="go"> [2, 0, 0, 0, 1],</span>
<span class="go"> [2, 0, 0, 0, 0],</span>
<span class="go"> [1, 0, 0, 0, 0],</span>
<span class="go"> [1, 0, 1, 0, 0],</span>
<span class="go"> [0, 0, 0, 1, 0],</span>
<span class="go"> [0, 0, 1, 1, 0],</span>
<span class="go"> [0, 0, 0, 1, 1],</span>
<span class="go"> [1, 0, 0, 0, 1],</span>
<span class="go"> [1, 0, 0, 1, 1],</span>
<span class="go"> [1, 0, 0, 1, 0],</span>
<span class="go"> [2, 0, 1, 0, 0],</span>
<span class="go"> [0, 0, 0, 0, 1],</span>
<span class="go"> [1, 0, 1, 1, 0]]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="symmetric-recurrents-orbits"><strong>symmetric_recurrents(orbits)</strong></p>
<blockquote>
<div><p>The list of symmetric recurrent configurations.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">orbits</span></tt> - list of lists partitioning the vertices</p>
<p>OUTPUT:</p>
<p>list of recurrent configurations</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;kite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {},</span>
<span class="go"> 1: {0: 1, 2: 1, 3: 1},</span>
<span class="go"> 2: {1: 1, 3: 1, 4: 1},</span>
<span class="go"> 3: {1: 1, 2: 1, 4: 1},</span>
<span class="go"> 4: {2: 1, 3: 1}}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">symmetric_recurrents</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">[{1: 2, 2: 2, 3: 2, 4: 1}, {1: 2, 2: 2, 3: 2, 4: 0}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()</span>
<span class="go">[{1: 2, 2: 2, 3: 2, 4: 1},</span>
<span class="go"> {1: 2, 2: 2, 3: 2, 4: 0},</span>
<span class="go"> {1: 2, 2: 1, 3: 2, 4: 0},</span>
<span class="go"> {1: 2, 2: 2, 3: 0, 4: 1},</span>
<span class="go"> {1: 2, 2: 0, 3: 2, 4: 1},</span>
<span class="go"> {1: 2, 2: 2, 3: 1, 4: 0},</span>
<span class="go"> {1: 2, 2: 1, 3: 2, 4: 1},</span>
<span class="go"> {1: 2, 2: 2, 3: 1, 4: 1}]</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The user is responsible for ensuring that the list of orbits comes
from a group of symmetries of the underlying graph.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="unsaturated-ideal"><strong>unsaturated_ideal()</strong></p>
<blockquote>
<div><p>The unsaturated, homogeneous sandpile ideal.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>ideal</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">unsaturated_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[x1^3 - x4*x3*x0, x2^3 - x5*x3*x0, x3^2 - x5*x2, x4^2 - x3*x1, x5^2 - x3*x2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[x2 - x0, x3^2 - x5*x0, x5*x3 - x0^2, x4^2 - x3*x1, x5^2 - x3*x0,</span>
<span class="go">x1^3 - x4*x3*x0, x4*x1^2 - x5*x0^2]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="version"><strong>version()</strong></p>
<blockquote>
<div><p>The version number of Sage Sandpiles.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>string</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
<span class="go">Sage Sandpiles Version 2.3</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="vertices-key-none-boundary-first-false"><strong>vertices(key=None, boundary_first=False)</strong></p>
<blockquote>
<div><p>A list of the vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">key</span></tt> - default: <tt class="docutils literal"><span class="pre">None</span></tt> - a function that takes a vertex as
its one argument and returns a value that can be used for
comparisons in the sorting algorithm.</li>
<li><tt class="docutils literal"><span class="pre">boundary_first</span></tt> - default:  <tt class="docutils literal"><span class="pre">False</span></tt> - if <tt class="docutils literal"><span class="pre">True</span></tt>, return
the boundary vertices first.</li>
</ul>
<p>OUTPUT:</p>
<p>The vertices of the list.</p>
<p>Warning: There is always an attempt to sort the list before returning the result. However, since any object may be a vertex, there is no guarantee that any two vertices will be comparable.  With default objects for vertices (all integers), or when all the vertices are of the same simple type, then there should not be a problem with how the vertices will be sorted. However, if you need to guarantee a total order for the sort, use the <tt class="docutils literal"><span class="pre">key</span></tt> argument, as illustrated in the examples below.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="zero-config"><strong>zero_config()</strong></p>
<blockquote>
<div><p>The all-zero configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_config</span><span class="p">()</span>
<span class="go">{1: 0, 2: 0, 3: 0, 4: 0, 5: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="zero-div"><strong>zero_div()</strong></p>
<blockquote>
<div><p>The all-zero divisor.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_div</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
</div>
<div class="section" id="sandpileconfig">
<h4>SandpileConfig<a class="headerlink" href="#sandpileconfig" title="Permalink to this headline">¶</a></h4>
<p><strong>Summary of methods.</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#id8"><em>+</em></a> &#8212; Addition of configurations.</li>
<li><a class="reference internal" href="#id9"><em>&amp;</em></a> &#8212; The stabilization of the sum.</li>
<li><a class="reference internal" href="#greater-equal"><em>greater-equal</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of <tt class="docutils literal"><span class="pre">other</span></tt>.</li>
<li><a class="reference internal" href="#greater"><em>greater</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of <tt class="docutils literal"><span class="pre">other</span></tt> and the two configurations are not equal.</li>
<li><a class="reference internal" href="#id10"><em>~</em></a> &#8212; The stabilized configuration.</li>
<li><a class="reference internal" href="#less-equal"><em>less-equal</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of <tt class="docutils literal"><span class="pre">other</span></tt>.</li>
<li><a class="reference internal" href="#less"><em>less</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of <tt class="docutils literal"><span class="pre">other</span></tt> and the two configurations are not equal.</li>
<li><a class="reference internal" href="#mul"><em>*</em></a> &#8212; The recurrent element equivalent to the sum.</li>
<li><a class="reference internal" href="#pow"><em>^</em></a> &#8212; Exponentiation for the *-operator.</li>
<li><a class="reference internal" href="#neg"><em>-</em></a> &#8212; The additive inverse of the configuration.</li>
<li><a class="reference internal" href="#id11"><em>-</em></a> &#8212; Subtraction of configurations.</li>
<li><a class="reference internal" href="#add-random"><em>add_random()</em></a> &#8212; Add one grain of sand to a random nonsink vertex.</li>
<li><a class="reference internal" href="#deg"><em>deg()</em></a> &#8212; The degree of the configuration.</li>
<li><a class="reference internal" href="#dualize"><em>dualize()</em></a> &#8212; The difference between the maximal stable configuration and the configuration.</li>
<li><a class="reference internal" href="#equivalent-recurrent-with-firing-vector-false"><em>equivalent_recurrent(with_firing_vector=False)</em></a> &#8212; The equivalent recurrent configuration.</li>
<li><a class="reference internal" href="#equivalent-superstable-with-firing-vector-false"><em>equivalent_superstable(with_firing_vector=False)</em></a> &#8212; The equivalent superstable configuration.</li>
<li><a class="reference internal" href="#fire-script-sigma"><em>fire_script(sigma)</em></a> &#8212; Fire the script <tt class="docutils literal"><span class="pre">sigma</span></tt>, i.e., fire each vertex the indicated number of times.</li>
<li><a class="reference internal" href="#fire-unstable"><em>fire_unstable()</em></a> &#8212; Fire all unstable vertices.</li>
<li><a class="reference internal" href="#fire-vertex-v"><em>fire_vertex(v)</em></a> &#8212; Fire the vertex <tt class="docutils literal"><span class="pre">v</span></tt>.</li>
<li><a class="reference internal" href="#is-recurrent"><em>is_recurrent()</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if the configuration is recurrent.</li>
<li><a class="reference internal" href="#is-stable"><em>is_stable()</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if stable.</li>
<li><a class="reference internal" href="#is-superstable"><em>is_superstable()</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">config</span></tt> is superstable.</li>
<li><a class="reference internal" href="#is-symmetric-orbits"><em>is_symmetric(orbits)</em></a> &#8212; Is the configuration constant over the vertices in each sublist of <tt class="docutils literal"><span class="pre">orbits</span></tt>?</li>
<li><a class="reference internal" href="#order"><em>order()</em></a> &#8212; The order of the recurrent element equivalent to <tt class="docutils literal"><span class="pre">config</span></tt>.</li>
<li><a class="reference internal" href="#id12"><em>sandpile()</em></a> &#8212; The configuration&#8217;s underlying sandpile.</li>
<li><a class="reference internal" href="#show-sink-true-colors-true-heights-false-directed-none-kwds"><em>show(sink=True,colors=True,heights=False,directed=None,kwds)</em></a> &#8212; Show the configuration.</li>
<li><a class="reference internal" href="#stabilize-with-firing-vector-false"><em>stabilize(with_firing_vector=False)</em></a> &#8212; The stabilized configuration.  Optionally returns the corresponding firing vector.</li>
<li><a class="reference internal" href="#support"><em>support()</em></a> &#8212; Keys of the nonzero values of the dictionary.</li>
<li><a class="reference internal" href="#unstable"><em>unstable()</em></a> &#8212; List of the unstable vertices.</li>
<li><a class="reference internal" href="#values"><em>values()</em></a> &#8212; The values of the configuration as a list.</li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of SandpileConfig methods.</strong></p>
<p>&#8212;</p>
<p id="id8"><strong>+</strong></p>
<blockquote>
<div><p>Addition of configurations.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>sum of <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">+</span> <span class="n">d</span>
<span class="go">{1: 4, 2: 4}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="id9"><strong>&amp;</strong></p>
<blockquote>
<div><p>The stabilization of the sum.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span>  <span class="c"># ordinary addition</span>
<span class="go">{1: 2, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&amp;</span> <span class="n">c</span>  <span class="c"># add and stabilize</span>
<span class="go">{1: 0, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">*</span><span class="n">c</span>  <span class="c"># add and find equivalent recurrent</span>
<span class="go">{1: 1, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="o">~</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span> <span class="o">&amp;</span> <span class="n">c</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="greater-equal"><strong>&gt;=</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of
<tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&gt;=</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">d</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">&gt;=</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">e</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="greater"><strong>&gt;</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of
<tt class="docutils literal"><span class="pre">other</span></tt> and the two configurations are not equal.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">d</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="id10"><strong>~</strong></p>
<blockquote>
<div><p>The stabilized configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">SandpileConfig</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">c</span>
<span class="go">{1: 2, 2: 2, 3: 1, 4: 1, 5: 1}</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">c</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="less-equal"><strong>&lt;=</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of
<tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&lt;=</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">e</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">&lt;=</span> <span class="n">c</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="less"><strong>&lt;</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of
<tt class="docutils literal"><span class="pre">other</span></tt> and the two configurations are not equal.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">c</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="mul"><strong>*</strong></p>
<blockquote>
<div><p>The recurrent element equivalent to the sum.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span>  <span class="c"># ordinary addition</span>
<span class="go">{1: 2, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&amp;</span> <span class="n">c</span>  <span class="c"># add and stabilize</span>
<span class="go">{1: 0, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">*</span><span class="n">c</span>  <span class="c"># add and find equivalent recurrent</span>
<span class="go">{1: 1, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="pow"><strong>^</strong></p>
<blockquote>
<div><p>The recurrent element equivalent to the sum of the configuration
with itself <tt class="docutils literal"><span class="pre">k</span></tt> times.  If <tt class="docutils literal"><span class="pre">k</span></tt> is negative, do the same for the
negation of the configuration.  If <tt class="docutils literal"><span class="pre">k</span></tt> is zero, return the
identity of the sandpile group.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">k</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="go">{1: 1, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">equivalent_recurrent</span><span class="p">()</span> <span class="o">==</span> <span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{1: 1, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="mi">0</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="neg"><strong>_</strong></p>
<blockquote>
<div><p>The additive inverse of the configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">c</span>
<span class="go">{1: -1, 2: -2}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="id11"><strong>-</strong></p>
<blockquote>
<div><p>Subtraction of configurations.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileConfig</p>
<p>OUTPUT:</p>
<p>sum of <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">-</span> <span class="n">d</span>
<span class="go">{1: -2, 2: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="add-random"><strong>add_random()</strong></p>
<blockquote>
<div><p>Add one grain of sand to a random nonsink vertex.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<p>We compute the &#8216;sizes&#8217; of the avalanches caused by adding random
grains of sand to the maximal stable configuration on a grid graph.
The function <tt class="docutils literal"><span class="pre">stabilize()</span></tt> returns the firing vector of the
stabilization, a dictionary whose values say how many times each
vertex fires in the stabilization.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">grid_sandpile</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
<span class="go">....:     m = m.add_random()</span>
<span class="go">....:     m, f = m.stabilize(True)</span>
<span class="go">....:     a.append(sum(f.values()))</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">list_plot</span><span class="p">([[</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">axes_labels</span><span class="p">([</span><span class="s">&#39;log(N)&#39;</span><span class="p">,</span><span class="s">&#39;log(D(N))&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s">&quot;Distribution of avalanche sizes&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">t</span><span class="p">,</span><span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;log(N)&#39;</span><span class="p">,</span><span class="s">&#39;log(D(N))&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="deg"><strong>deg()</strong></p>
<blockquote>
<div><p>The degree of the configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="dualize"><strong>dualize()</strong></p>
<blockquote>
<div><p>The difference between the maximal stable configuration and the
configuration.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 1, 2: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">{1: 0, 2: -1}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">-</span> <span class="n">c</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="equivalent-recurrent-with-firing-vector-false"><strong>equivalent_recurrent(with_firing_vector=False)</strong></p>
<blockquote>
<div><p>The recurrent configuration equivalent to the given configuration.
Optionally returns the corresponding firing vector.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">with_firing_vector</span></tt> (optional) -  boolean</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">SandpileConfig</span></tt> or <tt class="docutils literal"><span class="pre">[SandpileConfig,</span> <span class="pre">firing_vector]</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">equivalent_recurrent</span><span class="p">()</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">equivalent_recurrent</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">cv</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">==</span> <span class="n">cv</span> <span class="o">-</span> <span class="n">f</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>Let L be the reduced laplacian, c the initial configuration, r the
returned configuration, and f the firing vector.  Then r = c -
f * L.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="equivalent-superstable-with-firing-vector-false"><strong>equivalent_superstable(with_firing_vector=False)</strong></p>
<blockquote>
<div><p>The equivalent superstable configuration. Optionally returns the
corresponding firing vector.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">with_firing_vector</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">SandpileConfig</span></tt> or <tt class="docutils literal"><span class="pre">[SandpileConfig,</span> <span class="pre">firing_vector]</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">equivalent_superstable</span><span class="p">()</span><span class="o">.</span><span class="n">is_superstable</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">equivalent_superstable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">mv</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">==</span> <span class="n">mv</span> <span class="o">-</span> <span class="n">f</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>Let L be the reduced laplacian, c the initial configuration, s the
returned configuration, and f the firing vector.  Then s = c -
f * L.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="fire-script-sigma"><strong>fire_script(sigma)</strong></p>
<blockquote>
<div><p>Fire the script <tt class="docutils literal"><span class="pre">sigma</span></tt>, i.e., fire each vertex the indicated
number of times.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">sigma</span></tt> - SandpileConfig or (list or dict representing a SandpileConfig)</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_script</span><span class="p">(</span><span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">{1: 2, 2: 1, 3: 2}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_script</span><span class="p">(</span><span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="fire-unstable"><strong>fire_unstable()</strong></p>
<blockquote>
<div><p>Fire all unstable vertices.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_unstable</span><span class="p">()</span>
<span class="go">{1: 2, 2: 1, 3: 2}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="fire-vertex-v"><strong>fire_vertex(v)</strong></p>
<blockquote>
<div><p>Fire the vertex <tt class="docutils literal"><span class="pre">v</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">v</span></tt> - vertex</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">{1: 2, 2: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="is-recurrent"><strong>is_recurrent()</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if the configuration is recurrent.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_config</span><span class="p">()</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="is-stable"><strong>is_stable()</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if stable.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span><span class="o">.</span><span class="n">is_stable</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">())</span><span class="o">.</span><span class="n">is_stable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">())</span><span class="o">.</span><span class="n">is_stable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="is-superstable"><strong>is_superstable()</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">config</span></tt> is superstable, i.e., whether its dual is
recurrent.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_config</span><span class="p">()</span><span class="o">.</span><span class="n">is_superstable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="is-symmetric-orbits"><strong>is_symmetric(orbits)</strong></p>
<blockquote>
<div><p>This function checks if the values of the configuration are
constant over the vertices in each sublist of <tt class="docutils literal"><span class="pre">orbits</span></tt>.</p>
<p>INPUT:</p>
<blockquote>
<div><tt class="docutils literal"><span class="pre">orbits</span></tt> - list of lists of vertices</div></blockquote>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;kite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {},</span>
<span class="go"> 1: {0: 1, 2: 1, 3: 1},</span>
<span class="go"> 2: {1: 1, 3: 1, 4: 1},</span>
<span class="go"> 3: {1: 1, 2: 1, 4: 1},</span>
<span class="go"> 4: {2: 1, 3: 1}}</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="order"><strong>order()</strong></p>
<blockquote>
<div><p>The order of the recurrent element equivalent to <tt class="docutils literal"><span class="pre">config</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">config</span></tt> - configuration</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()]</span>
<span class="go">[3, 3, 5, 15, 15, 15, 5, 15, 15, 5, 15, 5, 15, 1, 15]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="id12"><strong>sandpile()</strong></p>
<blockquote>
<div><p>The configuration&#8217;s underlying sandpile.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;genus2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span>
<span class="go">Digraph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="show-sink-true-colors-true-heights-false-directed-none-kwds"><strong>show(sink=True,colors=True,heights=False,directed=None,kwds)</strong></p>
<blockquote>
<div><p>Show the configuration.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">sink</span></tt> - whether to show the sink</li>
<li><tt class="docutils literal"><span class="pre">colors</span></tt> - whether to color-code the amount of sand on each
vertex</li>
<li><tt class="docutils literal"><span class="pre">heights</span></tt> - whether to label each vertex with the amount of
sand</li>
<li><tt class="docutils literal"><span class="pre">kwds</span></tt> - arguments passed to the show method for Graph</li>
<li><tt class="docutils literal"><span class="pre">directed</span></tt> - whether to draw directed edges</li>
</ul>
<p>OUTPUT:</p>
<p>None</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">=</span><span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;genus2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">=</span><span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;genus2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">sink</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">heights</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="stabilize-with-firing-vector-false"><strong>stabilize(with_firing_vector=False)</strong></p>
<blockquote>
<div><p>The stabilized configuration.  Optionally returns the corresponding
firing vector.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">with_firing_vector</span></tt> (optional) -  boolean</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">SandpileConfig</span></tt> or <tt class="docutils literal"><span class="pre">[SandpileConfig,</span> <span class="pre">firing_vector]</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[{1: 2, 2: 2, 3: 1, 4: 1, 5: 1}, {1: 1, 2: 5, 3: 7, 4: 1, 5: 6}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">{1: 2, 2: 2, 3: 1, 4: 1, 5: 1}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">c</span>
<span class="go">{1: 2, 2: 2, 3: 1, 4: 1, 5: 1}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="support"><strong>support()</strong></p>
<blockquote>
<div><p>The input is a dictionary of integers.  The output is a list of
keys of nonzero values of the dictionary.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list - support of the config</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 2, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="unstable"><strong>unstable()</strong></p>
<blockquote>
<div><p>List of the unstable vertices.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of vertices</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="values"><strong>values()</strong></p>
<blockquote>
<div><p>The values of the configuration as a list, sorted in the order of
the vertices.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of integers</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">]},</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 2, &#39;b&#39;: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 1]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()</span>
<span class="go">[1, &#39;b&#39;]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
</div>
<div class="section" id="sandpiledivisor">
<h4>SandpileDivisor<a class="headerlink" href="#sandpiledivisor" title="Permalink to this headline">¶</a></h4>
<p><strong>Summary of methods.</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#divisor"><em>+</em></a> &#8212; Addition of divisors.</li>
<li><a class="reference internal" href="#greater-equal-divisor"><em>greater-equal</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of <tt class="docutils literal"><span class="pre">other</span></tt>.</li>
<li><a class="reference internal" href="#greater-divisor"><em>greater</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of <tt class="docutils literal"><span class="pre">other</span></tt> and the two divisors are not equal.</li>
<li><a class="reference internal" href="#less-equal-divisor"><em>less-equal</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of <tt class="docutils literal"><span class="pre">other</span></tt>.</li>
<li><a class="reference internal" href="#less-divisor"><em>less</em></a> &#8212; <tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of <tt class="docutils literal"><span class="pre">other</span></tt> and the two divisors are not equal.</li>
<li><a class="reference internal" href="#neg-divisor"><em>-</em></a> &#8212; The additive inverse of the divisor.</li>
<li><a class="reference internal" href="#sub-divisor"><em>-</em></a> &#8212; Subtraction of divisors.</li>
<li><a class="reference internal" href="#add-random-divisor"><em>add_random()</em></a> &#8212; Add one grain of sand to a random vertex.</li>
<li><a class="reference internal" href="#betti-divisor"><em>betti()</em></a> &#8212; The Betti numbers for the simplicial complex associated with the divisor.</li>
<li><a class="reference internal" href="#dcomplex"><em>Dcomplex()</em></a> &#8212; The simplicial complex determined by the supports of the linearly equivalent effective divisors.</li>
<li><a class="reference internal" href="#deg-divisor"><em>deg()</em></a> &#8212; The degree of the divisor.</li>
<li><a class="reference internal" href="#dualize-divisor"><em>dualize()</em></a> &#8212; The difference between the maximal stable divisor and the divisor.</li>
<li><a class="reference internal" href="#effective-div-verbose-true"><em>effective_div(verbose=True)</em></a> &#8212; All linearly equivalent effective divisors.</li>
<li><a class="reference internal" href="#fire-script-sigma-divisor"><em>fire_script(sigma)</em></a> &#8212; Fire the script <tt class="docutils literal"><span class="pre">sigma</span></tt>, i.e., fire each vertex the indicated number of times.</li>
<li><a class="reference internal" href="#fire-unstable-divisor"><em>fire_unstable()</em></a> &#8212; Fire all unstable vertices.</li>
<li><a class="reference internal" href="#fire-vertex-v-divisor"><em>fire_vertex(v)</em></a> &#8212; Fire the vertex <tt class="docutils literal"><span class="pre">v</span></tt>.</li>
<li><a class="reference internal" href="#is-alive-cycle-false"><em>is_alive(cycle=False)</em></a> &#8212; Will the divisor stabilize under repeated firings of all unstable vertices?</li>
<li><a class="reference internal" href="#is-symmetric-orbits-divisor"><em>is_symmetric(orbits)</em></a> &#8212; Is the divisor constant over the vertices in each sublist of <tt class="docutils literal"><span class="pre">orbits</span></tt>?</li>
<li><a class="reference internal" href="#linear-system"><em>linear_system()</em></a> &#8212; The complete linear system of a divisor.</li>
<li><a class="reference internal" href="#r-of-d-verbose-false"><em>r_of_D(verbose=False)</em></a> &#8212; Returns <tt class="docutils literal"><span class="pre">r(D)</span></tt>.</li>
<li><a class="reference internal" href="#sandpile-divisor"><em>sandpile()</em></a> &#8212; The divisor&#8217;s underlying sandpile.</li>
<li><a class="reference internal" href="#show-heights-true-directed-none-kwds-divisor"><em>show(heights=True,directed=None,kwds)</em></a> &#8212; Show the divisor.</li>
<li><a class="reference internal" href="#support-divisor"><em>support()</em></a> &#8212; List of keys of the nonzero values of the divisor.</li>
<li><a class="reference internal" href="#unstable-divisor"><em>unstable()</em></a> &#8212; List of the unstable vertices.</li>
<li><a class="reference internal" href="#values-divisor"><em>values()</em></a> &#8212; The values of the divisor as a list, sorted in the order of the vertices.</li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of SandpileDivisor methods.</strong></p>
<p>&#8212;</p>
<p id="divisor"><strong>+</strong></p>
<blockquote>
<div><p>Addition of divisors.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileDivisor</p>
<p>OUTPUT:</p>
<p>sum of <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">+</span> <span class="n">E</span>
<span class="go">{0: 4, 1: 4, 2: 4}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="greater-equal-divisor"><strong>&gt;=</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of
<tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;=</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&gt;=</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;=</span> <span class="n">E</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">&gt;=</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;=</span> <span class="n">F</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="greater-divisor"><strong>&gt;</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at least that of
<tt class="docutils literal"><span class="pre">other</span></tt> and the two divisors are not equal.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&gt;</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;</span> <span class="n">E</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="less-equal-divisor"><strong>&lt;=</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of
<tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;=</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;=</span> <span class="n">E</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&lt;=</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;=</span> <span class="n">F</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">&lt;=</span> <span class="n">D</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="less-divisor"><strong>&lt;</strong></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">True</span></tt> if every component of <tt class="docutils literal"><span class="pre">self</span></tt> is at most that of
<tt class="docutils literal"><span class="pre">other</span></tt> and the two divisors are not equal.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;</span> <span class="n">E</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&lt;</span> <span class="n">D</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="neg-divisor"><strong>-</strong></p>
<blockquote>
<div><p>The additive inverse of the divisor.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">D</span>
<span class="go">{0: -1, 1: -2, 2: -3}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="sub-divisor"><strong>-</strong></p>
<blockquote>
<div><p>Subtraction of divisors.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">other</span></tt> - SandpileDivisor</p>
<p>OUTPUT:</p>
<p>Difference of <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">-</span> <span class="n">E</span>
<span class="go">{0: -2, 1: 0, 2: 2}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="add-random-divisor"><strong>add_random()</strong></p>
<blockquote>
<div><p>Add one grain of sand to a random vertex.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_div</span><span class="p">()</span><span class="o">.</span><span class="n">add_random</span><span class="p">()</span>  <span class="c">#random</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 1, 4: 0, 5: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="betti-divisor"><strong>betti()</strong></p>
<blockquote>
<div><p>The Betti numbers for the simplicial complex associated with the
divisor.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>dictionary of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">{0: 1, 1: 1}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="dcomplex"><strong>Dcomplex()</strong></p>
<blockquote>
<div><p>The simplicial complex determined by the supports of the linearly
equivalent effective divisors.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>simplicial complex</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Dcomplex</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">{0: 0, 1: Z x Z, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">f_vector</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">[1, 6, 15, 9, 1]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">{0: 1, 1: 2, 2: 0, 3: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="deg-divisor"><strong>deg()</strong></p>
<blockquote>
<div><p>The degree of the divisor.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="dualize-divisor"><strong>dualize()</strong></p>
<blockquote>
<div><p>The difference between the maximal stable divisor and the divisor.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">{0: 0, 1: -1, 2: -2}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable_div</span><span class="p">()</span> <span class="o">-</span> <span class="n">D</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="effective-div-verbose-true"><strong>effective_div(verbose=True)</strong></p>
<blockquote>
<div><p>All linearly equivalent effective divisors.  If <tt class="docutils literal"><span class="pre">verbose</span></tt> is
<tt class="docutils literal"><span class="pre">False</span></tt>, the divisors are converted to lists of integers.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>list (of divisors)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">[{0: 1, 1: 0, 2: 0, 3: 1, 4: 0, 5: 0},</span>
<span class="go"> {0: 0, 1: 0, 2: 1, 3: 1, 4: 0, 5: 0},</span>
<span class="go"> {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 2}]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
<span class="go">[[1, 0, 0, 1, 0, 0], [0, 0, 1, 1, 0, 0], [0, 0, 0, 0, 0, 2]]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="fire-script-sigma-divisor"><strong>fire_script(sigma)</strong></p>
<blockquote>
<div><p>Fire the script <tt class="docutils literal"><span class="pre">sigma</span></tt>, i.e., fire each vertex the indicated
number of times.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">sigma</span></tt> - SandpileDivisor or (list or dict representing a SandpileDivisor)</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[1, 2]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_script</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">{0: 3, 1: 1, 2: 2}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_script</span><span class="p">(</span><span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="fire-unstable-divisor"><strong>fire_unstable()</strong></p>
<blockquote>
<div><p>Fire all unstable vertices.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_unstable</span><span class="p">()</span>
<span class="go">{0: 3, 1: 1, 2: 2}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="fire-vertex-v-divisor"><strong>fire_vertex(v)</strong></p>
<blockquote>
<div><p>Fire the vertex <tt class="docutils literal"><span class="pre">v</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">v</span></tt> - vertex</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{0: 2, 1: 0, 2: 4}</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="is-alive-cycle-false"><strong>is_alive(cycle=False)</strong></p>
<blockquote>
<div><p>Will the divisor stabilize under repeated firings of all unstable
vertices?  Optionally returns the resulting cycle.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">cycle</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>boolean or optionally, a list of SandpileDivisors</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_alive</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[{0: 4, 1: 3, 2: 3, 3: 2}, {0: 3, 1: 2, 2: 2, 3: 5}, {0: 1, 1: 4, 2: 4, 3: 3}]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="is-symmetric-orbits-divisor"><strong>is_symmetric(orbits)</strong></p>
<blockquote>
<div><p>This function checks if the values of the divisor are constant over
the vertices in each sublist of <tt class="docutils literal"><span class="pre">orbits</span></tt>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">orbits</span></tt> - list of lists of vertices</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;kite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {},</span>
<span class="go"> 1: {0: 1, 2: 1, 3: 1},</span>
<span class="go"> 2: {1: 1, 3: 1, 4: 1},</span>
<span class="go"> 3: {1: 1, 2: 1, 4: 1},</span>
<span class="go"> 4: {2: 1, 3: 1}}</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="linear-system"><strong>linear_system()</strong></p>
<blockquote>
<div><p>The complete linear system of a divisor.</p>
<p>INPUT: None</p>
<p>OUTPUT:</p>
<p>dict - <tt class="docutils literal"><span class="pre">{num_homog:</span> <span class="pre">int,</span> <span class="pre">homog:list,</span> <span class="pre">num_inhomog:int,</span>
<span class="pre">inhomog:list}</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">linear_system</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">{&#39;inhomog&#39;: [[0, 0, -1, -1, 0, -2], [0, 0, 0, 0, 0, -1], [0, 0, 0, 0, 0, 0]],</span>
<span class="go">&#39;num_inhomog&#39;: 3, &#39;num_homog&#39;: 2, &#39;homog&#39;: [[1, 0, 0, 0, 0, 0],</span>
<span class="go">[-1, 0, 0, 0, 0, 0]]}</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>If L is the Laplacian, an arbitrary v such that v * L&gt;= -D has
the form v = w + t where w is in <tt class="docutils literal"><span class="pre">inhomg</span></tt> and t is in the integer
span of <tt class="docutils literal"><span class="pre">homog</span></tt> in the output of <tt class="docutils literal"><span class="pre">linear_system(D)</span></tt>.</p>
<p>WARNING:</p>
<p>This method requires 4ti2.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="r-of-d-verbose-false"><strong>r_of_D(verbose=False)</strong></p>
<blockquote>
<div><p>Returns <tt class="docutils literal"><span class="pre">r(D)</span></tt> and, if <tt class="docutils literal"><span class="pre">verbose</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, an effective
divisor <tt class="docutils literal"><span class="pre">F</span></tt> such that <tt class="docutils literal"><span class="pre">|D</span> <span class="pre">-</span> <span class="pre">F|</span></tt> is empty.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">verbose</span></tt> (optional) - boolean</p>
<p>OUTPUT:</p>
<p>integer <tt class="docutils literal"><span class="pre">r(D)</span></tt> or tuple (integer <tt class="docutils literal"><span class="pre">r(D)</span></tt>, divisor <tt class="docutils literal"><span class="pre">F</span></tt>)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">r_of_D</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="c"># optional - 4ti2</span>
<span class="go">(1, {0: 0, 1: 1, 2: 0, 3: 1, 4: 0, 5: 0})</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">[0, -1, 0, -1, 0, 4]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">r_of_D</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
<span class="go">(-1, {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: -4})</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="sandpile-divisor"><strong>sandpile()</strong></p>
<blockquote>
<div><p>The divisor&#8217;s underlying sandpile.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;genus2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span>
<span class="go">Digraph on 4 vertices</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="show-heights-true-directed-none-kwds-divisor"><strong>show(heights=True,directed=None,kwds)</strong></p>
<blockquote>
<div><p>Show the divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">heights</span></tt> - whether to label each vertex with the amount of
sand</li>
<li><tt class="docutils literal"><span class="pre">kwds</span></tt> - arguments passed to the show method for Graph</li>
<li><tt class="docutils literal"><span class="pre">directed</span></tt> - whether to draw directed edges</li>
</ul>
<p>OUTPUT:</p>
<p>None</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;genus2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">graph_border</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span><span class="n">directed</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="support-divisor"><strong>support()</strong></p>
<blockquote>
<div><p>List of keys of the nonzero values of the divisor.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list - support of the divisor</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;generic&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 2, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="unstable-divisor"><strong>unstable()</strong></p>
<blockquote>
<div><p>List of the unstable vertices.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of vertices</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="values-divisor"><strong>values()</strong></p>
<blockquote>
<div><p>The values of the divisor as a list, sorted in the order of the
vertices.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of integers</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">]},</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">{&#39;a&#39;: 0, 1: 2, &#39;b&#39;: 1}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 0, 1]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[1, &#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="other">
<h4>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><a class="reference internal" href="#admissible-partitions-s-k"><em>admissible_partitions(S, k)</em></a> &#8212;
Partitions of the vertices into <tt class="docutils literal"><span class="pre">k</span></tt> parts, each of which is connected.</li>
<li><a class="reference internal" href="#aztec-sandpile-n"><em>aztec_sandpile(n)</em></a> &#8212; The aztec diamond graph.</li>
<li><a class="reference internal" href="#complete-sandpile-n"><em>complete_sandpile(n)</em></a> &#8212; Sandpile on the complete graph.</li>
<li><a class="reference internal" href="#firing-graph-s-eff"><em>firing_graph(S, eff)</em></a> &#8212; The
firing graph.</li>
<li><a class="reference internal" href="#firing-vector-s-d-e"><em>firing_vector(S,D,E)</em></a> &#8212; The firing vector
taking divisor <tt class="docutils literal"><span class="pre">D</span></tt> to divisor <tt class="docutils literal"><span class="pre">E</span></tt>.</li>
<li><a class="reference internal" href="#glue-graphs-g-h-glue-g-glue-h"><em>glue_graphs(g,h,glue_g,glue_h)</em></a> &#8212; Glue two sandpiles
together.</li>
<li><a class="reference internal" href="#grid-sandpile-m-n"><em>grid_sandpile(m,n)</em></a> &#8212; The <span class="math">\(m\times n\)</span> grid sandpile.</li>
<li><a class="reference internal" href="#min-cycles-g-v"><em>min_cycles(G,v)</em></a> &#8212; The minimal length cycles in
the digraph <tt class="docutils literal"><span class="pre">G</span></tt> starting at vertex <tt class="docutils literal"><span class="pre">v</span></tt>.</li>
<li><a class="reference internal" href="#parallel-firing-graph-s-eff"><em>parallel_firing_graph(S,eff)</em></a> &#8212; The
parallel-firing graph.</li>
<li><a class="reference internal" href="#partition-sandpile-s-p"><em>partition_sandpile(S,p)</em></a> &#8212; Sandpile formed
with vertices consisting of parts of an admissible partition.</li>
<li><a class="reference internal" href="#random-digraph-num-verts-p-1-2-directed-true-weight-max-1"><em>random_digraph(num_verts,p=1/2,directed=True,weight_max=1)</em></a> &#8212; A
random directed graph.</li>
<li><a class="reference internal" href="#random-dag-num-verts-p-1-2-weight-max-1"><em>random_DAG(num_verts,p=1/2,weight_max=1)</em></a> &#8212; A random directed acyclic graph.</li>
<li><a class="reference internal" href="#random-tree-n-d"><em>random_tree(n,d)</em></a> &#8212; Random tree sandpile.</li>
<li><a class="reference internal" href="#sandlib-selector-none"><em>sandlib(selector=None)</em></a> &#8212; A collection of sandpiles.</li>
<li><a class="reference internal" href="#triangle-sandpile-n"><em>triangle_sandpile(n)</em></a> &#8212; The triangle sandpile.</li>
<li><a class="reference internal" href="#wilmes-algorithm-m"><em>wilmes_algorithm(M)</em></a> &#8212; Find matrix with the
same integer row span as <tt class="docutils literal"><span class="pre">M</span></tt> that is the reduced Laplacian of a digraph.</li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of methods.</strong></p>
<p id="admissible-partitions-s-k"><strong>admissible_partitions(S, k)</strong></p>
<blockquote>
<div><p>The partitions of the vertices of <tt class="docutils literal"><span class="pre">S</span></tt> into <tt class="docutils literal"><span class="pre">k</span></tt> parts,
each of which is connected.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">S</span></tt> - Sandpile
<tt class="docutils literal"><span class="pre">k</span></tt> - integer</p>
<p>OUTPUT:</p>
<p>list of partitions</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">admissible_partitions</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[[{{0}, {1, 2, 3}},</span>
<span class="go">  {{0, 2, 3}, {1}},</span>
<span class="go">  {{0, 1, 3}, {2}},</span>
<span class="go">  {{0, 1, 2}, {3}},</span>
<span class="go">  {{0, 1}, {2, 3}},</span>
<span class="go">  {{0, 3}, {1, 2}}],</span>
<span class="go"> [{{0}, {1}, {2, 3}},</span>
<span class="go">  {{0}, {1, 2}, {3}},</span>
<span class="go">  {{0, 3}, {1}, {2}},</span>
<span class="go">  {{0, 1}, {2}, {3}}],</span>
<span class="go"> [{{0}, {1}, {2}, {3}}]]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">:</span> <span class="c"># long time</span>
<span class="go">....:     sum([partition_sandpile(S, i).betti(verbose=false)[-1] for i in p]) # long time</span>
<span class="go">6</span>
<span class="go">8</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>  <span class="c"># long time</span>
<span class="go">           0     1     2     3</span>
<span class="go">------------------------------</span>
<span class="go">    0:     1     -     -     -</span>
<span class="go">    1:     -     6     8     3</span>
<span class="go">------------------------------</span>
<span class="go">total:     1     6     8     3</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="aztec-sandpile-n"><strong>aztec(n)</strong></p>
<blockquote>
<div><p>The aztec diamond graph.</p>
<p>INPUT:</p>
<p>n - integer</p>
<p>OUTPUT:</p>
<p>dictionary for the aztec diamond graph</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">aztec_sandpile</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">{&#39;sink&#39;: {(-3/2, -1/2): 2,</span>
<span class="go">  (-3/2, 1/2): 2,</span>
<span class="go">  (-1/2, -3/2): 2,</span>
<span class="go">  (-1/2, 3/2): 2,</span>
<span class="go">  (1/2, -3/2): 2,</span>
<span class="go">  (1/2, 3/2): 2,</span>
<span class="go">  (3/2, -1/2): 2,</span>
<span class="go">  (3/2, 1/2): 2},</span>
<span class="go"> (-3/2, -1/2): {&#39;sink&#39;: 2, (-3/2, 1/2): 1, (-1/2, -1/2): 1},</span>
<span class="go"> (-3/2, 1/2): {&#39;sink&#39;: 2, (-3/2, -1/2): 1, (-1/2, 1/2): 1},</span>
<span class="go"> (-1/2, -3/2): {&#39;sink&#39;: 2, (-1/2, -1/2): 1, (1/2, -3/2): 1},</span>
<span class="go"> (-1/2, -1/2): {(-3/2, -1/2): 1,</span>
<span class="go">  (-1/2, -3/2): 1,</span>
<span class="go">  (-1/2, 1/2): 1,</span>
<span class="go">  (1/2, -1/2): 1},</span>
<span class="go"> (-1/2, 1/2): {(-3/2, 1/2): 1, (-1/2, -1/2): 1, (-1/2, 3/2): 1, (1/2, 1/2): 1},</span>
<span class="go"> (-1/2, 3/2): {&#39;sink&#39;: 2, (-1/2, 1/2): 1, (1/2, 3/2): 1},</span>
<span class="go"> (1/2, -3/2): {&#39;sink&#39;: 2, (-1/2, -3/2): 1, (1/2, -1/2): 1},</span>
<span class="go"> (1/2, -1/2): {(-1/2, -1/2): 1, (1/2, -3/2): 1, (1/2, 1/2): 1, (3/2, -1/2): 1},</span>
<span class="go"> (1/2, 1/2): {(-1/2, 1/2): 1, (1/2, -1/2): 1, (1/2, 3/2): 1, (3/2, 1/2): 1},</span>
<span class="go"> (1/2, 3/2): {&#39;sink&#39;: 2, (-1/2, 3/2): 1, (1/2, 1/2): 1},</span>
<span class="go"> (3/2, -1/2): {&#39;sink&#39;: 2, (1/2, -1/2): 1, (3/2, 1/2): 1},</span>
<span class="go"> (3/2, 1/2): {&#39;sink&#39;: 2, (1/2, 1/2): 1, (3/2, -1/2): 1}}</span>
<span class="gp">sage: </span><span class="n">Sandpile</span><span class="p">(</span><span class="n">aztec_sandpile</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;sink&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">4542720</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>This is the aztec diamond graph with a sink vertex added.  Boundary
vertices have edges to the sink so that each vertex has degree 4.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="complete-sandpile-n"><strong>complete_sandpile(n)</strong></p>
<blockquote>
<div><p>The sandpile on the complete graph with n vertices.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">n</span></tt> - positive integer</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">betti</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c"># long time</span>
<span class="go">[1, 15, 50, 60, 24]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="firing-graph-s-eff"><strong>firing_graph(S, eff)</strong></p>
<blockquote>
<div><p>Creates a digraph with divisors as vertices and edges between two
divisors <tt class="docutils literal"><span class="pre">D</span></tt> and <tt class="docutils literal"><span class="pre">E</span></tt> if firing a single vertex in <tt class="docutils literal"><span class="pre">D</span></tt> gives
<tt class="docutils literal"><span class="pre">E</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">S</span></tt> - sandpile
<tt class="docutils literal"><span class="pre">eff</span></tt> - list of divisors</p>
<p>OUTPUT:</p>
<p>DiGraph</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=.</span><span class="mo">005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span> <span class="c"># optional 4ti2</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="firing-vector-s-d-e"><strong>firing_vector(S,D,E)</strong></p>
<blockquote>
<div><p>If <tt class="docutils literal"><span class="pre">D</span></tt> and <tt class="docutils literal"><span class="pre">E</span></tt> are linearly equivalent divisors, find the firing vector
taking <tt class="docutils literal"><span class="pre">D</span></tt> to <tt class="docutils literal"><span class="pre">E</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">S</span></tt> -Sandpile</li>
<li><tt class="docutils literal"><span class="pre">D</span></tt>, <tt class="docutils literal"><span class="pre">E</span></tt> - tuples (representing linearly equivalent divisors)</li>
</ul>
<p>OUTPUT:</p>
<p>tuple (representing a firing vector from <tt class="docutils literal"><span class="pre">D</span></tt> to <tt class="docutils literal"><span class="pre">E</span></tt>)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">firing_vector</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">(0, 0, 2, 0)</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span><span class="o">*</span><span class="n">vector</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">vector</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The divisors must be linearly equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">complete_sandpile</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">firing_vector</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">zero_div</span><span class="p">())</span>
<span class="go">Error. Are the divisors linearly equivalent?</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="glue-graphs-g-h-glue-g-glue-h"><strong>glue_graphs(g,h,glue_g,glue_h)</strong></p>
<blockquote>
<div><p>Glue two graphs together.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">g</span></tt>, <tt class="docutils literal"><span class="pre">h</span></tt> - dictionaries for directed multigraphs</li>
<li><tt class="docutils literal"><span class="pre">glue_h</span></tt>, <tt class="docutils literal"><span class="pre">glue_g</span></tt> - dictionaries for a vertex</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<p>dictionary for a directed multigraph</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="gp">sage: </span><span class="n">glue_x</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="gp">sage: </span><span class="n">glue_y</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">glue_graphs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">glue_x</span><span class="p">,</span><span class="n">glue_y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">{0: {},</span>
<span class="go"> &#39;x0&#39;: {0: 1, &#39;x1&#39;: 1, &#39;x3&#39;: 2, &#39;y1&#39;: 2, &#39;y3&#39;: 1},</span>
<span class="go"> &#39;x1&#39;: {&#39;x0&#39;: 1},</span>
<span class="go"> &#39;x2&#39;: {&#39;x0&#39;: 1, &#39;x1&#39;: 1},</span>
<span class="go"> &#39;x3&#39;: {&#39;x0&#39;: 1, &#39;x1&#39;: 1, &#39;x2&#39;: 1},</span>
<span class="go"> &#39;y1&#39;: {0: 2},</span>
<span class="go"> &#39;y2&#39;: {&#39;y1&#39;: 2},</span>
<span class="go"> &#39;y3&#39;: {0: 1, &#39;y2&#39;: 1}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 6, 17, 31, 41, 41, 31, 17, 6, 1]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">&#39;R^1 &lt;-- R^7 &lt;-- R^21 &lt;-- R^35 &lt;-- R^35 &lt;-- R^21 &lt;-- R^7 &lt;-- R^1&#39;</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>This method makes a dictionary for a graph by combining those for <tt class="docutils literal"><span class="pre">g</span></tt> and
<tt class="docutils literal"><span class="pre">h</span></tt>.  The sink of <tt class="docutils literal"><span class="pre">g</span></tt> is replaced by a vertex that is connected to the
vertices of <tt class="docutils literal"><span class="pre">g</span></tt> as specified by <tt class="docutils literal"><span class="pre">glue_g</span></tt> the vertices of <tt class="docutils literal"><span class="pre">h</span></tt> as
specified in <tt class="docutils literal"><span class="pre">glue_h</span></tt>.  The sink of the glued graph is <span class="math">\(0\)</span>.</p>
<p>Both <tt class="docutils literal"><span class="pre">glue_g</span></tt> and <tt class="docutils literal"><span class="pre">glue_h</span></tt> are dictionaries with entries of the form
<tt class="docutils literal"><span class="pre">v:w</span></tt> where <tt class="docutils literal"><span class="pre">v</span></tt> is the vertex to be connected to and <tt class="docutils literal"><span class="pre">w</span></tt> is the weight
of the connecting edge.</p>
</div></blockquote>
<p>&#8212;</p>
<p id="grid-sandpile-m-n"><strong>grid_sandpile(m,n)</strong></p>
<blockquote>
<div><p>The mxn grid sandpile.  Each nonsink vertex has degree 4.</p>
<p>INPUT:
<tt class="docutils literal"><span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">n</span></tt> - positive integers</p>
<p>OUTPUT:
dictionary for a sandpile with sink named <tt class="docutils literal"><span class="pre">sink</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">grid_sandpile</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{&#39;sink&#39;: {},</span>
<span class="go"> (1, 1): {&#39;sink&#39;: 2, (1, 2): 1, (2, 1): 1},</span>
<span class="go"> (1, 2): {&#39;sink&#39;: 1, (1, 1): 1, (1, 3): 1, (2, 2): 1},</span>
<span class="go"> (1, 3): {&#39;sink&#39;: 1, (1, 2): 1, (1, 4): 1, (2, 3): 1},</span>
<span class="go"> (1, 4): {&#39;sink&#39;: 2, (1, 3): 1, (2, 4): 1},</span>
<span class="go"> (2, 1): {&#39;sink&#39;: 1, (1, 1): 1, (2, 2): 1, (3, 1): 1},</span>
<span class="go"> (2, 2): {(1, 2): 1, (2, 1): 1, (2, 3): 1, (3, 2): 1},</span>
<span class="go"> (2, 3): {(1, 3): 1, (2, 2): 1, (2, 4): 1, (3, 3): 1},</span>
<span class="go"> (2, 4): {&#39;sink&#39;: 1, (1, 4): 1, (2, 3): 1, (3, 4): 1},</span>
<span class="go"> (3, 1): {&#39;sink&#39;: 2, (2, 1): 1, (3, 2): 1},</span>
<span class="go"> (3, 2): {&#39;sink&#39;: 1, (2, 2): 1, (3, 1): 1, (3, 3): 1},</span>
<span class="go"> (3, 3): {&#39;sink&#39;: 1, (2, 3): 1, (3, 2): 1, (3, 4): 1},</span>
<span class="go"> (3, 4): {&#39;sink&#39;: 2, (2, 4): 1, (3, 3): 1}}</span>
<span class="gp">sage: </span><span class="n">grid_sandpile</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">4140081</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="min-cycles-g-v"><strong>min_cycles(G,v)</strong></p>
<blockquote>
<div><p>Minimal length cycles in the digraph <tt class="docutils literal"><span class="pre">G</span></tt> starting at vertex <tt class="docutils literal"><span class="pre">v</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">G</span></tt> - DiGraph
<tt class="docutils literal"><span class="pre">v</span></tt> - vertex of <tt class="docutils literal"><span class="pre">G</span></tt></p>
<p>OUTPUT:</p>
<p>list of lists of vertices</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">sandlib</span><span class="p">(</span><span class="s">&#39;gor&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">min_cycles</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">vertices</span><span class="p">()]</span>
<span class="go">[[], [[1, 3]], [[2, 3, 1], [2, 3]], [[3, 1], [3, 2]]]</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="parallel-firing-graph-s-eff"><strong>parallel_firing_graph(S,eff)</strong></p>
<blockquote>
<div><p>Creates a digraph with divisors as vertices and edges between two
divisors <tt class="docutils literal"><span class="pre">D</span></tt> and <tt class="docutils literal"><span class="pre">E</span></tt> if firing all unstable vertices in <tt class="docutils literal"><span class="pre">D</span></tt> gives
<tt class="docutils literal"><span class="pre">E</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">S</span></tt> - Sandpile
<tt class="docutils literal"><span class="pre">eff</span></tt> - list of divisors</p>
<p>OUTPUT:</p>
<p>DiGraph</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="c"># optional - 4ti2</span>
<span class="gp">sage: </span><span class="n">parallel_firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=.</span><span class="mo">005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span> <span class="c"># optional - 4ti2</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="partition-sandpile-s-p"><strong>partition_sandpile(S,p)</strong></p>
<blockquote>
<div><p>Each set of vertices in <tt class="docutils literal"><span class="pre">p</span></tt> is regarded as a single vertex, with and edge
between <tt class="docutils literal"><span class="pre">A</span></tt> and <tt class="docutils literal"><span class="pre">B</span></tt> if some element of <tt class="docutils literal"><span class="pre">A</span></tt> is connected by an edge
to  some element of <tt class="docutils literal"><span class="pre">B</span></tt> in <tt class="docutils literal"><span class="pre">S</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">S</span></tt> - Sandpile
<tt class="docutils literal"><span class="pre">p</span></tt> - partition of the vertices of <tt class="docutils literal"><span class="pre">S</span></tt></p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">admissible_partitions</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">:</span>  <span class="c">#long time</span>
<span class="go">....:     sum([partition_sandpile(S, i).betti(verbose=false)[-1] for i in p]) # long time</span>
<span class="go">6</span>
<span class="go">8</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">           0     1     2     3</span>
<span class="go">------------------------------</span>
<span class="go">    0:     1     -     -     -</span>
<span class="go">    1:     -     6     8     3</span>
<span class="go">------------------------------</span>
<span class="go">total:     1     6     8     3</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="random-digraph-num-verts-p-1-2-directed-true-weight-max-1"><strong>random_digraph(num_verts,p=1/2,directed=True,weight_max=1)</strong></p>
<blockquote>
<div><p>A random weighted digraph with a directed spanning tree rooted at <span class="math">\(0\)</span>.  If
<tt class="docutils literal"><span class="pre">directed</span> <span class="pre">=</span> <span class="pre">False</span></tt>, the only difference is that if <span class="math">\((i,j,w)\)</span> is an edge with
tail <span class="math">\(i\)</span>, head <span class="math">\(j\)</span>, and weight <span class="math">\(w\)</span>, then <span class="math">\((j,i,w)\)</span> appears also.  The result
is returned as a Sage digraph.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">num_verts</span></tt> - number of vertices</li>
<li><tt class="docutils literal"><span class="pre">p</span></tt> - probability edges occur</li>
<li><tt class="docutils literal"><span class="pre">directed</span></tt> - True if directed</li>
<li><tt class="docutils literal"><span class="pre">weight_max</span></tt> - integer maximum for random weights</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<p>random graph</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">random_digraph</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="random-dag-num-verts-p-1-2-weight-max-1"><strong>random_DAG(num_verts,p=1/2,weight_max=1)</strong></p>
<blockquote>
<div><p>Returns a random directed acyclic graph with <tt class="docutils literal"><span class="pre">num_verts</span></tt> vertices.
The method starts with the sink vertex and adds vertices one at a time.
Each vertex is connected only to only previously defined vertices, and the
probability of each possible connection is given by the argument <tt class="docutils literal"><span class="pre">p</span></tt>.
The weight of an edge is a random integer between <tt class="docutils literal"><span class="pre">1</span></tt> and
<tt class="docutils literal"><span class="pre">weight_max</span></tt>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">num_verts</span></tt> - positive integer</li>
<li><tt class="docutils literal"><span class="pre">p</span></tt> - number between <span class="math">\(0\)</span> and <span class="math">\(1\)</span></li>
<li><tt class="docutils literal"><span class="pre">weight_max</span></tt> &#8211; integer greater than <span class="math">\(0\)</span></li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<p>directed acyclic graph with sink <span class="math">\(0\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">random_DAG</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="random-tree-n-d"><strong>random_tree(n,d)</strong></p>
<blockquote>
<div><p>Returns a random undirected tree with <tt class="docutils literal"><span class="pre">n</span></tt> nodes, no node having
degree higher than <tt class="docutils literal"><span class="pre">d</span></tt>.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">n</span></tt>, <tt class="docutils literal"><span class="pre">d</span></tt> - integers</p>
<p>OUTPUT:</p>
<p>Graph</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">random_tree</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">reorder_vertices</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="n">U</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="sandlib-selector-none"><strong>sandlib(selector=None)</strong></p>
<blockquote>
<div><p>The sandpile identified by <tt class="docutils literal"><span class="pre">selector</span></tt>.  If no argument is
given, a description of the sandpiles in the sandlib is printed.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">selector</span></tt> - identifier or None</p>
<p>OUTPUT:</p>
<p>sandpile or description</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sandlib</span><span class="p">()</span>
<span class="go">  Sandpiles in the sandlib:</span>
<span class="go">     kite : generic undirected graphs with 5 vertices</span>
<span class="go">     generic : generic digraph with 6 vertices</span>
<span class="go">     genus2 : Undirected graph of genus 2</span>
<span class="go">     ci1 : complete intersection, non-DAG but  equivalent to a DAG</span>
<span class="go">     riemann-roch1 : directed graph with postulation 9 and 3 maximal weight superstables</span>
<span class="go">     riemann-roch2 : directed graph with a superstable not majorized by a maximal superstable</span>
<span class="go">     gor : Gorenstein but not a complete intersection</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="triangle-sandpile-n"><strong>triangle(n)</strong></p>
<blockquote>
<div><p>A triangular sandpile.  Each nonsink vertex has out-degree six.  The
vertices on the boundary of the triangle are connected to the sink.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">n</span></tt> - int</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">triangle_sandpile</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">135418115000</span>
</pre></div>
</div>
</div></blockquote>
<p>&#8212;</p>
<p id="wilmes-algorithm-m"><strong>wilmes_algorithm(M)</strong></p>
<blockquote>
<div><p>Computes an integer matrix <tt class="docutils literal"><span class="pre">L</span></tt> with the same integer row span as <tt class="docutils literal"><span class="pre">M</span></tt>
and such that <tt class="docutils literal"><span class="pre">L</span></tt> is the reduced laplacian of a directed multigraph.</p>
<p>INPUT:</p>
<p><tt class="docutils literal"><span class="pre">M</span></tt> - square integer matrix of full rank</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">L</span></tt> - integer matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">wilmes_algorithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">[ 1642   -13 -1627    -1]</span>
<span class="go">[   -1  1980 -1582  -397]</span>
<span class="go">[    0    -1  1650 -1649]</span>
<span class="go">[    0     0 -1658  1658]</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The algorithm is due to John Wilmes.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="help">
<h3>Help<a class="headerlink" href="#help" title="Permalink to this headline">¶</a></h3>
<p>Documentation for each method is available through the Sage online help system:</p>
<div class="highlight-python"><div class="highlight"><pre>sage: SandpileConfig.fire_vertex?
Base Class:     &lt;type &#39;instancemethod&#39;&gt;
String Form:    &lt;unbound method SandpileConfig.fire_vertex&gt;
Namespace:      Interactive
File:           /usr/local/sage-4.7/local/lib/python2.6/site-packages/sage/sandpiles/sandpile.py
Definition:     SandpileConfig.fire_vertex(self, v)
Docstring:
       Fire the vertex ``v``.

       INPUT:

       ``v`` - vertex

       OUTPUT:

       SandpileConfig

       EXAMPLES:

          sage: S = Sandpile(graphs.CycleGraph(3), 0)
          sage: c = SandpileConfig(S, [1,2])
          sage: c.fire_vertex(2)
          {1: 2, 2: 0}
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An alternative to <tt class="docutils literal"><span class="pre">SandpileConfig.fire_vertex?</span></tt> in the preceding code example
would be <tt class="docutils literal"><span class="pre">c.fire_vertex?</span></tt>, if <tt class="docutils literal"><span class="pre">c</span></tt> is any SandpileConfig.</p>
</div>
<p>General Sage documentation can be found at <a class="reference external" href="http://sagemath.org/doc/">http://sagemath.org/doc/</a>.</p>
</div>
</div>
<div class="section" id="contact">
<h2>Contact<a class="headerlink" href="#contact" title="Permalink to this headline">¶</a></h2>
<p>Please contact <a class="reference external" href="mailto:davidp&#37;&#52;&#48;reed&#46;edu">davidp<span>&#64;</span>reed<span>&#46;</span>edu</a> with questions, bug reports, and suggestions for
additional features and other improvements.</p>
<table class="docutils citation" frame="void" id="bn" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[BN]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> Matthew Baker, Serguei Norine, <a class="reference external" href="http://people.math.gatech.edu/~mbaker/papers.html">Riemann-Roch and Abel-Jacobi Theory on a Finite Graph</a>, Advances in Mathematics 215 (2007), 766&#8211;788.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="btw" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[BTW]</a></td><td>Per Bak, Chao Tang and Kurt Wiesenfeld (1987). <em>Self-organized criticality: an explanation of 1/ƒ noise</em>, Physical Review Letters 60: 381–384 <a class="reference external" href="http://en.wikipedia.org/wiki/Bak-Tang-Wiesenfeld_sandpile">Wikipedia article</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="crs" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[CRS]</a></td><td>Robert Cori, Dominique Rossin, and Bruno Salvy, <em>Polynomial ideals for sandpiles and their Gröbner bases</em>, Theoretical Computer Science, 276 (2002) no. 1&#8211;2, 1&#8211;15.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="h" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[H]</a></td><td>Holroyd, Levine, Meszaros, Peres, Propp, Wilson, <a class="reference external" href="http://front.math.ucdavis.edu/0801.3306">Chip-Firing and Rotor-Routing on Directed Graphs</a>. The final version of this paper appears in <em>In and out of Equilibrium II</em>, Eds. V. Sidoravicius, M. E. Vares, in the Series Progress in Probability, Birkhauser (2008).</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Abelian Sandpile Model</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#configurations-and-divisors">Configurations and divisors</a></li>
<li><a class="reference internal" href="#stabilization">Stabilization</a></li>
<li><a class="reference internal" href="#laplacian">Laplacian</a></li>
<li><a class="reference internal" href="#recurrent-elements">Recurrent elements</a></li>
<li><a class="reference internal" href="#burning-configuration">Burning Configuration</a></li>
<li><a class="reference internal" href="#sandpile-group">Sandpile group</a></li>
<li><a class="reference internal" href="#self-organized-criticality">Self-organized criticality</a></li>
<li><a class="reference internal" href="#divisors-and-discrete-riemann-surfaces">Divisors and Discrete Riemann surfaces</a><ul>
<li><a class="reference internal" href="#riemann-roch">Riemann-Roch</a></li>
<li><a class="reference internal" href="#picturing-linear-systems">Picturing linear systems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#algebraic-geometry-of-sandpiles">Algebraic geometry of sandpiles</a><ul>
<li><a class="reference internal" href="#affine">Affine</a></li>
<li><a class="reference internal" href="#projective">Projective</a></li>
<li><a class="reference internal" href="#zeros">Zeros</a></li>
<li><a class="reference internal" href="#resolutions">Resolutions</a></li>
<li><a class="reference internal" href="#complete-intersections-and-arithmetically-gorenstein-toppling-ideals">Complete Intersections and Arithmetically Gorenstein toppling ideals</a></li>
<li><a class="reference internal" href="#betti-numbers-for-undirected-graphs">Betti numbers for undirected graphs</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#ti2-installation">4ti2 installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#initialization">Initialization</a></li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#sandpile">Sandpile</a></li>
<li><a class="reference internal" href="#sandpileconfig">SandpileConfig</a></li>
<li><a class="reference internal" href="#sandpiledivisor">SandpileDivisor</a></li>
<li><a class="reference internal" href="#other">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#help">Help</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contact">Contact</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="tutorial-notebook-and-help-long.html"
                                  title="previous chapter">Tutorial: Using the Sage notebook, navigating the help system, first exercises</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="group_theory.html"
                                  title="next chapter">Group Theory and Sage</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/sandpile.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <!-- The shading of the "Go" button should be consistent -->
                <!-- with the colour of the header and footer. See the file -->
                <!-- doc/common/themes/sage/theme.conf for colours used by -->
                <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="group_theory.html" title="Group Theory and Sage"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial-notebook-and-help-long.html" title="Tutorial: Using the Sage notebook, navigating the help system, first exercises"
             >previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="index.html">Thematic Tutorials v6.7</a> &raquo;</li>

          <li><a href="toctree.html" >Thematic tutorial document tree</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>