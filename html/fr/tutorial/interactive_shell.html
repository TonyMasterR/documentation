<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>La ligne de commande interactive &mdash; Tutoriel Sage v7.0</title>
    
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Tutoriel Sage v7.0" href="index.html" />
    <link rel="next" title="Interfaces" href="interfaces.html" />
    <link rel="prev" title="Quelques mathématiques plus avancées" href="tour_advanced.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="interfaces.html" title="Interfaces"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="tour_advanced.html" title="Quelques mathématiques plus avancées"
             accesskey="P">précédent</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="index.html">Tutoriel Sage v7.0</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="la-ligne-de-commande-interactive">
<span id="chapter-interactive-shell"></span><h1>La ligne de commande interactive<a class="headerlink" href="#la-ligne-de-commande-interactive" title="Lien permanent vers ce titre">¶</a></h1>
<p>Dans la plus grande partie de ce tutoriel, nous supposons que vous avez
lancé l&#8217;interpréteur Sage avec la commande <tt class="docutils literal"><span class="pre">sage</span></tt>. Cela démarre une
version adaptée du shell (interpréteur de commandes) IPython et importe
un grand nombre de fonctions et de classes qui sont ainsi prêtes à
l&#8217;emploi depuis l&#8217;invite de commande. D&#8217;autres personnalisations sont
possibles en éditant le fichier <tt class="docutils literal"><span class="pre">$SAGE_ROOT/ipythonrc</span></tt>. Au démarrage,
le shell Sage affiche un message de ce genre :</p>
<div class="highlight-python"><div class="highlight"><pre>----------------------------------------------------------------------
| SAGE Version 3.1.1, Release Date: 2008-05-24                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------


sage:
</pre></div>
</div>
<p>Pour quitter Sage, tapez Ctrl-D ou tapez <tt class="docutils literal"><span class="pre">quit</span></tt> ou <tt class="docutils literal"><span class="pre">exit</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quit</span>
<span class="go">Exiting SAGE (CPU time 0m0.00s, Wall time 0m0.89s)</span>
</pre></div>
</div>
<p>L&#8217;indication <em>wall time</em> donne le temps écoulé à votre montre (ou
l&#8217;horloge suspendue au mur) pendant l&#8217;exécution. C&#8217;est une donnée
pertinente car le temps processeur (<em>CPU time</em>) ne tient pas compte du
temps utilisé par les sous-processus comme GAP et Singular.</p>
<p>(Il vaut mieux éviter de tuer un processus Sage depuis un terminal avec
<tt class="docutils literal"><span class="pre">kill</span> <span class="pre">-9</span></tt>, car il est possible que Sage ne tue pas ses processus
enfants, par exemple des processus Maple qu&#8217;il aurait lancés, ou encore
qu&#8217;il ne nettoie pas les fichiers temporaires de
<tt class="docutils literal"><span class="pre">$HOME/.sage/tmp</span></tt>.)</p>
<div class="section" id="votre-session-sage">
<h2>Votre session Sage<a class="headerlink" href="#votre-session-sage" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une session est la suite des entrées et sorties qui interviennent entre
le moment où vous démarrez Sage et celui où vous le quittez. Sage
enregistre un journal de toutes les entrées via IPython. Si vous
utilisez le shell interactif (par opposition à l&#8217;interface <em>notebook</em>),
vous pouvez taper <tt class="docutils literal"><span class="pre">%history</span></tt> (ou <tt class="docutils literal"><span class="pre">%hist</span></tt>) à n&#8217;importe
quel moment pour obtenir la
liste de toutes les lignes de commandes entrées depuis le début de la
session. Tapez <tt class="docutils literal"><span class="pre">?</span></tt> à l&#8217;invite de commande Sage pour plus
d&#8217;informations sur IPython. Par exemple : « IPython fournit des invites
de commande numérotées [...] avec un cache des entrées-sorties. Toutes
les entrées sont sauvegardées et peuvent être rappelées comme variables
(en plus de la navigation habituelle dans l&#8217;historique avec les flèches
du clavier). Les variables GLOBALES suivantes existent toujours (ne les
écrasez pas !) » :</p>
<div class="highlight-python"><div class="highlight"><pre>_ : dernière entrée (shell et notebook)
__ : avant-dernière entrée (shell uniquement)
_oh : liste de toutes les entrées précédentes (shell uniquement)
</pre></div>
</div>
<p>Voici un exemple :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go"> _1 = 2^2 * 5^2</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go"> _2 = -1</span>
<span class="gp">sage: </span><span class="o">%</span><span class="n">hist</span>   <span class="c">#Fonctionne depuis le shell mais pas depuis le notebook.</span>
<span class="go">1: factor(100)</span>
<span class="go">2: kronecker_symbol(3,5)</span>
<span class="go">3: %hist</span>
<span class="gp">sage: </span><span class="n">_oh</span>
<span class="go"> _4 = {1: 2^2 * 5^2, 2: -1}</span>
<span class="gp">sage: </span><span class="n">_i1</span>
<span class="go"> _5 = &#39;factor(ZZ(100))\n&#39;</span>
<span class="gp">sage: </span><span class="nb">eval</span><span class="p">(</span><span class="n">_i1</span><span class="p">)</span>
<span class="go"> _6 = 2^2 * 5^2</span>
<span class="gp">sage: </span><span class="o">%</span><span class="n">hist</span>
<span class="go">1: factor(100)</span>
<span class="go">2: kronecker_symbol(3,5)</span>
<span class="go">3: %hist</span>
<span class="go">4: _oh</span>
<span class="go">5: _i1</span>
<span class="go">6: eval(_i1)</span>
<span class="go">7: %hist</span>
</pre></div>
</div>
<p>Dans la suite de ce tutorial et le reste de la documentation de Sage,
nous omettrons la numérotation des sorties.</p>
<p>Il est possible de créer (pour la durée d&#8217;une session) une macro qui
rappelle une liste de plusieurs lignes d&#8217;entrée.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="o">%</span><span class="n">hist</span>
<span class="go">1: E = EllipticCurve([1,2,3,4,5])</span>
<span class="go">2: M = ModularSymbols(37)</span>
<span class="go">3: %hist</span>
<span class="gp">sage: </span><span class="o">%</span><span class="n">macro</span> <span class="n">em</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span>
<span class="go">Macro `em` created. To execute, type its name (without quotes).</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">sage: </span><span class="n">em</span>
<span class="go">Executing Macro...</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<p>Depuis le shell interactif Sage, il est possible d&#8217;exécuter une commande
Unix en la faisant précéder d&#8217;un point d&#8217;exclamation <tt class="docutils literal"><span class="pre">!</span></tt>. Par exemple,</p>
<div class="highlight-python"><div class="highlight"><pre>sage: !ls
auto  example.sage glossary.tex  t  tmp  tut.log  tut.tex
</pre></div>
</div>
<p>renvoie la liste des fichiers du répertoire courant.</p>
<p>Dans ce contexte, le <tt class="docutils literal"><span class="pre">PATH</span></tt> commence par le répertoire des binaires
de Sage, de sorte que les commandes <tt class="docutils literal"><span class="pre">gp</span></tt>, <tt class="docutils literal"><span class="pre">gap</span></tt>, <tt class="docutils literal"><span class="pre">singular</span></tt>,
<tt class="docutils literal"><span class="pre">maxima</span></tt>, etc. appellent les versions inclues dans Sage.</p>
<div class="highlight-python"><div class="highlight"><pre>sage: !gp
Reading GPRC: /etc/gprc ...Done.

                           GP/PARI CALCULATOR Version 2.2.11 (alpha)
                  i686 running linux (ix86/GMP-4.1.4 kernel) 32-bit version
...
sage: !singular
                     SINGULAR                             /  Development
 A Computer Algebra System for Polynomial Computations   /   version 3-0-1
                                                       0&lt;
     by: G.-M. Greuel, G. Pfister, H. Schoenemann        \   October 2005
FB Mathematik der Universitaet, D-67653 Kaiserslautern    \
</pre></div>
</div>
</div>
<div class="section" id="journal-des-entrees-sorties">
<h2>Journal des entrées-sorties<a class="headerlink" href="#journal-des-entrees-sorties" title="Lien permanent vers ce titre">¶</a></h2>
<p>Enregistrer le journal d&#8217;une session Sage n&#8217;est pas la même chose que
sauvegarder la session (voir <a class="reference internal" href="#section-save"><em>Enregister et recharger des sessions entières</em></a> pour cette possibilité).
Pour tenir un journal des entrées (et optionnellement des sorties) de
Sage, utilisez la commande <tt class="docutils literal"><span class="pre">logstart</span></tt>. Tapez <tt class="docutils literal"><span class="pre">logsatart?</span></tt> pour plus
d&#8217;informations. Cette commande permet d&#8217;enregistrer toutes les entrées que
vous tapez, toutes les sorties, et de rejouer ces entrées dans une
session future (en rechargeant le fichier journal).</p>
<div class="highlight-python"><div class="highlight"><pre>was@form:~$ sage
----------------------------------------------------------------------
| SAGE Version 3.0.2, Release Date: 2008-05-24                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------

sage: logstart setup
Activating auto-logging. Current session state plus future input saved.
Filename       : setup
Mode           : backup
Output logging : False
Timestamping   : False
State          : active
sage: E = EllipticCurve([1,2,3,4,5]).minimal_model()
sage: F = QQ^3
sage: x,y = QQ[&#39;x,y&#39;].gens()
sage: G = E.gens()
sage:
Exiting SAGE (CPU time 0m0.61s, Wall time 0m50.39s).
was@form:~$ sage
----------------------------------------------------------------------
| SAGE Version 3.0.2, Release Date: 2008-05-24                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------

sage: load(&quot;setup&quot;)
Loading log file &lt;setup&gt; one line at a time...
Finished replaying log file &lt;setup&gt;
sage: E
Elliptic Curve defined by y^2 + x*y  = x^3 - x^2 + 4*x + 3 over Rational
Field
sage: x*y
x*y
sage: G
[(2 : 3 : 1)]
</pre></div>
</div>
<p>Si vous utilisez le terminal Konsole de KDE, vous pouvez aussi sauver votre
session comme suit : après avoir lancé Sage dans la <tt class="docutils literal"><span class="pre">konsole</span></tt>, ouvrez
le menu « Configuration » et choisissez « Historique... » puis comme
nombre de lignes « Illimité ». Ensuite, lorsque vous souhaitez
enregistrer l&#8217;état de votre session, sélectionnez « Enregistrer
l&#8217;historique sous... » dans le menu « Édition » et entrez le nom d&#8217;un
fichier où enregistrer le texte de votre session. Une fois le fichier
sauvegardé, vous pouvez par exemple l&#8217;ouvrir dans un éditeur comme xemacs et
l&#8217;imprimer.</p>
</div>
<div class="section" id="coller-du-texte-ignore-les-invites">
<h2>Coller du texte ignore les invites<a class="headerlink" href="#coller-du-texte-ignore-les-invites" title="Lien permanent vers ce titre">¶</a></h2>
<p>Imaginons que vous lisiez une session Sage ou Python et que vous vouliez
copier-coller les calculs dans Sage. Le problème est qu&#8217;il y a des
invites <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> ou <tt class="docutils literal"><span class="pre">sage:</span></tt> en plus des entrées. En fait, vous pouvez
tout à fait copier un exemple complet, invites comprises : par défaut,
l&#8217;analyseur syntaxique de Sage supprime les <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> et <tt class="docutils literal"><span class="pre">sage:</span></tt> en
début de ligne avant de passer la ligne à Python. Par exemple, les
lignes suivantes sont interprétées correctement :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">10</span>
<span class="go">1024</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="p">:</span> <span class="n">sage</span><span class="p">:</span> <span class="mi">2</span><span class="o">^</span><span class="mi">10</span>
<span class="go">1024</span>
<span class="gp">sage: </span><span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="o">^</span><span class="mi">10</span>
<span class="go">1024</span>
</pre></div>
</div>
</div>
<div class="section" id="mesure-du-temps-d-execution-d-une-commande">
<h2>Mesure du temps d&#8217;exécution d&#8217;une commande<a class="headerlink" href="#mesure-du-temps-d-execution-d-une-commande" title="Lien permanent vers ce titre">¶</a></h2>
<p>Si une ligne d&#8217;entrée commence par <tt class="docutils literal"><span class="pre">%time</span></tt>, le temps d&#8217;exécution de la
commande correspondante est affiché après la sortie. Nous pouvons par
exemple comparer le temps que prend le calcul d&#8217;une certaine puissance
entière par diverses méthodes. Les temps de calcul ci-dessous seront
sans doute très différents suivant l&#8217;ordinateur, voire la version de
Sage utilisés. Premièrement, en pur Python :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="o">%</span><span class="n">time</span> <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">^</span><span class="nb">int</span><span class="p">(</span><span class="mi">99484</span><span class="p">)</span>
<span class="go">CPU times: user 0.66 s, sys: 0.00 s, total: 0.66 s</span>
<span class="go">Wall time: 0.66</span>
</pre></div>
</div>
<p>Le calcul a pris 0.66 seconde, pendant un intervalle de <em>wall time</em> (le
temps de votre montre) lui aussi de 0.66 seconde. Si d&#8217;autres programmes
qui s&#8217;exécutent en même temps que Sage chargent l&#8217;ordinateur avec de gros
calculs, le <em>wall time</em> peut être nettement plus important que le temps
processeur.</p>
<p>Chronométrons maintenant le calcul de la même puissance avec le type
Integer de Sage, qui est implémenté (en Cython) en utilisant la
bibliothèque GMP :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="o">%</span><span class="n">time</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1938</span><span class="o">^</span><span class="mi">99484</span>
<span class="go">CPU times: user 0.04 s, sys: 0.00 s, total: 0.04 s</span>
<span class="go">Wall time: 0.04</span>
</pre></div>
</div>
<p>Avec l&#8217;interface à la bibliothèque C PARI :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="o">%</span><span class="n">time</span> <span class="n">a</span> <span class="o">=</span> <span class="n">pari</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">^</span><span class="n">pari</span><span class="p">(</span><span class="mi">99484</span><span class="p">)</span>
<span class="go">CPU times: user 0.05 s, sys: 0.00 s, total: 0.05 s</span>
<span class="go">Wall time: 0.05</span>
</pre></div>
</div>
<p>GMP est plus rapide, mais de peu (ce n&#8217;est pas une surprise, car la
version de PARI incluse dans Sage utilise GMP pour l&#8217;arithmétique
entière).</p>
<p>Il est aussi possible de chronométrer tout un bloc de commandes avec la
commande <tt class="docutils literal"><span class="pre">cputime</span></tt>, comme dans l&#8217;exemple suivant :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">^</span><span class="nb">int</span><span class="p">(</span><span class="mi">99484</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1938</span><span class="o">^</span><span class="mi">99484</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">pari</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">^</span><span class="n">pari</span><span class="p">(</span><span class="mi">99484</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                       <span class="c">#random</span>
<span class="go">0.64</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>sage: cputime?
...
    Return the time in CPU second since SAGE started, or with optional
    argument t, return the time since time t.
    INPUT:
        t -- (optional) float, time in CPU seconds
    OUTPUT:
        float -- time in CPU seconds
</pre></div>
</div>
<p>La commande <tt class="docutils literal"><span class="pre">walltime</span></tt> fonctionne comme <tt class="docutils literal"><span class="pre">cputime</span></tt>, à ceci près
qu&#8217;elle mesure le temps total écoulé « à la montre ».</p>
<p>Nous pouvons aussi faire faire le calcul de puissance ci-dessus à chacun
des systèmes de calcul formel inclus dans Sage. Dans chaque cas, nous
commençons par lancer une commande triviale dans le système en question,
de façon à démarrer son serveur. La mesure la plus pertinente est le
<em>wall time</em>. Cependant, si la différence entre celui-ci et le temps
processeur est importante, cela peut indiquer un problème de performance
qui mérite d&#8217;être examiné.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">time</span> <span class="mi">1938</span><span class="o">^</span><span class="mi">99484</span><span class="p">;</span>
<span class="go">CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s</span>
<span class="go">Wall time: 0.01</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="s">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.04</span>
<span class="gp">sage: </span><span class="n">maxima</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">maxima</span><span class="p">(</span><span class="s">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.30</span>
<span class="gp">sage: </span><span class="n">kash</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">kash</span><span class="p">(</span><span class="s">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.04</span>
<span class="gp">sage: </span><span class="n">mathematica</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">        0</span>
<span class="gp">sage: </span><span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">mathematica</span><span class="p">(</span><span class="s">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.03</span>
<span class="gp">sage: </span><span class="n">maple</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">maple</span><span class="p">(</span><span class="s">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.11</span>
<span class="gp">sage: </span><span class="n">gap</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">gap</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&#39;1938^99484;;&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 1.02</span>
</pre></div>
</div>
<p>Nous voyons que GAP et Maxima sont les plus lents sur ce test (lancé sur
la machine <tt class="docutils literal"><span class="pre">sage.math.washington.edu</span></tt>). Mais en raison du surcoût de
l&#8217;interface pexpect, la comparaison avec Sage, qui est le plus rapide,
n&#8217;est pas vraiment équitable.</p>
</div>
<div class="section" id="trucs-et-astuces-ipython">
<h2>Trucs et astuces IPython<a class="headerlink" href="#trucs-et-astuces-ipython" title="Lien permanent vers ce titre">¶</a></h2>
<p>Comme signalé plus haut, Sage utilise l&#8217;interpréteur de commandes IPython, et
met donc à votre disposition toutes les commandes et fonctionnalités de
celui-ci. Vous voudrez peut-être consulter la <a class="reference external" href="http://ipython.scipy.org/moin/Documentation">documentation complète de IPython</a>. Voici en attendant quelques
astuces utiles &#8211; qui reposent sur ce que IPython appelle des « commandes
magiques » :</p>
<ul>
<li><p class="first">La commande magique <tt class="docutils literal"><span class="pre">%bg</span></tt> lance une commande en arrière-plan. Le résultat
sera ensuite accessible à travers l&#8217;objet <tt class="docutils literal"><span class="pre">jobs</span></tt>, comme dans l&#8217;exemple
ci-dessous. (Les commentaires « not tested » sont là parce que <tt class="docutils literal"><span class="pre">%bg</span></tt> ne
fonctionne pas correctement dans l&#8217;infrastructure de test automatisé de Sage,
mais si vous reproduisez l&#8217;exemple, il devrait fonctionner comme indiqué.
Naturellement, <tt class="docutils literal"><span class="pre">%bg</span></tt> est surtout utile pour les commandes dont l&#8217;exécution
prend beaucoup de temps.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">def</span> <span class="nf">quick</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span>
<span class="gp">sage: </span><span class="o">%</span><span class="n">bg</span> <span class="n">quick</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="c"># not tested</span>
<span class="go">Starting job # 0 in a separate thread.</span>
<span class="gp">sage: </span><span class="n">jobs</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>  <span class="c"># not tested</span>
<span class="go">Completed jobs:</span>
<span class="go">0 : quick(20)</span>
<span class="gp">sage: </span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">result</span>  <span class="c"># the actual answer, not tested</span>
<span class="go">40</span>
</pre></div>
</div>
<p>Attention, les tâches lancées en arrière-plan ignorent le préprocesseur Sage
(voir section <a class="reference internal" href="afterword.html#section-mathannoy"><em>Le préprocesseur Sage et les différences entre Sage et Python</em></a>). Une manière (certes pas très
commode) de contourner le problème est la suivante</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="o">%</span><span class="n">bg</span> <span class="nb">eval</span><span class="p">(</span><span class="n">preparse</span><span class="p">(</span><span class="s">&#39;quick(20)&#39;</span><span class="p">))</span> <span class="c"># not tested</span>
</pre></div>
</div>
<p>Mais il est plus simple et plus sûr de réserver <tt class="docutils literal"><span class="pre">%bg</span></tt> aux commandes en pur
Python, qui ne font pas appel au préprocesseur.</p>
</li>
<li><p class="first">Lorsque l&#8217;on souhaite saisir un morceau de code complexe, on peut utiliser
<tt class="docutils literal"><span class="pre">%edit</span></tt> (ou <tt class="docutils literal"><span class="pre">%ed</span></tt>, ou <tt class="docutils literal"><span class="pre">ed</span></tt>) pour ouvrir un éditeur de texte.
Assurez-vous que la variable d&#8217;environnement <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">EDITOR</span></tt> est réglée à
votre éditeur favori au démarrage de Sage (en plaçant si nécessaire quelque
chose du genre <tt class="docutils literal"><span class="pre">export</span> <span class="pre">EDITOR=/usr/bin/emacs</span></tt> ou encore  <tt class="docutils literal"><span class="pre">export</span>
<span class="pre">EDITOR=/usr/bin/vim</span></tt> dans un fichier de configuration convenable, par
exemple <tt class="docutils literal"><span class="pre">.profile</span></tt>). La commande <tt class="docutils literal"><span class="pre">%edit</span></tt> à l&#8217;invite de Sage ouvrira
l&#8217;éditeur sélectionné. Vous pouvez alors par exemple saisir une définition de
fonction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">some_function</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span>
</pre></div>
</div>
<p>puis enregistrer le fichier et quitter l&#8217;éditeur. La fonction
<tt class="docutils literal"><span class="pre">some_function</span></tt> est désormais disponible dans votre session Sage, et vous
pouvez la modifier en saisissant <tt class="docutils literal"><span class="pre">edit</span> <span class="pre">some_function</span></tt> à l&#8217;invite de
commande.</p>
</li>
<li><p class="first">Si vous souhaitez reprendre une version modifiée du résultat d&#8217;un calcul dans
une nouvelle commande, tapez <tt class="docutils literal"><span class="pre">%rep</span></tt> après avoir fait le calcul. Cela
récupère le texte du résultat et le place sur la ligne de commande, prêt à
être modifié.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-sin(x)</span>
</pre></div>
</div>
<p>Ainsi, après les commandes ci-dessus, la commande <tt class="docutils literal"><span class="pre">%rep</span></tt> fournit un nouvel
invite de commande pré-rempli avec le texte <tt class="docutils literal"><span class="pre">-sin(x)</span></tt> et le curseur en fin
de ligne.</p>
</li>
</ul>
<p>Pour plus d&#8217;information, entrez la commande <tt class="docutils literal"><span class="pre">%quickref</span></tt> pour un résumé des
possibilités de IPython. Au moment où cette documentation est écrite
(avril 2011), Sage emploie IPython 0.9.1. La <a class="reference external" href="http://ipython.org/ipython-doc/dev/interactive/tutorial.html#magic-functions">documentation des commandes
magiques</a>
est disponible en ligne, et divers aspects un peu plus avancés de leur
fonctionnement sont décrits <a class="reference external" href="http://ipython.org/ipython-doc/stable/interactive/reference.html#magic-command-system">ici</a>.</p>
</div>
<div class="section" id="erreurs-et-exceptions">
<h2>Erreurs et exceptions<a class="headerlink" href="#erreurs-et-exceptions" title="Lien permanent vers ce titre">¶</a></h2>
<p>Quand quelque chose ne marche pas, cela se manifeste habituellement par
une « exception » Python. Python essaie de plus de donner une idée de ce
qui a pu déclencher l&#8217;exception. Bien souvent, il affiche le nom de
l&#8217;exception (par exemple <tt class="docutils literal"><span class="pre">NameError</span></tt> ou <tt class="docutils literal"><span class="pre">ValueError</span></tt>, voir le manuel
de référence de Python <a class="reference internal" href="bibliography.html#py" id="id1">[Py]</a> pour une liste complète). Par exemple :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="mi">3</span><span class="n">_2</span>
<span class="go">------------------------------------------------------------</span>
<span class="go">   File &quot;&lt;console&gt;&quot;, line 1</span>
<span class="go">     ZZ(3)_2</span>
<span class="go">           ^</span>
<span class="go">SyntaxError: invalid syntax</span>

<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">infinity</span><span class="p">])</span>
<span class="go">------------------------------------------------------------</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Unable to coerce Infinity (&lt;class &#39;sage...Infinity&#39;&gt;) to Rational</span>
</pre></div>
</div>
<p>Le débogueur interactif est parfois utile pour comprendre ce qu&#8217;il s&#8217;est
passé. Il s&#8217;active ou se désactive avec <tt class="docutils literal"><span class="pre">%pdb</span></tt> (et est désactivé par
défaut). L&#8217;invite <tt class="docutils literal"><span class="pre">ipdb&gt;&gt;</span></tt> du débogueur apparaît si une exception a
lieu alors que celui-ci est actif. Le débogueur permet d&#8217;afficher l&#8217;état
de n&#8217;importe quelle variable locale et de monter ou descendre dans la
pile d&#8217;exécution. Par exemple :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="o">%</span><span class="n">pdb</span>
<span class="go">Automatic pdb calling has been turned ON</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">infinity</span><span class="p">])</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">&lt;type &#39;exceptions.TypeError&#39;&gt;             Traceback (most recent call last)</span>
<span class="gp">...</span>

<span class="go">ipdb&gt;</span>
</pre></div>
</div>
<p>Pour obtenir une liste des commandes disponibles dans le débogueur,
tapez <tt class="docutils literal"><span class="pre">?</span></tt> à l&#8217;invite <tt class="docutils literal"><span class="pre">ipdb&gt;</span></tt> :</p>
<div class="highlight-python"><div class="highlight"><pre>ipdb&gt; ?

Documented commands (type help &lt;topic&gt;):
========================================
EOF    break  commands   debug    h       l     pdef   quit    tbreak
a      bt     condition  disable  help    list  pdoc   r       u
alias  c      cont       down     ignore  n     pinfo  return  unalias
args   cl     continue   enable   j       next  pp     s       up
b      clear  d          exit     jump    p     q      step    w
whatis where

Miscellaneous help topics:
==========================
exec  pdb

Undocumented commands:
======================
retval  rv
</pre></div>
</div>
<p>Tapez Ctrl-D ou <tt class="docutils literal"><span class="pre">quit</span></tt> pour revenir à Sage.</p>
</div>
<div class="section" id="recherche-en-arriere-et-completion-de-ligne-de-commande">
<span id="section-tabcompletion"></span><h2>Recherche en arrière et complétion de ligne de commande<a class="headerlink" href="#recherche-en-arriere-et-completion-de-ligne-de-commande" title="Lien permanent vers ce titre">¶</a></h2>
<p>Commençons par créer l&#8217;espace vectoriel de dimension trois
<span class="math">\(V=\QQ^3\)</span> comme suit :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span>
<span class="go">Vector space of dimension 3 over Rational Field</span>
</pre></div>
</div>
<p>Nous pouvons aussi utiliser la variante plus concise :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span>
</pre></div>
</div>
<p>Tapez ensuite le début d&#8217;une commande, puis <tt class="docutils literal"><span class="pre">Ctrl-p</span></tt> (ou flèche vers
le haut) pour passer en revue les lignes qui commencent par les mêmes
lettres parmi celles que vous avez entrées jusque-là. Cela fonctionne
même si vous avez quitté et relancé Sage entre-temps. Vous pouvez aussi
rechercher une portion de commande en remontant dans l&#8217;historique avec
<tt class="docutils literal"><span class="pre">Ctrl-r</span></tt>. Toutes ces fonctionnalités reposent sur la bibliothèque
<tt class="docutils literal"><span class="pre">readline</span></tt>, qui existe pour la plupart des variantes de Linux.</p>
<p>La complétion de ligne de commande permet d&#8217;obtenir facilement la liste
des fonctions membres de <span class="math">\(V\)</span> : tapez simplement <tt class="docutils literal"><span class="pre">V.</span></tt> puis
appuyez sur la touche tabulation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="p">[</span><span class="n">tab</span> <span class="n">key</span><span class="p">]</span>
<span class="go">V._VectorSpace_generic__base_field</span>
<span class="gp">...</span>
<span class="go">V.ambient_space</span>
<span class="go">V.base_field</span>
<span class="go">V.base_ring</span>
<span class="go">V.basis</span>
<span class="go">V.coordinates</span>
<span class="gp">...</span>
<span class="go">V.zero_vector</span>
</pre></div>
</div>
<p>Si vous tapez les quelques premières lettres d&#8217;un nom de fonction avant
d&#8217;appuyer sur <tt class="docutils literal"><span class="pre">tab</span></tt>, vous n&#8217;obtiendrez que les fonctions qui
commencent par ces quelques lettres :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="n">tab</span> <span class="n">key</span><span class="p">]</span>
<span class="go">V.is_ambient  V.is_dense    V.is_full     V.is_sparse</span>
</pre></div>
</div>
<p>Si vous cherchez à savoir ce que fait une fonction, par exemple la
fonction coordinates, <tt class="docutils literal"><span class="pre">V.coordinates?</span></tt> affiche un message d&#8217;aide et
<tt class="docutils literal"><span class="pre">V.coordinates??</span></tt> le code source de la fonction, comme expliqué dans
la section suivante.</p>
</div>
<div class="section" id="aide-en-ligne">
<h2>Aide en ligne<a class="headerlink" href="#aide-en-ligne" title="Lien permanent vers ce titre">¶</a></h2>
<p>Sage dispose d&#8217;un système d&#8217;aide intégré. Pour obtenir la documentation
d&#8217;une fonction, tapez son nom suivi d&#8217;un point d&#8217;interrogation.</p>
<div class="highlight-python"><div class="highlight"><pre>sage: V = QQ^3
sage: V.coordinates?
Type:           instancemethod
Base Class:     &lt;type &#39;instancemethod&#39;&gt;
String Form:    &lt;bound method FreeModule_ambient_field.coordinates of Vector
space of dimension 3 over Rational Field&gt;
Namespace:      Interactive
File:           /home/was/s/local/lib/python2.4/site-packages/sage/modules/f
ree_module.py
Definition:     V.coordinates(self, v)
Docstring:
    Write v in terms of the basis for self.

    Returns a list c such that if B is the basis for self, then

            sum c_i B_i = v.

    If v is not in self, raises an ArithmeticError exception.

    EXAMPLES:
        sage: M = FreeModule(IntegerRing(), 2); M0,M1=M.gens()
        sage: W = M.submodule([M0 + M1, M0 - 2*M1])
        sage: W.coordinates(2*M0-M1)
        [2, -1]
</pre></div>
</div>
<p>Comme nous pouvons le voir ci-dessus, la sortie indique le type de
l&#8217;objet, le nom du fichier où il est défini, et donne une description
de l&#8217;effet de la fonction, avec des exemples que vous pouvez copier dans
votre session Sage. Pratiquement tous ces exemples sont automatiquement
testés régulièrement pour s&#8217;assurer qu&#8217;ils se comportent exactement
comme indiqué.</p>
<p>Une autre fonctionnalité, nettement dans l&#8217;esprit du caractère ouvert de
Sage, est que lorsque <tt class="docutils literal"><span class="pre">f</span></tt> est une fonction Python, taper <tt class="docutils literal"><span class="pre">f??</span></tt>
affiche son code source. Par exemple,</p>
<div class="highlight-python"><div class="highlight"><pre>sage: V = QQ^3
sage: V.coordinates??
Type:           instancemethod
...
Source:
def coordinates(self, v):
        &quot;&quot;&quot;
        Write $v$ in terms of the basis for self.
        ...
        &quot;&quot;&quot;
        return self.coordinate_vector(v).list()
</pre></div>
</div>
<p>Nous voyons que la fonction <tt class="docutils literal"><span class="pre">coordinates</span></tt> ne fait qu&#8217;appeler
<tt class="docutils literal"><span class="pre">coordinate_vector</span></tt> et transformer le résultat en une liste. Mais alors,
que fait la fonction <tt class="docutils literal"><span class="pre">coordinate_vector</span></tt> ?</p>
<div class="highlight-python"><div class="highlight"><pre>sage: V = QQ^3
sage: V.coordinate_vector??
...
def coordinate_vector(self, v):
        ...
        return self.ambient_vector_space()(v)
</pre></div>
</div>
<p>La fonction <tt class="docutils literal"><span class="pre">coordinate_vector</span></tt> convertit son entrée en un élément de
l&#8217;espace ambiant, ce qui a pour effet de calculer le vecteur des
coefficients de  <span class="math">\(v\)</span> dans <span class="math">\(V\)</span>. L&#8217;espace <span class="math">\(V\)</span> est déjà
« l&#8217;espace ambiant » puisque c&#8217;est simplement <span class="math">\(\QQ^3\)</span>. Il y
a aussi une fonction <tt class="docutils literal"><span class="pre">coordinate_vector</span></tt> différente pour les
sous-espaces. Créons un sous-espace et examinons-là :</p>
<div class="highlight-python"><div class="highlight"><pre>sage: V = QQ^3; W = V.span_of_basis([V.0, V.1])
sage: W.coordinate_vector??
...
def coordinate_vector(self, v):
        &quot;&quot;&quot;
         ...
        &quot;&quot;&quot;
        # First find the coordinates of v wrt echelon basis.
        w = self.echelon_coordinate_vector(v)
        # Next use transformation matrix from echelon basis to
        # user basis.
        T = self.echelon_to_user_matrix()
        return T.linear_combination_of_rows(w)
</pre></div>
</div>
<p>(Si vous pensez que cette implémentation est inefficace, venez nous
aider à optimiser l&#8217;algèbre linéaire !)</p>
<p>Vous pouvez aussi taper <tt class="docutils literal"><span class="pre">help(commande)</span></tt> ou <tt class="docutils literal"><span class="pre">help(classe)</span></tt> pour
appeler une sorte de page de manuel relative à une commande ou une
classe.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">help</span><span class="p">(</span><span class="n">VectorSpace</span><span class="p">)</span>
<span class="go">Help on class VectorSpace ...</span>

<span class="go">class VectorSpace(__builtin__.object)</span>
<span class="go"> |  Create a Vector Space.</span>
<span class="go"> |</span>
<span class="go"> |  To create an ambient space over a field with given dimension</span>
<span class="go"> |  using the calling syntax ...</span>
<span class="go"> :</span>
<span class="go"> :</span>
</pre></div>
</div>
<p>Pour quitter la page d&#8217;aide, appuyez sur <tt class="docutils literal"><span class="pre">q</span></tt>. Votre session revient à
l&#8217;écran comme elle était : contrairement à la sortie de <tt class="docutils literal"><span class="pre">fonction?</span></tt>,
celle de <tt class="docutils literal"><span class="pre">help</span></tt> n&#8217;encombre pas votre session. Une possibilité
particulièrement utile est de consulter l&#8217;aide d&#8217;un module entier avec
<tt class="docutils literal"><span class="pre">help(nom_du_module</span></tt>. Par exemple, les espaces vectoriels sont définis
dans  <tt class="docutils literal"><span class="pre">sage.modules.free_module</span></tt>, et on accède à la documentation de
ce module en tapant <tt class="docutils literal"><span class="pre">help(sage.modules.free_module)</span></tt>. Lorsque vous
lisez une page de documentation avec la commande <tt class="docutils literal"><span class="pre">help</span></tt>, vous pouvez
faire des recherches en avant en tapant <tt class="docutils literal"><span class="pre">/</span></tt> et en arrière en tapant
<tt class="docutils literal"><span class="pre">?</span></tt>.</p>
</div>
<div class="section" id="enregistrer-et-charger-des-objets-individuellement">
<h2>Enregistrer et charger des objets individuellement<a class="headerlink" href="#enregistrer-et-charger-des-objets-individuellement" title="Lien permanent vers ce titre">¶</a></h2>
<p>Imaginons que nous calculions une matrice, ou pire, un espace compliqué
de symboles modulaires, et que nous souhaitions les sauvegarder pour
un usage futur. Les systèmes de calcul formel ont différentes approches
pour permettre cela.</p>
<ol class="arabic simple">
<li><strong>Sauver la partie :</strong> il n&#8217;est possible de sauver que la session
entière (p.ex. GAP, Magma).</li>
<li><strong>Format d&#8217;entrée/sortie unifié :</strong> chaque objet est
affiché sous une forme qui peut être relue (GP/PARI).</li>
<li><strong>Eval :</strong> permettre d&#8217;évaluer facilement du code arbitraire dans
l&#8217;interpréteur (p.ex. Singular, PARI).</li>
</ol>
<p>Utilisant Python, Sage adopte une approche différente, à savoir que tous
les objets peuvent être sérialisés, i.e. transformés en chaînes de
caractères à partir desquelles ils peuvent être reconstruits. C&#8217;est une
méthode semblable dans l&#8217;esprit à l&#8217;unification des entrées et sorties
de PARI, avec l&#8217;avantage que l&#8217;affichage normal des objets n&#8217;a pas
besoin d&#8217;être trop compliqué. En outre, cette fonction de sauvegarde et
de relecture des objets ne nécessite (dans la plupart des cas) aucune
programmation supplémentaire : il s&#8217;agit simplement une fonctionnalité de
Python fournie par le langage depuis la base.</p>
<p>Quasiment n&#8217;importe quel objet Sage <tt class="docutils literal"><span class="pre">x</span></tt> peut être enregistré sur le
disque, dans un format compressé, avec <tt class="docutils literal"><span class="pre">save(x,</span> <span class="pre">nom_de_fichier)</span></tt> (ou
dans bien des cas <tt class="docutils literal"><span class="pre">x.save(nom_de_fichier)</span></tt>). Pour recharger les
objets, on utilise <tt class="docutils literal"><span class="pre">load(nom_de_fichier)</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[ 15  18  21]</span>
<span class="go">[ 42  54  66]</span>
<span class="go">[ 69  90 111]</span>
<span class="gp">sage: </span><span class="n">save</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Quittez puis redémarrez maintenant Sage. Vous pouvez récupérer <tt class="docutils literal"><span class="pre">A</span></tt> :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[ 15  18  21]</span>
<span class="go">[ 42  54  66]</span>
<span class="go">[ 69  90 111]</span>
</pre></div>
</div>
<p>Vous pouvez faire de même avec des objets plus compliqués, par exemple
des courbes elliptiques. Toute l&#8217;information en cache sur l&#8217;objet est
stockée avec celui-ci :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">anlist</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>              <span class="c"># prend un moment</span>
<span class="gp">sage: </span><span class="n">save</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">quit</span>
</pre></div>
</div>
<p>Ainsi, la version sauvegardée de <tt class="docutils literal"><span class="pre">E</span></tt> prend 153 kilo-octets car elle
contient les 100000 premiers <span class="math">\(a_n\)</span>.</p>
<div class="highlight-python"><div class="highlight"><pre>~/tmp$ ls -l E.sobj
-rw-r--r--  1 was was 153500 2006-01-28 19:23 E.sobj
~/tmp$ sage [...]
sage: E = load(&#39;E&#39;)
sage: v = E.anlist(100000)              # instantané !
</pre></div>
</div>
<p>(En Python, les sauvegardes et rechargements s&#8217;effectuent à l&#8217;aide du
module <tt class="docutils literal"><span class="pre">cPickle</span></tt>. En particulier, on peut sauver un objet Sage <tt class="docutils literal"><span class="pre">x</span></tt>
par la commande <tt class="docutils literal"><span class="pre">cPickle.dumps(x,</span> <span class="pre">2)</span></tt>.  Attention au <tt class="docutils literal"><span class="pre">2</span></tt> !)</p>
<p>Sage n&#8217;est pas capable de sauvegarder les objets créés dans d&#8217;autres systèmes
de calcul formel comme GAP, Singular, Maxima etc. : au rechargement, ils
sont dans un état marqué « invalide ». Concernant GAP, un certain
nombre d&#8217;objets sont affichés sous une forme qui permet de les
reconstruire, mais d&#8217;autres non, aussi la reconstruction d&#8217;objets GAP
à partir de leur affichage est intentionnellement interdite.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">gap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">load</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The session in which this object was defined is no longer</span>
<span class="go">running.</span>
</pre></div>
</div>
<p>Les objets GP/PARI, en revanche, peuvent être sauvegardés et rechargés,
puisque la forme imprimée d&#8217;un objet suffit à reconstruire celui-ci.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">load</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Un objet sauvegardé peut être rechargé y compris sur un ordinateur doté
d&#8217;une architecture ou d&#8217;un système d&#8217;exploitation différent. Ainsi, il
est possible de sauvegarder une immense matrice sur un OS-X 32 bits, la
recharger sur un Linux 64 bits, l&#8217;y mettre en forme échelon et rapatrier
le résultat. Bien souvent, un objet peut même être rechargé avec une
version de Sage différente de celle utilisée pour le sauver, pourvu que
le code qui gère cet objet n&#8217;ait pas trop changé d&#8217;une version sur
l&#8217;autre. Sauver un objet enregistre tous ses attributs ainsi que la
classe à laquelle il appartient (mais pas son code source). Si cette
classe n&#8217;existe plus dans une version ultérieure de Sage, l&#8217;objet ne
peut pas y être rechargé. Mais il demeure possible de le charger dans
l&#8217;ancienne version pour récupérer son dictionnaire (avec
<tt class="docutils literal"><span class="pre">x.__dict__</span></tt>), sauver celui-ci, et le recharger dans la nouvelle
version.</p>
<div class="section" id="enregistrer-un-objet-comme-texte">
<h3>Enregistrer un objet comme texte<a class="headerlink" href="#enregistrer-un-objet-comme-texte" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une autre possibilité consiste à sauvegarder la représentation texte ASCII
dans un fichier texte brut, ce qui se fait simplement en ouvrant le
fichier en écriture et en y écrivant la représentation de l&#8217;objet (il
est tout à fait possible d&#8217;écrire plusieurs objets). Une fois l&#8217;écriture
terminée, nous refermons le fichier.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span>
<span class="gp">sage: </span><span class="n">o</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;file.txt&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">o</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="enregister-et-recharger-des-sessions-entieres">
<span id="section-save"></span><h2>Enregister et recharger des sessions entières<a class="headerlink" href="#enregister-et-recharger-des-sessions-entieres" title="Lien permanent vers ce titre">¶</a></h2>
<p>Sage dispose de fonctions très souples de sauvegarde et relecture de
sessions entières.</p>
<p>La commande <tt class="docutils literal"><span class="pre">save_session(nom_de_session)</span></tt> enregistre toutes les
variables définies dans la session courante sous forme de dictionnaire
dans le fichier <tt class="docutils literal"><span class="pre">nom_de_session.sobj</span></tt>. (Les éventuelles variables qui
ne supportent pas la sauvegarde sont ignorées.) Le fichier <tt class="docutils literal"><span class="pre">.sobj</span></tt> obtenu
peut être rechargé comme n&#8217;importe quel objet sauvegardé ; on obtient en
le rechargeant un dictionnaire dont les clés sont les noms de variables
et les valeurs les objets correspondants.</p>
<p>La commande <tt class="docutils literal"><span class="pre">reload_session(nom_de_session)</span></tt> charge toutes les
variables sauvées dans <tt class="docutils literal"><span class="pre">nom_de_session</span></tt>. Cela n&#8217;efface pas les
variables déjà définies dans la session courante : les deux sessions
sont fusionnées.</p>
<p>Commençons par démarrer Sage et par définir quelques variables.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">389</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2003</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">t</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go"> _4 = (x - 2004) * (x - 12)^2 * (x + 54)^2</span>
</pre></div>
</div>
<p>Nous sauvons maintenant notre session, ce qui a pour effet d&#8217;enregistrer
dans un même fichier toutes les variables ci-dessus. Nous pouvons
constater que le fichier fait environ 3 ko.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">save_session</span><span class="p">(</span><span class="s">&#39;misc&#39;</span><span class="p">)</span>
<span class="go">Saving a</span>
<span class="go">Saving M</span>
<span class="go">Saving t</span>
<span class="go">Saving E</span>
<span class="gp">sage: </span><span class="n">quit</span>
<span class="go">was@form:~/tmp$ ls -l misc.sobj</span>
<span class="go">-rw-r--r--  1 was was 2979 2006-01-28 19:47 misc.sobj</span>
</pre></div>
</div>
<p>Enfin, nous redémarrons Sage, nous définissons une nouvelle variable, et
nous rechargeons la session précédente.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">19</span>
<span class="gp">sage: </span><span class="n">load_session</span><span class="p">(</span><span class="s">&#39;misc&#39;</span><span class="p">)</span>
<span class="go">Loading a</span>
<span class="go">Loading M</span>
<span class="go">Loading E</span>
<span class="go">Loading t</span>
</pre></div>
</div>
<p>Toutes les variables sauvegardées sont à nouveau disponibles. En outre,
la variable <tt class="docutils literal"><span class="pre">b</span></tt> n&#8217;a pas été écrasée.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span>
<span class="go">Full Modular Symbols space for Gamma_0(37) of weight 2 with sign 0</span>
<span class="go">and dimension 5 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational</span>
<span class="go">Field</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">19</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">389</span>
</pre></div>
</div>
</div>
<div class="section" id="l-interface-notebook">
<span id="section-notebook"></span><h2>L&#8217;interface <em>notebook</em><a class="headerlink" href="#l-interface-notebook" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour démarrer le <em>notebook</em> Sage, tapez</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">notebook</span><span class="p">()</span>
</pre></div>
</div>
<p>sur la ligne de commande Sage. Cela démarre le serveur du <em>notebook</em> et
ouvre votre navigateur web par défaut sur la page correspondante. Les
fichiers d&#8217;état du serveur sont placés dans <tt class="docutils literal"><span class="pre">$HOME/.sage/sage\_notebook</span></tt>.</p>
<p>La variante</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">notebook</span><span class="p">(</span><span class="s">&quot;repertoire&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>lance un nouveau serveur <em>notebook</em> en utilisant les fichiers du
répertoire donné à la place de <tt class="docutils literal"><span class="pre">$HOME/.sage/sage_notebook</span></tt>. Cela peut
être utile si vous voulez gérer une collection de feuilles de travail
attachées à un projet spécifique, ou encore lancer plusieurs instances
du serveur en même temps.</p>
<p>Au démarrage, le <em>notebook</em> commence par créer les fichiers suivants
dans <tt class="docutils literal"><span class="pre">$HOME/.sage/sage_notebook</span></tt> :</p>
<div class="highlight-python"><div class="highlight"><pre>nb.sobj       (fichier objet Sage du notebook)
objects/      (sous-répertoire contenant les objets Sage)
worksheets/   (sous-répertoire contenant les feuilles de travail).
</pre></div>
</div>
<p>Une fois ces fichiers créés, le <em>notebook</em> démarre un serveur web.</p>
<p>Un « <em>notebook</em> » est une collection de comptes utilisateur, qui peuvent
chacun posséder un nombre quelconque de feuilles de travail. Quand vous
créez une nouvelle feuille de travail, les données correspondantes sont
stockées dans un répertoire de la forme
<tt class="docutils literal"><span class="pre">worksheets/utilisateur/numéro</span></tt>. Dans chacun de ces répertoires se trouve un
fichier texte brut <tt class="docutils literal"><span class="pre">worksheet.txt</span></tt> qui contient tout ce qu&#8217;il faut
pour reconstituer la feuille de travail s&#8217;il lui arrive quelque
chose, si Sage rencontre un problème, ou quoi que ce soit de ce genre.</p>
<p>Dans Sage, vous pouvez taper <tt class="docutils literal"><span class="pre">notebook?</span></tt> pour beaucoup plus
d&#8217;informations sur comment démarrer un serveur.</p>
<p>Le schéma suivant présente l&#8217;architecture du <em>Notebook</em> Sage :</p>
<div class="highlight-python"><div class="highlight"><pre>----------------------
|                    |
|                    |
|   firefox/safari   |
|                    |
|     programme      |
|     javascript     |
|                    |
|                    |
----------------------
      |      ^
      | AJAX |
      V      |
----------------------
|                    |
|     serveur        |                processus SAGE 1
|       web          | ------------&gt;  processus SAGE 2  (processus Python)
|       sage         |   pexpect      processus SAGE 3
|                    |                    .
|                    |                    .
----------------------                    .
</pre></div>
</div>
<p>Dans le <em>notebook</em>, pour consulter l&#8217;aide d&#8217;une commande Sage <tt class="docutils literal"><span class="pre">cmd</span></tt>,
tapez <tt class="docutils literal"><span class="pre">cmd?</span></tt> dans le champ d&#8217;entrée des commandes puis tapez <tt class="docutils literal"><span class="pre">&lt;échap&gt;</span></tt>
(et non <tt class="docutils literal"><span class="pre">&lt;maj-entrée&gt;</span></tt>).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table des Matières</a></h3>
            <ul>
<li><a class="reference internal" href="#">La ligne de commande interactive</a><ul>
<li><a class="reference internal" href="#votre-session-sage">Votre session Sage</a></li>
<li><a class="reference internal" href="#journal-des-entrees-sorties">Journal des entrées-sorties</a></li>
<li><a class="reference internal" href="#coller-du-texte-ignore-les-invites">Coller du texte ignore les invites</a></li>
<li><a class="reference internal" href="#mesure-du-temps-d-execution-d-une-commande">Mesure du temps d&#8217;exécution d&#8217;une commande</a></li>
<li><a class="reference internal" href="#trucs-et-astuces-ipython">Trucs et astuces IPython</a></li>
<li><a class="reference internal" href="#erreurs-et-exceptions">Erreurs et exceptions</a></li>
<li><a class="reference internal" href="#recherche-en-arriere-et-completion-de-ligne-de-commande">Recherche en arrière et complétion de ligne de commande</a></li>
<li><a class="reference internal" href="#aide-en-ligne">Aide en ligne</a></li>
<li><a class="reference internal" href="#enregistrer-et-charger-des-objets-individuellement">Enregistrer et charger des objets individuellement</a><ul>
<li><a class="reference internal" href="#enregistrer-un-objet-comme-texte">Enregistrer un objet comme texte</a></li>
</ul>
</li>
<li><a class="reference internal" href="#enregister-et-recharger-des-sessions-entieres">Enregister et recharger des sessions entières</a></li>
<li><a class="reference internal" href="#l-interface-notebook">L&#8217;interface <em>notebook</em></a></li>
</ul>
</li>
</ul>

            <h4>Sujet précédent</h4>
            <p class="topless"><a href="tour_advanced.html"
                                  title="Chapitre précédent">Quelques mathématiques plus avancées</a></p>
            <h4>Sujet suivant</h4>
            <p class="topless"><a href="interfaces.html"
                                  title="Chapitre suivant">Interfaces</a></p>
            <h3>Cette page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/interactive_shell.txt"
                     rel="nofollow">Montrer la source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Recherche rapide</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <!-- The shading of the "Go" button should be consistent -->
                <!-- with the colour of the header and footer. See the file -->
                <!-- doc/common/themes/sage/theme.conf for colours used by -->
                <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Saisissez un mot clef ou un nom de module, classe ou fonction.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="interfaces.html" title="Interfaces"
             >suivant</a> |</li>
        <li class="right" >
          <a href="tour_advanced.html" title="Quelques mathématiques plus avancées"
             >précédent</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="index.html">Tutoriel Sage v7.0</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Créé avec <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>